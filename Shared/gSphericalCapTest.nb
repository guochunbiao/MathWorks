(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    158487,       3431]
NotebookOptionsPosition[    154689,       3364]
NotebookOutlinePosition[    155033,       3379]
CellTagsIndexPosition[    154990,       3376]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "gPrint", "[", "\"\<Intersection points of two spherical caps\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "  ", 
  RowBox[{
   RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", " ", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\"\<spheres\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", "   ", 
          RowBox[{
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"#intsPoints", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}], ",", 
           "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"#intsPoints", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}]}], 
          "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<intsPoints\>\"", "\[Rule]", 
         RowBox[{"Quiet", "@", 
          RowBox[{"gSolveCapIntsPoints", "[", 
           RowBox[{
           "capDir1", ",", "capAperture1", ",", "capDir2", ",", 
            "capAperture2"}], "]"}]}]}], "|>"}], "]"}], ",", 
      "\[IndentingNewLine]", "   ", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<spherCaps\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", "   ", 
          RowBox[{
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir1"}], ",", 
             RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture1"}]}], 
            "|>"}], ",", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir2"}], ",", 
             RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture2"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", "LightBlue", "]"}]}]}], "|>"}]}], 
          "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<capDir1\>\"", "\[Rule]", "capDir1"}], ",", 
         RowBox[{"\"\<capDir2\>\"", "\[Rule]", "capDir2"}], ",", 
         RowBox[{"\"\<capAperture1\>\"", "\[Rule]", "capAperture1"}], ",", 
         RowBox[{"\"\<capAperture2\>\"", "\[Rule]", "capAperture2"}]}], 
        "|>"}], "]"}], ",", "\[IndentingNewLine]", "    ", 
      RowBox[{"\"\<spherCapInts\>\"", "\[Rule]", 
       RowBox[{"{", "\[IndentingNewLine]", "\t ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<spherCapPair\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], ",", 
          RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
           RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
          RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}]}], "|>"}], 
        "\[IndentingNewLine]", "       ", "}"}]}], ",", "\[IndentingNewLine]",
       "     ", 
      RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.5"}]}], 
     "\[IndentingNewLine]", "|>"}], "]"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"capDir1", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capDir2", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}], ",", "0.001"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture1", ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture2", ",", 
       RowBox[{"3", 
        RowBox[{"\[Pi]", "/", "10"}]}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8321212842610292`*^9, 3.8321213227938147`*^9}, {
   3.832210205999543*^9, 3.8322102074834433`*^9}, {3.832210531199204*^9, 
   3.8322105349599004`*^9}, {3.8322105827189474`*^9, 
   3.8322105903449945`*^9}, {3.8322106627300854`*^9, 3.832210770938238*^9}, {
   3.8322199576756883`*^9, 3.8322199971687098`*^9}, 3.8322230471655493`*^9, {
   3.832223115985383*^9, 3.8322231471058607`*^9}, 3.8322242229456453`*^9, {
   3.832230164190217*^9, 3.832230179944717*^9}, {3.832232187553664*^9, 
   3.832232259710579*^9}, {3.8322322955835924`*^9, 3.832232328272789*^9}, {
   3.8322324090605416`*^9, 3.8322324188293915`*^9}, {3.832232503904131*^9, 
   3.8322325253668585`*^9}, {3.8322326444125447`*^9, 
   3.8322326509677362`*^9}, {3.832232871990279*^9, 3.8322328746250467`*^9}, 
   3.8322329881468315`*^9, 3.8322331016087914`*^9, 3.83223313325909*^9, {
   3.8322335161492634`*^9, 3.8322335505715113`*^9}, {3.8322359277321916`*^9, 
   3.832235936282449*^9}, {3.83223608176986*^9, 3.8322360846678195`*^9}, 
   3.8323100516423693`*^9},
 CellLabel->
  "In[147]:=",ExpressionUUID->"f0e648ee-f34f-4104-9ddb-f49c9767f0e9"],

Cell[BoxData[
 StyleBox["\<\" Intersection points of two spherical caps\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8322106909632893`*^9, {3.8322199648480825`*^9, 3.8322199773973064`*^9}, 
   3.8322230187839546`*^9, 3.8322230541231174`*^9, 3.832223118903562*^9, 
   3.8322231559752226`*^9, 3.83222422360089*^9, {3.832230153080617*^9, 
   3.832230182059477*^9}, 3.8322308676890945`*^9, 3.8322322040444546`*^9, 
   3.8322322612603054`*^9, {3.8322323091854897`*^9, 3.832232329081808*^9}, 
   3.8322324196019135`*^9, {3.8322325110883274`*^9, 3.832232526204382*^9}, 
   3.8322326515542507`*^9, 3.832232875576206*^9, 3.8322329892191496`*^9, 
   3.8322331031573305`*^9, 3.8322331341030593`*^9, {3.8322335194669666`*^9, 
   3.832233551237774*^9}, 3.832233866773921*^9, 3.8322359371118126`*^9, 
   3.8322361022587566`*^9, 3.8323086468751926`*^9, {3.8323093921704426`*^9, 
   3.832309403998352*^9}, {3.8323100530927134`*^9, 3.8323100720515137`*^9}, {
   3.832310132245734*^9, 3.832310157995902*^9}, {3.8323192216404467`*^9, 
   3.8323192477024565`*^9}, 3.8327123690943813`*^9, 3.8327294320450974`*^9, 
   3.8327295853207407`*^9, 3.8327311841160746`*^9, 3.8327523839336195`*^9, 
   3.83724460918286*^9},
 CellLabel->
  "During evaluation of \
In[147]:=",ExpressionUUID->"5de4e5b5-7cfb-4dfd-839b-8f963fd1ab95"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`capAperture1$$ = Rational[1, 3] 
    Pi, $CellContext`capAperture2$$ = Rational[3, 10] 
    Pi, $CellContext`capDir1$$ = {0, 0, 1}, $CellContext`capDir2$$ = {1, -1, 
    1}, Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`capDir1$$], {0, 0, 1}}}, {{
       Hold[$CellContext`capDir2$$], {1, -1, 1}}, {-1, -1, 0.001}, {1, 1, 
      1}}, {{
       Hold[$CellContext`capAperture1$$], Rational[1, 3] Pi}, 0, 
      Rational[1, 2] Pi}, {{
       Hold[$CellContext`capAperture2$$], Rational[3, 10] Pi}, 0, 
      Rational[1, 2] Pi}}, Typeset`size$$ = {89., {47., 53.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`capDir2$234852$$ = {0, 0, 
    0}, $CellContext`capAperture1$234853$$ = 
    0, $CellContext`capAperture2$234854$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`capAperture1$$ = 
        Rational[1, 3] Pi, $CellContext`capAperture2$$ = 
        Rational[3, 10] Pi, $CellContext`capDir1$$ = {0, 0, 
         1}, $CellContext`capDir2$$ = {1, -1, 1}}, "ControllerVariables" :> {
        Hold[$CellContext`capDir2$$, $CellContext`capDir2$234852$$, {0, 0, 
         0}], 
        Hold[$CellContext`capAperture1$$, $CellContext`capAperture1$234853$$, 
         0], 
        Hold[$CellContext`capAperture2$$, $CellContext`capAperture2$234854$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> gPlots3D`gParamPlot3D[
        Association[
         ("spheres" -> {
           Association["center" -> Part[
              Slot["intsPoints"], 1], "radius" -> 0.03, 
            "colorFunc" -> (Red& )], 
           Association["center" -> Part[
              Slot["intsPoints"], 2], "radius" -> 0.03, 
            "colorFunc" -> (Red& )]}& )[
          Association["intsPoints" -> Quiet[
             
             gSphericalCap`gSolveCapIntsPoints[$CellContext`capDir1$$, \
$CellContext`capAperture1$$, $CellContext`capDir2$$, \
$CellContext`capAperture2$$]]]], 
         ("spherCaps" -> {
           Association[
           "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> Slot["capDir1"],
             "coneAperture" -> Slot["capAperture1"]], 
           Association[
           "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> Slot["capDir2"],
             "coneAperture" -> Slot["capAperture2"], 
            "colorFunc" -> (LightBlue& )]}& )[
          Association[
          "capDir1" -> $CellContext`capDir1$$, 
           "capDir2" -> $CellContext`capDir2$$, 
           "capAperture1" -> $CellContext`capAperture1$$, 
           "capAperture2" -> $CellContext`capAperture2$$]], "spherCapInts" -> {
           Association[
           "spherCapPair" -> {1, 2}, "colorFunc" -> (Blue& ), "zbias" -> 1]}, 
         "axisExtent" -> 1.5]], 
      "Specifications" :> {{{$CellContext`capDir1$$, {0, 0, 
          1}}}, {{$CellContext`capDir2$$, {1, -1, 1}}, {-1, -1, 0.001}, {1, 1,
          1}}, {{$CellContext`capAperture1$$, Rational[1, 3] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`capAperture2$$, Rational[3, 10] Pi}, 0, 
         Rational[1, 2] Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{140., {71., 77.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8322199648909674`*^9, 3.832219977441945*^9}, 
   3.8322230188288355`*^9, 3.8322230541699886`*^9, 3.8322231189554224`*^9, 
   3.8322231560211*^9, 3.8322242236388173`*^9, {3.8322301531284885`*^9, 
   3.83223018210732*^9}, 3.8322308677333956`*^9, 3.8322322040970383`*^9, 
   3.832232261310172*^9, {3.8322323091834593`*^9, 3.8322323290788155`*^9}, 
   3.832232419599889*^9, {3.832232511082343*^9, 3.8322325262513294`*^9}, 
   3.8322326515522547`*^9, 3.8322328756211147`*^9, 3.832232989267061*^9, 
   3.8322331032013893`*^9, 3.832233134153923*^9, {3.8322335195155544`*^9, 
   3.832233551283167*^9}, 3.832233866831766*^9, 3.8322359371720295`*^9, 
   3.832236102281786*^9, 3.8323086469260564`*^9, {3.8323093922442465`*^9, 
   3.832309404057167*^9}, {3.8323100531495605`*^9, 3.832310072111354*^9}, {
   3.832310132305574*^9, 3.8323101581682153`*^9}, {3.8323192216683416`*^9, 
   3.8323192477673116`*^9}, 3.832712371098277*^9, 3.8327294320895357`*^9, 
   3.8327295853659678`*^9, 3.8327311841679354`*^9, 3.83275238396675*^9, 
   3.837244609212844*^9},
 CellLabel->
  "Out[155]=",ExpressionUUID->"c2cc573d-2b75-46ac-8f19-a5f642c9988a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", 
   "\"\<Approximating centroid point of the intersection of two spherical \
caps\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "centroidPt", ",", "approxCentroid", ",", "asgAxis1", ",", "asgAxis2"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "     ", 
  RowBox[{
   RowBox[{
    RowBox[{"centroidPt", ":=", 
     RowBox[{"Quiet", "@", 
      RowBox[{"gSolveSpherCapIntsCentroid", "[", 
       RowBox[{
       "capDir1", ",", "capAperture1", ",", "capDir2", ",", "capAperture2"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", "     ", 
    RowBox[{"approxCentroid", ":=", 
     RowBox[{"gApproxCapIntsCentroid", "[", 
      RowBox[{
      "capDir1", ",", "capAperture1", ",", "capDir2", ",", "capAperture2"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "     ", 
    RowBox[{"asgAxis1", ":=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"Cross", "[", 
       RowBox[{"capDir1", ",", "capDir2"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "     ", 
    RowBox[{"asgAxis2", ":=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"Cross", "[", 
       RowBox[{"centroidPt", ",", "asgAxis1"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "    ", 
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", "  ", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "#linePos1"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "#lineDir1"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "1"}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "#linePos2"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "#lineDir2"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "1"}]}], "|>"}]}], "\n", 
           "\t\t", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<linePos1\>\"", "\[Rule]", "centroidPt"}], ",", 
          RowBox[{"\"\<lineDir1\>\"", "\[Rule]", "asgAxis1"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<linePos2\>\"", "\[Rule]", "centroidPt"}], ",", 
          RowBox[{"\"\<lineDir2\>\"", "\[Rule]", "asgAxis2"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spheres\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#centroidPt"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#approxCentroid"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.05"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "White", "]"}]}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<centroidPt\>\"", "\[Rule]", "centroidPt"}], ",", 
          RowBox[{"\"\<approxCentroid\>\"", "\[Rule]", "approxCentroid"}]}], 
         "|>"}], "]"}], ",", "\[IndentingNewLine]", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spherCaps\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir1"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture1"}]}], 
             "|>"}], ",", "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir2"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture2"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "LightBlue", "]"}]}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<capDir1\>\"", "\[Rule]", "capDir1"}], ",", 
          RowBox[{"\"\<capDir2\>\"", "\[Rule]", "capDir2"}], ",", 
          RowBox[{"\"\<capAperture1\>\"", "\[Rule]", "capAperture1"}], ",", 
          RowBox[{"\"\<capAperture2\>\"", "\[Rule]", "capAperture2"}]}], 
         "|>"}], "]"}], ",", "\[IndentingNewLine]", "    ", 
       RowBox[{"\"\<spherCapInts\>\"", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", "\t ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<spherCapPair\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], ",", 
           RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
            RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
           RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}]}], "|>"}], 
         "\[IndentingNewLine]", "       ", "}"}]}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"capDir1", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capDir2", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}], ",", "0.001"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture1", ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture2", ",", 
       RowBox[{"3", 
        RowBox[{"\[Pi]", "/", "10"}]}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "centroidPt", ",", "approxCentroid", ",", "asgAxis1", ",", "asgAxis2"}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8322338728432245`*^9, 3.8322338880690837`*^9}, {
   3.8322339230132065`*^9, 3.8322339801315603`*^9}, {3.8322340102226057`*^9, 
   3.832234013612236*^9}, {3.8322354627707*^9, 3.8322354985792847`*^9}, {
   3.8322355499613256`*^9, 3.832235554514228*^9}, {3.832235741114032*^9, 
   3.8322357575210257`*^9}, 3.8322358320352926`*^9, {3.8322358722025166`*^9, 
   3.8322358777627897`*^9}, {3.83223595649769*^9, 3.8322360240895004`*^9}, 
   3.8322360916457896`*^9, {3.8322361537243133`*^9, 3.8322363426543694`*^9}, {
   3.8322363733860292`*^9, 3.8322363867847233`*^9}, {3.832308631017044*^9, 
   3.832308714634387*^9}, 3.8323101123288264`*^9, {3.8323101652807207`*^9, 
   3.83231020724275*^9}, {3.8327425920158625`*^9, 3.832742651856933*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"4fe272e8-3b2c-4b18-b7b5-f7a1a2b26511"],

Cell[BoxData[
 StyleBox["\<\" Approximating centroid point of the intersection of two \
spherical caps\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.8323101328957987`*^9, 3.832310183642114*^9}, {
   3.832310218266827*^9, 3.832310231003992*^9}, {3.8323192179437256`*^9, 
   3.8323192482898846`*^9}, 3.8327123722642903`*^9, 3.8327294323794007`*^9, 
   3.832729585862686*^9, 3.8327311847295785`*^9, 3.832742657490144*^9, 
   3.8327523842835875`*^9, 3.837244609690717*^9},
 CellLabel->
  "During evaluation of \
In[156]:=",ExpressionUUID->"5f350d64-9a34-4b73-acec-647dcd93ea64"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`capAperture1$$ = Rational[1, 3] 
    Pi, $CellContext`capAperture2$$ = Rational[3, 10] 
    Pi, $CellContext`capDir1$$ = {0, 0, 1}, $CellContext`capDir2$$ = {1, -1, 
    1}, Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`capDir1$$], {0, 0, 1}}}, {{
       Hold[$CellContext`capDir2$$], {1, -1, 1}}, {-1, -1, 0.001}, {1, 1, 
      1}}, {{
       Hold[$CellContext`capAperture1$$], Rational[1, 3] Pi}, 0, 
      Rational[1, 2] Pi}, {{
       Hold[$CellContext`capAperture2$$], Rational[3, 10] Pi}, 0, 
      Rational[1, 2] Pi}}, Typeset`size$$ = {89., {54., 60.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`capDir2$235019$$ = {0, 0, 
    0}, $CellContext`capAperture1$235020$$ = 
    0, $CellContext`capAperture2$235021$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`capAperture1$$ = 
        Rational[1, 3] Pi, $CellContext`capAperture2$$ = 
        Rational[3, 10] Pi, $CellContext`capDir1$$ = {0, 0, 
         1}, $CellContext`capDir2$$ = {1, -1, 1}}, "ControllerVariables" :> {
        Hold[$CellContext`capDir2$$, $CellContext`capDir2$235019$$, {0, 0, 
         0}], 
        Hold[$CellContext`capAperture1$$, $CellContext`capAperture1$235020$$, 
         0], 
        Hold[$CellContext`capAperture2$$, $CellContext`capAperture2$235021$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`centroidPt := Quiet[
          
          gSphericalCap`gSolveSpherCapIntsCentroid[$CellContext`capDir1$$, \
$CellContext`capAperture1$$, $CellContext`capDir2$$, \
$CellContext`capAperture2$$]]; $CellContext`approxCentroid := 
        gSphericalCap`gApproxCapIntsCentroid[$CellContext`capDir1$$, \
$CellContext`capAperture1$$, $CellContext`capDir2$$, \
$CellContext`capAperture2$$]; $CellContext`asgAxis1 := Normalize[
          
          Cross[$CellContext`capDir1$$, $CellContext`capDir2$$]]; \
$CellContext`asgAxis2 := Normalize[
          Cross[$CellContext`centroidPt, $CellContext`asgAxis1]]; 
       gPlots3D`gParamPlot3D[
         Association[
          ("lines" -> {
            Association[
            "startPos" -> Slot["linePos1"], "dirVec" -> Slot["lineDir1"], 
             "length" -> 1], 
            Association[
            "startPos" -> Slot["linePos2"], "dirVec" -> Slot["lineDir2"], 
             "length" -> 1]}& )[
           Association[
           "linePos1" -> $CellContext`centroidPt, 
            "lineDir1" -> $CellContext`asgAxis1, 
            "linePos2" -> $CellContext`centroidPt, 
            "lineDir2" -> $CellContext`asgAxis2]], 
          ("spheres" -> {
            Association[
            "center" -> Slot["centroidPt"], "radius" -> 0.03, 
             "colorFunc" -> (Red& )], 
            Association[
            "center" -> Slot["approxCentroid"], "radius" -> 0.05, 
             "colorFunc" -> (White& )]}& )[
           Association[
           "centroidPt" -> $CellContext`centroidPt, 
            "approxCentroid" -> $CellContext`approxCentroid]], 
          ("spherCaps" -> {
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir1"], "coneAperture" -> Slot["capAperture1"]], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir2"], "coneAperture" -> Slot["capAperture2"], 
             "colorFunc" -> (LightBlue& )]}& )[
           Association[
           "capDir1" -> $CellContext`capDir1$$, 
            "capDir2" -> $CellContext`capDir2$$, 
            "capAperture1" -> $CellContext`capAperture1$$, 
            "capAperture2" -> $CellContext`capAperture2$$]], "spherCapInts" -> {
            Association[
            "spherCapPair" -> {1, 2}, "colorFunc" -> (Blue& ), "zbias" -> 1]},
           "axisExtent" -> 1.5]]), 
      "Specifications" :> {{{$CellContext`capDir1$$, {0, 0, 
          1}}}, {{$CellContext`capDir2$$, {1, -1, 1}}, {-1, -1, 0.001}, {1, 1,
          1}}, {{$CellContext`capAperture1$$, Rational[1, 3] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`capAperture2$$, Rational[3, 10] Pi}, 0, 
         Rational[1, 2] Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{140., {78., 84.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.832236163194276*^9, {3.8322363185031805`*^9, 3.8322363436057653`*^9}, {
   3.832236376017442*^9, 3.8322363874853725`*^9}, {3.8323086320336847`*^9, 
   3.832308716017576*^9}, 3.832309409472189*^9, {3.8323100953850207`*^9, 
   3.832310100005382*^9}, {3.8323101303690777`*^9, 3.832310183701954*^9}, {
   3.8323102183096743`*^9, 3.832310231054827*^9}, {3.8323192179702096`*^9, 
   3.8323192483268223`*^9}, 3.83271237230556*^9, 3.8327294324208198`*^9, 
   3.832729585896038*^9, 3.832731184777482*^9, 3.832742657521219*^9, 
   3.8327523843165007`*^9, 3.8372446097261505`*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"8f93673a-0596-4dea-a6d4-5e1257c3e12f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<gSpherCapIntsAreaError\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
  "0.21929180836563508`", ",", "0.32153623337560877`", ",", 
   "0.5305438425774492`", ",", "0.22855000721505725`", ",", 
   "0.7189595228647483`"}], "}"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"{", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"gSpherCapIntsAreaError", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"\[Pi]", "/", "10"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"gSpherCapIntsAreaError", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"\[Pi]", "/", "8"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"gSpherCapIntsAreaError", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"\[Pi]", "/", "6"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"gSpherCapIntsAreaError", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"\[Pi]", "/", "4"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"gSpherCapIntsAreaError", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.832311251586887*^9, 3.8323113120070763`*^9}, {
   3.8323127911958413`*^9, 3.8323127914686017`*^9}, {3.832318810347979*^9, 
   3.832318866499895*^9}, {3.8323189427980623`*^9, 3.832319021034824*^9}, 
   3.8323190643049493`*^9, 3.832319102361596*^9, {3.8323191407995005`*^9, 
   3.832319174315135*^9}, {3.832319206116948*^9, 3.832319210428277*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"d1a4f573-3587-43d4-9f50-feb5db6eb19c"],

Cell[BoxData[
 StyleBox["\<\" gSpherCapIntsAreaError\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.8323188233324723`*^9, 3.8323188304826813`*^9}, 
   3.8323191751939754`*^9, {3.8323192132636595`*^9, 3.832319248966112*^9}, 
   3.832712373344867*^9, 3.832729432969062*^9, 3.8327295864844704`*^9, 
   3.832731185422649*^9, 3.832752385973492*^9, 3.837244613136201*^9},
 CellLabel->
  "During evaluation of \
In[160]:=",ExpressionUUID->"f3c3854e-6651-45ac-aa34-40297eb7dfdf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.21929180836563508`", ",", "0.32153623337560877`", ",", 
   "0.5305438425774492`", ",", "0.22855000721505725`", ",", 
   "0.7189595228647483`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8323112842769165`*^9, 3.8323113264201574`*^9}, 
   3.8323127923060465`*^9, {3.832318828365247*^9, 3.8323188354982386`*^9}, {
   3.8323192002758665`*^9, 3.8323192489691043`*^9}, 3.832712373347933*^9, 
   3.8327294329721527`*^9, 3.8327295864885254`*^9, 3.83273118542564*^9, 
   3.8327523859832473`*^9, 3.837244613151831*^9},
 CellLabel->
  "Out[161]=",ExpressionUUID->"87e44bbc-ca98-4abc-a09b-593cf685c4d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", 
   "\"\<Intersection area of intersection of spherical caps\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"intsArea", ",", "capDir2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "       ", 
  RowBox[{
   RowBox[{
    RowBox[{"capDir2", "=", 
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "0", ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "   ", 
    RowBox[{"intsArea", ":=", 
     RowBox[{"N", "@", 
      RowBox[{"gSpherCapIntsArea", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"capDir1", ",", "capAperture1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"capDir2", ",", "capAperture2"}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", " ", 
     RowBox[{"<|", "\[IndentingNewLine]", "   ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spherCaps\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir1"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture1"}], 
              ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir2"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture2"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<capDir1\>\"", "\[Rule]", "capDir1"}], ",", 
          RowBox[{"\"\<capDir2\>\"", "\[Rule]", "capDir2"}], ",", 
          RowBox[{"\"\<capAperture1\>\"", "\[Rule]", "capAperture1"}], ",", 
          RowBox[{"\"\<capAperture2\>\"", "\[Rule]", "capAperture2"}]}], 
         "|>"}], "]"}], ",", "\[IndentingNewLine]", "    ", 
       RowBox[{"\"\<spherCapInts\>\"", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", "\t ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<spherCapPair\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], ",", 
           RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
            RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
           RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], 
         "\[IndentingNewLine]", "       ", "}"}]}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.5"}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<viewPoint\>\"", "\[Rule]", "Top"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsArea", ",", "0"}], "}"}], ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"capDir1", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "0.5"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture1", ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture2", ",", 
       RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"intsArea", ",", "capDir2"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.832389138679553*^9, 3.832389181048128*^9}, 
   3.8323963406420126`*^9, {3.832729411912788*^9, 3.8327295269628496`*^9}, {
   3.8327296437437663`*^9, 3.8327297278494377`*^9}, 3.8327297997915936`*^9, {
   3.832729862212615*^9, 3.832729872708512*^9}, {3.8327299158476396`*^9, 
   3.8327299877894936`*^9}, {3.83273010977524*^9, 3.8327302098102565`*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"6d041034-bf16-4370-b639-efd81d1ee155"],

Cell[BoxData[
 StyleBox["\<\" Intersection area of intersection of spherical caps\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8327295865307503`*^9, 3.8327296221258307`*^9, {3.832729664464349*^9, 
   3.832729707934866*^9}, 3.8327298017803297`*^9, 3.8327298733860483`*^9, {
   3.8327299170109167`*^9, 3.8327299883861523`*^9}, 3.832730096969221*^9, {
   3.832730136840601*^9, 3.8327301446980286`*^9}, {3.8327302038766994`*^9, 
   3.8327302215147142`*^9}, 3.832731185462542*^9, 3.8327523860181227`*^9, 
   3.837244613190284*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"ecb250f2-d029-4251-a017-30a72c667776"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`capAperture1$$ = Rational[1, 3] 
    Pi, $CellContext`capAperture2$$ = Rational[1, 4] 
    Pi, $CellContext`capDir1$$ = {0, 0, 1}, $CellContext`capDir2X$$ = 
    0.5, $CellContext`intsArea$$ = 1.7569486634256075`, Typeset`show$$ = 
    False, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`intsArea$$], 0}}, {{
       Hold[$CellContext`capDir1$$], {0, 0, 1}}}, {{
       Hold[$CellContext`capDir2X$$], 0.5}, -1, 1}, {{
       Hold[$CellContext`capAperture1$$], Rational[1, 3] Pi}, 0, 
      Rational[1, 2] Pi}, {{
       Hold[$CellContext`capAperture2$$], Rational[1, 4] Pi}, 0, 
      Rational[1, 2] Pi}}, Typeset`size$$ = {102., {47., 53.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`capDir2X$235497$$ = 
    0, $CellContext`capAperture1$235498$$ = 
    0, $CellContext`capAperture2$235499$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`capAperture1$$ = 
        Rational[1, 3] Pi, $CellContext`capAperture2$$ = 
        Rational[1, 4] Pi, $CellContext`capDir1$$ = {0, 0, 
         1}, $CellContext`capDir2X$$ = 0.5, $CellContext`intsArea$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`capDir2X$$, $CellContext`capDir2X$235497$$, 0], 
        Hold[$CellContext`capAperture1$$, $CellContext`capAperture1$235498$$, 
         0], 
        Hold[$CellContext`capAperture2$$, $CellContext`capAperture2$235499$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`capDir2 = {$CellContext`capDir2X$$, 0, 
          1}; $CellContext`intsArea$$ := N[
          
          gSphericalCap`gSpherCapIntsArea[{$CellContext`capDir1$$, \
$CellContext`capAperture1$$}, {$CellContext`capDir2, \
$CellContext`capAperture2$$}]]; gPlots3D`gParamPlot3D[
         Association[
          ("spherCaps" -> {
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir1"], "coneAperture" -> Slot["capAperture1"], 
             "opacity" -> 1, "mesh" -> None], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir2"], "coneAperture" -> Slot["capAperture2"], 
             "colorFunc" -> (Green& ), "opacity" -> 1, "mesh" -> None]}& )[
           Association[
           "capDir1" -> $CellContext`capDir1$$, 
            "capDir2" -> $CellContext`capDir2, 
            "capAperture1" -> $CellContext`capAperture1$$, 
            "capAperture2" -> $CellContext`capAperture2$$]], "spherCapInts" -> {
            Association[
            "spherCapPair" -> {1, 2}, "colorFunc" -> (Blue& ), "opacity" -> 1,
              "zbias" -> 1, "mesh" -> None]}, "axisExtent" -> 1.5, 
          "viewPoint" -> Top]]), 
      "Specifications" :> {{{$CellContext`intsArea$$, 0}, Appearance -> 
         "Labeled"}, {{$CellContext`capDir1$$, {0, 0, 
          1}}}, {{$CellContext`capDir2X$$, 0.5}, -1, 
         1}, {{$CellContext`capAperture1$$, Rational[1, 3] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`capAperture2$$, Rational[1, 4] Pi}, 0, 
         Rational[1, 2] Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{153., {71., 77.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.832389164620803*^9, 3.8323891819761467`*^9}, 
   3.832396341351241*^9, 3.8327123734447994`*^9, {3.8327294152174845`*^9, 
   3.8327294876208434`*^9}, 3.8327295279036407`*^9, {3.8327295737858925`*^9, 
   3.8327295865704794`*^9}, 3.8327296221597395`*^9, {3.832729664466342*^9, 
   3.8327297079809427`*^9}, 3.8327298018285093`*^9, 3.832729873421138*^9, {
   3.8327299170518103`*^9, 3.832729988429535*^9}, 3.832730097010066*^9, {
   3.832730136990987*^9, 3.83273014473094*^9}, {3.8327302039141665`*^9, 
   3.8327302215506587`*^9}, 3.8327311855004683`*^9, 3.8327523860550804`*^9, 
   3.8372446132383575`*^9},
 CellLabel->
  "Out[164]=",ExpressionUUID->"055c8b97-0679-4cbf-aa04-75ebb10fcf0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", "\"\<Intersection edge points and apex coverage\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "capApex1", ",", "capDir2", ",", "edgeInfo", ",", "edgeThetaL", ",", 
    "edgeThetaR", ",", "apex1Covered", ",", "intsEdgePtL", ",", 
    "intsEdgePtR"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "         ", 
  RowBox[{
   RowBox[{
    RowBox[{"capDir2", "=", 
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "0", ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"capApex1", ":=", 
     RowBox[{"Normalize", "[", "capDir1", "]"}]}], ";", "\[IndentingNewLine]",
     "\t", 
    RowBox[{"edgeInfo", ":=", 
     RowBox[{"gSpherCapIntsEdgeInfo", "[", 
      RowBox[{
      "capDir1", ",", "capAperture1", ",", "capDir2", ",", "capAperture2"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"apex1Covered", ":=", 
     RowBox[{"edgeInfo", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"edgeThetaL", ":=", 
     RowBox[{"edgeInfo", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"edgeThetaR", ":=", 
     RowBox[{"edgeInfo", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"intsEdgePtL", ":=", 
     RowBox[{
      RowBox[{"RotationTransform", "[", 
       RowBox[{
        RowBox[{"edgeInfo", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], "[", "capApex1", 
      "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"intsEdgePtR", ":=", 
     RowBox[{
      RowBox[{"RotationTransform", "[", 
       RowBox[{
        RowBox[{"edgeInfo", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], "[", "capApex1", 
      "]"}]}], ";", "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", " ", 
     RowBox[{"<|", "\[IndentingNewLine]", "   ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<startPos\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}], ",", "1.1"}], "}"}]}], ",", 
             RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<length\>\"", "\[Rule]", 
              RowBox[{"2", "*", "apex1Covered"}]}]}], "|>"}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spheres\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "intsEdgePtL"}], ",", 
              RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "intsEdgePtR"}], ",", 
              RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}]}], " ", 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<capAxis1\>\"", "\[Rule]", "capDir1"}], ",", 
          RowBox[{"\"\<capApert1\>\"", "\[Rule]", "capAperture1"}], ",", 
          RowBox[{"\"\<capAxis2\>\"", "\[Rule]", "capDir2"}], ",", 
          RowBox[{"\"\<capApert2\>\"", "\[Rule]", "capAperture2"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spherCaps\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir1"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture1"}], 
              ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir2"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture2"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<capDir1\>\"", "\[Rule]", "capDir1"}], ",", 
          RowBox[{"\"\<capDir2\>\"", "\[Rule]", "capDir2"}], ",", 
          RowBox[{"\"\<capAperture1\>\"", "\[Rule]", "capAperture1"}], ",", 
          RowBox[{"\"\<capAperture2\>\"", "\[Rule]", "capAperture2"}]}], 
         "|>"}], "]"}], ",", "\[IndentingNewLine]", "    ", 
       RowBox[{"\"\<spherCapInts\>\"", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", "\t ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<spherCapPair\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], ",", 
           RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
            RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
           RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], 
         "\[IndentingNewLine]", "       ", "}"}]}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.2"}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<viewPoint\>\"", "\[Rule]", "Top"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"capDir1", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "0.5"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture1", ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture2", ",", 
       RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "capApex1", ",", "capDir2", ",", "edgeInfo", ",", "apex1Covered", ",", 
    "intsEdgePtL", ",", "intsEdgePtR"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.832396290457934*^9, 3.832396320729961*^9}, {
   3.8323963510340247`*^9, 3.8323963689622564`*^9}, {3.8323967045804596`*^9, 
   3.832396709540718*^9}, 3.8327300049853587`*^9, {3.83273023497832*^9, 
   3.832730272927435*^9}, {3.8327303326980104`*^9, 3.832730333504211*^9}, {
   3.83273038245675*^9, 3.8327303874602213`*^9}, {3.832730423743256*^9, 
   3.832730429055287*^9}, {3.8327304693775654`*^9, 3.8327304956342087`*^9}, {
   3.8327305383343763`*^9, 3.832730583063961*^9}, {3.8327306527678766`*^9, 
   3.832730675766636*^9}, {3.832730713015634*^9, 3.8327307715847964`*^9}, {
   3.83273082339847*^9, 3.832730844328868*^9}, {3.8327309448408775`*^9, 
   3.8327309687446156`*^9}, {3.8327310054644785`*^9, 3.8327310421666*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"32df95ee-451f-4e73-9a8b-12e509254f67"],

Cell[BoxData[
 StyleBox["\<\" Intersection edge points and apex coverage\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8323963697922435`*^9, 3.832396710089739*^9, 3.8327123736311154`*^9, 
   3.832729433160923*^9, 3.83272958672841*^9, 3.83273008006495*^9, {
   3.832730273625597*^9, 3.8327302862671375`*^9}, 3.832730584760435*^9, 
   3.8327306396281013`*^9, {3.832730691477357*^9, 3.832730713997604*^9}, {
   3.832730759711447*^9, 3.832730772331339*^9}, {3.8327308259101095`*^9, 
   3.8327308448845425`*^9}, {3.8327309466844287`*^9, 3.832730969207241*^9}, {
   3.8327310211961913`*^9, 3.832731044668579*^9}, 3.832731185727832*^9, 
   3.8327332001528378`*^9, 3.832752386151662*^9, 3.83724461344545*^9},
 CellLabel->
  "During evaluation of \
In[166]:=",ExpressionUUID->"8d18acb9-ba34-45c2-9150-2853f2d6aefb"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`capAperture1$$ = Rational[1, 3] 
    Pi, $CellContext`capAperture2$$ = Rational[1, 4] 
    Pi, $CellContext`capDir1$$ = {0, 0, 1}, $CellContext`capDir2X$$ = 0.5, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`capDir1$$], {0, 0, 1}}}, {{
       Hold[$CellContext`capDir2X$$], 0.5}, -1, 1}, {{
       Hold[$CellContext`capAperture1$$], Rational[1, 3] Pi}, 0, 
      Rational[1, 2] Pi}, {{
       Hold[$CellContext`capAperture2$$], Rational[1, 4] Pi}, 0, 
      Rational[1, 2] Pi}}, Typeset`size$$ = {109., {47., 52.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`capDir2X$235615$$ = 
    0, $CellContext`capAperture1$235616$$ = 
    0, $CellContext`capAperture2$235617$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`capAperture1$$ = 
        Rational[1, 3] Pi, $CellContext`capAperture2$$ = 
        Rational[1, 4] Pi, $CellContext`capDir1$$ = {0, 0, 
         1}, $CellContext`capDir2X$$ = 0.5}, "ControllerVariables" :> {
        Hold[$CellContext`capDir2X$$, $CellContext`capDir2X$235615$$, 0], 
        Hold[$CellContext`capAperture1$$, $CellContext`capAperture1$235616$$, 
         0], 
        Hold[$CellContext`capAperture2$$, $CellContext`capAperture2$235617$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`capDir2 = {$CellContext`capDir2X$$, 0, 
          1}; $CellContext`capApex1 := 
        Normalize[$CellContext`capDir1$$]; $CellContext`edgeInfo := 
        gSphericalCap`gSpherCapIntsEdgeInfo[$CellContext`capDir1$$, \
$CellContext`capAperture1$$, $CellContext`capDir2, \
$CellContext`capAperture2$$]; $CellContext`apex1Covered := 
        Part[$CellContext`edgeInfo, 1]; $CellContext`edgeThetaL := 
        Part[$CellContext`edgeInfo, 2]; $CellContext`edgeThetaR := 
        Part[$CellContext`edgeInfo, 3]; $CellContext`intsEdgePtL := 
        RotationTransform[
          Part[$CellContext`edgeInfo, 2], {0, 1, 
          0}][$CellContext`capApex1]; $CellContext`intsEdgePtR := 
        RotationTransform[
          Part[$CellContext`edgeInfo, 3], {0, 1, 0}][$CellContext`capApex1]; 
       gPlots3D`gParamPlot3D[
         Association[
          ("lines" -> {
            Association[
            "startPos" -> {0, -1, 1.1}, "dirVec" -> {0, 1, 0}, "length" -> 
             2 $CellContext`apex1Covered]}& )[], 
          ("spheres" -> {
            Association[
            "center" -> $CellContext`intsEdgePtL, "zbias" -> 1, "radius" -> 
             0.03, "colorFunc" -> (Red& )], 
            Association[
            "center" -> $CellContext`intsEdgePtR, "zbias" -> 1, "radius" -> 
             0.03, "colorFunc" -> (Red& )]}& )[
           Association[
           "capAxis1" -> $CellContext`capDir1$$, 
            "capApert1" -> $CellContext`capAperture1$$, 
            "capAxis2" -> $CellContext`capDir2, 
            "capApert2" -> $CellContext`capAperture2$$]], 
          ("spherCaps" -> {
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir1"], "coneAperture" -> Slot["capAperture1"], 
             "opacity" -> 1, "mesh" -> None], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir2"], "coneAperture" -> Slot["capAperture2"], 
             "colorFunc" -> (Green& ), "opacity" -> 1, "mesh" -> None]}& )[
           Association[
           "capDir1" -> $CellContext`capDir1$$, 
            "capDir2" -> $CellContext`capDir2, 
            "capAperture1" -> $CellContext`capAperture1$$, 
            "capAperture2" -> $CellContext`capAperture2$$]], "spherCapInts" -> {
            Association[
            "spherCapPair" -> {1, 2}, "colorFunc" -> (Blue& ), "opacity" -> 1,
              "zbias" -> 1, "mesh" -> None]}, "axisExtent" -> 1.2, 
          "viewPoint" -> Top]]), 
      "Specifications" :> {{{$CellContext`capDir1$$, {0, 0, 
          1}}}, {{$CellContext`capDir2X$$, 0.5}, -1, 
         1}, {{$CellContext`capAperture1$$, Rational[1, 3] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`capAperture2$$, Rational[1, 4] Pi}, 0, 
         Rational[1, 2] Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{160., {70., 76.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.832396244446126*^9, 3.832396324840388*^9, 3.8323963698136187`*^9, 
   3.8323967101176643`*^9, 3.832712373807972*^9, 3.832729433221346*^9, 
   3.8327295867694016`*^9, 3.832730080261485*^9, {3.832730273668805*^9, 
   3.832730286301056*^9}, 3.832730584796339*^9, 3.8327306396702175`*^9, {
   3.832730691516347*^9, 3.8327307140370755`*^9}, {3.8327307597547493`*^9, 
   3.83273077236712*^9}, {3.8327308259450355`*^9, 3.832730844925471*^9}, {
   3.832730946726474*^9, 3.83273096924874*^9}, {3.832731021242054*^9, 
   3.832731044706417*^9}, 3.8327311857709885`*^9, 3.832733200190502*^9, 
   3.8327523861871967`*^9, 3.837244613488886*^9},
 CellLabel->
  "Out[168]=",ExpressionUUID->"1dc845f0-09bf-4b91-8782-1fe9110ad410"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", "\"\<Base reference spherical cap for intersection\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "capApex1", ",", "capDir2", ",", "baseApertInfo", ",", "baseQuaterAxis"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"capApex1", ":=", 
     RowBox[{"Normalize", "[", "capDir1", "]"}]}], ";", "\[IndentingNewLine]",
     "         ", 
    RowBox[{"capDir2", "=", 
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "0", ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"baseApertInfo", ":=", 
     RowBox[{"gSpherCapIntsBaseRefs", "[", 
      RowBox[{
      "capDir1", ",", "capAperture1", ",", "capDir2", ",", "capAperture2"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"baseQuaterAxis", ":=", 
     RowBox[{
      RowBox[{"RotationTransform", "[", 
       RowBox[{
        RowBox[{"baseApertInfo", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], "[", "capApex1", 
      "]"}]}], ";", "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", " ", 
     RowBox[{"<|", "\[IndentingNewLine]", "  ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spheres\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "capApex1"}], ",", 
             RowBox[{"\"\<zbias\>\"", "\[Rule]", "5"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spherCaps\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"(*", 
            RowBox[{"2", " ", "intersection", " ", "shperical", " ", "caps"}],
             "*)"}], "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir1"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture1"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir2"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture2"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "   ", 
            RowBox[{"(*", 
             RowBox[{"hemi", " ", "base", " ", "part"}], "*)"}], 
            "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "capApex1"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", 
               RowBox[{"baseApertInfo", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Red", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<zbias\>\"", "\[Rule]", "2"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "  ", 
            RowBox[{"(*", 
             RowBox[{"qtr", " ", "base", " ", "part"}], "*)"}], "   ", 
            "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "baseQuaterAxis"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", 
               RowBox[{"baseApertInfo", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Red", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<zbias\>\"", "\[Rule]", "2"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<capDir1\>\"", "\[Rule]", "capDir1"}], ",", 
          RowBox[{"\"\<capDir2\>\"", "\[Rule]", "capDir2"}], ",", 
          RowBox[{"\"\<capAperture1\>\"", "\[Rule]", "capAperture1"}], ",", 
          RowBox[{"\"\<capAperture2\>\"", "\[Rule]", "capAperture2"}]}], 
         "|>"}], "]"}], ",", "\[IndentingNewLine]", "    ", 
       RowBox[{"\"\<spherCapInts\>\"", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", "\t ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<spherCapPair\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], ",", 
           RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
            RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
           RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], 
         "\[IndentingNewLine]", "       ", "}"}]}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.2"}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<viewPoint\>\"", "\[Rule]", "Top"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"capDir1", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "0.8"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture1", ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture2", ",", 
       RowBox[{"\[Pi]", "/", "5"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", " ", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "capApex1", ",", "capDir2", ",", "baseApertInfo", ",", "baseQuaterAxis"}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8324058313726177`*^9, 3.832405868461471*^9}, {
  3.8327125850422688`*^9, 3.8327126223526196`*^9}, {3.8327128490609274`*^9, 
  3.8327128814645042`*^9}, {3.832712992393035*^9, 3.8327130152004056`*^9}, {
  3.8327305996397395`*^9, 3.832730614169668*^9}, {3.832731057055801*^9, 
  3.8327311168801117`*^9}, {3.832731248810616*^9, 3.832731249734619*^9}, {
  3.8327312845556917`*^9, 3.832731316453699*^9}, {3.8327314409812675`*^9, 
  3.8327314735489407`*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"3ccd6b78-27a4-4890-be28-3d6a5bc26856"],

Cell[BoxData[
 StyleBox["\<\" Base reference spherical cap for intersection\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.832405848866724*^9, 3.832405870962078*^9}, 
   3.83271237405487*^9, 3.8327294335043354`*^9, 3.8327295870120697`*^9, {
   3.832731098420714*^9, 3.8327311183211017`*^9}, 3.8327311860173287`*^9, 
   3.832731251548765*^9, {3.832731305854167*^9, 3.832731318336809*^9}, 
   3.8327314068930435`*^9, {3.8327314472724953`*^9, 3.832731474114641*^9}, 
   3.8327523863732743`*^9, 3.8372446139058285`*^9},
 CellLabel->
  "During evaluation of \
In[170]:=",ExpressionUUID->"d3982ed2-5e4a-425b-90d9-ff83583bd7be"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`capAperture1$$ = Rational[1, 3] 
    Pi, $CellContext`capAperture2$$ = Rational[1, 5] 
    Pi, $CellContext`capDir1$$ = {0, 0, 1}, $CellContext`capDir2X$$ = 0.8, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`capDir1$$], {0, 0, 1}}}, {{
       Hold[$CellContext`capDir2X$$], 0.8}, -1, 1}, {{
       Hold[$CellContext`capAperture1$$], Rational[1, 3] Pi}, 0, 
      Rational[1, 2] Pi}, {{
       Hold[$CellContext`capAperture2$$], Rational[1, 5] Pi}, 0, 
      Rational[1, 2] Pi}}, Typeset`size$$ = {109., {47., 52.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`capDir2X$235809$$ = 
    0, $CellContext`capAperture1$235810$$ = 
    0, $CellContext`capAperture2$235811$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`capAperture1$$ = 
        Rational[1, 3] Pi, $CellContext`capAperture2$$ = 
        Rational[1, 5] Pi, $CellContext`capDir1$$ = {0, 0, 
         1}, $CellContext`capDir2X$$ = 0.8}, "ControllerVariables" :> {
        Hold[$CellContext`capDir2X$$, $CellContext`capDir2X$235809$$, 0], 
        Hold[$CellContext`capAperture1$$, $CellContext`capAperture1$235810$$, 
         0], 
        Hold[$CellContext`capAperture2$$, $CellContext`capAperture2$235811$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`capApex1 := 
        Normalize[$CellContext`capDir1$$]; $CellContext`capDir2 = \
{$CellContext`capDir2X$$, 0, 1}; $CellContext`baseApertInfo := 
        gSphericalCap`gSpherCapIntsBaseRefs[$CellContext`capDir1$$, \
$CellContext`capAperture1$$, $CellContext`capDir2, \
$CellContext`capAperture2$$]; $CellContext`baseQuaterAxis := RotationTransform[
          Part[$CellContext`baseApertInfo, 2], {0, 1, 
          0}][$CellContext`capApex1]; gPlots3D`gParamPlot3D[
         Association[
          ("spheres" -> {
            Association[
            "center" -> $CellContext`capApex1, "zbias" -> 5, "radius" -> 0.03,
              "colorFunc" -> (Red& )]}& )[], 
          ("spherCaps" -> {
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir1"], "coneAperture" -> Slot["capAperture1"], 
             "opacity" -> 1, "mesh" -> None], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir2"], "coneAperture" -> Slot["capAperture2"], 
             "colorFunc" -> (Green& ), "opacity" -> 1, "mesh" -> None], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, 
             "coneDir" -> $CellContext`capApex1, "coneAperture" -> 
             Part[$CellContext`baseApertInfo, 1], "colorFunc" -> (Red& ), 
             "opacity" -> 1, "zbias" -> 2, "mesh" -> None], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, 
             "coneDir" -> $CellContext`baseQuaterAxis, "coneAperture" -> 
             Part[$CellContext`baseApertInfo, 3], "colorFunc" -> (Red& ), 
             "opacity" -> 1, "zbias" -> 2, "mesh" -> None]}& )[
           Association[
           "capDir1" -> $CellContext`capDir1$$, 
            "capDir2" -> $CellContext`capDir2, 
            "capAperture1" -> $CellContext`capAperture1$$, 
            "capAperture2" -> $CellContext`capAperture2$$]], "spherCapInts" -> {
            Association[
            "spherCapPair" -> {1, 2}, "colorFunc" -> (Blue& ), "opacity" -> 1,
              "zbias" -> 1, "mesh" -> None]}, "axisExtent" -> 1.2, 
          "viewPoint" -> Top]]), 
      "Specifications" :> {{{$CellContext`capDir1$$, {0, 0, 
          1}}}, {{$CellContext`capDir2X$$, 0.8}, -1, 
         1}, {{$CellContext`capAperture1$$, Rational[1, 3] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`capAperture2$$, Rational[1, 5] Pi}, 0, 
         Rational[1, 2] Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{160., {70., 76.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.832405848952321*^9, 3.8324058709958253`*^9}, 
   3.8327123741202464`*^9, 3.8327294335441456`*^9, 3.8327295870499425`*^9, {
   3.8327310984517107`*^9, 3.8327311183530874`*^9}, 3.832731186046253*^9, 
   3.8327312515846806`*^9, {3.832731305890887*^9, 3.8327313183709345`*^9}, 
   3.8327314069263906`*^9, {3.832731447304834*^9, 3.8327314741618276`*^9}, 
   3.832752386402128*^9, 3.837244613959326*^9},
 CellLabel->
  "Out[172]=",ExpressionUUID->"ea427f67-659b-417c-ab60-4c5cfd094179"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", "\"\<Base reference spherical range for intersection\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "capApex1", ",", "capDir2", ",", "baseApertInfo", ",", "baseQuaterAxis", 
    ",", "qtrPart1MidTheta", ",", "qtrPart1ThetaRadius", ",", 
    "qtrPart1MinTheta", ",", "\[IndentingNewLine]", "qtrPart1MaxTheta", ",", 
    "qtrPart2MidPhi", ",", "qtrPart2MinPhi", ",", "qtrPart2MaxPhi"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"capApex1", ":=", 
     RowBox[{"Normalize", "[", "capDir1", "]"}]}], ";", "\[IndentingNewLine]",
     "         ", 
    RowBox[{"capDir2", "=", 
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "0", ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"baseApertInfo", ":=", 
     RowBox[{"gSpherCapIntsBaseRefs", "[", 
      RowBox[{
      "capDir1", ",", "capAperture1", ",", "capDir2", ",", "capAperture2"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"baseQuaterAxis", ":=", 
     RowBox[{
      RowBox[{"RotationTransform", "[", 
       RowBox[{
        RowBox[{"baseApertInfo", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], "[", "capApex1", 
      "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"qtrPart1MidTheta", "=", 
     RowBox[{"baseApertInfo", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"qtrPart1ThetaRadius", "=", 
     RowBox[{"baseApertInfo", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"qtrPart1MinTheta", "=", 
     RowBox[{"qtrPart1MidTheta", "-", "qtrPart1ThetaRadius"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"Assert", "[", 
     RowBox[{"qtrPart1MinTheta", "\[GreaterEqual]", "0"}], "]"}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"qtrPart1MaxTheta", "=", 
     RowBox[{"qtrPart1MidTheta", "+", "qtrPart1ThetaRadius"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"Assert", "[", 
     RowBox[{"qtrPart1MaxTheta", "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"qtrPart2MidPhi", "=", "0"}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"qtrPart2MinPhi", "=", 
     RowBox[{"qtrPart2MidPhi", "-", 
      RowBox[{"qtrPart1ThetaRadius", "*", "2"}]}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"qtrPart2MaxPhi", "=", 
     RowBox[{"qtrPart2MidPhi", "+", 
      RowBox[{"qtrPart1ThetaRadius", "*", "2"}]}]}], ";", 
    "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", " ", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spheres\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "capApex1"}], ",", 
             RowBox[{"\"\<zbias\>\"", "\[Rule]", "5"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spherCaps\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"(*", 
            RowBox[{"2", " ", "intersection", " ", "shperical", " ", "caps"}],
             "*)"}], "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir1"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture1"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Gray", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir2"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture2"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}]}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", "  ", 
            RowBox[{",", " ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<coneDir\>\"", "\[Rule]", "baseQuaterAxis"}], ",", 
               RowBox[{"\"\<coneAperture\>\"", "\[Rule]", 
                RowBox[{"baseApertInfo", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]",
                "\t", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Brown", "]"}]}], ",", 
               RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<zbias\>\"", "\[Rule]", "3"}], ",", 
               RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}]}], 
            "*)"}], "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<capDir1\>\"", "\[Rule]", "capDir1"}], ",", 
          RowBox[{"\"\<capDir2\>\"", "\[Rule]", "capDir2"}], ",", 
          RowBox[{"\"\<capAperture1\>\"", "\[Rule]", "capAperture1"}], ",", 
          RowBox[{"\"\<capAperture2\>\"", "\[Rule]", "capAperture2"}]}], 
         "|>"}], "]"}], ",", "\[IndentingNewLine]", "    ", 
       RowBox[{"\"\<spherCapInts\>\"", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", "\t ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<spherCapPair\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], ",", 
           RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
            RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
           RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<zbias\>\"", "\[Rule]", "2"}], ",", 
           RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], 
         "\[IndentingNewLine]", "       ", "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "    ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\"\<spherSegs\>\"", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", "   ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "#showPart1"}], ",", 
               RowBox[{"\"\<segAxis\>\"", "\[Rule]", "#segAxis"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<segH1\>\"", "\[Rule]", 
                RowBox[{"Cos", "[", "qtrPart1MaxTheta", "]"}]}], ",", 
               RowBox[{"\"\<segH2\>\"", "\[Rule]", 
                RowBox[{"Cos", "[", "qtrPart1MinTheta", "]"}]}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Green", "]"}]}], ",", 
               RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}]}], "|>"}], 
             "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<segAxis\>\"", "\[Rule]", "capDir1"}], ",", 
            RowBox[{"\"\<showPart1\>\"", "\[Rule]", "showPart1"}]}], "|>"}], 
          "]"}], ","}], "*)"}], "\[IndentingNewLine]", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spherRanges\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "#showPart2"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<rangeTheta\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#minTheta", ",", "#maxTheta"}], "}"}]}], ",", 
             RowBox[{"\"\<rangePhi\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#minPhi", ",", "#maxPhi"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", "Orange", "]"}]}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<showPart2\>\"", "\[Rule]", "showPart2"}], ",", 
          RowBox[{"\"\<minTheta\>\"", "\[Rule]", "qtrPart1MinTheta"}], ",", 
          RowBox[{"\"\<maxTheta\>\"", "\[Rule]", "qtrPart1MaxTheta"}], ",", 
          "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"\"\<minPhi\>\"", "\[Rule]", "qtrPart2MinPhi"}], ",", 
          RowBox[{"\"\<maxPhi\>\"", "\[Rule]", "qtrPart2MaxPhi"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.2"}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<viewPoint\>\"", "\[Rule]", "Top"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"showPart1", ",", "1"}], "}"}], ",", "0", ",", "1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"showPart2", ",", "1"}], "}"}], ",", "0", ",", "1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"capDir1", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "1"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "10"}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture1", ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture2", ",", 
       RowBox[{"\[Pi]", "/", "7"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "capApex1", ",", "capDir2", ",", "baseApertInfo", ",", "baseQuaterAxis", 
    ",", "qtrPart1MidTheta", ",", "qtrPart1ThetaRadius", ",", 
    "qtrPart1MinTheta", ",", "\[IndentingNewLine]", "qtrPart1MaxTheta", ",", 
    "qtrPart2MidPhi", ",", "qtrPart2MinPhi", ",", "qtrPart2MaxPhi"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8327332174544535`*^9, 3.832733234409243*^9}, {
   3.832733608156437*^9, 3.832733635205454*^9}, 3.8327433815968695`*^9},
 CellLabel->
  "In[174]:=",ExpressionUUID->"fa4ceeea-8f85-4c9c-bd92-408e9fd736d1"],

Cell[BoxData[
 StyleBox["\<\" Base reference spherical range for intersection\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.832733224130063*^9, 3.832733235183195*^9}, 
   3.8327336391068783`*^9, 3.832752386569001*^9, 3.837244614272211*^9},
 CellLabel->
  "During evaluation of \
In[174]:=",ExpressionUUID->"334a8975-82e7-4007-9067-610447b0e179"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`capAperture1$$ = Rational[1, 3] 
    Pi, $CellContext`capAperture2$$ = Rational[1, 7] 
    Pi, $CellContext`capDir1$$ = {0, 0, 1}, $CellContext`capDir2X$$ = 
    1, $CellContext`showPart1$$ = 1, $CellContext`showPart2$$ = 1, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`showPart1$$], 1}, 0, 1, 1}, {{
       Hold[$CellContext`showPart2$$], 1}, 0, 1, 1}, {{
       Hold[$CellContext`capDir1$$], {0, 0, 1}}}, {{
       Hold[$CellContext`capDir2X$$], 1}, -1, 10}, {{
       Hold[$CellContext`capAperture1$$], Rational[1, 3] Pi}, 0, 
      Rational[1, 2] Pi}, {{
       Hold[$CellContext`capAperture2$$], Rational[1, 7] Pi}, 0, 
      Rational[1, 2] Pi}}, Typeset`size$$ = {109., {47., 52.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`showPart1$236002$$ = 
    0, $CellContext`showPart2$236003$$ = 0, $CellContext`capDir2X$236004$$ = 
    0, $CellContext`capAperture1$236005$$ = 
    0, $CellContext`capAperture2$236006$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`capAperture1$$ = 
        Rational[1, 3] Pi, $CellContext`capAperture2$$ = 
        Rational[1, 7] Pi, $CellContext`capDir1$$ = {0, 0, 
         1}, $CellContext`capDir2X$$ = 1, $CellContext`showPart1$$ = 
        1, $CellContext`showPart2$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`showPart1$$, $CellContext`showPart1$236002$$, 0], 
        Hold[$CellContext`showPart2$$, $CellContext`showPart2$236003$$, 0], 
        Hold[$CellContext`capDir2X$$, $CellContext`capDir2X$236004$$, 0], 
        Hold[$CellContext`capAperture1$$, $CellContext`capAperture1$236005$$, 
         0], 
        Hold[$CellContext`capAperture2$$, $CellContext`capAperture2$236006$$, 
         0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`capApex1 := 
        Normalize[$CellContext`capDir1$$]; $CellContext`capDir2 = \
{$CellContext`capDir2X$$, 0, 1}; $CellContext`baseApertInfo := 
        gSphericalCap`gSpherCapIntsBaseRefs[$CellContext`capDir1$$, \
$CellContext`capAperture1$$, $CellContext`capDir2, \
$CellContext`capAperture2$$]; $CellContext`baseQuaterAxis := RotationTransform[
          Part[$CellContext`baseApertInfo, 2], {0, 1, 
          0}][$CellContext`capApex1]; $CellContext`qtrPart1MidTheta = 
        Part[$CellContext`baseApertInfo, 2]; $CellContext`qtrPart1ThetaRadius = 
        Part[$CellContext`baseApertInfo, 
          3]; $CellContext`qtrPart1MinTheta = $CellContext`qtrPart1MidTheta - \
$CellContext`qtrPart1ThetaRadius; 
       Assert[$CellContext`qtrPart1MinTheta >= 
         0]; $CellContext`qtrPart1MaxTheta = $CellContext`qtrPart1MidTheta + \
$CellContext`qtrPart1ThetaRadius; 
       Assert[$CellContext`qtrPart1MaxTheta <= 
         Pi/2]; $CellContext`qtrPart2MidPhi = 
        0; $CellContext`qtrPart2MinPhi = $CellContext`qtrPart2MidPhi - \
$CellContext`qtrPart1ThetaRadius 
         2; $CellContext`qtrPart2MaxPhi = $CellContext`qtrPart2MidPhi + \
$CellContext`qtrPart1ThetaRadius 2; gPlots3D`gParamPlot3D[
         Association[
          ("spheres" -> {
            Association[
            "center" -> $CellContext`capApex1, "zbias" -> 5, "radius" -> 0.03,
              "colorFunc" -> (Red& )]}& )[], 
          ("spherCaps" -> {
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir1"], "coneAperture" -> Slot["capAperture1"], 
             "colorFunc" -> (Gray& ), "opacity" -> 1, "mesh" -> None], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir2"], "coneAperture" -> Slot["capAperture2"], 
             "colorFunc" -> (Green& ), "opacity" -> 1, "mesh" -> None]}& )[
           Association[
           "capDir1" -> $CellContext`capDir1$$, 
            "capDir2" -> $CellContext`capDir2, 
            "capAperture1" -> $CellContext`capAperture1$$, 
            "capAperture2" -> $CellContext`capAperture2$$]], "spherCapInts" -> {
            Association[
            "spherCapPair" -> {1, 2}, "colorFunc" -> (Blue& ), "opacity" -> 1,
              "zbias" -> 2, "mesh" -> None]}, 
          ("spherRanges" -> {
            Association[
            "center" -> {0, 0, 0}, "radius" -> Slot["showPart2"], 
             "rangeTheta" -> {
               Slot["minTheta"], 
               Slot["maxTheta"]}, "rangePhi" -> {
               Slot["minPhi"], 
               Slot["maxPhi"]}, "colorFunc" -> (Orange& ), "opacity" -> 1, 
             "zbias" -> 1, "mesh" -> None]}& )[
           Association[
           "showPart2" -> $CellContext`showPart2$$, 
            "minTheta" -> $CellContext`qtrPart1MinTheta, 
            "maxTheta" -> $CellContext`qtrPart1MaxTheta, 
            "minPhi" -> $CellContext`qtrPart2MinPhi, 
            "maxPhi" -> $CellContext`qtrPart2MaxPhi]], "axisExtent" -> 1.2, 
          "viewPoint" -> Top]]), 
      "Specifications" :> {{{$CellContext`showPart1$$, 1}, 0, 1, 
         1}, {{$CellContext`showPart2$$, 1}, 0, 1, 
         1}, {{$CellContext`capDir1$$, {0, 0, 1}}}, {{$CellContext`capDir2X$$,
           1}, -1, 10}, {{$CellContext`capAperture1$$, Rational[1, 3] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`capAperture2$$, Rational[1, 7] Pi}, 0, 
         Rational[1, 2] Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{160., {70., 76.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.832733224173465*^9, 3.832733235225895*^9}, 
   3.832733639143861*^9, 3.832752386602247*^9, 3.837244614334711*^9},
 CellLabel->
  "Out[176]=",ExpressionUUID->"61cf5512-0d17-4350-b135-d6465104f123"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Integral flags for intersection\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"capApex1", ",", "capDir2", ",", "integralFlags"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"capApex1", ":=", 
     RowBox[{"Normalize", "[", "capDir1", "]"}]}], ";", "\[IndentingNewLine]",
     "         ", 
    RowBox[{"capDir2", "=", 
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "0", ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"integralFlags", ":=", 
     RowBox[{"gCapIntsIntegralFlags", "[", 
      RowBox[{
      "capDir1", ",", "capAperture1", ",", "capDir2", ",", "capAperture2"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", " ", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spheres\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "capApex1"}], ",", 
             RowBox[{"\"\<zbias\>\"", "\[Rule]", "5"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spherCaps\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"(*", 
            RowBox[{"2", " ", "intersection", " ", "shperical", " ", "caps"}],
             "*)"}], "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir1"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture1"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Gray", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir2"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture2"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<capDir1\>\"", "\[Rule]", "capDir1"}], ",", 
          RowBox[{"\"\<capDir2\>\"", "\[Rule]", "capDir2"}], ",", 
          RowBox[{"\"\<capAperture1\>\"", "\[Rule]", "capAperture1"}], ",", 
          RowBox[{"\"\<capAperture2\>\"", "\[Rule]", "capAperture2"}]}], 
         "|>"}], "]"}], ",", "\[IndentingNewLine]", "    ", 
       RowBox[{"\"\<spherCapInts\>\"", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", "\t ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<spherCapPair\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], ",", 
           RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
            RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
           RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<zbias\>\"", "\[Rule]", "2"}], ",", 
           RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], 
         "\[IndentingNewLine]", "       ", "}"}]}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.2"}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<viewPoint\>\"", "\[Rule]", "Top"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "  ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"intsFlags", ",", "integralFlags"}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"showPart1", ",", "1"}], "}"}], ",", "0", ",", "1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"showPart2", ",", "1"}], "}"}], ",", "0", ",", "1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"capDir1", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "1"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "10"}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture1", ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture2", ",", 
       RowBox[{"\[Pi]", "/", "7"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"capApex1", ",", "capDir2", ",", "integralFlags"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8327523484732*^9, 3.8327523678011584`*^9}, 
   3.8327524047722077`*^9, {3.832752492442581*^9, 3.832752501692436*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"65726603-db31-4a3c-9ed5-871f963dcbc9"],

Cell[BoxData[
 StyleBox["\<\" Integral flags for intersection\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.832752368531833*^9, 3.8327523867672586`*^9}, 
   3.8327524947008405`*^9, 3.832822791547722*^9, 3.8372446145746045`*^9},
 CellLabel->
  "During evaluation of \
In[178]:=",ExpressionUUID->"bf38ac82-fbb6-45dd-98a2-7c5a978f513f"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`capAperture1$$ = Rational[1, 3] 
    Pi, $CellContext`capAperture2$$ = Rational[1, 7] 
    Pi, $CellContext`capDir1$$ = {0, 0, 1}, $CellContext`capDir2X$$ = 
    1, $CellContext`intsFlags$$ = {0, 0, 0, 1}, $CellContext`showPart1$$ = 
    1, $CellContext`showPart2$$ = 1, Typeset`show$$ = False, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`intsFlags$$], {0, 0, 0, 1}}}, {{
       Hold[$CellContext`showPart1$$], 1}, 0, 1, 1}, {{
       Hold[$CellContext`showPart2$$], 1}, 0, 1, 1}, {{
       Hold[$CellContext`capDir1$$], {0, 0, 1}}}, {{
       Hold[$CellContext`capDir2X$$], 1}, -1, 10}, {{
       Hold[$CellContext`capAperture1$$], Rational[1, 3] Pi}, 0, 
      Rational[1, 2] Pi}, {{
       Hold[$CellContext`capAperture2$$], Rational[1, 7] Pi}, 0, 
      Rational[1, 2] Pi}}, Typeset`size$$ = {109., {47., 52.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`showPart1$236175$$ = 
    0, $CellContext`showPart2$236176$$ = 0, $CellContext`capDir2X$236177$$ = 
    0, $CellContext`capAperture1$236178$$ = 
    0, $CellContext`capAperture2$236179$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`capAperture1$$ = 
        Rational[1, 3] Pi, $CellContext`capAperture2$$ = 
        Rational[1, 7] Pi, $CellContext`capDir1$$ = {0, 0, 
         1}, $CellContext`capDir2X$$ = 
        1, $CellContext`intsFlags$$ = $CellContext`integralFlags, \
$CellContext`showPart1$$ = 1, $CellContext`showPart2$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`showPart1$$, $CellContext`showPart1$236175$$, 0], 
        Hold[$CellContext`showPart2$$, $CellContext`showPart2$236176$$, 0], 
        Hold[$CellContext`capDir2X$$, $CellContext`capDir2X$236177$$, 0], 
        Hold[$CellContext`capAperture1$$, $CellContext`capAperture1$236178$$, 
         0], 
        Hold[$CellContext`capAperture2$$, $CellContext`capAperture2$236179$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`capApex1 := 
        Normalize[$CellContext`capDir1$$]; $CellContext`capDir2 = \
{$CellContext`capDir2X$$, 0, 1}; $CellContext`integralFlags := 
        gSphericalCap`gCapIntsIntegralFlags[$CellContext`capDir1$$, \
$CellContext`capAperture1$$, $CellContext`capDir2, \
$CellContext`capAperture2$$]; gPlots3D`gParamPlot3D[
         Association[
          ("spheres" -> {
            Association[
            "center" -> $CellContext`capApex1, "zbias" -> 5, "radius" -> 0.03,
              "colorFunc" -> (Red& )]}& )[], 
          ("spherCaps" -> {
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir1"], "coneAperture" -> Slot["capAperture1"], 
             "colorFunc" -> (Gray& ), "opacity" -> 1, "mesh" -> None], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir2"], "coneAperture" -> Slot["capAperture2"], 
             "colorFunc" -> (Green& ), "opacity" -> 1, "mesh" -> None]}& )[
           Association[
           "capDir1" -> $CellContext`capDir1$$, 
            "capDir2" -> $CellContext`capDir2, 
            "capAperture1" -> $CellContext`capAperture1$$, 
            "capAperture2" -> $CellContext`capAperture2$$]], "spherCapInts" -> {
            Association[
            "spherCapPair" -> {1, 2}, "colorFunc" -> (Blue& ), "opacity" -> 1,
              "zbias" -> 2, "mesh" -> None]}, "axisExtent" -> 1.2, 
          "viewPoint" -> Top]]), 
      "Specifications" :> {{{$CellContext`intsFlags$$, \
$CellContext`integralFlags}}, {{$CellContext`showPart1$$, 1}, 0, 1, 
         1}, {{$CellContext`showPart2$$, 1}, 0, 1, 
         1}, {{$CellContext`capDir1$$, {0, 0, 1}}}, {{$CellContext`capDir2X$$,
           1}, -1, 10}, {{$CellContext`capAperture1$$, Rational[1, 3] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`capAperture2$$, Rational[1, 7] Pi}, 0, 
         Rational[1, 2] Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{160., {70., 76.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8327523685957203`*^9, 3.832752386836255*^9}, 
   3.8327524947208176`*^9, 3.8328227915795355`*^9, 3.8372446146136274`*^9},
 CellLabel->
  "Out[180]=",ExpressionUUID->"c3c53b2f-522b-489a-bc2a-6c81f999a3df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", "\"\<Intersection approximation for quater sphere.\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"capApex1", ",", "capDir2", ",", "quaterPart"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"capApex1", ":=", 
     RowBox[{"Normalize", "[", "capDir1", "]"}]}], ";", "\[IndentingNewLine]",
     "         ", 
    RowBox[{"capDir2", "=", 
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "0", ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"quaterPart", ":=", 
     RowBox[{"gCapIntsQuaterPart", "[", 
      RowBox[{
      "capDir1", ",", "capAperture1", ",", "capDir2", ",", "capAperture2"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", " ", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spheres\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "capApex1"}], ",", 
             RowBox[{"\"\<zbias\>\"", "\[Rule]", "5"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spherCaps\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"(*", 
            RowBox[{"2", " ", "intersection", " ", "shperical", " ", "caps"}],
             "*)"}], "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir1"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture1"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Gray", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir2"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture2"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<capDir1\>\"", "\[Rule]", "capDir1"}], ",", 
          RowBox[{"\"\<capDir2\>\"", "\[Rule]", "capDir2"}], ",", 
          RowBox[{"\"\<capAperture1\>\"", "\[Rule]", "capAperture1"}], ",", 
          RowBox[{"\"\<capAperture2\>\"", "\[Rule]", "capAperture2"}]}], 
         "|>"}], "]"}], ",", "\[IndentingNewLine]", "    ", 
       RowBox[{"\"\<spherCapInts\>\"", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", "\t ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<spherCapPair\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], ",", 
           RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
            RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
           RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<zbias\>\"", "\[Rule]", "2"}], ",", 
           RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], 
         "\[IndentingNewLine]", "       ", "}"}]}], ",", 
       "\[IndentingNewLine]", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spherRanges\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<axisDir\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", "Red", "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<rangeTheta\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#minTheta", ",", "#maxTheta"}], "}"}]}], ",", 
             RowBox[{"\"\<rangePhi\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#minPhi", ",", "#maxPhi"}], "}"}]}], ",", 
             RowBox[{"\"\<zbias\>\"", "\[Rule]", "2"}]}], "|>"}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<minTheta\>\"", "\[Rule]", 
           RowBox[{"quaterPart", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"\"\<maxTheta\>\"", "\[Rule]", 
           RowBox[{"quaterPart", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{"\"\<minPhi\>\"", "\[Rule]", 
           RowBox[{"quaterPart", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", 
          RowBox[{"\"\<maxPhi\>\"", "\[Rule]", 
           RowBox[{"quaterPart", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]}], "|>"}], "]"}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.2"}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<viewPoint\>\"", "\[Rule]", "Top"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"qtrPart", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     "quaterPart"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"showPart2", ",", "1"}], "}"}], ",", "0", ",", "1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"capDir1", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "0.72"}], "}"}], ",", "0", ",", "2"}], "}"}], 
   ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture1", ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture2", ",", 
       RowBox[{"\[Pi]", "/", "7"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"capApex1", ",", "capDir2", ",", "quaterPart"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8328217366446514`*^9, 3.8328217590807858`*^9}, {
   3.832821873738293*^9, 3.832821876772834*^9}, {3.8328228034088736`*^9, 
   3.8328228105163865`*^9}, 3.8328228719521513`*^9},
 CellLabel->
  "In[182]:=",ExpressionUUID->"f875c241-463b-414e-91e0-0ec1628109f2"],

Cell[BoxData[
 StyleBox["\<\" Intersection approximation for quater sphere.\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.832821760454646*^9, 3.8328228118974705`*^9, 
  3.8328228757840195`*^9, 3.837244614831353*^9},
 CellLabel->
  "During evaluation of \
In[182]:=",ExpressionUUID->"acdd3c37-d727-4100-be73-bcd6d82afe84"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`capAperture1$$ = Rational[1, 3] 
    Pi, $CellContext`capAperture2$$ = Rational[1, 7] 
    Pi, $CellContext`capDir1$$ = {0, 0, 1}, $CellContext`capDir2X$$ = 
    0.72, $CellContext`qtrPart$$ = {0, 0, 0, 0}, $CellContext`showPart2$$ = 1,
     Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`qtrPart$$], {0, 0, 0, 0}}, {
      0.1752241024639294, Rational[1, 3] Pi, -0.5825181761507041, 
       0.5825181761507041}}, {{
       Hold[$CellContext`showPart2$$], 1}, 0, 1, 1}, {{
       Hold[$CellContext`capDir1$$], {0, 0, 1}}}, {{
       Hold[$CellContext`capDir2X$$], 0.72}, 0, 2}, {{
       Hold[$CellContext`capAperture1$$], Rational[1, 3] Pi}, 0, 
      Rational[1, 2] Pi}, {{
       Hold[$CellContext`capAperture2$$], Rational[1, 7] Pi}, 0, 
      Rational[1, 2] Pi}}, Typeset`size$$ = {109., {47., 52.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`showPart2$236329$$ = 
    0, $CellContext`capDir2X$236330$$ = 
    0, $CellContext`capAperture1$236331$$ = 
    0, $CellContext`capAperture2$236332$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`capAperture1$$ = 
        Rational[1, 3] Pi, $CellContext`capAperture2$$ = 
        Rational[1, 7] Pi, $CellContext`capDir1$$ = {0, 0, 
         1}, $CellContext`capDir2X$$ = 
        0.72, $CellContext`qtrPart$$ = {0, 0, 0, 0}, $CellContext`showPart2$$ = 
        1}, "ControllerVariables" :> {
        Hold[$CellContext`showPart2$$, $CellContext`showPart2$236329$$, 0], 
        Hold[$CellContext`capDir2X$$, $CellContext`capDir2X$236330$$, 0], 
        Hold[$CellContext`capAperture1$$, $CellContext`capAperture1$236331$$, 
         0], 
        Hold[$CellContext`capAperture2$$, $CellContext`capAperture2$236332$$, 
         0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`capApex1 := 
        Normalize[$CellContext`capDir1$$]; $CellContext`capDir2 = \
{$CellContext`capDir2X$$, 0, 1}; $CellContext`quaterPart := 
        gSphericalCap`gCapIntsQuaterPart[$CellContext`capDir1$$, \
$CellContext`capAperture1$$, $CellContext`capDir2, \
$CellContext`capAperture2$$]; gPlots3D`gParamPlot3D[
         Association[
          ("spheres" -> {
            Association[
            "center" -> $CellContext`capApex1, "zbias" -> 5, "radius" -> 0.03,
              "colorFunc" -> (Red& )]}& )[], 
          ("spherCaps" -> {
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir1"], "coneAperture" -> Slot["capAperture1"], 
             "colorFunc" -> (Gray& ), "opacity" -> 1, "mesh" -> None], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir2"], "coneAperture" -> Slot["capAperture2"], 
             "colorFunc" -> (Green& ), "opacity" -> 1, "mesh" -> None]}& )[
           Association[
           "capDir1" -> $CellContext`capDir1$$, 
            "capDir2" -> $CellContext`capDir2, 
            "capAperture1" -> $CellContext`capAperture1$$, 
            "capAperture2" -> $CellContext`capAperture2$$]], "spherCapInts" -> {
            Association[
            "spherCapPair" -> {1, 2}, "colorFunc" -> (Blue& ), "opacity" -> 1,
              "zbias" -> 2, "mesh" -> None]}, 
          ("spherRanges" -> {
            Association[
            "center" -> {0, 0, 0}, "axisDir" -> {0, 0, 1}, "radius" -> 1, 
             "colorFunc" -> (Red& ), "rangeTheta" -> {
               Slot["minTheta"], 
               Slot["maxTheta"]}, "rangePhi" -> {
               Slot["minPhi"], 
               Slot["maxPhi"]}, "zbias" -> 2]}& )[
           Association[
           "minTheta" -> Part[$CellContext`quaterPart, 1], "maxTheta" -> 
            Part[$CellContext`quaterPart, 2], "minPhi" -> 
            Part[$CellContext`quaterPart, 3], "maxPhi" -> 
            Part[$CellContext`quaterPart, 4]]], "axisExtent" -> 1.2, 
          "viewPoint" -> Top]]), 
      "Specifications" :> {{{$CellContext`qtrPart$$, {0, 0, 0, 
          0}}, $CellContext`quaterPart}, {{$CellContext`showPart2$$, 1}, 0, 1,
          1}, {{$CellContext`capDir1$$, {0, 0, 
          1}}}, {{$CellContext`capDir2X$$, 0.72}, 0, 
         2}, {{$CellContext`capAperture1$$, Rational[1, 3] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`capAperture2$$, Rational[1, 7] Pi}, 0, 
         Rational[1, 2] Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{160., {70., 76.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.832821760504512*^9, 3.832822811935387*^9, 
  3.8328228758167543`*^9, 3.8372446148782263`*^9},
 CellLabel->
  "Out[184]=",ExpressionUUID->"8f654ef6-bf17-4fea-9c6a-262442e98780"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", "\"\<Intersection approximation for hemi sphere\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"capApex1", ",", "capDir2", ",", "hemiParts"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"capApex1", ":=", 
     RowBox[{"Normalize", "[", "capDir1", "]"}]}], ";", "\[IndentingNewLine]",
     "         ", 
    RowBox[{"capDir2", "=", 
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "0", ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"hemiParts", ":=", 
     RowBox[{"gCapIntsHemiPart", "[", 
      RowBox[{
      "capDir1", ",", "capAperture1", ",", "capDir2", ",", "capAperture2"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", " ", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spheres\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "capApex1"}], ",", 
             RowBox[{"\"\<zbias\>\"", "\[Rule]", "5"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spherCaps\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"(*", 
            RowBox[{"2", " ", "intersection", " ", "shperical", " ", "caps"}],
             "*)"}], "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir1"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture1"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Gray", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir2"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture2"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "    ", 
            RowBox[{"(*", 
             RowBox[{"hemi", " ", "part", " ", "1"}], "*)"}], 
            "\[IndentingNewLine]", "    ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "capApex1"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", 
               RowBox[{"hemiParts", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Red", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
              RowBox[{"\"\<zbias\>\"", "\[Rule]", "3"}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<capDir1\>\"", "\[Rule]", "capDir1"}], ",", 
          RowBox[{"\"\<capDir2\>\"", "\[Rule]", "capDir2"}], ",", 
          RowBox[{"\"\<capAperture1\>\"", "\[Rule]", "capAperture1"}], ",", 
          RowBox[{"\"\<capAperture2\>\"", "\[Rule]", "capAperture2"}]}], 
         "|>"}], "]"}], ",", "\[IndentingNewLine]", "    ", 
       RowBox[{"\"\<spherCapInts\>\"", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", "\t ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<spherCapPair\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], ",", 
           RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
            RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
           RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<zbias\>\"", "\[Rule]", "2"}], ",", 
           RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], 
         "\[IndentingNewLine]", "       ", "}"}]}], ",", 
       "\[IndentingNewLine]", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spherRanges\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<axisDir\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", "Green", "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<rangeTheta\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#minTheta", ",", "#maxTheta"}], "}"}]}], ",", 
             RowBox[{"\"\<rangePhi\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#minPhi", ",", "#maxPhi"}], "}"}]}], ",", 
             RowBox[{"\"\<zbias\>\"", "\[Rule]", "2"}]}], "|>"}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<minTheta\>\"", "\[Rule]", 
           RowBox[{"hemiParts", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"\"\<maxTheta\>\"", "\[Rule]", 
           RowBox[{"hemiParts", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{"\"\<minPhi\>\"", "\[Rule]", 
           RowBox[{"hemiParts", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], ",", 
          RowBox[{"\"\<maxPhi\>\"", "\[Rule]", 
           RowBox[{"hemiParts", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}]}], "|>"}], "]"}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.2"}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<viewPoint\>\"", "\[Rule]", "Top"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"qtrPart", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     "quaterPart"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"showPart2", ",", "1"}], "}"}], ",", "0", ",", "1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"capDir1", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "0.3"}], "}"}], ",", "0", ",", "2"}], "}"}], 
   ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture1", ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture2", ",", 
       RowBox[{"\[Pi]", "/", "7"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"capApex1", ",", "capDir2", ",", "hemiParts"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8328227854367*^9, 3.832822785918412*^9}, {
  3.832822823733445*^9, 3.8328228431808715`*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"e66845e2-7135-4c6e-bd81-431f5145103f"],

Cell[BoxData[
 StyleBox["\<\" Intersection approximation for hemi sphere\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.832822829561728*^9, 3.832822849233693*^9}, 
   3.837244615177007*^9},
 CellLabel->
  "During evaluation of \
In[186]:=",ExpressionUUID->"3ec7bd64-37c6-4584-bf2d-16e891016caf"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`capAperture1$$ = Rational[1, 3] 
    Pi, $CellContext`capAperture2$$ = Rational[1, 7] 
    Pi, $CellContext`capDir1$$ = {0, 0, 1}, $CellContext`capDir2X$$ = 
    0.3, $CellContext`qtrPart$$ = {0, 0, 0, 0}, $CellContext`showPart2$$ = 1, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`qtrPart$$], {0, 0, 0, 0}}, {0, 0, 0, 0}}, {{
       Hold[$CellContext`showPart2$$], 1}, 0, 1, 1}, {{
       Hold[$CellContext`capDir1$$], {0, 0, 1}}}, {{
       Hold[$CellContext`capDir2X$$], 0.3}, 0, 2}, {{
       Hold[$CellContext`capAperture1$$], Rational[1, 3] Pi}, 0, 
      Rational[1, 2] Pi}, {{
       Hold[$CellContext`capAperture2$$], Rational[1, 7] Pi}, 0, 
      Rational[1, 2] Pi}}, Typeset`size$$ = {109., {47., 52.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`showPart2$236533$$ = 
    0, $CellContext`capDir2X$236534$$ = 
    0, $CellContext`capAperture1$236535$$ = 
    0, $CellContext`capAperture2$236536$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`capAperture1$$ = 
        Rational[1, 3] Pi, $CellContext`capAperture2$$ = 
        Rational[1, 7] Pi, $CellContext`capDir1$$ = {0, 0, 
         1}, $CellContext`capDir2X$$ = 
        0.3, $CellContext`qtrPart$$ = {0, 0, 0, 0}, $CellContext`showPart2$$ = 
        1}, "ControllerVariables" :> {
        Hold[$CellContext`showPart2$$, $CellContext`showPart2$236533$$, 0], 
        Hold[$CellContext`capDir2X$$, $CellContext`capDir2X$236534$$, 0], 
        Hold[$CellContext`capAperture1$$, $CellContext`capAperture1$236535$$, 
         0], 
        Hold[$CellContext`capAperture2$$, $CellContext`capAperture2$236536$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`capApex1 := 
        Normalize[$CellContext`capDir1$$]; $CellContext`capDir2 = \
{$CellContext`capDir2X$$, 0, 1}; $CellContext`hemiParts := 
        gSphericalCap`gCapIntsHemiPart[$CellContext`capDir1$$, \
$CellContext`capAperture1$$, $CellContext`capDir2, \
$CellContext`capAperture2$$]; gPlots3D`gParamPlot3D[
         Association[
          ("spheres" -> {
            Association[
            "center" -> $CellContext`capApex1, "zbias" -> 5, "radius" -> 0.03,
              "colorFunc" -> (Red& )]}& )[], 
          ("spherCaps" -> {
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir1"], "coneAperture" -> Slot["capAperture1"], 
             "colorFunc" -> (Gray& ), "opacity" -> 1, "mesh" -> None], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir2"], "coneAperture" -> Slot["capAperture2"], 
             "colorFunc" -> (Green& ), "opacity" -> 1, "mesh" -> None], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, 
             "coneDir" -> $CellContext`capApex1, "coneAperture" -> 
             Part[$CellContext`hemiParts, 1], "colorFunc" -> (Red& ), 
             "opacity" -> 1, "mesh" -> None, "zbias" -> 3]}& )[
           Association[
           "capDir1" -> $CellContext`capDir1$$, 
            "capDir2" -> $CellContext`capDir2, 
            "capAperture1" -> $CellContext`capAperture1$$, 
            "capAperture2" -> $CellContext`capAperture2$$]], "spherCapInts" -> {
            Association[
            "spherCapPair" -> {1, 2}, "colorFunc" -> (Blue& ), "opacity" -> 1,
              "zbias" -> 2, "mesh" -> None]}, 
          ("spherRanges" -> {
            Association[
            "center" -> {0, 0, 0}, "axisDir" -> {0, 0, 1}, "radius" -> 1, 
             "colorFunc" -> (Green& ), "rangeTheta" -> {
               Slot["minTheta"], 
               Slot["maxTheta"]}, "rangePhi" -> {
               Slot["minPhi"], 
               Slot["maxPhi"]}, "zbias" -> 2]}& )[
           Association[
           "minTheta" -> Part[$CellContext`hemiParts, 2], "maxTheta" -> 
            Part[$CellContext`hemiParts, 3], "minPhi" -> 
            Part[$CellContext`hemiParts, 4], "maxPhi" -> 
            Part[$CellContext`hemiParts, 5]]], "axisExtent" -> 1.2, 
          "viewPoint" -> Top]]), 
      "Specifications" :> {{{$CellContext`qtrPart$$, {0, 0, 0, 0}}, 
         If[If[
            And[If[Re[
                 ArcCos[
                  Dot[{0, 0, 1}, 
                   Normalize[$CellContext`capDir2]]]] >= Rational[10, 21] Pi, 
               1, 0] == 0, Re[
               ArcCos[
                Dot[{0, 0, 1}, 
                 Normalize[$CellContext`capDir2]]]] >= Rational[1, 7] Pi], 1, 
            0] == 1, {
          gSphericalCap`Private`minTheta$236529, 
           gSphericalCap`Private`maxTheta$236529, 
           gSphericalCap`Private`minPhi$236529, 
           gSphericalCap`Private`maxPhi$236529}, {0, 0, 0, 
          0}]}, {{$CellContext`showPart2$$, 1}, 0, 1, 
         1}, {{$CellContext`capDir1$$, {0, 0, 1}}}, {{$CellContext`capDir2X$$,
           0.3}, 0, 2}, {{$CellContext`capAperture1$$, Rational[1, 3] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`capAperture2$$, Rational[1, 7] Pi}, 0, 
         Rational[1, 2] Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{160., {70., 76.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8328228295946827`*^9, 3.8328228492537003`*^9}, 
   3.837244615213089*^9},
 CellLabel->
  "Out[188]=",ExpressionUUID->"acb9157a-27de-4cd9-b793-8d645c91ce6e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", 
   "\"\<Intersection approximation in whole sphere(combined hemi & \
quater)\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "capApex1", ",", "capDir2", ",", "intsAreas", ",", "hemiAperture", ",", 
    "quaterRange"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"capApex1", "=", 
     RowBox[{"Normalize", "[", "capDir1", "]"}]}], ";", "\[IndentingNewLine]",
     "         ", 
    RowBox[{"capDir2", "=", 
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "0", ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"intsAreas", "=", 
     RowBox[{"gCapIntsAreas", "[", 
      RowBox[{
      "capDir1", ",", "capAperture1", ",", "capDir2", ",", "capAperture2"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"hemiAperture", "=", 
     RowBox[{"intsAreas", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"quaterRange", "=", 
     RowBox[{"intsAreas", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", " ", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spheres\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "capApex1"}], ",", 
             RowBox[{"\"\<zbias\>\"", "\[Rule]", "5"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spherCaps\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"(*", 
            RowBox[{"2", " ", "intersection", " ", "shperical", " ", "caps"}],
             "*)"}], "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir1"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture1"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Gray", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir2"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture2"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "    ", 
            RowBox[{"(*", 
             RowBox[{"hemi", " ", "part", " ", "1"}], "*)"}], 
            "\[IndentingNewLine]", "    ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "capApex1"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "hemiAperture"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Red", "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
              RowBox[{"\"\<zbias\>\"", "\[Rule]", "3"}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<capDir1\>\"", "\[Rule]", "capDir1"}], ",", 
          RowBox[{"\"\<capDir2\>\"", "\[Rule]", "capDir2"}], ",", 
          RowBox[{"\"\<capAperture1\>\"", "\[Rule]", "capAperture1"}], ",", 
          RowBox[{"\"\<capAperture2\>\"", "\[Rule]", "capAperture2"}]}], 
         "|>"}], "]"}], ",", "\[IndentingNewLine]", "    ", 
       RowBox[{"\"\<spherCapInts\>\"", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", "\t ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<spherCapPair\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], ",", 
           RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
            RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
           RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<zbias\>\"", "\[Rule]", "2"}], ",", 
           RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], 
         "\[IndentingNewLine]", "       ", "}"}]}], ",", 
       "\[IndentingNewLine]", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spherRanges\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<axisDir\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", "Green", "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<rangeTheta\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#minTheta", ",", "#maxTheta"}], "}"}]}], ",", 
             RowBox[{"\"\<rangePhi\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#minPhi", ",", "#maxPhi"}], "}"}]}], ",", 
             RowBox[{"\"\<zbias\>\"", "\[Rule]", "2"}]}], "|>"}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<minTheta\>\"", "\[Rule]", 
           RowBox[{"quaterRange", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"\"\<maxTheta\>\"", "\[Rule]", 
           RowBox[{"quaterRange", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{"\"\<minPhi\>\"", "\[Rule]", 
           RowBox[{"quaterRange", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", 
          RowBox[{"\"\<maxPhi\>\"", "\[Rule]", 
           RowBox[{"quaterRange", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]}], "|>"}], "]"}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.2"}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<viewPoint\>\"", "\[Rule]", "Top"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"qtrPart", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     "quaterPart"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"showPart2", ",", "1"}], "}"}], ",", "0", ",", "1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"capDir1", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capDir2X", ",", "0.3"}], "}"}], ",", "0", ",", "2"}], "}"}], 
   ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture1", ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture2", ",", 
       RowBox[{"\[Pi]", "/", "7"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "capApex1", ",", "capDir2", ",", "intsAreas", ",", "hemiAperture", ",", 
    "quaterRange"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.832823879317861*^9, 3.832823900486845*^9}, {
  3.832823951406057*^9, 3.832823953973832*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"bb99413e-f5d9-4852-bc09-08e5eb32d4d5"],

Cell[BoxData[
 StyleBox["\<\" Intersection approximation in whole sphere(combined hemi & \
quater)\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8328239073184233`*^9, 3.8328239612590113`*^9, 
  3.8372446155387516`*^9},
 CellLabel->
  "During evaluation of \
In[190]:=",ExpressionUUID->"f63e1758-fa12-4038-9b2b-ba865edaa603"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`capAperture1$$ = Rational[1, 3] 
    Pi, $CellContext`capAperture2$$ = Rational[1, 7] 
    Pi, $CellContext`capDir1$$ = {0, 0, 1}, $CellContext`capDir2X$$ = 
    0.3, $CellContext`qtrPart$$ = {0, 0, 0, 0}, $CellContext`showPart2$$ = 1, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`qtrPart$$], {0, 0, 0, 0}}, {0, 0, 0, 0}}, {{
       Hold[$CellContext`showPart2$$], 1}, 0, 1, 1}, {{
       Hold[$CellContext`capDir1$$], {0, 0, 1}}}, {{
       Hold[$CellContext`capDir2X$$], 0.3}, 0, 2}, {{
       Hold[$CellContext`capAperture1$$], Rational[1, 3] Pi}, 0, 
      Rational[1, 2] Pi}, {{
       Hold[$CellContext`capAperture2$$], Rational[1, 7] Pi}, 0, 
      Rational[1, 2] Pi}}, Typeset`size$$ = {109., {47., 52.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`showPart2$236749$$ = 
    0, $CellContext`capDir2X$236750$$ = 
    0, $CellContext`capAperture1$236751$$ = 
    0, $CellContext`capAperture2$236752$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`capAperture1$$ = 
        Rational[1, 3] Pi, $CellContext`capAperture2$$ = 
        Rational[1, 7] Pi, $CellContext`capDir1$$ = {0, 0, 
         1}, $CellContext`capDir2X$$ = 
        0.3, $CellContext`qtrPart$$ = {0, 0, 0, 0}, $CellContext`showPart2$$ = 
        1}, "ControllerVariables" :> {
        Hold[$CellContext`showPart2$$, $CellContext`showPart2$236749$$, 0], 
        Hold[$CellContext`capDir2X$$, $CellContext`capDir2X$236750$$, 0], 
        Hold[$CellContext`capAperture1$$, $CellContext`capAperture1$236751$$, 
         0], 
        Hold[$CellContext`capAperture2$$, $CellContext`capAperture2$236752$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`capApex1 = 
        Normalize[$CellContext`capDir1$$]; $CellContext`capDir2 = \
{$CellContext`capDir2X$$, 0, 1}; $CellContext`intsAreas = 
        gSphericalCap`gCapIntsAreas[$CellContext`capDir1$$, \
$CellContext`capAperture1$$, $CellContext`capDir2, \
$CellContext`capAperture2$$]; $CellContext`hemiAperture = 
        Part[$CellContext`intsAreas, 1]; $CellContext`quaterRange = 
        Part[$CellContext`intsAreas, 2]; gPlots3D`gParamPlot3D[
         Association[
          ("spheres" -> {
            Association[
            "center" -> $CellContext`capApex1, "zbias" -> 5, "radius" -> 0.03,
              "colorFunc" -> (Red& )]}& )[], 
          ("spherCaps" -> {
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir1"], "coneAperture" -> Slot["capAperture1"], 
             "colorFunc" -> (Gray& ), "opacity" -> 1, "mesh" -> None], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir2"], "coneAperture" -> Slot["capAperture2"], 
             "colorFunc" -> (Green& ), "opacity" -> 1, "mesh" -> None], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, 
             "coneDir" -> $CellContext`capApex1, 
             "coneAperture" -> $CellContext`hemiAperture, 
             "colorFunc" -> (Red& ), "opacity" -> 1, "mesh" -> None, "zbias" -> 
             3]}& )[
           Association[
           "capDir1" -> $CellContext`capDir1$$, 
            "capDir2" -> $CellContext`capDir2, 
            "capAperture1" -> $CellContext`capAperture1$$, 
            "capAperture2" -> $CellContext`capAperture2$$]], "spherCapInts" -> {
            Association[
            "spherCapPair" -> {1, 2}, "colorFunc" -> (Blue& ), "opacity" -> 1,
              "zbias" -> 2, "mesh" -> None]}, 
          ("spherRanges" -> {
            Association[
            "center" -> {0, 0, 0}, "axisDir" -> {0, 0, 1}, "radius" -> 1, 
             "colorFunc" -> (Green& ), "rangeTheta" -> {
               Slot["minTheta"], 
               Slot["maxTheta"]}, "rangePhi" -> {
               Slot["minPhi"], 
               Slot["maxPhi"]}, "zbias" -> 2]}& )[
           Association[
           "minTheta" -> Part[$CellContext`quaterRange, 1], "maxTheta" -> 
            Part[$CellContext`quaterRange, 2], "minPhi" -> 
            Part[$CellContext`quaterRange, 3], "maxPhi" -> 
            Part[$CellContext`quaterRange, 4]]], "axisExtent" -> 1.2, 
          "viewPoint" -> Top]]), 
      "Specifications" :> {{{$CellContext`qtrPart$$, {0, 0, 0, 0}}, 
         If[If[
            And[If[Re[
                 ArcCos[
                  Dot[{0, 0, 1}, 
                   Normalize[$CellContext`capDir2]]]] >= Rational[10, 21] Pi, 
               1, 0] == 0, Re[
               ArcCos[
                Dot[{0, 0, 1}, 
                 Normalize[$CellContext`capDir2]]]] >= Rational[1, 7] Pi], 1, 
            0] == 1, {
          gSphericalCap`Private`minTheta$236745, 
           gSphericalCap`Private`maxTheta$236745, 
           gSphericalCap`Private`minPhi$236745, 
           gSphericalCap`Private`maxPhi$236745}, {0, 0, 0, 
          0}]}, {{$CellContext`showPart2$$, 1}, 0, 1, 
         1}, {{$CellContext`capDir1$$, {0, 0, 1}}}, {{$CellContext`capDir2X$$,
           0.3}, 0, 2}, {{$CellContext`capAperture1$$, Rational[1, 3] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`capAperture2$$, Rational[1, 7] Pi}, 0, 
         Rational[1, 2] Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{160., {70., 76.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8328239073548317`*^9, 3.832823961286019*^9, 
  3.8372446155818176`*^9},
 CellLabel->
  "Out[192]=",ExpressionUUID->"5b812fc1-b7d5-4a54-92f3-5321260db52e"]
}, Open  ]]
},
WindowSize->{1014, 844},
WindowMargins->{{Automatic, 123}, {72, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 7064, 160, 637, "Input",ExpressionUUID->"f0e648ee-f34f-4104-9ddb-f49c9767f0e9"],
Cell[7647, 184, 1373, 23, 30, "Print",ExpressionUUID->"5de4e5b5-7cfb-4dfd-839b-8f963fd1ab95"],
Cell[9023, 209, 5244, 100, 167, "Output",ExpressionUUID->"c2cc573d-2b75-46ac-8f19-a5f642c9988a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14304, 314, 8402, 188, 675, "Input",ExpressionUUID->"4fe272e8-3b2c-4b18-b7b5-f7a1a2b26511"],
Cell[22709, 504, 645, 13, 30, "Print",ExpressionUUID->"5f350d64-9a34-4b73-acec-647dcd93ea64"],
Cell[23357, 519, 5839, 116, 181, "Output",ExpressionUUID->"8f93673a-0596-4dea-a6d4-5e1257c3e12f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29233, 640, 3261, 89, 181, "Input",ExpressionUUID->"d1a4f573-3587-43d4-9f50-feb5db6eb19c"],
Cell[32497, 731, 541, 11, 30, "Print",ExpressionUUID->"f3c3854e-6651-45ac-aa34-40297eb7dfdf"],
Cell[33041, 744, 635, 12, 32, "Output",ExpressionUUID->"87e44bbc-ca98-4abc-a09b-593cf685c4d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33713, 761, 5587, 127, 504, "Input",ExpressionUUID->"6d041034-bf16-4370-b639-efd81d1ee155"],
Cell[39303, 890, 705, 14, 30, "Print",ExpressionUUID->"ecb250f2-d029-4251-a017-30a72c667776"],
Cell[40011, 906, 4814, 92, 167, "Output",ExpressionUUID->"055c8b97-0679-4cbf-aa04-75ebb10fcf0b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44862, 1003, 9230, 202, 751, "Input",ExpressionUUID->"32df95ee-451f-4e73-9a8b-12e509254f67"],
Cell[54095, 1207, 879, 16, 30, "Print",ExpressionUUID->"8d18acb9-ba34-45c2-9150-2853f2d6aefb"],
Cell[54977, 1225, 5922, 114, 165, "Output",ExpressionUUID->"1dc845f0-09bf-4b91-8782-1fe9110ad410"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60936, 1344, 8820, 190, 732, "Input",ExpressionUUID->"3ccd6b78-27a4-4890-be28-3d6a5bc26856"],
Cell[69759, 1536, 691, 13, 30, "Print",ExpressionUUID->"d3982ed2-5e4a-425b-90d9-ff83583bd7be"],
Cell[70453, 1551, 5340, 101, 165, "Output",ExpressionUUID->"ea427f67-659b-417c-ab60-4c5cfd094179"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75830, 1657, 12739, 272, 1112, "Input",ExpressionUUID->"fa4ceeea-8f85-4c9c-bd92-408e9fd736d1"],
Cell[88572, 1931, 416, 9, 30, "Print",ExpressionUUID->"334a8975-82e7-4007-9067-610447b0e179"],
Cell[88991, 1942, 6530, 124, 165, "Output",ExpressionUUID->"61cf5512-0d17-4350-b135-d6465104f123"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95558, 2071, 6581, 149, 656, "Input",ExpressionUUID->"65726603-db31-4a3c-9ed5-871f963dcbc9"],
Cell[102142, 2222, 404, 9, 30, "Print",ExpressionUUID->"bf38ac82-fbb6-45dd-98a2-7c5a978f513f"],
Cell[102549, 2233, 5175, 98, 165, "Output",ExpressionUUID->"c3c53b2f-522b-489a-bc2a-6c81f999a3df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107761, 2336, 8383, 189, 732, "Input",ExpressionUUID->"f875c241-463b-414e-91e0-0ec1628109f2"],
Cell[116147, 2527, 391, 9, 30, "Print",ExpressionUUID->"acdd3c37-d727-4100-be73-bcd6d82afe84"],
Cell[116541, 2538, 5590, 110, 165, "Output",ExpressionUUID->"8f654ef6-bf17-4fea-9c6a-262442e98780"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122168, 2653, 9317, 208, 789, "Input",ExpressionUUID->"e66845e2-7135-4c6e-bd81-431f5145103f"],
Cell[131488, 2863, 365, 9, 30, "Print",ExpressionUUID->"3ec7bd64-37c6-4584-bf2d-16e891016caf"],
Cell[131856, 2874, 6293, 125, 165, "Output",ExpressionUUID->"acb9157a-27de-4cd9-b793-8d645c91ce6e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138186, 3004, 9647, 215, 827, "Input",ExpressionUUID->"bb99413e-f5d9-4852-bc09-08e5eb32d4d5"],
Cell[147836, 3221, 394, 10, 30, "Print",ExpressionUUID->"f63e1758-fa12-4038-9b2b-ba865edaa603"],
Cell[148233, 3233, 6440, 128, 165, "Output",ExpressionUUID->"5b812fc1-b7d5-4a54-92f3-5321260db52e"]
}, Open  ]]
}
]
*)

