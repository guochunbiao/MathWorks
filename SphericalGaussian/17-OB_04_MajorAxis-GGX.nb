(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50716,       1189]
NotebookOptionsPosition[     48931,       1154]
NotebookOutlinePosition[     49276,       1169]
CellTagsIndexPosition[     49233,       1166]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gPrint", "[", "\"\<Approx Major Axis\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "diskCenterPt", ",", "diskNormalAxis", ",", "diskRadius", ",", 
     "\[IndentingNewLine]", "\t", "diskTangentZ", ",", "diskBiTangentZ", ",", 
     "viewPoint", ",", "lightDir", ",", "\[IndentingNewLine]", "\t", 
     "viewDir0", ",", "viewDist0", ",", "viewDir1", ",", "viewDist1", ",", 
     "\[IndentingNewLine]", "\t", "shadingPt1", ",", "shadingPt1Proj", ",", 
     "halfEdgePt", ",", "halfEdgePtProj", ",", "\[IndentingNewLine]", "\t", 
     "theta1", ",", "theta1Axis", ",", "theta2", ",", "theta3Axis", ",", 
     "theta3", ",", "theta3Axis", ",", "theta4", ",", "theta5", ",", 
     "lerpFactor", ",", "approxTheta3"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"shadingPt0", "=", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"viewPoint", "=", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"diskCenterPt", "=", "shadingPt0"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"diskNormalAxis", "=", 
          RowBox[{"Normalize", "@", 
           RowBox[{"{", 
            RowBox[{"0", ",", "diskNormalY", ",", "1"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"diskRadius", "=", "2"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"halfDir0", "=", "diskNormalAxis"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"viewDist0", "=", 
          RowBox[{"Norm", "[", 
           RowBox[{"viewPoint", "-", "shadingPt0"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"viewDir0", "=", 
          RowBox[{"Normalize", "[", 
           RowBox[{"viewPoint", "-", "shadingPt0"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lightDir", "=", 
          RowBox[{"gReflectVector", "[", 
           RowBox[{"viewDir0", ",", "halfDir0"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"diskTangentZ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{"diskNormalAxis", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0", ",", "x"}], "}"}]}], "]"}], 
               "\[Equal]", "0"}], ",", "x"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"diskTangent", "=", 
          RowBox[{"Normalize", "@", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "diskTangentZ"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"diskBiTangentZ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{"diskNormalAxis", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1", ",", "x"}], "}"}]}], "]"}], 
               "\[Equal]", "0"}], ",", "x"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"diskBiTangent", "=", 
          RowBox[{"Normalize", "@", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "diskBiTangentZ"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"shadingPt1", "=", 
          RowBox[{"shadingPt0", "+", 
           RowBox[{"diskTangent", "*", "shadingPt1Offset"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"viewDir1", "=", 
          RowBox[{"Normalize", "[", 
           RowBox[{"viewPoint", "-", "shadingPt1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"viewDist1", "=", 
          RowBox[{"Norm", "[", 
           RowBox[{"viewPoint", "-", "shadingPt1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"halfDir1", "=", 
          RowBox[{"Normalize", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"lightDir", "+", "viewDir1"}], ")"}], "/", "2"}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"halfEdgePt", "=", 
          RowBox[{"shadingPt1", "+", 
           RowBox[{"halfDir1", "*", "1"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"halfEdgePtProj", "=", 
          RowBox[{"halfEdgePt", "-", 
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{"halfDir1", ",", "diskNormalAxis"}], "]"}], "*", 
            "diskNormalAxis"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"theta1", "=", 
          RowBox[{
           RowBox[{"ArcCos", "[", 
            RowBox[{"Abs", "@", 
             RowBox[{"Dot", "[", 
              RowBox[{"viewDir0", ",", "diskNormalAxis"}], "]"}]}], "]"}], "//",
            "N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"theta1Axis", "=", 
          RowBox[{"Normalize", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"viewDir0", "+", "diskNormalAxis"}], ")"}], "/", "2"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"theta2", "=", 
          RowBox[{
           RowBox[{"ArcCos", "[", 
            RowBox[{"Abs", "@", 
             RowBox[{"Dot", "[", 
              RowBox[{"viewDir1", ",", "diskNormalAxis"}], "]"}]}], "]"}], "//",
            "N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"theta2Axis", "=", 
          RowBox[{"Normalize", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"viewDir1", "+", "diskNormalAxis"}], ")"}], "/", "2"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"theta3", "=", 
          RowBox[{
           RowBox[{"ArcCos", "[", 
            RowBox[{"Abs", "@", 
             RowBox[{"Dot", "[", 
              RowBox[{"halfDir1", ",", "diskNormalAxis"}], "]"}]}], "]"}], "//",
            "N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"theta3Axis", "=", 
          RowBox[{"Normalize", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"halfDir1", "+", "diskNormalAxis"}], ")"}], "/", "2"}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"theta4", "=", 
          FractionBox[
           RowBox[{"ArcTan", "[", 
            RowBox[{"shadingPt1Offset", "/", "1"}], "]"}], "2"]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"theta5", "=", 
          RowBox[{
           RowBox[{"\[Pi]", "/", "2"}], "//", "N"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lerpFactor", "=", 
          RowBox[{"Sin", "[", "theta1", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"approxTheta3", "=", 
            RowBox[{"theta4", "+", 
             RowBox[{
              RowBox[{"ArcCot", "[", 
               FractionBox[
                RowBox[{"Sin", "[", 
                 RowBox[{"2", "*", "theta1"}], "]"}], "shadingPt1Offset"], 
               "]"}], "*", 
              RowBox[{"Sin", "[", 
               RowBox[{"theta1", "/", "2"}], "]"}]}]}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"approxTheta3", "=", 
          RowBox[{"theta4", "+", 
           RowBox[{
            RowBox[{"ArcCot", "[", 
             FractionBox[
              RowBox[{"Sin", "[", 
               RowBox[{"2", "*", "theta1"}], "]"}], "shadingPt1Offset"], 
             "]"}], "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"theta1", "/", "2"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<disks\>\"", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", "   ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "diskCenterPt"}], ",", 
               RowBox[{"\"\<normalAxis\>\"", "\[Rule]", "diskNormalAxis"}], 
               ",", "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "diskRadius"}], ",", 
               RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                  "LightCyan"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", 
             " ", "}"}]}], "&"}], "[", "]"}]}], ",", "\[IndentingNewLine]", 
        "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<lines\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", "  ", 
            RowBox[{"(*", 
             RowBox[{"disk", " ", "tangent"}], "*)"}], "\[IndentingNewLine]", 
            "   ", 
            RowBox[{
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "diskCenterPt"}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "diskTangent"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "diskRadius"}], ",", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "LightGreen", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", "   ", 
             RowBox[{"(*", 
              RowBox[{"view", " ", "dirs"}], "*)"}], "\[IndentingNewLine]", 
             "   ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt0"}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "viewDir0"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "viewDist0"}], ",", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "LightGray", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", "   ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt1"}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "viewDir1"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "viewDist1"}], ",", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "LightGray", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", "   ", 
             RowBox[{"(*", 
              RowBox[{"light", " ", "dirs"}], "*)"}], "\[IndentingNewLine]", 
             "    ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt0"}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "lightDir"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Green", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", "    ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt1"}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "lightDir"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Green", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", "    ", 
             RowBox[{"(*", 
              RowBox[{"half", " ", "dirs"}], "*)"}], "\[IndentingNewLine]", 
             "     ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt0"}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "halfDir0"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", "     ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt1"}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "halfDir1"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Red", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", "    ", 
             RowBox[{"(*", 
              RowBox[{"normal", " ", "dirs"}], "*)"}], "\[IndentingNewLine]", 
             "    ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt1"}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "diskNormalAxis"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Gray", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", "     ", 
             RowBox[{"(*", 
              RowBox[{"helper", " ", "lines"}], "*)"}], "\[IndentingNewLine]",
              "     ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"shadingPt1", "+", 
                 RowBox[{"halfDir1", "*", "1"}]}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"-", "diskNormalAxis"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Orange", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", "     ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt1"}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"Normalize", "[", 
                 RowBox[{"halfEdgePtProj", "-", "shadingPt1"}], "]"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", 
                RowBox[{"Norm", "[", 
                 RowBox[{"halfEdgePtProj", "-", "shadingPt1"}], "]"}]}], ",", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Orange", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}]}], 
            "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "     ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\"\<arcsEx\>\"", "\[Rule]", 
             RowBox[{"{", "\[IndentingNewLine]", "   ", 
              RowBox[{"(*", "theta1", "*)"}], "\[IndentingNewLine]", "   ", 
              RowBox[{
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"\"\<center\>\"", "\[Rule]", "shadingPt0"}], ",", 
                 RowBox[{"\"\<radius\>\"", "\[Rule]", "0.2"}], ",", 
                 RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}], ",", 
                 "\[IndentingNewLine]", "\t", 
                 RowBox[{"\"\<leftDir\>\"", "\[Rule]", "viewDir0"}], ",", 
                 RowBox[{"\"\<rightDir\>\"", "\[Rule]", "diskNormalAxis"}], 
                 ",", "\[IndentingNewLine]", "\t", 
                 RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
                 RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                  RowBox[{"Function", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                    "Black"}], "]"}]}]}], "|>"}], ",", "\[IndentingNewLine]", 
               "   ", 
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"\"\<center\>\"", "\[Rule]", "shadingPt1"}], ",", 
                 RowBox[{"\"\<radius\>\"", "\[Rule]", "0.2"}], ",", 
                 RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}], ",", 
                 "\[IndentingNewLine]", "\t", 
                 RowBox[{"\"\<leftDir\>\"", "\[Rule]", "viewDir1"}], ",", 
                 RowBox[{"\"\<rightDir\>\"", "\[Rule]", "diskNormalAxis"}], 
                 ",", "\[IndentingNewLine]", "\t", 
                 RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
                 RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                  RowBox[{"Function", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                    "Black"}], "]"}]}]}], "|>"}], ",", "\[IndentingNewLine]", 
               "   ", 
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"\"\<center\>\"", "\[Rule]", "shadingPt1"}], ",", 
                 RowBox[{"\"\<radius\>\"", "\[Rule]", "0.4"}], ",", 
                 RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}], ",", 
                 "\[IndentingNewLine]", "\t", 
                 RowBox[{"\"\<leftDir\>\"", "\[Rule]", "halfDir1"}], ",", 
                 RowBox[{"\"\<rightDir\>\"", "\[Rule]", "diskNormalAxis"}], 
                 ",", "\[IndentingNewLine]", "\t", 
                 RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
                 RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                  RowBox[{"Function", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                    "Black"}], "]"}]}]}], "|>"}]}], "\[IndentingNewLine]", 
              " ", "}"}]}], "&"}], "[", "]"}], ","}], "*)"}], 
        "\[IndentingNewLine]", "     ", 
        RowBox[{"\"\<customPlots\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"view", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
          "\t", 
          RowBox[{
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Magenta", ",", 
              RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
              RowBox[{"Point", "[", "viewPoint", "]"}]}], "}"}], " ", "]"}], 
           ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", 
            RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Red", ",", 
              RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
              RowBox[{"Point", "[", "shadingPt1", "]"}]}], "}"}], " ", "]"}], 
           ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", 
            RowBox[{
            "half", " ", "edge", " ", "point", " ", "project", " ", "onto", 
             " ", "disk"}], "*)"}], "\[IndentingNewLine]", "\t", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Gray", ",", 
              RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
              RowBox[{"Point", "[", "halfEdgePtProj", "]"}]}], "}"}], " ", 
            "]"}], ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", "texts", "*)"}], "\[IndentingNewLine]", "\t", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<l\>\"", ",", "18"}], "]"}], ",", 
               RowBox[{"shadingPt1", "+", 
                RowBox[{"lightDir", "*", "1.05"}]}]}], "]"}], "}"}], "]"}], 
           ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<h\>\"", ",", "18"}], "]"}], ",", 
               RowBox[{"shadingPt1", "+", 
                RowBox[{"halfDir1", "*", "1.05"}]}]}], "]"}], "}"}], "]"}], 
           ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<n\>\"", ",", "18"}], "]"}], ",", 
               RowBox[{"shadingPt1", "+", 
                RowBox[{"diskNormalAxis", "*", "1.05"}]}]}], "]"}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<\[Theta]1\>\"", ",", "16"}], "]"}], ",", 
               RowBox[{"shadingPt0", "+", 
                RowBox[{"theta1Axis", "*", "0.3"}]}]}], "]"}], "}"}], "]"}], 
           ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<\[Theta]2\>\"", ",", "16"}], "]"}], ",", 
               RowBox[{"shadingPt1", "+", 
                RowBox[{"theta2Axis", "*", "0.3"}]}]}], "]"}], "}"}], "]"}], 
           ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<\[Theta]3\>\"", ",", "16"}], "]"}], ",", 
               RowBox[{"shadingPt1", "+", 
                RowBox[{"theta3Axis", "*", "0.5"}]}]}], "]"}], "}"}], "]"}]}],
           "\[IndentingNewLine]", "\t", "}"}]}], ",", "\[IndentingNewLine]", 
        "     ", 
        RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "2"}]}], 
       "\[IndentingNewLine]", "|>"}], ",", "Large"}], "]"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"diskNormalY", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"-", "10"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
    "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"shadingPt1Offset", ",", "1.5"}], "}"}], ",", "0.01", ",", 
      "2"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"thetas", ",", 
       RowBox[{"{", 
        RowBox[{
        "theta3", ",", "approxTheta3", ",", "theta4", ",", "theta5", ",", 
         "lerpFactor"}], "}"}]}], "}"}], "}"}], ",", "\[IndentingNewLine]", 
    "   ", 
    RowBox[{"Method", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "diskCenterPt", ",", "diskNormalAxis", ",", "diskRadius", ",", 
     "\[IndentingNewLine]", "\t", "diskTangentZ", ",", "diskBiTangentZ", ",", 
     "viewPoint", ",", "lightDir", ",", "\[IndentingNewLine]", "\t", 
     "viewDir0", ",", "viewDist0", ",", "viewDir1", ",", "viewDist1", ",", 
     "\[IndentingNewLine]", "\t", "shadingPt1", ",", "shadingPt1Proj", ",", 
     "halfEdgePt", ",", "halfEdgePtProj", ",", "\[IndentingNewLine]", "\t", 
     "theta1", ",", "theta1Axis", ",", "theta2", ",", "theta3Axis", ",", 
     "theta3", ",", "theta3Axis", ",", "theta4", ",", "theta5", ",", 
     "lerpFactor", ",", "approxTheta3"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.8353286839278593`*^9, {3.8353287201439123`*^9, 3.8353287203506503`*^9}, {
   3.835328770488923*^9, 3.835328779619835*^9}, {3.835411402115467*^9, 
   3.8354114404616876`*^9}, {3.83541337956394*^9, 3.8354133872542396`*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"61af0d58-2f26-4f9c-a4a1-9e561e9e1b28"],

Cell[BoxData[
 StyleBox["\<\" Approx Major Axis\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.835328780307745*^9, {3.835411418487243*^9, 3.835411441236021*^9}, {
   3.8354133801702423`*^9, 3.835413387635914*^9}},
 CellLabel->
  "During evaluation of \
In[121]:=",ExpressionUUID->"83de5b90-c42b-4446-898c-0023fe112f5e"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`diskNormalY$$ = -1, \
$CellContext`shadingPt1Offset$$ = 1.5, $CellContext`thetas$$ = {
    0.6803539669214088, 0.8674957369428186, 0.4913968616236645, 
    1.5707963267948966`, 0.7071067811865476}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`diskNormalY$$], -1}, -10, 1}, {{
       Hold[$CellContext`shadingPt1Offset$$], 1.5}, 0.01, 2}, {{
       Hold[$CellContext`thetas$$], {0.6803539669214088, 0.8674957369428186, 
       0.4913968616236645, 1.5707963267948966`, 0.7071067811865476}}}}, 
    Typeset`size$$ = {585., {288., 292.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`diskNormalY$760437$$ = 
    0, $CellContext`shadingPt1Offset$760438$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`diskNormalY$$ = -1, \
$CellContext`shadingPt1Offset$$ = 
        1.5, $CellContext`thetas$$ = {$CellContext`theta3, \
$CellContext`approxTheta3, $CellContext`theta4, $CellContext`theta5, \
$CellContext`lerpFactor}}, "ControllerVariables" :> {
        Hold[$CellContext`diskNormalY$$, $CellContext`diskNormalY$760437$$, 
         0], 
        Hold[$CellContext`shadingPt1Offset$$, \
$CellContext`shadingPt1Offset$760438$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> gPlots3D`gParamPlot3D[
        Association[$CellContext`shadingPt0 = {0, 0, 
           0}; $CellContext`viewPoint = {0, 0, 
           1}; $CellContext`diskCenterPt = $CellContext`shadingPt0; \
$CellContext`diskNormalAxis = 
          Normalize[{
            0, $CellContext`diskNormalY$$, 1}]; $CellContext`diskRadius = 
          
          2; $CellContext`halfDir0 = $CellContext`diskNormalAxis; \
$CellContext`viewDist0 = 
          Norm[$CellContext`viewPoint - $CellContext`shadingPt0]; \
$CellContext`viewDir0 = 
          Normalize[$CellContext`viewPoint - $CellContext`shadingPt0]; \
$CellContext`lightDir = 
          gUtils`gReflectVector[$CellContext`viewDir0, $CellContext`halfDir0]; \
$CellContext`diskTangentZ = Part[
            Part[
             Solve[
             Dot[$CellContext`diskNormalAxis, {1, 0, $CellContext`x}] == 
              0, $CellContext`x], All, 1, 2], 1]; $CellContext`diskTangent = 
          Normalize[{
            1, 0, $CellContext`diskTangentZ}]; $CellContext`diskBiTangentZ = 
          Part[
            Part[
             Solve[
             Dot[$CellContext`diskNormalAxis, {0, 1, $CellContext`x}] == 
              0, $CellContext`x], All, 1, 2], 1]; $CellContext`diskBiTangent = 
          Normalize[{
            0, 1, $CellContext`diskBiTangentZ}]; $CellContext`shadingPt1 = \
$CellContext`shadingPt0 + $CellContext`diskTangent \
$CellContext`shadingPt1Offset$$; $CellContext`viewDir1 = 
          Normalize[$CellContext`viewPoint - $CellContext`shadingPt1]; \
$CellContext`viewDist1 = 
          Norm[$CellContext`viewPoint - $CellContext`shadingPt1]; \
$CellContext`halfDir1 = 
          Normalize[($CellContext`lightDir + $CellContext`viewDir1)/
            2]; $CellContext`halfEdgePt = $CellContext`shadingPt1 + \
$CellContext`halfDir1 
            1; $CellContext`halfEdgePtProj = $CellContext`halfEdgePt - 
           Dot[$CellContext`halfDir1, $CellContext`diskNormalAxis] \
$CellContext`diskNormalAxis; $CellContext`theta1 = N[
            ArcCos[
             Abs[
              
              Dot[$CellContext`viewDir0, $CellContext`diskNormalAxis]]]]; \
$CellContext`theta1Axis = 
          Normalize[($CellContext`viewDir0 + $CellContext`diskNormalAxis)/
            2]; $CellContext`theta2 = N[
            ArcCos[
             Abs[
              
              Dot[$CellContext`viewDir1, $CellContext`diskNormalAxis]]]]; \
$CellContext`theta2Axis = 
          Normalize[($CellContext`viewDir1 + $CellContext`diskNormalAxis)/
            2]; $CellContext`theta3 = N[
            ArcCos[
             Abs[
              
              Dot[$CellContext`halfDir1, $CellContext`diskNormalAxis]]]]; \
$CellContext`theta3Axis = 
          Normalize[($CellContext`halfDir1 + $CellContext`diskNormalAxis)/
            2]; $CellContext`theta4 = 
          ArcTan[$CellContext`shadingPt1Offset$$/1]/2; $CellContext`theta5 = 
          N[Pi/2]; $CellContext`lerpFactor = 
          Sin[$CellContext`theta1]; $CellContext`approxTheta3 = \
$CellContext`theta4 + 
           ArcCot[Sin[2 $CellContext`theta1]/$CellContext`shadingPt1Offset$$] 
            Sin[$CellContext`theta1/2]; ("disks" -> {
            Association[
            "center" -> $CellContext`diskCenterPt, 
             "normalAxis" -> $CellContext`diskNormalAxis, 
             "radius" -> $CellContext`diskRadius, "mesh" -> None, "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z, \
$CellContext`p}, LightCyan]]}& )[], 
         ("lines" -> {
           Association[
           "startPos" -> $CellContext`diskCenterPt, 
            "dirVec" -> $CellContext`diskTangent, 
            "length" -> $CellContext`diskRadius, 
            "colorFunc" -> (LightGreen& ), "thickness" -> 0.01], 
           Association[
           "startPos" -> $CellContext`shadingPt0, 
            "dirVec" -> $CellContext`viewDir0, 
            "length" -> $CellContext`viewDist0, "colorFunc" -> (LightGray& ), 
            "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt1, 
            "dirVec" -> $CellContext`viewDir1, 
            "length" -> $CellContext`viewDist1, "colorFunc" -> (LightGray& ), 
            "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt0, 
            "dirVec" -> $CellContext`lightDir, "length" -> 1, 
            "colorFunc" -> (Green& ), "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt1, 
            "dirVec" -> $CellContext`lightDir, "length" -> 1, 
            "colorFunc" -> (Green& ), "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt0, 
            "dirVec" -> $CellContext`halfDir0, "length" -> 1, 
            "colorFunc" -> (Blue& ), "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt1, 
            "dirVec" -> $CellContext`halfDir1, "length" -> 1, 
            "colorFunc" -> (Red& ), "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt1, 
            "dirVec" -> $CellContext`diskNormalAxis, "length" -> 1, 
            "colorFunc" -> (Gray& ), "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt1 + $CellContext`halfDir1 1, 
            "dirVec" -> -$CellContext`diskNormalAxis, "length" -> 1, 
            "colorFunc" -> (Orange& ), "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt1, "dirVec" -> 
            Normalize[$CellContext`halfEdgePtProj - $CellContext`shadingPt1], 
            "length" -> 
            Norm[$CellContext`halfEdgePtProj - $CellContext`shadingPt1], 
            "colorFunc" -> (Orange& ), "thickness" -> 0.005]}& )[], 
         "customPlots" -> {
           Graphics3D[{Magenta, 
             PointSize[0.02], 
             Point[$CellContext`viewPoint]}], 
           Graphics3D[{Red, 
             PointSize[0.02], 
             Point[$CellContext`shadingPt1]}], 
           Graphics3D[{Gray, 
             PointSize[0.02], 
             Point[$CellContext`halfEdgePtProj]}], 
           Graphics3D[{
             Text[
              Style[
              "l", 18], $CellContext`shadingPt1 + $CellContext`lightDir 
               1.05]}], 
           Graphics3D[{
             Text[
              Style[
              "h", 18], $CellContext`shadingPt1 + $CellContext`halfDir1 
               1.05]}], 
           Graphics3D[{
             Text[
              Style[
              "n", 18], $CellContext`shadingPt1 + $CellContext`diskNormalAxis 
               1.05]}], 
           Graphics3D[{
             Text[
              Style[
              "\[Theta]1", 
               16], $CellContext`shadingPt0 + $CellContext`theta1Axis 0.3]}], 
           Graphics3D[{
             Text[
              Style[
              "\[Theta]2", 
               16], $CellContext`shadingPt1 + $CellContext`theta2Axis 0.3]}], 
           Graphics3D[{
             Text[
              Style[
              "\[Theta]3", 
               16], $CellContext`shadingPt1 + $CellContext`theta3Axis 0.5]}]},
          "axisExtent" -> 2], Large], 
      "Specifications" :> {{{$CellContext`diskNormalY$$, -1}, -10, 
         1}, {{$CellContext`shadingPt1Offset$$, 1.5}, 0.01, 
         2}, {{$CellContext`thetas$$, {$CellContext`theta3, \
$CellContext`approxTheta3, $CellContext`theta4, $CellContext`theta5, \
$CellContext`lerpFactor}}}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{636., {368., 374.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8354114412669992`*^9, {3.835413380201338*^9, 3.8354133876795187`*^9}},
 CellLabel->
  "Out[130]=",ExpressionUUID->"a39909e0-1897-461b-9c28-d0faf1f0e2f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "\[Theta]H2", ",", "\[Theta]L", ",", "\[Theta]", ",", "k", ",", "m"}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"approxTheta3", "=", 
     RowBox[{"theta4", "+", 
      RowBox[{
       RowBox[{"ArcCot", "[", 
        FractionBox[
         RowBox[{"Sin", "[", 
          RowBox[{"2", "*", "theta1"}], "]"}], "shadingPt1Offset"], "]"}], 
       "*", 
       RowBox[{"Sin", "[", 
        RowBox[{"theta1", "/", "2"}], "]"}]}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]H2", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"ArcTan", "[", "k", "]"}], "2"], "+", 
     RowBox[{
      RowBox[{"ArcCot", "[", 
       FractionBox[
        RowBox[{"Sin", "[", 
         RowBox[{"2", "*", "\[Theta]L"}], "]"}], "k"], "]"}], "*", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]L", "/", "2"}], "]"}]}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"k", "\[Rule]", 
      RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<\[Theta]H2\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", "\[Theta]H2", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<GGX Attenuation\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"gDGGX", "[", 
      RowBox[{"m", ",", 
       RowBox[{"Cos", "[", "\[Theta]H2", "]"}]}], "]"}], 
     RowBox[{"gDGGX", "[", 
      RowBox[{"m", ",", "1"}], "]"}]], ",", 
    RowBox[{
     RowBox[{"0", "<", "\[Theta]", "<", 
      RowBox[{"\[Pi]", "/", "2"}]}], "&&", 
     RowBox[{"0", "<", "\[Theta]L", "<", 
      RowBox[{"\[Pi]", "/", "2"}]}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "\[Theta]H2", ",", "\[Theta]L", ",", "\[Theta]", ",", "k", ",", "m"}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.835411498948516*^9, 3.8354115240447645`*^9}, {
  3.8354115683159957`*^9, 3.8354117167753305`*^9}, {3.8354132454616365`*^9, 
  3.835413342752759*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"38fcfcd0-437c-4913-8afd-2ab46971bcdd"],

Cell[BoxData[
 StyleBox["\<\" \[Theta]H2\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8354116706798744`*^9, 3.8354117057685285`*^9, {3.8354132602382593`*^9, 
   3.8354133431464186`*^9}},
 CellLabel->
  "During evaluation of \
In[101]:=",ExpressionUUID->"124b97d6-3c06-47fb-b25b-f8df6b421293"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"ArcTan", "[", 
    RowBox[{"Tan", "[", "\[Theta]", "]"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"ArcCot", "[", 
    RowBox[{
     RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Theta]L"}], "]"}]}], "]"}], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Theta]L", "2"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.835411653434349*^9, 3.835411670682866*^9}, 
   3.8354117057715197`*^9, {3.835413260248233*^9, 3.835413343158714*^9}},
 CellLabel->
  "Out[104]=",ExpressionUUID->"8799ffec-e83f-4711-b4e0-4fb36bd8508d"],

Cell[BoxData[
 StyleBox["\<\" GGX Attenuation\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8354116706798744`*^9, 3.8354117057685285`*^9, {3.8354132602382593`*^9, 
   3.835413343159979*^9}},
 CellLabel->
  "During evaluation of \
In[101]:=",ExpressionUUID->"285203b4-0073-41f2-8fad-ff9aff844b36"],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", 
   SuperscriptBox["m", "4"]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["m", "2"], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["m", "2"]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "+", 
        RowBox[{"2", " ", 
         RowBox[{"ArcCot", "[", 
          RowBox[{
           RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Theta]L"}], "]"}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Theta]L", "2"], "]"}]}]}], "]"}]}]}], ")"}], 
   "2"]]], "Output",
 CellChangeTimes->{{3.835411653434349*^9, 3.835411670682866*^9}, 
   3.8354117057715197`*^9, {3.835413260248233*^9, 3.8354133431620064`*^9}},
 CellLabel->
  "Out[106]=",ExpressionUUID->"7715580e-6961-4055-8a88-ad7dfe05d800"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<GGX Attenuation\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"{", 
      FractionBox[
       RowBox[{"4", " ", 
        SuperscriptBox["m", "4"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["m", "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["m", "2"]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]", "+", 
             RowBox[{"2", " ", 
              RowBox[{"ArcCot", "[", 
               RowBox[{
                RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "\[Theta]L"}], "]"}]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               FractionBox["\[Theta]L", "2"], "]"}]}]}], "]"}]}]}], ")"}], 
        "2"]], "\[IndentingNewLine]", "\t", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "0.5"}], "}"}], ",", "0.01", ",", "0.99"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]L", ",", "1"}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8354117293748894`*^9, 3.8354117457479153`*^9}, 
   3.835413348584405*^9},
 CellLabel->
  "In[108]:=",ExpressionUUID->"d6562151-d7b4-436a-b26a-16586e43b313"],

Cell[BoxData[
 StyleBox["\<\" GGX Attenuation\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.835411754531063*^9, 3.835413349464802*^9},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"1c870b78-5785-49f3-afee-d78d4a20596c"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`m$$ = 0.5, $CellContext`\[Theta]L$$ = 1, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`m$$], 0.5}, 0.01, 0.99}, {{
       Hold[$CellContext`\[Theta]L$$], 1}, 0, Rational[1, 2] Pi}}, 
    Typeset`size$$ = {360., {114., 120.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`m$759652$$ = 0, $CellContext`\[Theta]L$759653$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`m$$ = 0.5, $CellContext`\[Theta]L$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`m$$, $CellContext`m$759652$$, 0], 
        Hold[$CellContext`\[Theta]L$$, $CellContext`\[Theta]L$759653$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Plot[{4 $CellContext`m$$^4/(
          1 + $CellContext`m$$^2 + (-1 + $CellContext`m$$^2) 
           Cos[$CellContext`\[Theta] + 
             2 ArcCot[
               Cot[$CellContext`\[Theta]] Sin[2 $CellContext`\[Theta]L$$]] 
              Sin[$CellContext`\[Theta]L$$/2]])^2}, {$CellContext`\[Theta], 0,
          Pi/2}, PlotRange -> {{0, Pi/2}, {0, 1}}], 
      "Specifications" :> {{{$CellContext`m$$, 0.5}, 0.01, 
         0.99}, {{$CellContext`\[Theta]L$$, 1}, 0, Rational[1, 2] Pi}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{411., {175., 181.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.835411754572288*^9, 3.8354133495154023`*^9},
 CellLabel->
  "Out[109]=",ExpressionUUID->"79416dcb-430f-480d-b88c-475a99fb2a05"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "asg1", ",", "\[Theta]", ",", "\[Lambda]", ",", "\[Mu]", ",", "m"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<ASG Energy along axis\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"asg1", "=", 
  RowBox[{"asgPolar", "[", 
   RowBox[{"\[Theta]", ",", 
    RowBox[{
     RowBox[{"\[Pi]", "/", "2"}], "-", "\[Theta]"}], ",", 
    RowBox[{"\[Pi]", "/", "2"}], ",", "\[Lambda]", ",", "\[Mu]", ",", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[Lambda]"}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]], " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", "\[Theta]1"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.835411827340474*^9, 3.8354118834603043`*^9}, {
  3.8354119199324446`*^9, 3.835411921547682*^9}, {3.83541196594131*^9, 
  3.8354119764753046`*^9}, {3.8354120393009486`*^9, 3.835412076068906*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"b608543c-e7ea-4be7-a67e-bc3a6989808f"],

Cell[BoxData[
 StyleBox["\<\" ASG Energy along axis\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8354118185547976`*^9, {3.835411961120499*^9, 3.8354119774828634`*^9}, {
   3.835412046696644*^9, 3.8354120766294117`*^9}},
 CellLabel->
  "During evaluation of \
In[55]:=",ExpressionUUID->"dd8ab3c1-b7c6-43ee-b601-f33e52d9ddf8"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "\[Lambda]"}], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]], " ", 
  RowBox[{"Cos", "[", "\[Theta]", "]"}]}]], "Output",
 CellChangeTimes->{
  3.835411818559022*^9, {3.8354119611255417`*^9, 3.8354119774888473`*^9}, {
   3.8354120467016315`*^9, 3.835412076640383*^9}},
 CellLabel->"Out[57]=",ExpressionUUID->"8f9d10aa-bf11-48b5-b61a-e2627c146f61"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox["\[Pi]"], " ", 
   RowBox[{"Erf", "[", 
    RowBox[{
     SqrtBox["\[Lambda]"], " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "]"}]}], 
  RowBox[{"2", " ", 
   SqrtBox["\[Lambda]"]}]]], "Output",
 CellChangeTimes->{
  3.835411818559022*^9, {3.8354119611255417`*^9, 3.8354119774888473`*^9}, {
   3.8354120467016315`*^9, 3.835412076662964*^9}},
 CellLabel->"Out[58]=",ExpressionUUID->"5d24ca05-ceae-449b-9d84-5b5137774351"]
}, Open  ]]
},
WindowSize->{1082, 812},
WindowMargins->{{Automatic, 320}, {-56, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 25899, 557, 2497, "Input",ExpressionUUID->"61af0d58-2f26-4f9c-a4a1-9e561e9e1b28"],
Cell[26482, 581, 391, 10, 30, "Print",ExpressionUUID->"83de5b90-c42b-4446-898c-0023fe112f5e"],
Cell[26876, 593, 9954, 215, 761, "Output",ExpressionUUID->"a39909e0-1897-461b-9c28-d0faf1f0e2f5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36867, 813, 2256, 67, 234, "Input",ExpressionUUID->"38fcfcd0-437c-4913-8afd-2ab46971bcdd"],
Cell[39126, 882, 366, 10, 30, "Print",ExpressionUUID->"124b97d6-3c06-47fb-b25b-f8df6b421293"],
Cell[39495, 894, 643, 17, 49, "Output",ExpressionUUID->"8799ffec-e83f-4711-b4e0-4fb36bd8508d"],
Cell[40141, 913, 369, 10, 30, "Print",ExpressionUUID->"285203b4-0073-41f2-8fad-ff9aff844b36"],
Cell[40513, 925, 949, 27, 63, "Output",ExpressionUUID->"7715580e-6961-4055-8a88-ad7dfe05d800"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41499, 957, 2019, 58, 188, "Input",ExpressionUUID->"d6562151-d7b4-436a-b26a-16586e43b313"],
Cell[43521, 1017, 310, 8, 30, "Print",ExpressionUUID->"1c870b78-5785-49f3-afee-d78d4a20596c"],
Cell[43834, 1027, 2353, 46, 375, "Output",ExpressionUUID->"79416dcb-430f-480d-b88c-475a99fb2a05"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46224, 1078, 1337, 33, 155, "Input",ExpressionUUID->"b608543c-e7ea-4be7-a67e-bc3a6989808f"],
Cell[47564, 1113, 398, 10, 30, "Print",ExpressionUUID->"dd8ab3c1-b7c6-43ee-b601-f33e52d9ddf8"],
Cell[47965, 1125, 469, 11, 37, "Output",ExpressionUUID->"8f9d10aa-bf11-48b5-b61a-e2627c146f61"],
Cell[48437, 1138, 478, 13, 61, "Output",ExpressionUUID->"5d24ca05-ceae-449b-9d84-5b5137774351"]
}, Open  ]]
}
]
*)

