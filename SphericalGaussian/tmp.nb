(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    100956,       2145]
NotebookOptionsPosition[     99232,       2106]
NotebookOutlinePosition[     99728,       2124]
CellTagsIndexPosition[     99685,       2121]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"CellContext", "\[Rule]", "Notebook"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "testDisk", ",", "testSphere", ",", "diskNormalAxis", ",", 
     "\[IndentingNewLine]", "  ", "diskTangent", ",", "diskBiTangent", ",", 
     "diskTangentZ", ",", "diskBiTangentZ", ",", "\[IndentingNewLine]", "   ",
      "majorAxis", ",", "majorX", ",", "majorY", ",", "minorAxis", ",", 
     "minorX", ",", "minorY", ",", "majorSize", ",", "minorSize", ",", 
     "\[IndentingNewLine]", "  ", "sphereShadingFunc", ",", "viewDist0Proj", 
     ",", "\[IndentingNewLine]", "  ", "theta0", ",", "arc0Center", ",", 
     "arc0Radius", ",", "arc0Normal", ",", "arc0Axis", ",", "arc0ThetaSpan", 
     ",", "\[IndentingNewLine]", "  ", "theta1", ",", "arc1Center", ",", 
     "arc1Radius", ",", "arc1Normal", ",", "arc1Axis", ",", "arc1ThetaSpan", 
     ",", "\[IndentingNewLine]", "  ", "shadingPt1", ",", "lightDir", ",", 
     "helperPt1", ",", "\[IndentingNewLine]", "  ", "viewDir0", ",", 
     "viewDist0", ",", "halfDir0", ",", "viewDir1", ",", "viewDist1", ",", 
     "halfDir1", ",", "\[IndentingNewLine]", "  ", "halfTheta0", ",", 
     "arc2Center", ",", "arc2Radius", ",", "arc2Normal", ",", "arc2Axis", ",",
      "arc2ThetaSpan", ",", "\[IndentingNewLine]", "  ", "halfTheta1", ",", 
     "arc3Center", ",", "arc3Radius", ",", "arc3Normal", ",", "arc3Axis", ",",
      "arc3ThetaSpan", ",", "\[IndentingNewLine]", "  ", "NoL", ",", "t2", 
     ",", "t1", ",", "p2", ",", "p1", ",", "ld", ",", "dx", ",", "detH"}], 
    "\[IndentingNewLine]", "  ", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", "\t ", 
   RowBox[{
    RowBox[{"NoL", ":", " ", 
     RowBox[{"normal", " ", "dot", " ", "light"}]}], ",", 
    "\[IndentingNewLine]", "\t ", 
    RowBox[{"t2", ":", " ", 
     RowBox[{"theta2", "\[IndentingNewLine]", "   ", "t1"}], ":", " ", 
     RowBox[{"theta1", "\[IndentingNewLine]", "   ", 
      RowBox[{"h2", ":", " ", 
       RowBox[{"half", " ", "theta2", "\[IndentingNewLine]", " ", "h1"}], ":",
        " ", 
       RowBox[{"half", " ", "theta1", "\[IndentingNewLine]", " ", 
        RowBox[{"p2", ":", " ", "phi2"}]}]}]}]}], ",", "\[IndentingNewLine]", 
    "\t ", 
    RowBox[{"p1", ":", " ", 
     RowBox[{"phi1", "\[IndentingNewLine]", "   ", "vd"}], ":", " ", 
     RowBox[{"view", " ", "distance"}]}], ",", "\[IndentingNewLine]", "\t ", 
    RowBox[{"dx", ":", " ", 
     RowBox[{"delta", " ", "x"}]}]}], " ", "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Tan", "[", "theta0", "]"}], "*", "viewDist0Proj"}], "\[Equal]", 
     RowBox[{
      RowBox[{"Tan", "[", "theta1", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"viewDist0Proj", "+", "shadingOffset"}], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"viewDist0Proj", "=", 
      RowBox[{"viewDist0", "*", 
       RowBox[{"Cos", "[", "theta0", "]"}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t2", "=", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Tan", "[", "t1", "]"}], "*", "vd", "*", 
         RowBox[{"Cos", "[", "t1", "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vd", "*", 
          RowBox[{"Cos", "[", "t1", "]"}]}], "+", "dx"}], ")"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "*", "halfTheta1"}], "+", "theta1"}], "\[Equal]", 
      RowBox[{
       RowBox[{"2", "*", "halfTheta2"}], "+", "theta2"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"halfTheta2", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", "halfTheta1"}], "+", "theta1", "-", "theta2"}], 
         ")"}], "/", "2"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"h2", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "*", "h1"}], "+", "t1", "-", "t2"}], ")"}], "/", "2"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"h2", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ArcCos", "[", "NoL", "]"}], "+", 
        RowBox[{"\[Pi]", "/", "2"}], "-", "t2"}], ")"}], "/", "2"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"h1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ArcCos", "[", "NoL", "]"}], "+", 
        RowBox[{"\[Pi]", "/", "2"}], "-", "t1"}], ")"}], "/", "2"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"p2", "=", "p1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"detH", "=", 
     RowBox[{"Det", "[", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"h2", ",", "p2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "p1"}], "}"}], "}"}]}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"gPrint", "[", 
     RowBox[{"TraditionalForm", "@", 
      RowBox[{"FullSimplify", "@", "detH"}]}], "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"diskNormalAxis", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"{", 
       RowBox[{"diskNormalX", ",", "diskNormalY", ",", 
        RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"testDisk", "=", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"center", " ", "point"}], "*)"}], "\[IndentingNewLine]", "\t",
        "diskNormalAxis", ",", 
       RowBox[{"(*", 
        RowBox[{"normal", " ", "axis"}], "*)"}], "\[IndentingNewLine]", "\t", 
       "diskRadius"}], 
      RowBox[{"(*", 
       RowBox[{"disk", " ", "radius"}], "*)"}], "\[IndentingNewLine]", 
      "}"}]}], ";", "\[IndentingNewLine]", " ", 
    RowBox[{"testSphere", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"solving", " ", "ellipse", " ", "axes"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"majorX", "=", 
     RowBox[{"-", "diskNormalY"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"majorY", "=", "diskNormalX"}], ";", "\[IndentingNewLine]", 
    RowBox[{"majorAxis", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"{", 
       RowBox[{"majorX", ",", "majorY", ",", "0"}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"minorX", "=", "majorY"}], ";", "\[IndentingNewLine]", 
    RowBox[{"minorY", "=", 
     RowBox[{"-", "majorX"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"minorAxis", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"{", 
       RowBox[{"minorX", ",", "minorY", ",", "0"}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"majorSize", "=", "diskRadius"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"solving", " ", "disk", " ", "tangents"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"diskTangentZ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"diskNormalAxis", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"majorAxis", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"majorAxis", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "}"}]}], "]"}], 
          "\[Equal]", "0"}], ",", "z"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"diskTangent", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"majorAxis", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"majorAxis", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "diskTangentZ"}], "}"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"diskBiTangentZ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"diskNormalAxis", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"minorAxis", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"minorAxis", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "}"}]}], "]"}], 
          "\[Equal]", "0"}], ",", "z"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"diskBiTangent", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"minorAxis", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"minorAxis", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "diskBiTangentZ"}], "}"}]}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"viewDir0", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], "-", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"halfDir0", "=", "diskNormalAxis"}], ";", "\[IndentingNewLine]", 
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{"Dot", "[", 
         RowBox[{"viewDir0", ",", "halfDir0"}], "]"}], "*", "halfDir0"}], "-",
        "viewDir0"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"shading", " ", "info"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"shadingPt1", "=", 
     RowBox[{
      RowBox[{"testDisk", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{"diskBiTangent", "*", "shadingOffset"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"viewDir1", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], "-", "shadingPt1"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"viewDist0", "=", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], "-", 
       RowBox[{"testDisk", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"viewDist1", "=", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], "-", "shadingPt1"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"halfDir1", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lightDir", "+", "viewDir1"}], ")"}], "/", "2"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"helperPt1", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], "-", 
      RowBox[{"diskNormalAxis", "*", "viewDist0", "*", 
       RowBox[{"Dot", "[", 
        RowBox[{"diskNormalAxis", ",", "viewDir0"}], "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"theta0", "=", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "2"}], "-", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"Dot", "[", 
        RowBox[{"diskNormalAxis", ",", "viewDir0"}], "]"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"arc0", " ", "for", " ", "theta0"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"arc0Center", "=", 
     RowBox[{"testDisk", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"arc0Radius", "=", "0.1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"arc0Normal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"diskNormalAxis", ",", "viewDir0"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"arc0Axis", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"viewDir0", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "*", "diskBiTangent"}], ")"}]}], ")"}], "/", 
      "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"arc0ThetaSpan", "=", "theta0"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"viewDist0Proj", "=", 
     RowBox[{"viewDist0", "*", 
      RowBox[{"Cos", "[", "theta0", "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"Tan", "[", "theta0", "]"}], "*", "viewDist0Proj"}], 
      "\[Equal]", 
      RowBox[{
       RowBox[{"Tan", "[", "theta1", "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"viewDist0Proj", "+", "shadingOffset"}], ")"}]}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"theta1", "=", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Tan", "[", "theta0", "]"}], "*", "viewDist0Proj"}], ")"}], 
       "/", 
       RowBox[{"(", 
        RowBox[{"viewDist0Proj", "+", "shadingOffset"}], ")"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "*", "halfTheta0"}], "+", "theta0"}], "\[Equal]", 
      RowBox[{
       RowBox[{"2", "*", "halfTheta1"}], "+", "theta1"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"halfTheta1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "*", "halfTheta0"}], "+", "theta0", "-", "theta1"}], 
       ")"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"arc1", " ", "for", " ", "theta1"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"arc1Center", "=", "shadingPt1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"arc1Radius", "=", "0.1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"arc1Normal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"diskNormalAxis", ",", "viewDir1"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"arc1Axis", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"viewDir1", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "*", "diskBiTangent"}], ")"}]}], ")"}], "/", 
      "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"arc1ThetaSpan", "=", "theta1"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"arc2", " ", "for", " ", "halfTheta0"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"arc2Center", "=", 
       RowBox[{"testDisk", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"arc2Radius", "=", "0.1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"arc2Normal", "=", "arc0Normal"}], ";", "\[IndentingNewLine]", 
      RowBox[{"arc2Axis", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"halfDir0", "+", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "*", "diskBiTangent"}], ")"}]}], ")"}], "/", 
        "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"arc2ThetaSpan", "=", "theta0"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "solve", " ", "left", " ", "minor", " ", "size", " ", "of", " ", 
      "ellipse"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "/", 
        RowBox[{"(", 
         RowBox[{"diskRadius", "*", 
          RowBox[{"Cos", "[", "theta0", "]"}]}], ")"}]}], "\[Equal]", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"diskRadius", "*", 
           RowBox[{"Sin", "[", "theta0", "]"}]}]}], ")"}]}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"minorSize", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"diskRadius", "*", 
        RowBox[{"Cos", "[", "theta0", "]"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"diskRadius", "*", 
         RowBox[{"Sin", "[", "theta0", "]"}]}]}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"maxLeftThetaD", "=", 
     RowBox[{"ArcTan", "[", 
      RowBox[{"minorSize", "/", "1"}], 
      RowBox[{"(*", "sphereRadius", "*)"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"shading", " ", "function", " ", "on", " ", "disk"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"sphereShadingFunc", ":=", 
     RowBox[{"Block", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "spherePt", ",", "diskPt", ",", "tmpRayDir", ",", "tmpDiff", ",", 
         "tmpProd1", ",", "tmpProd2", ",", "tmpProd3", ",", "intsPt", ",", 
         "\[IndentingNewLine]", "\t", "sglight", ",", "refLightDir", ",", 
         "refViewDir", ",", "\[IndentingNewLine]", "\t", "refNormal", ",", 
         "sgndf", ",", "diskLighting1", ",", "finalLighting"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"spherePt", "=", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"hemi", "-", 
          RowBox[{"sphere", " ", "only"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"z", "<", "0"}], ",", 
          RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "find", " ", "related", " ", "point", " ", "on", " ", "disk"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"https", ":"}], "//", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"www", ".", "rosettacode", ".", "org"}], "/", "wiki"}], 
            "/", "Find_the"}], "_intersection", "_of", "_a", "_line", "_with",
            "_a", "_plane", "#C", ".2", "B", ".2", "B"}]}], "*)"}], "\n", 
        "       ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"c", "++"}], " ", "code", " ", "example"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"tmpRayDir", "=", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tmpRayDir", "=", 
         RowBox[{"Normalize", "@", "spherePt"}]}], ";", "\[IndentingNewLine]",
         " ", 
        RowBox[{"tmpDiff", "=", 
         RowBox[{"spherePt", "-", 
          RowBox[{"testDisk", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\n", "        ", 
        RowBox[{"tmpProd1", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{"tmpDiff", ",", "diskNormalAxis"}], "]"}]}], ";", "\n", 
        "        ", 
        RowBox[{"tmpProd2", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{"tmpRayDir", ",", "diskNormalAxis"}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"tmpProd3", "=", 
         RowBox[{"tmpProd1", "/", "tmpProd2"}]}], ";", "\n", "\t ", 
        RowBox[{"intsPt", "=", 
         RowBox[{"spherePt", "-", 
          RowBox[{"tmpRayDir", "*", "tmpProd3"}]}]}], ";", 
        "\[IndentingNewLine]", "  ", 
        RowBox[{"diskPt", "=", "intsPt"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{"intsPt", "-", 
             RowBox[{"testDisk", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ">", "diskRadius"}], 
          ",", 
          RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"calculate", " ", "shading", " ", "on", " ", "disk"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"sglight", "=", 
         RowBox[{"sgDirLight", "[", 
          RowBox[{"lightDir", ",", "lightIntensity", ",", "lightLambda"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"refLightDir", "=", "lightDir"}], ";", "\[IndentingNewLine]", 
        RowBox[{"refViewDir", "=", 
         RowBox[{"Normalize", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], "-", "diskPt"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"refNormal", "=", "diskNormalAxis"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sgndf", "=", 
         RowBox[{"sgNDF", "[", 
          RowBox[{
          "roughness", ",", "refLightDir", ",", "refViewDir", ",", 
           "refNormal"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"diskLighting1", "=", 
         RowBox[{"sgDot", "[", 
          RowBox[{"sglight", ",", "sgndf"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"finalLighting", "=", 
         RowBox[{"diskLighting1", "*", "shadingColorScaling"}]}], ";", 
        "\[IndentingNewLine]", "finalLighting"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"<|", "\[IndentingNewLine]", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\"\<spheres\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", "  ", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "sphere"}], "*)"}], 
            "\[IndentingNewLine]", "   ", 
            RowBox[{
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", 
                RowBox[{"testSphere", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", 
                RowBox[{"testSphere", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.1"}], ",", 
               RowBox[{"\"\<plotPts\>\"", "\[Rule]", "30"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                  "LightBlue"}], 
                 RowBox[{"(*", "sphereShadingFunc", " ", "*)"}], "]"}]}]}], 
              "|>"}], ",", "\[IndentingNewLine]", "  ", 
             RowBox[{"(*", 
              RowBox[{"helper", " ", "points"}], "*)"}], 
             "\[IndentingNewLine]", "   ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "shadingPt1"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
               RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}], ",", 
             "\[IndentingNewLine]", "   ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "helperPt1"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
               RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Gray", "]"}]}]}], "|>"}]}], 
            "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
        "\[IndentingNewLine]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<lines\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", " ", 
            RowBox[{"(*", 
             RowBox[{"ellipse", " ", "major", " ", "axis"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", "   ", 
             RowBox[{
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
                RowBox[{"\"\<dirVec\>\"", "\[Rule]", "majorAxis"}], ",", 
                RowBox[{"\"\<length\>\"", "\[Rule]", "majorSize"}], ",", 
                RowBox[{"\"\<plotPts\>\"", "\[Rule]", "2"}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                 RowBox[{"Function", "[", "Green", "]"}]}], ",", 
                RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
              ","}], "*)"}], "\[IndentingNewLine]", " ", 
            RowBox[{"(*", 
             RowBox[{"disk", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", "   ", 
             RowBox[{
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                 RowBox[{"testDisk", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"\"\<dirVec\>\"", "\[Rule]", "diskTangent"}], ",", 
                RowBox[{"\"\<length\>\"", "\[Rule]", "#diskRadius"}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                 RowBox[{"Function", "[", "Green", "]"}]}], ",", 
                RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
              ","}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", "   ", 
             RowBox[{
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                 RowBox[{"testDisk", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"\"\<dirVec\>\"", "\[Rule]", "diskBiTangent"}], ",", 
                RowBox[{"\"\<length\>\"", "\[Rule]", "#diskRadius"}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                 RowBox[{"Function", "[", "Green", "]"}]}], ",", 
                RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
              ","}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"disk", " ", "normal"}], "*)"}], "\[IndentingNewLine]", 
            "   ", 
            RowBox[{
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"testDisk", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "diskNormalAxis"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Green", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", " ", 
             RowBox[{"(*", 
              RowBox[{"view", " ", "dir"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"-", "viewDir0"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", 
                RowBox[{"viewDist0", "+", "0.2"}]}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"-", "viewDir1"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", 
                RowBox[{"viewDist1", "+", "0.2"}]}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Red", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", "  ", 
             RowBox[{"(*", 
              RowBox[{"helper", " ", "lines"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"Normalize", "[", 
                 RowBox[{"helperPt1", "-", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", 
                RowBox[{"Norm", "[", 
                 RowBox[{"helperPt1", "-", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Gray", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"testDisk", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"-", "diskBiTangent"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "viewDist0Proj"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"testDisk", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "diskBiTangent"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", 
                RowBox[{"(", "#shadingOffset", ")"}]}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Red", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"testDisk", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "halfDir0"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "0.2"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Gray", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt1"}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "halfDir1"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "0.2"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Gray", "]"}]}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}]}], 
            "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<diskRadius\>\"", "\[Rule]", "diskRadius"}], ",", 
           RowBox[{"\"\<shadingOffset\>\"", "\[Rule]", "shadingOffset"}]}], 
          "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<disks\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"testDisk", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"\"\<normalAxis\>\"", "\[Rule]", 
               RowBox[{"testDisk", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", 
               RowBox[{"testDisk", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "0"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                 "Cyan"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", " ", 
            "}"}]}], "&"}], "[", "]"}], ",", "\[IndentingNewLine]", "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<arcs\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", "   ", 
            RowBox[{
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "arc0Center"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "arc0Radius"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<normalDir\>\"", "\[Rule]", "arc0Normal"}], ",", 
               RowBox[{"\"\<axisDir\>\"", "\[Rule]", 
                RowBox[{"-", "arc0Axis"}]}], ",", 
               RowBox[{"\"\<thetaSpan\>\"", "\[Rule]", "arc0ThetaSpan"}], ",",
                "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                  "Blue"}], "]"}]}]}], "|>"}], ",", "\[IndentingNewLine]", 
             "  ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "arc1Center"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "arc1Radius"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<normalDir\>\"", "\[Rule]", "arc1Normal"}], ",", 
               RowBox[{"\"\<axisDir\>\"", "\[Rule]", 
                RowBox[{"-", "arc1Axis"}]}], ",", 
               RowBox[{"\"\<thetaSpan\>\"", "\[Rule]", "arc1ThetaSpan"}], ",",
                "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                  "Red"}], "]"}]}]}], "|>"}]}], "\[IndentingNewLine]", "  ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<center\>\"", "\[Rule]", "arc2Center"}], ",", 
                RowBox[{"\"\<radius\>\"", "\[Rule]", "arc2Radius"}], ",", 
                RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<normalDir\>\"", "\[Rule]", "arc2Normal"}], ",", 
                RowBox[{"\"\<axisDir\>\"", "\[Rule]", "arc2Axis"}], ",", 
                RowBox[{"\"\<thetaSpan\>\"", "\[Rule]", "arc2ThetaSpan"}], 
                ",", "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
                RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                   "Blue"}], "]"}]}]}], "|>"}], ",", "\[IndentingNewLine]", 
              "   ", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<center\>\"", "\[Rule]", "arc3Center"}], ",", 
                RowBox[{"\"\<radius\>\"", "\[Rule]", "arc3Radius"}], ",", 
                RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<normalDir\>\"", "\[Rule]", "arc3Normal"}], ",", 
                RowBox[{"\"\<axisDir\>\"", "\[Rule]", "arc3Axis"}], ",", 
                RowBox[{"\"\<thetaSpan\>\"", "\[Rule]", "arc3ThetaSpan"}], 
                ",", "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
                RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                   "Green"}], "]"}]}]}], "|>"}]}], "*)"}], 
            "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
        "\[IndentingNewLine]", "    ", 
        RowBox[{"\"\<customPlots\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"directional", " ", "light"}], "*)"}], 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"testDisk", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "+", 
                  RowBox[{"lightDir", "*", "2"}]}], ",", 
                 RowBox[{
                  RowBox[{"testDisk", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "+", "lightDir"}]}], "}"}],
                "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", 
            RowBox[{"label", " ", "of", " ", "arc0"}], "*)"}], 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(0\)]\)\>\"", ",", 
                 "18"}], "]"}], ",", 
               RowBox[{"arc0Center", "-", 
                RowBox[{"arc0Axis", "*", 
                 RowBox[{"(", 
                  RowBox[{"arc0Radius", "+", "0.1"}], ")"}]}]}]}], "]"}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "         ", 
           RowBox[{"(*", 
            RowBox[{"label", " ", "of", " ", "arc1"}], "*)"}], 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(1\)]\)\>\"", ",", 
                 "18"}], "]"}], ",", 
               RowBox[{"arc1Center", "-", 
                RowBox[{"arc1Axis", "*", 
                 RowBox[{"(", 
                  RowBox[{"arc1Radius", "+", "0.1"}], ")"}]}]}]}], "]"}], 
             "}"}], "]"}]}], "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"(*", 
            RowBox[{"label", " ", "of", " ", "arc2"}], "*)"}], 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"Graphics3D", "[", 
             RowBox[{"{", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<\[Theta]21\>\"", ",", "18"}], "]"}], ",", 
                RowBox[{"arc2Center", "+", 
                 RowBox[{"arc2Axis", "*", 
                  RowBox[{"(", 
                   RowBox[{"arc2Radius", "+", "0.15"}], ")"}]}]}]}], "]"}], 
              "}"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{"{", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<\[Theta]22\>\"", ",", "18"}], "]"}], ",", 
                RowBox[{"arc3Center", "+", 
                 RowBox[{"arc3Axis", "*", 
                  RowBox[{"(", 
                   RowBox[{"arc3Radius", "+", "0.15"}], ")"}]}]}]}], "]"}], 
              "}"}], "]"}]}], "*)"}], "\[IndentingNewLine]", " ", "}"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "  ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\"\<projDisks\>\"", "\[Rule]", 
             RowBox[{"{", "\[IndentingNewLine]", "   ", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<disk\>\"", "\[Rule]", "#testDisk"}], ",", 
                RowBox[{"\"\<sphCenter\>\"", "\[Rule]", 
                 RowBox[{"testSphere", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"\"\<sphRadius\>\"", "\[Rule]", 
                 RowBox[{"testSphere", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
                RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}], ",", 
                RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                   "LightBlue"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", 
              " ", "}"}]}], "&"}], "[", 
           RowBox[{"<|", 
            RowBox[{"\"\<testDisk\>\"", "\[Rule]", "testDisk"}], "|>"}], 
           "]"}], ","}], "*)"}], "\[IndentingNewLine]", "     ", 
        RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.6"}], ",", 
        "\[IndentingNewLine]", "     ", 
        RowBox[{"\"\<viewPoint\>\"", "\[Rule]", "Front"}]}], 
       "\[IndentingNewLine]", "|>"}], ",", "Large"}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "0.1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightLambda", ",", "5"}], "}"}], ",", "sgMinLambda", ",", 
     "50"}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalX", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "0.1"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalY", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "3"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskRadius", ",", "0.5"}], "}"}], ",", "0.2", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.1"}], "}"}], ",", "0.01", ",", "0.99"}], 
    "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingColorScaling", ",", "0.3"}], "}"}], ",", "0.1", ",", 
     "1"}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingOffset", ",", "0.3"}], "}"}], ",", "0", ",", 
     "diskRadius"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "testDisk", ",", "testSphere", ",", "diskNormalAxis", ",", "roughness", 
    ",", "lightCenter", ",", "\[IndentingNewLine]", "  ", "diskTangent", ",", 
    "diskBiTangent", ",", "diskTangentZ", ",", "diskBiTangentZ", ",", 
    "\[IndentingNewLine]", "   ", "majorAxis", ",", "majorX", ",", "majorY", 
    ",", "minorAxis", ",", "minorX", ",", "minorY", ",", "majorSize", ",", 
    "minorSize", ",", "\[IndentingNewLine]", "  ", "peakDiskPt", ",", 
    "peakSpherePt", ",", "tmpSquareZ", ",", "sphereShadingFunc", ",", 
    "\[IndentingNewLine]", "  ", "theta0", ",", "arc0Center", ",", 
    "arc0Radius", ",", "arc0Normal", ",", "arc0Axis", ",", "arc0ThetaSpan", 
    ",", "\[IndentingNewLine]", "  ", "arc1Center", ",", "arc1Radius", ",", 
    "arc1Normal", ",", "arc1Axis", ",", "arc1ThetaSpan", ",", 
    "\[IndentingNewLine]", "  ", "shadingPt1", ",", "viewDir", ",", 
    "lightDist0", ",", "lightDist0Proj", ",", "\[IndentingNewLine]", "  ", 
    "theta21", ",", "arc2Center", ",", "arc2Radius", ",", "arc2Normal", ",", 
    "arc2Axis", ",", "arc2ThetaSpan", ",", "\[IndentingNewLine]", "  ", 
    "arc3Center", ",", "arc3Radius", ",", "arc3Normal", ",", "arc3Axis", ",", 
    "arc3ThetaSpan", ",", "\[IndentingNewLine]", "  ", "helperPt1", ",", 
    "\[IndentingNewLine]", "  ", "t2", ",", "t1", ",", "p2", ",", "p1", ",", 
    "ld", ",", "dx", ",", "detH"}], "\[IndentingNewLine]", "  ", "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8328889412895775`*^9, 3.832888943829444*^9}, 
   3.8329105814363804`*^9, 3.832911658214327*^9, {3.832915422319006*^9, 
   3.832915429550082*^9}, {3.8329154722806787`*^9, 3.832915476772599*^9}, {
   3.832915570542097*^9, 3.8329156282965984`*^9}, {3.832915661051976*^9, 
   3.832915761196766*^9}, {3.832915854105765*^9, 3.8329158545000343`*^9}, 
   3.8329159284747925`*^9, {3.832916038039627*^9, 3.8329160794187365`*^9}, {
   3.8329163010990877`*^9, 3.832916338590598*^9}, {3.8329259282106915`*^9, 
   3.8329260088439074`*^9}, 3.832972206505047*^9, {3.832972578645569*^9, 
   3.8329726211552844`*^9}, {3.832972657934229*^9, 3.832972679476902*^9}, {
   3.8329736515768385`*^9, 3.8329737181620116`*^9}, 3.8329741272349186`*^9, {
   3.8329748391562*^9, 3.8329749519685273`*^9}, {3.832975049742714*^9, 
   3.832975244861807*^9}, {3.832975309946328*^9, 3.83297533243433*^9}, 
   3.8329756992236834`*^9, {3.832976036868046*^9, 3.8329761084378605`*^9}, {
   3.832976280222788*^9, 3.832976289341758*^9}, 3.832976363090472*^9, {
   3.8329765164379635`*^9, 3.832976669459014*^9}, {3.8329767064390707`*^9, 
   3.8329767102798*^9}, {3.832976768979664*^9, 3.8329767693452764`*^9}, {
   3.8329862161456156`*^9, 3.8329862746932898`*^9}, 3.832986319260833*^9, {
   3.8329866236605783`*^9, 3.8329866940199547`*^9}, {3.8329867396457815`*^9, 
   3.8329867817967525`*^9}, {3.8329868429093847`*^9, 3.832986848447735*^9}, {
   3.8329869121904964`*^9, 3.8329869216406126`*^9}, {3.8329869590106916`*^9, 
   3.8329869845563993`*^9}, {3.8329870710350056`*^9, 
   3.8329870868271523`*^9}, {3.832987117777122*^9, 3.8329871304494476`*^9}, {
   3.8329871840840254`*^9, 3.83298719640114*^9}, {3.832987252110629*^9, 
   3.832987297680984*^9}, {3.8329875782121964`*^9, 3.8329876779974585`*^9}, 
   3.8329891108207664`*^9, 3.8329891509603167`*^9, {3.8329893124673257`*^9, 
   3.832989341889273*^9}, {3.832989372343317*^9, 3.832989380094492*^9}, {
   3.832989469023359*^9, 3.8329895116222334`*^9}, 3.832989550475444*^9, {
   3.8329895812925844`*^9, 3.8329896430291557`*^9}, 3.832989710389038*^9, {
   3.832989794380674*^9, 3.832989840515479*^9}, {3.8329900359119043`*^9, 
   3.8329900392269583`*^9}, 3.8329902300451517`*^9, {3.8329902850595045`*^9, 
   3.832990290634919*^9}, {3.832990400692901*^9, 3.8329904167990813`*^9}, {
   3.8329905340857077`*^9, 3.8329905519651194`*^9}, 3.832990814613847*^9, {
   3.8329909286939344`*^9, 3.832990970544267*^9}, {3.8329912138491836`*^9, 
   3.83299127662766*^9}, {3.8329913594125805`*^9, 3.8329913604285154`*^9}, 
   3.832991535927836*^9, {3.832991587536005*^9, 3.8329916363961196`*^9}, {
   3.8329917763022046`*^9, 3.832991806289969*^9}, {3.832992044473613*^9, 
   3.8329920639739323`*^9}, {3.83299238485332*^9, 3.8329923989212475`*^9}, {
   3.83299289699961*^9, 3.8329929313175583`*^9}, {3.832993059234866*^9, 
   3.8329931404701014`*^9}, {3.832993176216199*^9, 3.832993302041716*^9}, {
   3.832993332818115*^9, 3.832993374134757*^9}, {3.832993556022413*^9, 
   3.8329935579497795`*^9}, {3.8329935965431356`*^9, 
   3.8329935967349715`*^9}, {3.8329938447455964`*^9, 
   3.8329938490018787`*^9}, {3.8329941687479954`*^9, 
   3.8329942177993145`*^9}, {3.832994320512024*^9, 3.83299432882345*^9}, {
   3.8329943747957373`*^9, 3.8329944018957214`*^9}, 3.8329946066161766`*^9, {
   3.8329948156526885`*^9, 3.83299486356558*^9}, {3.832994928855524*^9, 
   3.8329949310471373`*^9}, {3.8329954643185854`*^9, 
   3.8329955703042583`*^9}, {3.8329975892542048`*^9, 
   3.8329976034978075`*^9}, {3.832997720467806*^9, 3.8329977384848337`*^9}, {
   3.832997825146538*^9, 3.832997972287462*^9}, {3.832999139865249*^9, 
   3.832999151009587*^9}, {3.832999523891568*^9, 3.832999579518628*^9}, {
   3.8329997835944915`*^9, 3.8329998096426773`*^9}, {3.832999861059485*^9, 
   3.8329998665428133`*^9}, {3.832999901518716*^9, 3.8329999035050645`*^9}, {
   3.832999965715056*^9, 3.8329999659628916`*^9}, {3.833000248057844*^9, 
   3.8330002703796377`*^9}, {3.8330086307851515`*^9, 
   3.8330086314800177`*^9}, {3.8330116721059823`*^9, 3.8330116901242375`*^9}, 
   3.8330118144119864`*^9, {3.833260509242383*^9, 3.833260532726719*^9}, 
   3.83326059542842*^9, {3.833260744584882*^9, 3.8332607482393255`*^9}, 
   3.833266464234175*^9, {3.833266500434166*^9, 3.833266501133353*^9}, {
   3.8332666663139424`*^9, 3.8332666667220216`*^9}, {3.8332668381227427`*^9, 
   3.833266838996587*^9}, {3.833267620110351*^9, 3.8332676335519943`*^9}, {
   3.833267891926862*^9, 3.833267998049799*^9}, {3.833268048415619*^9, 
   3.833268077873011*^9}, 3.83326812847721*^9, 3.833268263343051*^9, {
   3.833268466893989*^9, 3.833268598006301*^9}, 3.8332686541983356`*^9, {
   3.8332688497816586`*^9, 3.833268871481926*^9}, {3.833268946128127*^9, 
   3.8332690067735357`*^9}, {3.833269278421533*^9, 3.833269304804965*^9}, {
   3.833269476819786*^9, 3.8332694788229637`*^9}, {3.8332695686711845`*^9, 
   3.83326962071119*^9}, {3.833269661272939*^9, 3.8332697085595665`*^9}, {
   3.833269745335767*^9, 3.8332697574079065`*^9}, {3.8332698038661723`*^9, 
   3.8332698963780036`*^9}, {3.833270015252054*^9, 3.833270024808095*^9}, {
   3.833270129682167*^9, 3.8332701303034487`*^9}, 3.833270165756631*^9, {
   3.8332701961377115`*^9, 3.833270216166669*^9}, 3.8332702724092484`*^9, {
   3.833272701073426*^9, 3.8332727011113243`*^9}, {3.833317228322328*^9, 
   3.833317244884077*^9}, {3.8333220282889013`*^9, 3.8333220552486157`*^9}, {
   3.833322353677619*^9, 3.8333223785612183`*^9}, {3.833333331815894*^9, 
   3.8333334431909285`*^9}, {3.8333335579238987`*^9, 
   3.8333335669072647`*^9}, {3.833333603778741*^9, 3.8333336779839797`*^9}, {
   3.8333337171407375`*^9, 3.8333337312290936`*^9}, {3.833341471565282*^9, 
   3.8333414824597797`*^9}, {3.833341529550749*^9, 3.8333415299577503`*^9}, 
   3.8333449936035285`*^9, {3.833418365812372*^9, 3.8334184114225636`*^9}, {
   3.8334260444598694`*^9, 3.8334260521288633`*^9}, {3.833426235570955*^9, 
   3.8334262420660553`*^9}, {3.833426441612363*^9, 3.8334264443371143`*^9}, {
   3.8334952464112444`*^9, 3.8334953395321035`*^9}, {3.8334954440478506`*^9, 
   3.8334955530974197`*^9}, {3.8334955833833237`*^9, 3.833495609856223*^9}, {
   3.8334956601264095`*^9, 3.8334957058063936`*^9}, {3.833495895974969*^9, 
   3.833495938113219*^9}, {3.833495969467995*^9, 3.833496041686122*^9}, {
   3.8335028663735743`*^9, 3.833502889754938*^9}, {3.833505651468855*^9, 
   3.833505789724749*^9}, {3.8335058393328876`*^9, 3.833506115498336*^9}, {
   3.833506179980727*^9, 3.833506206202691*^9}, {3.8335062809474044`*^9, 
   3.8335063596350703`*^9}, {3.833506408532711*^9, 3.833506510939436*^9}, {
   3.833506543804199*^9, 3.8335065723140388`*^9}, {3.8335066398900957`*^9, 
   3.8335068239490013`*^9}, {3.833506872421897*^9, 3.8335069388183637`*^9}, {
   3.8335069734854965`*^9, 3.833507002592222*^9}, {3.833507102726697*^9, 
   3.8335071112018437`*^9}, 3.833507279149382*^9, 3.8335178266376476`*^9, {
   3.833517867589338*^9, 3.8335178712688503`*^9}, {3.833519393470583*^9, 
   3.8335194029098234`*^9}, {3.8335196192603693`*^9, 
   3.8335196796725283`*^9}, {3.8335198040444264`*^9, 
   3.8335198504202986`*^9}, {3.8335199324960337`*^9, 3.8335199972715025`*^9}, 
   3.8335200383292933`*^9, {3.833520299488854*^9, 3.833520332819271*^9}, {
   3.8335203679618797`*^9, 3.8335203683843746`*^9}, {3.833520431415739*^9, 
   3.833520566634655*^9}, {3.8335263169383445`*^9, 3.8335263370570526`*^9}, {
   3.8335263690369215`*^9, 3.8335263784166613`*^9}, {3.8335264143277016`*^9, 
   3.833526474490698*^9}, {3.833526580925555*^9, 3.833526618007094*^9}, {
   3.8335269238893943`*^9, 3.8335269244363995`*^9}, {3.8335279191445293`*^9, 
   3.833527977478672*^9}, {3.8335763784918404`*^9, 3.833576379047311*^9}, {
   3.833577319498063*^9, 3.83357734485139*^9}, {3.833577413067032*^9, 
   3.83357747888929*^9}, 3.833592197839825*^9, {3.833595167703071*^9, 
   3.833595257493655*^9}, {3.8335953791733065`*^9, 3.8335955068425713`*^9}, {
   3.833595836398831*^9, 3.8335958403725915`*^9}, {3.833597900797676*^9, 
   3.83359793553404*^9}, {3.8335981421759925`*^9, 3.83359839964459*^9}, {
   3.8335984325183296`*^9, 3.8335984917104907`*^9}, 3.8335987609897175`*^9, {
   3.833599018883754*^9, 3.8335991300909157`*^9}, {3.833599217778845*^9, 
   3.8335992862044744`*^9}, {3.8335997341800957`*^9, 3.833599762411063*^9}, {
   3.833600063931925*^9, 3.8336001367373133`*^9}, {3.83360023621483*^9, 
   3.8336004706037064`*^9}, {3.833600641155302*^9, 3.833600642585394*^9}, {
   3.8336006778848033`*^9, 3.8336007039293766`*^9}, {3.833601218868611*^9, 
   3.8336012207400875`*^9}, {3.8336013450061803`*^9, 
   3.8336013483602858`*^9}, {3.833601433267707*^9, 3.833601533755525*^9}, {
   3.833601755533919*^9, 3.8336018157758064`*^9}, 3.8336018654622183`*^9, {
   3.8336019717370744`*^9, 3.83360199681855*^9}, {3.833770623932353*^9, 
   3.8337706375978894`*^9}, {3.83377079552612*^9, 3.833770814660884*^9}, {
   3.8337708863864784`*^9, 3.8337708904981155`*^9}, {3.8337709263430414`*^9, 
   3.8337709352641816`*^9}, {3.8337709995746346`*^9, 3.833771098371046*^9}, {
   3.833771338393111*^9, 3.8337713670635285`*^9}, {3.8337714665862885`*^9, 
   3.8337714677412343`*^9}, 3.8337715447671723`*^9, {3.833771684134333*^9, 
   3.8337717497734556`*^9}, {3.833772151912898*^9, 3.833772358401018*^9}, {
   3.83377355158165*^9, 3.8337735763234005`*^9}, {3.8337737018323126`*^9, 
   3.833773761277417*^9}, {3.8337740921486177`*^9, 3.833774109304488*^9}, {
   3.8337741623855824`*^9, 3.833774179320955*^9}, {3.8337742217140102`*^9, 
   3.833774254605995*^9}, {3.833774427875184*^9, 3.8337745047855825`*^9}, {
   3.8337746627706585`*^9, 3.833774674458459*^9}, {3.8337754151454906`*^9, 
   3.8337754268988743`*^9}, {3.833775467601567*^9, 3.833775619340825*^9}, 
   3.833775672158123*^9, {3.833775783857421*^9, 3.833775791195829*^9}, {
   3.8337791669805894`*^9, 3.8337791925508304`*^9}, {3.8337792988987265`*^9, 
   3.833779316370799*^9}, {3.833779679379975*^9, 3.833779683581132*^9}, {
   3.833779785322719*^9, 3.8337797969901943`*^9}, {3.833779842475302*^9, 
   3.8337798484193916`*^9}, {3.8338356918766575`*^9, 3.833835695817426*^9}, {
   3.8338358869887094`*^9, 3.833835891273756*^9}, 3.8338361071587768`*^9, {
   3.8338366453232203`*^9, 3.833836793806225*^9}, {3.8338370071210938`*^9, 
   3.833837116432189*^9}, 3.833837160171174*^9, {3.833837273330202*^9, 
   3.8338374080120525`*^9}, {3.8338374522935314`*^9, 3.83383747571824*^9}, {
   3.833837593438037*^9, 3.8338376971550045`*^9}, {3.8338378124090133`*^9, 
   3.8338381511820683`*^9}, {3.8338381952891855`*^9, 3.833838200402206*^9}, {
   3.8338382609604063`*^9, 3.8338383054718995`*^9}, {3.833838370718996*^9, 
   3.8338384195041533`*^9}, {3.8338392104448643`*^9, 
   3.8338392324464865`*^9}, {3.833839263764002*^9, 3.8338393174374886`*^9}, {
   3.8338395066036825`*^9, 3.8338396084619803`*^9}, {3.8338410419984684`*^9, 
   3.833841067157407*^9}, {3.8338411353864436`*^9, 3.833841149060585*^9}, {
   3.8338413751344213`*^9, 3.8338414401487722`*^9}, 3.8338414944404573`*^9, {
   3.833841575507801*^9, 3.8338416670506983`*^9}, {3.8338417080127487`*^9, 
   3.833841710427762*^9}, {3.8338490153392124`*^9, 3.833849041791651*^9}, {
   3.8338491593083677`*^9, 3.833849290567129*^9}, {3.8338493266190677`*^9, 
   3.8338494015264273`*^9}, 3.833849578751194*^9, {3.833850188775714*^9, 
   3.8338501929906607`*^9}, {3.8338502268875074`*^9, 
   3.8338502312001495`*^9}, {3.8338502753836727`*^9, 
   3.8338502807158213`*^9}, {3.833850775716303*^9, 3.833850843361579*^9}, {
   3.8338539524566517`*^9, 3.833853965158213*^9}, {3.833864651613485*^9, 
   3.833864711611679*^9}, {3.833864745230559*^9, 3.8338648006996355`*^9}, {
   3.833864858166874*^9, 3.833864925182195*^9}, 3.83386497128272*^9, {
   3.8338650159075203`*^9, 3.833865075688139*^9}, {3.833865137157236*^9, 
   3.8338651974981594`*^9}, {3.833865267439844*^9, 3.833865275772188*^9}, {
   3.833865407910533*^9, 3.8338655757343044`*^9}, {3.8338658918609467`*^9, 
   3.833865901035062*^9}, {3.8338659601198874`*^9, 3.833866061758861*^9}, {
   3.833866204597522*^9, 3.833866256242448*^9}, {3.8338663862960415`*^9, 
   3.8338664341041403`*^9}, 3.833866478556568*^9, {3.833866510364379*^9, 
   3.8338665106469574`*^9}, {3.83455585937309*^9, 3.8345558800050707`*^9}, {
   3.834556283708276*^9, 3.8345564677000637`*^9}, 3.8345564980132103`*^9, {
   3.8345566453712816`*^9, 3.8345567282334347`*^9}, 3.8345648794294596`*^9, {
   3.8345667367923665`*^9, 3.834566746686951*^9}, {3.8345667851076055`*^9, 
   3.834566890238554*^9}, {3.834566944155698*^9, 3.8345669463585234`*^9}, {
   3.834566998260236*^9, 3.834567002563795*^9}, {3.834567046324072*^9, 
   3.8345670764033947`*^9}, {3.8346181483084836`*^9, 3.834618232425601*^9}, {
   3.834618413050808*^9, 3.8346184507810125`*^9}, {3.834618723198928*^9, 
   3.83461872731711*^9}, {3.8346187886418715`*^9, 3.8346188395800495`*^9}, {
   3.8346188706213646`*^9, 3.8346189450119295`*^9}, {3.834619012856116*^9, 
   3.8346191156655293`*^9}, {3.8346192125399485`*^9, 3.834619215365235*^9}, {
   3.8346203760359707`*^9, 3.8346203803806906`*^9}, {3.834620471393161*^9, 
   3.8346204716666813`*^9}, {3.8346205030684624`*^9, 
   3.8346209698778777`*^9}, {3.834625957802145*^9, 3.8346261211232166`*^9}, {
   3.8346262464349666`*^9, 3.8346263192829075`*^9}, {3.8346266159337173`*^9, 
   3.834626658002313*^9}, {3.834630722692277*^9, 3.8346307311041126`*^9}, {
   3.834630761522069*^9, 3.834630763229432*^9}, {3.8346309266134167`*^9, 
   3.834631017262119*^9}, {3.834631268289591*^9, 3.8346312847604346`*^9}, {
   3.8346313175813384`*^9, 3.834631349636341*^9}, {3.834631489831416*^9, 
   3.834631571182186*^9}, {3.8346316580933523`*^9, 3.8346317257531185`*^9}, 
   3.8346318769097137`*^9, {3.834631907037794*^9, 3.8346319080869975`*^9}, {
   3.8346319581942625`*^9, 3.8346319816461315`*^9}, {3.8346320690907745`*^9, 
   3.83463206978495*^9}, {3.834632208257845*^9, 3.834632215225396*^9}, {
   3.8346323992695885`*^9, 3.834632476850516*^9}, {3.8346325231939135`*^9, 
   3.834632532441766*^9}, {3.8346339792570705`*^9, 3.8346340799164963`*^9}, {
   3.8346342003920565`*^9, 3.8346342307636423`*^9}, {3.8346387188701363`*^9, 
   3.8346387413218703`*^9}, {3.834638790805142*^9, 3.8346387933888874`*^9}, {
   3.8346388510679593`*^9, 3.834638904383151*^9}, {3.8346389494444475`*^9, 
   3.8346393265940804`*^9}, {3.8346393604448395`*^9, 3.83463972167308*^9}, 
   3.8346401594998636`*^9, {3.834640208530592*^9, 3.8346402165664835`*^9}, {
   3.834640552545493*^9, 3.8346407206517982`*^9}, {3.834640758544514*^9, 
   3.834641275622789*^9}, {3.834641339958897*^9, 3.834641365380951*^9}, {
   3.8346414015997157`*^9, 3.834641701305843*^9}, 3.8346417597995267`*^9, {
   3.8346418975768967`*^9, 3.8346418986889353`*^9}, {3.834642334720008*^9, 
   3.8346423666744967`*^9}, {3.8346424092263374`*^9, 3.83464245771558*^9}, {
   3.8346424880570436`*^9, 3.834642495036747*^9}, {3.8346425487118235`*^9, 
   3.8346426862762423`*^9}, {3.8346427211514616`*^9, 
   3.8346429711367564`*^9}, {3.8346430201198177`*^9, 3.8346432679186087`*^9}, 
   3.834643308951255*^9, {3.8346433526012745`*^9, 3.8346433909198866`*^9}, {
   3.8346436802603135`*^9, 3.8346436852129087`*^9}, {3.834643717350258*^9, 
   3.8346437895225906`*^9}, {3.8346438355622044`*^9, 3.834643837079113*^9}, {
   3.8346439341593704`*^9, 3.8346439556463575`*^9}, {3.834644098379367*^9, 
   3.8346441294192295`*^9}, {3.834644186591736*^9, 3.8346441876740046`*^9}, {
   3.83464426785563*^9, 3.834644285635398*^9}, {3.834644320382204*^9, 
   3.8346443904483776`*^9}, {3.8346497054168797`*^9, 3.834649721098814*^9}, {
   3.8346498096807237`*^9, 3.834649871379731*^9}, {3.834650013745886*^9, 
   3.834650050230825*^9}, {3.8346501356977606`*^9, 3.834650330912716*^9}, {
   3.8346503649672236`*^9, 3.834650482986489*^9}, {3.8346505167506447`*^9, 
   3.8346506997971053`*^9}, {3.8346507654389563`*^9, 
   3.8346507693136463`*^9}, {3.8346508663811054`*^9, 
   3.8346508956805162`*^9}, {3.834650941848879*^9, 3.8346510489211206`*^9}, {
   3.8346510821309257`*^9, 3.8346510823252125`*^9}, {3.834651213536523*^9, 
   3.834651271102111*^9}, {3.83465130494989*^9, 3.834651305166016*^9}, {
   3.8346515675865517`*^9, 3.8346515722242894`*^9}, {3.8346516099985886`*^9, 
   3.834651710560135*^9}, {3.83465174904237*^9, 3.8346517795841303`*^9}, {
   3.834651818523247*^9, 3.8346518494612117`*^9}, {3.834651887623377*^9, 
   3.83465193839064*^9}, {3.8346519721415443`*^9, 3.8346519769313173`*^9}, {
   3.834654003574836*^9, 3.834654168307161*^9}, {3.8346544859555287`*^9, 
   3.834654631833847*^9}, {3.834654720753235*^9, 3.83465495438742*^9}, {
   3.83465500646569*^9, 3.8346550211421003`*^9}, {3.834655104186417*^9, 
   3.8346551052918673`*^9}, {3.8346551595322933`*^9, 3.834655203186694*^9}, {
   3.8346552708900642`*^9, 3.8346554098500786`*^9}, {3.8346554762732205`*^9, 
   3.8346555410145416`*^9}, {3.834655987015789*^9, 3.8346559889663897`*^9}, {
   3.834656032676391*^9, 3.8346560637356663`*^9}, 3.834656154901741*^9, {
   3.8347003048435864`*^9, 3.8347003609499493`*^9}, {3.834700549466688*^9, 
   3.8347005610013943`*^9}, {3.834700973980945*^9, 3.8347009745924835`*^9}, {
   3.834701020703624*^9, 3.8347010876771317`*^9}, {3.8347015849589195`*^9, 
   3.834701632987954*^9}, {3.8347016656187057`*^9, 3.8347017111669607`*^9}, {
   3.834701747759903*^9, 3.834701853385932*^9}, {3.8347018901847754`*^9, 
   3.8347018911280475`*^9}, {3.8347019465224514`*^9, 3.83470201038986*^9}, {
   3.8347020903187575`*^9, 3.834702282762987*^9}, 3.8347130914796305`*^9, {
   3.8347131323358316`*^9, 3.8347131608340883`*^9}, {3.834713240989467*^9, 
   3.834713593697852*^9}, 3.8347136247728395`*^9, {3.8347139154801636`*^9, 
   3.8347139281117873`*^9}, {3.8347141406270647`*^9, 3.834714289919633*^9}, {
   3.834714345723111*^9, 3.834714461532728*^9}, {3.834714557458558*^9, 
   3.8347145585164323`*^9}, {3.834714589723448*^9, 3.834714590784034*^9}, {
   3.8347146277552657`*^9, 3.8347146383628693`*^9}, {3.83471467822723*^9, 
   3.83471471910828*^9}, {3.8347148117657733`*^9, 3.834714996135127*^9}, {
   3.834715056223711*^9, 3.834715112025732*^9}, {3.8347151592375927`*^9, 
   3.834715262870102*^9}, {3.834715298246091*^9, 3.8347156019640627`*^9}, {
   3.834715642181222*^9, 3.834715654958086*^9}, {3.834715703439255*^9, 
   3.834715862402362*^9}, {3.834715916754024*^9, 3.834715952493599*^9}, {
   3.8347160674528766`*^9, 3.834716085851677*^9}, {3.8347161271141677`*^9, 
   3.8347161493903255`*^9}, {3.8347162470196114`*^9, 
   3.8347163497233086`*^9}, {3.8347164237497206`*^9, 
   3.8347164761327653`*^9}, {3.8347165346936827`*^9, 3.834716667613672*^9}, {
   3.834717074742263*^9, 3.8347171029588227`*^9}, 3.834717243823594*^9, {
   3.834717290548418*^9, 3.834717392211062*^9}, {3.8347174273097973`*^9, 
   3.8347175812938623`*^9}, {3.834717693832827*^9, 3.8347176990832815`*^9}, {
   3.8347178139350195`*^9, 3.8347178451550617`*^9}, {3.834717960117036*^9, 
   3.834718090945257*^9}, 3.8347228012899675`*^9},
 CellLabel->
  "In[378]:=",ExpressionUUID->"de46ef57-a359-4ec4-a7d3-aea9f5198032"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`diskNormalX$$ = -1, \
$CellContext`diskNormalY$$ = 0, $CellContext`diskRadius$$ = 
    0.5, $CellContext`lightIntensity$$ = 1, $CellContext`lightLambda$$ = 
    5, $CellContext`roughness$$ = 0.1, $CellContext`shadingColorScaling$$ = 
    0.3, $CellContext`shadingOffset$$ = 0.3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightIntensity$$], 1}, 0.1, 10}, {{
       Hold[$CellContext`lightLambda$$], 5}, 4.60517, 50}, {{
       Hold[$CellContext`diskNormalX$$], -1}, -3, -0.1}, {{
       Hold[$CellContext`diskNormalY$$], 0}, -3, 0}, {{
       Hold[$CellContext`diskRadius$$], 0.5}, 0.2, 1}, {{
       Hold[$CellContext`roughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`shadingColorScaling$$], 0.3}, 0.1, 1}, {{
       Hold[$CellContext`shadingOffset$$], 0.3}, 0, 
      Dynamic[$CellContext`diskRadius$$]}}, Typeset`size$$ = {
    585., {289., 294.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightIntensity$1579867$$ = 
    0, $CellContext`lightLambda$1579868$$ = 
    0, $CellContext`diskNormalX$1579869$$ = 
    0, $CellContext`diskNormalY$1579870$$ = 
    0, $CellContext`diskRadius$1579871$$ = 
    0, $CellContext`roughness$1579872$$ = 
    0, $CellContext`shadingColorScaling$1579873$$ = 
    0, $CellContext`shadingOffset$1579874$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`diskNormalX$$ = -1, \
$CellContext`diskNormalY$$ = 0, $CellContext`diskRadius$$ = 
        0.5, $CellContext`lightIntensity$$ = 1, $CellContext`lightLambda$$ = 
        5, $CellContext`roughness$$ = 0.1, $CellContext`shadingColorScaling$$ = 
        0.3, $CellContext`shadingOffset$$ = 0.3}, "ControllerVariables" :> {
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$1579867$$, 0], 
        Hold[$CellContext`lightLambda$$, $CellContext`lightLambda$1579868$$, 
         0], 
        Hold[$CellContext`diskNormalX$$, $CellContext`diskNormalX$1579869$$, 
         0], 
        Hold[$CellContext`diskNormalY$$, $CellContext`diskNormalY$1579870$$, 
         0], 
        Hold[$CellContext`diskRadius$$, $CellContext`diskRadius$1579871$$, 0], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$1579872$$, 0], 
        Hold[$CellContext`shadingColorScaling$$, \
$CellContext`shadingColorScaling$1579873$$, 0], 
        Hold[$CellContext`shadingOffset$$, \
$CellContext`shadingOffset$1579874$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`diskNormalAxis = 
        Normalize[{$CellContext`diskNormalX$$, $CellContext`diskNormalY$$, \
-1}]; $CellContext`testDisk = {{0, 0, 
          1}, $CellContext`diskNormalAxis, $CellContext`diskRadius$$}; \
$CellContext`testSphere = {{0, 0, 0}, 
          1}; $CellContext`majorX = -$CellContext`diskNormalY$$; \
$CellContext`majorY = $CellContext`diskNormalX$$; $CellContext`majorAxis = 
        Normalize[{$CellContext`majorX, $CellContext`majorY, 
           0}]; $CellContext`minorX = $CellContext`majorY; \
$CellContext`minorY = -$CellContext`majorX; $CellContext`minorAxis = 
        Normalize[{$CellContext`minorX, $CellContext`minorY, 
           0}]; $CellContext`majorSize = $CellContext`diskRadius$$; \
$CellContext`diskTangentZ = Part[
          Part[
           Solve[Dot[$CellContext`diskNormalAxis, {
               Part[$CellContext`majorAxis, 1], 
               Part[$CellContext`majorAxis, 2], $CellContext`z}] == 
            0, $CellContext`z], All, 1, 2], 1]; $CellContext`diskTangent = 
        Normalize[{
           Part[$CellContext`majorAxis, 1], 
           
           Part[$CellContext`majorAxis, 
            2], $CellContext`diskTangentZ}]; $CellContext`diskBiTangentZ = 
        Part[
          Part[
           Solve[Dot[$CellContext`diskNormalAxis, {
               Part[$CellContext`minorAxis, 1], 
               Part[$CellContext`minorAxis, 2], $CellContext`z}] == 
            0, $CellContext`z], All, 1, 2], 1]; $CellContext`diskBiTangent = 
        Normalize[{
           Part[$CellContext`minorAxis, 1], 
           
           Part[$CellContext`minorAxis, 
            2], $CellContext`diskBiTangentZ}]; $CellContext`viewDir0 = 
        Normalize[{0, 0, 0} - {0, 0, 
          1}]; $CellContext`halfDir0 = $CellContext`diskNormalAxis; \
$CellContext`lightDir = 
        Normalize[
         2 Dot[$CellContext`viewDir0, $CellContext`halfDir0] \
$CellContext`halfDir0 - $CellContext`viewDir0]; $CellContext`shadingPt1 = 
        Part[$CellContext`testDisk, 
           1] + $CellContext`diskBiTangent $CellContext`shadingOffset$$; \
$CellContext`viewDir1 = 
        Normalize[{0, 0, 
           0} - $CellContext`shadingPt1]; $CellContext`viewDist0 = 
        Norm[{0, 0, 0} - 
          Part[$CellContext`testDisk, 1]]; $CellContext`viewDist1 = 
        Norm[{0, 0, 0} - $CellContext`shadingPt1]; $CellContext`halfDir1 = 
        Normalize[($CellContext`lightDir + $CellContext`viewDir1)/
          2]; $CellContext`helperPt1 = {0, 0, 
          0} - $CellContext`diskNormalAxis $CellContext`viewDist0 
         Dot[$CellContext`diskNormalAxis, $CellContext`viewDir0]; \
$CellContext`theta0 = Pi/2 - ArcCos[
          
          Dot[$CellContext`diskNormalAxis, $CellContext`viewDir0]]; \
$CellContext`arc0Center = 
        Part[$CellContext`testDisk, 1]; $CellContext`arc0Radius = 
        0.1; $CellContext`arc0Normal = Normalize[
          
          Cross[$CellContext`diskNormalAxis, $CellContext`viewDir0]]; \
$CellContext`arc0Axis = ($CellContext`viewDir0 - $CellContext`diskBiTangent)/
         2; $CellContext`arc0ThetaSpan = $CellContext`theta0; \
$CellContext`viewDist0Proj = $CellContext`viewDist0 
         Cos[$CellContext`theta0]; $CellContext`theta1 = 
        ArcTan[(
           Tan[$CellContext`theta0] \
$CellContext`viewDist0Proj)/($CellContext`viewDist0Proj + \
$CellContext`shadingOffset$$)]; $CellContext`halfTheta1 = (
          2 $CellContext`halfTheta0 + $CellContext`theta0 - \
$CellContext`theta1)/
         2; $CellContext`arc1Center = $CellContext`shadingPt1; \
$CellContext`arc1Radius = 0.1; $CellContext`arc1Normal = Normalize[
          
          Cross[$CellContext`diskNormalAxis, $CellContext`viewDir1]]; \
$CellContext`arc1Axis = ($CellContext`viewDir1 - $CellContext`diskBiTangent)/
         2; $CellContext`arc1ThetaSpan = $CellContext`theta1; \
$CellContext`minorSize = ($CellContext`diskRadius$$ 
          Cos[$CellContext`theta0])/(
         1 + $CellContext`diskRadius$$ 
          Sin[$CellContext`theta0]); $CellContext`maxLeftThetaD = 
        ArcTan[$CellContext`minorSize/1]; $CellContext`sphereShadingFunc := 
        Block[{$CellContext`spherePt, $CellContext`diskPt, \
$CellContext`tmpRayDir, $CellContext`tmpDiff, $CellContext`tmpProd1, \
$CellContext`tmpProd2, $CellContext`tmpProd3, $CellContext`intsPt, \
$CellContext`sglight, $CellContext`refLightDir, $CellContext`refViewDir, \
$CellContext`refNormal, $CellContext`sgndf, $CellContext`diskLighting1, \
$CellContext`finalLighting}, $CellContext`spherePt = {$CellContext`x, \
$CellContext`y, $CellContext`z}; If[$CellContext`z < 0, 
            Return[0]]; $CellContext`tmpRayDir = 
           Normalize[$CellContext`spherePt]; $CellContext`tmpDiff = \
$CellContext`spherePt - Part[$CellContext`testDisk, 1]; $CellContext`tmpProd1 = 
           Dot[$CellContext`tmpDiff, $CellContext`diskNormalAxis]; \
$CellContext`tmpProd2 = 
           Dot[$CellContext`tmpRayDir, $CellContext`diskNormalAxis]; \
$CellContext`tmpProd3 = $CellContext`tmpProd1/$CellContext`tmpProd2; \
$CellContext`intsPt = $CellContext`spherePt - $CellContext`tmpRayDir \
$CellContext`tmpProd3; $CellContext`diskPt = $CellContext`intsPt; 
          If[Norm[$CellContext`intsPt - 
              Part[$CellContext`testDisk, 1]] > $CellContext`diskRadius$$, 
            Return[0]]; $CellContext`sglight = 
           sgCommon`sgDirLight[$CellContext`lightDir, \
$CellContext`lightIntensity$$, $CellContext`lightLambda$$]; \
$CellContext`refLightDir = $CellContext`lightDir; $CellContext`refViewDir = 
           Normalize[{0, 0, 
              0} - $CellContext`diskPt]; $CellContext`refNormal = \
$CellContext`diskNormalAxis; $CellContext`sgndf = 
           sgCommon`sgNDF[$CellContext`roughness$$, $CellContext`refLightDir, \
$CellContext`refViewDir, $CellContext`refNormal]; $CellContext`diskLighting1 = 
           sgCommon`sgDot[$CellContext`sglight, $CellContext`sgndf]; \
$CellContext`finalLighting = $CellContext`diskLighting1 \
$CellContext`shadingColorScaling$$; $CellContext`finalLighting]; 
       gPlots3D`gParamPlot3D[
         Association[
          ("spheres" -> {
            Association[
            "center" -> Part[$CellContext`testSphere, 1], "radius" -> 
             Part[$CellContext`testSphere, 2], "opacity" -> 0.1, "plotPts" -> 
             30, "mesh" -> None, "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
               LightBlue]], 
            Association[
            "center" -> $CellContext`shadingPt1, "radius" -> 0.03, "mesh" -> 
             None, "colorFunc" -> (Red& )], 
            Association[
            "center" -> $CellContext`helperPt1, "radius" -> 0.03, "mesh" -> 
             None, "colorFunc" -> (Gray& )]}& )[], 
          ("lines" -> {
            Association[
            "startPos" -> Part[$CellContext`testDisk, 1], 
             "dirVec" -> $CellContext`diskNormalAxis, "length" -> 1, 
             "colorFunc" -> (Green& ), "thickness" -> 0.005], 
            Association[
            "startPos" -> {0, 0, 0}, "dirVec" -> -$CellContext`viewDir0, 
             "length" -> $CellContext`viewDist0 + 0.2, 
             "colorFunc" -> (Blue& ), "thickness" -> 0.005], 
            Association[
            "startPos" -> {0, 0, 0}, "dirVec" -> -$CellContext`viewDir1, 
             "length" -> $CellContext`viewDist1 + 0.2, "colorFunc" -> (Red& ),
              "thickness" -> 0.005], 
            Association[
            "startPos" -> {0, 0, 0}, "dirVec" -> 
             Normalize[$CellContext`helperPt1 - {0, 0, 0}], "length" -> 
             Norm[$CellContext`helperPt1 - {0, 0, 0}], 
             "colorFunc" -> (Gray& ), "thickness" -> 0.005], 
            Association[
            "startPos" -> Part[$CellContext`testDisk, 1], 
             "dirVec" -> -$CellContext`diskBiTangent, 
             "length" -> $CellContext`viewDist0Proj, "colorFunc" -> (Blue& ), 
             "thickness" -> 0.005], 
            Association[
            "startPos" -> Part[$CellContext`testDisk, 1], 
             "dirVec" -> $CellContext`diskBiTangent, "length" -> 
             Slot["shadingOffset"], "colorFunc" -> (Red& ), "thickness" -> 
             0.005], 
            Association[
            "startPos" -> Part[$CellContext`testDisk, 1], 
             "dirVec" -> $CellContext`halfDir0, "length" -> 0.2, 
             "colorFunc" -> (Gray& ), "thickness" -> 0.005], 
            Association[
            "startPos" -> $CellContext`shadingPt1, 
             "dirVec" -> $CellContext`halfDir1, "length" -> 0.2, 
             "colorFunc" -> (Gray& ), "thickness" -> 0.005]}& )[
           Association[
           "diskRadius" -> $CellContext`diskRadius$$, 
            "shadingOffset" -> $CellContext`shadingOffset$$]], 
          ("disks" -> {
            Association[
            "center" -> Part[$CellContext`testDisk, 1], "normalAxis" -> 
             Part[$CellContext`testDisk, 2], "radius" -> 
             Part[$CellContext`testDisk, 3], "opacity" -> 0, "mesh" -> None, 
             "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z, \
$CellContext`p}, Cyan]]}& )[], 
          ("arcs" -> {
            Association[
            "center" -> $CellContext`arc0Center, 
             "radius" -> $CellContext`arc0Radius, "thickness" -> 0.01, 
             "normalDir" -> $CellContext`arc0Normal, 
             "axisDir" -> -$CellContext`arc0Axis, 
             "thetaSpan" -> $CellContext`arc0ThetaSpan, "mesh" -> None, 
             "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z, \
$CellContext`p}, Blue]], 
            Association[
            "center" -> $CellContext`arc1Center, 
             "radius" -> $CellContext`arc1Radius, "thickness" -> 0.01, 
             "normalDir" -> $CellContext`arc1Normal, 
             "axisDir" -> -$CellContext`arc1Axis, 
             "thetaSpan" -> $CellContext`arc1ThetaSpan, "mesh" -> None, 
             "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z, \
$CellContext`p}, Red]]}& )[], "customPlots" -> {
            Graphics3D[{Blue, 
              
              Arrow[{Part[$CellContext`testDisk, 1] + $CellContext`lightDir 2,
                 Part[$CellContext`testDisk, 1] + $CellContext`lightDir}]}], 
            Graphics3D[{
              Text[
               Style[
               "\!\(\*SubscriptBox[\(\[Theta]\), \(0\)]\)", 
                18], $CellContext`arc0Center - $CellContext`arc0Axis \
($CellContext`arc0Radius + 0.1)]}], 
            Graphics3D[{
              Text[
               Style[
               "\!\(\*SubscriptBox[\(\[Theta]\), \(1\)]\)", 
                18], $CellContext`arc1Center - $CellContext`arc1Axis \
($CellContext`arc1Radius + 0.1)]}]}, "axisExtent" -> 1.6, "viewPoint" -> 
          Front], Large]), 
      "Specifications" :> {{{$CellContext`lightIntensity$$, 1}, 0.1, 
         10}, {{$CellContext`lightLambda$$, 5}, 4.60517, 
         50}, {{$CellContext`diskNormalX$$, -1}, -3, -0.1}, \
{{$CellContext`diskNormalY$$, 0}, -3, 0}, {{$CellContext`diskRadius$$, 0.5}, 
         0.2, 1}, {{$CellContext`roughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`shadingColorScaling$$, 0.3}, 0.1, 
         1}, {{$CellContext`shadingOffset$$, 0.3}, 0, 
         Dynamic[$CellContext`diskRadius$$]}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{965., {320., 326.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.834650700665185*^9, 3.8346507707073097`*^9, 3.834650899341587*^9, {
   3.834651260222808*^9, 3.8346512721470985`*^9}, 3.8346513063358297`*^9, 
   3.8346517114173036`*^9, 3.8346518514111032`*^9, 3.8346519399582195`*^9, 
   3.8346519776130257`*^9, 3.8346541694139585`*^9, 3.8346549555350475`*^9, {
   3.83465500963844*^9, 3.8346550223411565`*^9}, 3.834655542616188*^9, 
   3.8346559899242015`*^9, {3.834656048317128*^9, 3.834656064612192*^9}, 
   3.8346998315009556`*^9, {3.8347003059584475`*^9, 3.8347003341889267`*^9}, 
   3.8347005619286137`*^9, 3.8347008719180655`*^9, 3.834700975433257*^9, 
   3.8347010898864636`*^9, {3.834701590279948*^9, 3.8347016346155663`*^9}, 
   3.8347016694469786`*^9, 3.834701711962609*^9, {3.834701748504998*^9, 
   3.834701810004668*^9}, 3.8347018567633705`*^9, 3.834701897006027*^9, {
   3.834702239926469*^9, 3.834702283955127*^9}, 3.834713057698367*^9, 
   3.8347131618792715`*^9, 3.834713634358624*^9, 3.834713928712866*^9, {
   3.8347141465299945`*^9, 3.834714163929039*^9}, 3.8347142122843876`*^9, 
   3.8347143070134225`*^9, {3.834714575630481*^9, 3.834714592016182*^9}, 
   3.8347146393009667`*^9, 3.8347146809354115`*^9, 3.8347147204087276`*^9, 
   3.8347153278568773`*^9, 3.834715406841894*^9, 3.8347154684476185`*^9, 
   3.8347155128557005`*^9, 3.834715603040459*^9, 3.8347158681931133`*^9, 
   3.8347159184235573`*^9, 3.8347159596954956`*^9, 3.8347161529168253`*^9, {
   3.8347164344121213`*^9, 3.8347164774004803`*^9}, 3.834716593406914*^9, 
   3.834717701173773*^9, {3.834722791622343*^9, 3.8347228034049873`*^9}},
 CellLabel->
  "Out[387]=",ExpressionUUID->"4b179a6e-9982-44a1-81e5-b4e98d0b7220"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"h2", "=", 
   RowBox[{"h1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2", "=", "p1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"detH", "=", 
  RowBox[{"Det", "[", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"h2", ",", "p2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"h1", ",", "p1"}], "}"}], "}"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8347181358570027`*^9, 3.8347181536812005`*^9}, {
  3.8347182330884743`*^9, 3.834718234629998*^9}},
 CellLabel->
  "In[328]:=",ExpressionUUID->"380cc0c5-97c7-4359-84a4-ba52067e148e"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{{3.8347181461553116`*^9, 3.8347181544883814`*^9}, 
   3.8347182351061954`*^9},
 CellLabel->
  "Out[330]=",ExpressionUUID->"ac893b92-59bd-4e67-b2e2-dafba86aa164"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "p1", ",", "p2", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", "k", ",", 
    "\[Mu]1", ",", "\[Mu]2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sgProductIntegral", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", "\[Lambda]1", ",", "\[Mu]1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p2", ",", 
     RowBox[{"k", "*", "\[Lambda]2"}], ",", "\[Mu]2"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.834719319081644*^9, 3.834719375040493*^9}, {
  3.834719405110696*^9, 3.834719412292285*^9}, {3.834719503510847*^9, 
  3.8347195303894253`*^9}, {3.8347195755641513`*^9, 3.834719593484353*^9}},
 CellLabel->
  "In[338]:=",ExpressionUUID->"0750f98a-ebac-4ea9-815f-a222330b55ed"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"k", " ", "\[Lambda]1", " ", "\[Lambda]2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"p1", ".", "p2"}]}], ")"}]}], 
     RowBox[{"\[Lambda]1", "+", 
      RowBox[{"k", " ", "\[Lambda]2"}]}]]], " ", "\[Pi]", " ", "\[Mu]1", " ", 
   "\[Mu]2"}], 
  RowBox[{"\[Lambda]1", "+", 
   RowBox[{"k", " ", "\[Lambda]2"}], "-", 
   FractionBox[
    RowBox[{"k", " ", "\[Lambda]1", " ", "\[Lambda]2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"p1", ".", "p2"}]}], ")"}]}], 
    RowBox[{"\[Lambda]1", "+", 
     RowBox[{"k", " ", "\[Lambda]2"}]}]]}]]], "Output",
 CellChangeTimes->{{3.8347193470087914`*^9, 3.834719375678765*^9}, 
   3.834719412822565*^9, 3.834719504675669*^9, {3.834719537817848*^9, 
   3.834719552969389*^9}, 3.8347195963259797`*^9},
 CellLabel->
  "Out[339]=",ExpressionUUID->"6cc6e744-7909-4e32-9091-e61e57a75fe4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sgNDF", "[", 
  RowBox[{"0.3", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.834719718625404*^9, 3.834719804657679*^9}},
 CellLabel->
  "In[348]:=",ExpressionUUID->"0684a174-05fa-4a9a-b029-c2ac4b3cdc7f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", "5.555555555555555`", ",", 
   "3.53677651315323`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8347197392747593`*^9, 3.834719805048872*^9}},
 CellLabel->
  "Out[348]=",ExpressionUUID->"18f199dc-e2da-4db3-b86b-a3164331957f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "@", 
  RowBox[{"Series", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"k", " ", "\[Lambda]1", " ", "\[Lambda]2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"p1", ".", "p2"}]}], ")"}]}], 
        RowBox[{"\[Lambda]1", "+", 
         RowBox[{"k", " ", "\[Lambda]2"}]}]]], " ", "\[Pi]", " ", "\[Mu]1", 
      " ", "\[Mu]2"}], 
     RowBox[{"\[Lambda]1", "+", 
      RowBox[{"k", " ", "\[Lambda]2"}], "-", 
      FractionBox[
       RowBox[{"k", " ", "\[Lambda]1", " ", "\[Lambda]2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"p1", ".", "p2"}]}], ")"}]}], 
       RowBox[{"\[Lambda]1", "+", 
        RowBox[{"k", " ", "\[Lambda]2"}]}]]}]], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8347198810292897`*^9, 3.834719892469777*^9}, 
   3.8347199382482214`*^9, {3.83471998647338*^9, 3.8347199885237384`*^9}},
 CellLabel->
  "In[354]:=",ExpressionUUID->"32261a81-0277-4c03-ba34-bdeac217b2d0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"\[Lambda]1", " ", "\[Lambda]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"p1", ".", "p2"}]}], ")"}]}], 
       RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}]]], " ", "\[Pi]", " ", 
     "\[Mu]1", " ", "\[Mu]2"}], 
    RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "+", 
     FractionBox[
      RowBox[{"\[Lambda]1", " ", "\[Lambda]2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"p1", ".", "p2"}]}], ")"}]}], 
      RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}]]}]], "-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[Lambda]1", " ", "\[Lambda]2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"p1", ".", "p2"}]}], ")"}]}], 
         RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}]]], " ", "\[Pi]", " ", 
       "\[Lambda]2", " ", "\[Mu]1", " ", "\[Mu]2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Lambda]1", "4"], "+", 
         RowBox[{
          SuperscriptBox["\[Lambda]1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", "\[Lambda]1"}], ")"}], " ", "\[Lambda]2"}], "+", 
         RowBox[{"\[Lambda]1", " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", "\[Lambda]1"}], ")"}], " ", 
          SuperscriptBox["\[Lambda]2", "2"]}], "+", 
         SuperscriptBox["\[Lambda]2", "3"], "-", 
         RowBox[{
          SuperscriptBox["\[Lambda]1", "2"], " ", 
          RowBox[{"p1", ".", "p2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Lambda]1"}], ")"}], " ", 
             "\[Lambda]1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Lambda]2"}], ")"}], " ", 
             "\[Lambda]2"}], "+", 
            RowBox[{"\[Lambda]1", " ", "\[Lambda]2", " ", 
             RowBox[{"p1", ".", "p2"}]}]}], ")"}]}]}], ")"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"k", "-", "1"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Lambda]1", "2"], "+", 
        RowBox[{"\[Lambda]1", " ", "\[Lambda]2"}], "+", 
        SuperscriptBox["\[Lambda]2", "2"], "+", 
        RowBox[{"\[Lambda]1", " ", "\[Lambda]2", " ", 
         RowBox[{"p1", ".", "p2"}]}]}], ")"}], "2"]}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      RowBox[{"k", "-", "1"}], "]"}], "2"],
    SeriesData[$CellContext`k, 1, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`k, 1, {
   2 E^($CellContext`\[Lambda]1 $CellContext`\[Lambda]2 ($CellContext`\
\[Lambda]1 + $CellContext`\[Lambda]2)^(-1) (-1 + 
       Dot[$CellContext`p1, $CellContext`p2])) 
    Pi $CellContext`\[Mu]1 $CellContext`\[Mu]2/($CellContext`\[Lambda]1 + \
$CellContext`\[Lambda]2 + $CellContext`\[Lambda]1 $CellContext`\[Lambda]2 \
($CellContext`\[Lambda]1 + $CellContext`\[Lambda]2)^(-1) (-1 + 
      Dot[$CellContext`p1, $CellContext`p2])), (-2) 
    E^($CellContext`\[Lambda]1 $CellContext`\[Lambda]2 \
($CellContext`\[Lambda]1 + $CellContext`\[Lambda]2)^(-1) (-1 + 
       Dot[$CellContext`p1, $CellContext`p2])) 
    Pi $CellContext`\[Lambda]2 ($CellContext`\[Lambda]1 + $CellContext`\
\[Lambda]2)^(-1) $CellContext`\[Mu]1 $CellContext`\[Mu]2 ($CellContext`\
\[Lambda]1^2 + $CellContext`\[Lambda]1 $CellContext`\[Lambda]2 + \
$CellContext`\[Lambda]2^2 + $CellContext`\[Lambda]1 $CellContext`\[Lambda]2 
       Dot[$CellContext`p1, $CellContext`p2])^(-2) ($CellContext`\[Lambda]1^4 + \
$CellContext`\[Lambda]1^2 (
       2 + $CellContext`\[Lambda]1) $CellContext`\[Lambda]2 + $CellContext`\
\[Lambda]1 (
       3 + $CellContext`\[Lambda]1) $CellContext`\[Lambda]2^2 + $CellContext`\
\[Lambda]2^3 - $CellContext`\[Lambda]1^2 
     Dot[$CellContext`p1, $CellContext`p2] ((-1 + $CellContext`\[Lambda]1) \
$CellContext`\[Lambda]1 + (-1 + $CellContext`\[Lambda]2) $CellContext`\
\[Lambda]2 + $CellContext`\[Lambda]1 $CellContext`\[Lambda]2 
       Dot[$CellContext`p1, $CellContext`p2]))}, 0, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.834719893375289*^9, 3.8347199392848916`*^9, 
  3.834719989356486*^9},
 CellLabel->
  "Out[354]=",ExpressionUUID->"1337c3d3-d445-428f-8a1a-6fe3c008fac4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"\[Lambda]1", " ", "\[Lambda]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"p1", ".", "p2"}]}], ")"}]}], 
       RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}]]], " ", "\[Pi]", " ", 
     "\[Mu]1", " ", "\[Mu]2"}], 
    RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "+", 
     FractionBox[
      RowBox[{"\[Lambda]1", " ", "\[Lambda]2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"p1", ".", "p2"}]}], ")"}]}], 
      RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}]]}]], "-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[Lambda]1", " ", "\[Lambda]2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"p1", ".", "p2"}]}], ")"}]}], 
         RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}]]], " ", "\[Pi]", " ", 
       "\[Lambda]2", " ", "\[Mu]1", " ", "\[Mu]2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Lambda]1", "4"], "+", 
         RowBox[{
          SuperscriptBox["\[Lambda]1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", "\[Lambda]1"}], ")"}], " ", "\[Lambda]2"}], "+", 
         RowBox[{"\[Lambda]1", " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", "\[Lambda]1"}], ")"}], " ", 
          SuperscriptBox["\[Lambda]2", "2"]}], "+", 
         SuperscriptBox["\[Lambda]2", "3"], "-", 
         RowBox[{
          SuperscriptBox["\[Lambda]1", "2"], " ", 
          RowBox[{"p1", ".", "p2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Lambda]1"}], ")"}], " ", 
             "\[Lambda]1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Lambda]2"}], ")"}], " ", 
             "\[Lambda]2"}], "+", 
            RowBox[{"\[Lambda]1", " ", "\[Lambda]2", " ", 
             RowBox[{"p1", ".", "p2"}]}]}], ")"}]}]}], ")"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"k", "-", "1"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Lambda]1", "2"], "+", 
        RowBox[{"\[Lambda]1", " ", "\[Lambda]2"}], "+", 
        SuperscriptBox["\[Lambda]2", "2"], "+", 
        RowBox[{"\[Lambda]1", " ", "\[Lambda]2", " ", 
         RowBox[{"p1", ".", "p2"}]}]}], ")"}], "2"]}]]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Lambda]1", "*", 
      RowBox[{"\[Lambda]2", "/", 
       RowBox[{"(", 
        RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}], "\[Rule]", 
     "c1"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Dot", "[", 
      RowBox[{"p1", ",", "p2"}], "]"}], "\[Rule]", "c2"}], ",", 
    "\[IndentingNewLine]", "  ", 
    RowBox[{
     RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "-", 
      RowBox[{"c1", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "c2"}], ")"}]}]}], "\[Rule]", "\[Lambda]3"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.8347199480560126`*^9, 3.834719976857131*^9}, {
   3.8347200472649393`*^9, 3.834720075981324*^9}, {3.8347204400144396`*^9, 
   3.834720467676073*^9}, 3.8347205011149483`*^9},
 CellLabel->
  "In[357]:=",ExpressionUUID->"55769050-e0c2-4e90-be85-d195a7b9c669"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"c1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"p1", ".", "p2"}]}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "\[Pi]", " ", "\[Lambda]2",
      " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[Lambda]1", "4"], "+", 
       RowBox[{
        SuperscriptBox["\[Lambda]1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "\[Lambda]1"}], ")"}], " ", "\[Lambda]2"}], "+", 
       RowBox[{"\[Lambda]1", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Lambda]1"}], ")"}], " ", 
        SuperscriptBox["\[Lambda]2", "2"]}], "+", 
       SuperscriptBox["\[Lambda]2", "3"], "-", 
       RowBox[{"c2", " ", 
        SuperscriptBox["\[Lambda]1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Lambda]1"}], ")"}], " ", 
           "\[Lambda]1"}], "+", 
          RowBox[{"c2", " ", "\[Lambda]1", " ", "\[Lambda]2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Lambda]2"}], ")"}], " ", 
           "\[Lambda]2"}]}], ")"}]}]}], ")"}], " ", "\[Mu]1", " ", "\[Mu]2"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Lambda]1", "2"], "+", 
        RowBox[{"\[Lambda]1", " ", "\[Lambda]2"}], "+", 
        RowBox[{"c2", " ", "\[Lambda]1", " ", "\[Lambda]2"}], "+", 
        SuperscriptBox["\[Lambda]2", "2"]}], ")"}], "2"]}]]}], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"c1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"p1", ".", "p2"}]}], ")"}]}]], " ", "\[Pi]", " ", "\[Mu]1", 
    " ", "\[Mu]2"}], 
   RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "+", 
    RowBox[{"c1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"p1", ".", "p2"}]}], ")"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.8347199567611437`*^9, 3.8347199777433233`*^9}, {
   3.834720054773641*^9, 3.8347200765700936`*^9}, 3.8347204687135715`*^9},
 CellLabel->
  "Out[357]=",ExpressionUUID->"1f7e5625-138d-4f6a-bdcc-87c10b3d60c5"]
}, Open  ]]
},
WindowSize->{1082, 745},
WindowMargins->{{Automatic, 335}, {9, Automatic}},
TaggingRules->{"PresenterSettings" -> {"Dialogs" -> {}}},
CellContext->Notebook,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->FrontEnd`FileName[{"PresenterTools"}, "Default.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 66447, 1337, 4817, "Input",ExpressionUUID->"de46ef57-a359-4ec4-a7d3-aea9f5198032"],
Cell[67030, 1361, 16494, 308, 665, "Output",ExpressionUUID->"4b179a6e-9982-44a1-81e5-b4e98d0b7220"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83561, 1674, 644, 18, 67, "Input",ExpressionUUID->"380cc0c5-97c7-4359-84a4-ba52067e148e"],
Cell[84208, 1694, 229, 5, 49, "Output",ExpressionUUID->"ac893b92-59bd-4e67-b2e2-dafba86aa164"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84474, 1704, 762, 18, 48, "Input",ExpressionUUID->"0750f98a-ebac-4ea9-815f-a222330b55ed"],
Cell[85239, 1724, 1011, 26, 75, "Output",ExpressionUUID->"6cc6e744-7909-4e32-9091-e61e57a75fe4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86287, 1755, 471, 13, 28, "Input",ExpressionUUID->"0684a174-05fa-4a9a-b029-c2ac4b3cdc7f"],
Cell[86761, 1770, 330, 8, 32, "Output",ExpressionUUID->"18f199dc-e2da-4db3-b86b-a3164331957f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87128, 1783, 1177, 30, 71, "Input",ExpressionUUID->"32261a81-0277-4c03-ba34-bdeac217b2d0"],
Cell[88308, 1815, 4701, 112, 135, "Output",ExpressionUUID->"1337c3d3-d445-428f-8a1a-6fe3c008fac4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93046, 1932, 3655, 99, 192, "Input",ExpressionUUID->"55769050-e0c2-4e90-be85-d195a7b9c669"],
Cell[96704, 2033, 2512, 70, 100, "Output",ExpressionUUID->"1f7e5625-138d-4f6a-bdcc-87c10b3d60c5"]
}, Open  ]]
}
]
*)

