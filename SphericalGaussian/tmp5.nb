(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49474,       1105]
NotebookOptionsPosition[     47189,       1060]
NotebookOutlinePosition[     47588,       1077]
CellTagsIndexPosition[     47545,       1074]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"CellContext", "\[Rule]", "Notebook"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3DEx`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBlochSphere`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gTexStyles`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightDir", ",", "dynViewPt", ",", "debugViewPoint", ",", "viewPoint", ",",
     "realViewDir", ",", "\[IndentingNewLine]", "\t", "horzCenter", ",", 
    "horzNormal", ",", "vertCenter", ",", "vertNormal", ",", "reflPeakPt", 
    ",", "\[IndentingNewLine]", "\t", "reflLightingFunc", ",", "reflAsgLight",
     ",", "reflAsgEnergy", ",", "asgDisplayPt", ",", "\[IndentingNewLine]", 
    "\t", "reflDisplayAsg", ",", "sgndf", ",", "sgndfEnergy", ",", 
    "reflShading"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"lightDir", "=", 
      RowBox[{"Normalize", "@", 
       RowBox[{"{", 
        RowBox[{"lightDirX", ",", 
         RowBox[{"-", "1"}], ",", "lightDirZ"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dynViewPt", "=", 
      RowBox[{
       RowBox[{"Options", "[", 
        RowBox[{"Graphics3D", ",", "ViewPoint"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"debugViewPoint", "=", 
      RowBox[{"Dynamic", "[", "dynViewPt", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "debugViewPoint", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"viewPoint", "=", 
      RowBox[{"{", 
       RowBox[{"1.3", ",", 
        RowBox[{"-", "2.4"}], ",", "2"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"realViewDir", "=", 
      RowBox[{"Normalize", "[", 
       RowBox[{"viewPoint", "-", "shadingPt"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"normals", " ", "for", " ", "rectangle"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"horzNormal", "=", 
      RowBox[{"Normalize", "@", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vertNormal", "=", 
      RowBox[{"Normalize", "@", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "1"}], ",", "0"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"horzCenter", "=", 
      RowBox[{"Normalize", "@", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"-", "0.5"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vertCenter", "=", 
      RowBox[{"Normalize", "@", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"reflPeakPt", "=", 
      RowBox[{"gCalcPeakPoint", "[", 
       RowBox[{
       "vertNormal", ",", "vertCenter", ",", "lightDir", ",", "shadingPt"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reflLightingFunc", "[", "reflPt_", "]"}], ":=", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "reflViewPt", ",", "reflView", ",", "reflHalf", ",", "noh", ",", 
          "nol", ",", "lighting"}], "}"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"reflViewPt", "=", "shadingPt"}], ";", "\[IndentingNewLine]", 
         RowBox[{"reflView", "=", 
          RowBox[{"Normalize", "[", 
           RowBox[{"reflViewPt", "-", "reflPt"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"reflHalf", "=", 
          RowBox[{"Normalize", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"reflView", "+", "lightDir"}], ")"}], "/", "2"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"noh", "=", 
          RowBox[{"Dot", "[", 
           RowBox[{"vertNormal", ",", "reflHalf"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nol", "=", 
          RowBox[{"Dot", "[", 
           RowBox[{"vertNormal", ",", "lightDir"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"lighting", "=", 
          RowBox[{
           RowBox[{"gDGGX", "[", 
            RowBox[{"vertRoughness", ",", "noh"}], "]"}], "*", "nol", "*", 
           "lightIntensity"}]}], ";", "\[IndentingNewLine]", "lighting"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"reflAsgLight", "=", 
      RowBox[{"asgReflectLight", "[", 
       RowBox[{
       "shadingPt", ",", "lightDir", ",", "lightIntensity", ",", 
        "vertRoughness", ",", 
        RowBox[{"{", 
         RowBox[{"reflPeakPt", ",", "vertNormal", ",", "samplingRadius"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"asgDisplayPt", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5"}], ",", 
        RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reflDisplayAsg", "=", "reflAsgLight"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reflDisplayAsg", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"-", "1"}], "*", 
       RowBox[{"reflDisplayAsg", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reflAsgEnergy", "=", 
      RowBox[{"asgEnergyEx", "[", "reflAsgLight", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"sgndf", "=", 
      RowBox[{"sgNDF", "[", 
       RowBox[{"horzRoughness", ",", 
        RowBox[{"reflAsgLight", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "realViewDir", ",", 
        "horzNormal"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sgndfEnergy", "=", 
      RowBox[{"sgEnergy", "[", "sgndf", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"reflShading", "=", 
      RowBox[{"asgDotSg", "[", 
       RowBox[{"reflAsgLight", ",", "sgndf"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", "  ", 
        RowBox[{"(*", 
         RowBox[{"horizontal", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
        "  ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pltRect3D", "[", " ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "horzCenter"}], ",", 
              RowBox[{"\"\<normal\>\"", "\[Rule]", "horzNormal"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                 "LightBlue"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", 
            "  ", "]"}], "&"}], "[", 
          RowBox[{"<|", 
           RowBox[{"\"\<roughness\>\"", "\[Rule]", "horzRoughness"}], "|>"}], 
          "]"}], ",", "\[IndentingNewLine]", "  ", 
         RowBox[{"(*", 
          RowBox[{"vertical", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
         "  ", 
         RowBox[{
          RowBox[{
           RowBox[{"pltRect3D", "[", " ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "vertCenter"}], ",", 
              RowBox[{"\"\<normal\>\"", "\[Rule]", "vertNormal"}], ",", 
              RowBox[{"\"\<plotPts\>\"", "\[Rule]", "50"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "0.5"}], ",", 
              RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                 RowBox[{"Hue", "@", 
                  RowBox[{"reflLightingFunc", "[", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}]}], 
                "]"}]}]}], "|>"}], "\[IndentingNewLine]", "  ", "]"}], "&"}], 
          "[", 
          RowBox[{"<|", 
           RowBox[{"\"\<roughness\>\"", "\[Rule]", "vertRoughness"}], "|>"}], 
          "]"}], ",", "\[IndentingNewLine]", "   ", 
         RowBox[{"(*", "points", "*)"}], "\[IndentingNewLine]", "   ", 
         RowBox[{
          RowBox[{
           RowBox[{"pltPoint3D", "[", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<pos\>\"", "\[Rule]", "#shadingPt"}], ",", 
              RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}]}], "|>"}], 
            "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
          RowBox[{"<|", 
           RowBox[{"\"\<shadingPt\>\"", "\[Rule]", "shadingPt"}], "|>"}], 
          "]"}], ",", "\[IndentingNewLine]", "   ", 
         RowBox[{
          RowBox[{
           RowBox[{"pltPoint3D", "[", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<pos\>\"", "\[Rule]", "reflPeakPt"}], ",", 
              RowBox[{"\"\<size\>\"", "\[Rule]", "0.02"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
            "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
          RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", "   ", 
         RowBox[{"(*", 
          RowBox[{"sampling", " ", "area"}], "*)"}], "\[IndentingNewLine]", 
         "   ", 
         RowBox[{
          RowBox[{
           RowBox[{"pltCircle3D", "[", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "reflPeakPt"}], ",", 
              RowBox[{"\"\<normal\>\"", "\[Rule]", "vertNormal"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#radius"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                 "LightGreen"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", 
            "\t", "]"}], "&"}], "[", 
          RowBox[{"<|", 
           RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], "|>"}], 
          "]"}], ",", "\[IndentingNewLine]", "   ", 
         RowBox[{"(*", 
          RowBox[{"ASG", " ", "Reflection", " ", "Light"}], "*)"}], 
         "\[IndentingNewLine]", "   ", 
         RowBox[{
          RowBox[{
           RowBox[{"pltSphere3D", "[", " ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "asgDisplayPt"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.5"}], ",", 
              RowBox[{"\"\<plotPts\>\"", "\[Rule]", "50"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                 RowBox[{"Hue", "@", 
                  RowBox[{"asgVector", "[", 
                   RowBox[{
                    RowBox[{"Normalize", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], "-", 
                    "asgDisplayPt"}], "]"}], ",", "reflDisplayAsg"}], 
                   "]"}]}]}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", "]"}],
            "&"}], "[", 
          RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", "   ", 
         RowBox[{"(*", 
          RowBox[{"light", " ", "direction"}], "*)"}], "\[IndentingNewLine]", 
         "   ", 
         RowBox[{
          RowBox[{
           RowBox[{"pltArrow3D", "[", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<origin\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<dir\>\"", "\[Rule]", 
               RowBox[{"-", "lightDir"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}]}], "|>"}], 
            "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
          RowBox[{"<|", "|>"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "    ", 
       RowBox[{"showProps3D", "[", 
        RowBox[{"1", ",", "Large"}], "]"}], ",", "\[IndentingNewLine]", "   ", 
       RowBox[{"ViewPoint", "\[Rule]", 
        RowBox[{"Dynamic", "[", "dynViewPt", "]"}]}]}], "\[IndentingNewLine]",
       " ", "]"}]}], ",", "\[IndentingNewLine]", "   ", "\[IndentingNewLine]",
     "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"horzRoughness", ",", "0.1"}], "}"}], ",", "0.01", ",", 
      "0.99"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vertRoughness", ",", "0.1"}], "}"}], ",", "0.01", ",", 
      "0.99"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lightDirX", ",", 
        RowBox[{"-", "0.5"}]}], "}"}], ",", 
      RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
    "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lightDirZ", ",", "1"}], "}"}], ",", "0.5", ",", "1"}], "}"}], 
    ",", "\[IndentingNewLine]", "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "0", ",", "1"}], 
     "}"}], ",", "\[IndentingNewLine]", "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"shadingPt", ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.35", ",", 
          RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "0.5"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "1", ",", 
        RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    "   ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"samplingRadius", ",", "0.3"}], "}"}], ",", "0.1", ",", "1"}], 
     "}"}], ",", "\[IndentingNewLine]", "   ", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"sgndf1", ",", "sgndf"}], "}"}], "}"}], ",", 
    "\[IndentingNewLine]", "   ", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"sgndfEnergy1", ",", "sgndfEnergy"}], "}"}], "}"}], ",", 
    "\[IndentingNewLine]", "   ", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"reflAsgLight1", ",", "reflAsgLight"}], "}"}], "}"}], ",", 
    "\[IndentingNewLine]", "   ", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"reflAsgEnergy1", ",", "reflAsgEnergy"}], "}"}], "}"}], ",", 
    "\[IndentingNewLine]", "   ", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"reflShading1", ",", "reflShading"}], "}"}], "}"}], ",", 
    "\[IndentingNewLine]", "    ", 
    RowBox[{"Method", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.835670701288266*^9, 3.835670712370261*^9}, {
   3.835671054711174*^9, 3.835671077088069*^9}, {3.8356711285676064`*^9, 
   3.835671184412266*^9}, {3.8356712950557876`*^9, 3.8356713715236235`*^9}, {
   3.835671521828059*^9, 3.8356715726086674`*^9}, 3.835671827792815*^9, 
   3.835674111193063*^9, {3.8356762817894545`*^9, 3.835676293886113*^9}, {
   3.835676324795972*^9, 3.835676360602216*^9}, {3.8356763995761595`*^9, 
   3.835676725016245*^9}, {3.835679490023012*^9, 3.8356795680199547`*^9}, {
   3.8356803970604877`*^9, 3.8356804810349846`*^9}, {3.835680515796523*^9, 
   3.8356805338100834`*^9}, {3.8356805693497124`*^9, 
   3.8356806800033407`*^9}, {3.8356807581180296`*^9, 3.835680791100999*^9}, {
   3.8356808346519976`*^9, 3.835680861859683*^9}, {3.835681016999529*^9, 
   3.835681040165759*^9}, {3.8356875328238273`*^9, 3.8356876050340366`*^9}, 
   3.8356877635700397`*^9, {3.8356880922818356`*^9, 3.835688093163101*^9}, {
   3.8356883342389374`*^9, 3.8356883346059723`*^9}, 3.835688448974818*^9, {
   3.83568853846344*^9, 3.8356885407571945`*^9}, {3.835688618032502*^9, 
   3.835688619090272*^9}, {3.8356888857187176`*^9, 3.835688947400548*^9}, 
   3.8356892378555956`*^9, {3.8357353990202866`*^9, 3.835735429252323*^9}, {
   3.8357358822304306`*^9, 3.8357359360933633`*^9}, {3.8357360942292147`*^9, 
   3.835736095015504*^9}, {3.835736142824606*^9, 3.835736239359292*^9}, 
   3.835736299253292*^9, {3.8357363317684517`*^9, 3.83573637847194*^9}, {
   3.8357365112682996`*^9, 3.8357366066329913`*^9}, 3.835736647245437*^9, {
   3.8357376152377133`*^9, 3.835737617586599*^9}, {3.835737981013405*^9, 
   3.8357382720179806`*^9}, {3.835738305012949*^9, 3.8357383583453407`*^9}, {
   3.8357384029877253`*^9, 3.8357384696433983`*^9}, {3.8357385173698444`*^9, 
   3.8357385790825195`*^9}, 3.835738725076711*^9, 3.83573883297313*^9, {
   3.835738920091546*^9, 3.8357389325655727`*^9}, {3.835738972082717*^9, 
   3.83573900127752*^9}, {3.8357390721094236`*^9, 3.835739091405341*^9}, {
   3.835739375149233*^9, 3.835739468549222*^9}, {3.8357395457288666`*^9, 
   3.8357396729799337`*^9}, {3.8357397031870255`*^9, 
   3.8357398019536047`*^9}, {3.835739964086808*^9, 3.8357399685096583`*^9}, {
   3.835740004544803*^9, 3.8357400487716894`*^9}, {3.8357402304296474`*^9, 
   3.835740274096136*^9}, {3.835740349753442*^9, 3.8357403512642393`*^9}, 
   3.835740414884508*^9, 3.8357408113353715`*^9, {3.835741038825101*^9, 
   3.8357410397769413`*^9}, {3.8357413600054717`*^9, 
   3.8357413615770693`*^9}, {3.835741827839464*^9, 3.8357418351420193`*^9}, {
   3.835753240746601*^9, 3.8357532450988073`*^9}, {3.835753284499771*^9, 
   3.835753295162857*^9}, {3.835753363187603*^9, 3.835753413507699*^9}, 
   3.8357535108048105`*^9, {3.8357539848429365`*^9, 3.835753986708721*^9}, {
   3.835754025207201*^9, 3.835754059842146*^9}, {3.835754136299243*^9, 
   3.835754178214035*^9}, {3.835754233334052*^9, 3.8357542584933157`*^9}, {
   3.8357544279354267`*^9, 3.835754436373258*^9}, {3.8357545276808405`*^9, 
   3.835754544731331*^9}, {3.835754602529829*^9, 3.835754648806507*^9}, {
   3.8357570646697006`*^9, 3.8357570727526913`*^9}, {3.835757111264329*^9, 
   3.8357571230480337`*^9}, {3.8357571863435526`*^9, 
   3.8357572126635094`*^9}, {3.8357572497040014`*^9, 
   3.8357573495359106`*^9}, {3.8357576150716944`*^9, 
   3.8357576250146627`*^9}, {3.835757863563367*^9, 3.835757888455716*^9}, {
   3.8357580911862197`*^9, 3.835758121011235*^9}, {3.835758662866884*^9, 
   3.8357588447024827`*^9}, {3.8357588757427177`*^9, 3.835758877517865*^9}, {
   3.835758909871806*^9, 3.8357589214297333`*^9}, {3.835760007693113*^9, 
   3.8357601641811028`*^9}, {3.8357602809005337`*^9, 3.835760352693851*^9}, {
   3.835760541003414*^9, 3.835760549126495*^9}, {3.8357605898505154`*^9, 
   3.835760678829238*^9}, {3.8357607207178416`*^9, 3.835760771371914*^9}, {
   3.8357622064413366`*^9, 3.8357622790124273`*^9}, {3.835762313123645*^9, 
   3.8357623136491237`*^9}, {3.8357627510539804`*^9, 
   3.8357627554031444`*^9}, {3.8357629327942963`*^9, 
   3.8357629868700476`*^9}, {3.835763041603657*^9, 3.8357631881377325`*^9}, 
   3.8357632353446617`*^9, {3.835763777330101*^9, 3.8357638040892963`*^9}, {
   3.8357639720101004`*^9, 3.835764231770074*^9}, {3.835764368384879*^9, 
   3.8357644196436033`*^9}, {3.835764586057603*^9, 3.8357645875542994`*^9}, {
   3.8357647027077465`*^9, 3.835764733955415*^9}, {3.8357648015209446`*^9, 
   3.8357648395865297`*^9}, {3.83576489139421*^9, 3.8357649038624706`*^9}, {
   3.8357651124825497`*^9, 3.83576511341401*^9}, {3.835765162830226*^9, 
   3.835765165755761*^9}, {3.835765259475198*^9, 3.8357652939445353`*^9}, 
   3.8357654392766876`*^9, {3.8357656591228557`*^9, 3.835765717124754*^9}, {
   3.835765755262804*^9, 3.835765871890098*^9}, {3.8357659607222524`*^9, 
   3.835766016000598*^9}, {3.8357660516828613`*^9, 3.835766071424608*^9}, {
   3.8357664358353148`*^9, 3.8357664632124815`*^9}, {3.835766504516271*^9, 
   3.8357665080219855`*^9}, {3.835766570726167*^9, 3.8357665795204163`*^9}, {
   3.835822483382369*^9, 3.8358225499653573`*^9}, {3.835822942139061*^9, 
   3.8358230381699834`*^9}, {3.8358231032016153`*^9, 3.835823141702737*^9}, 
   3.83582317568204*^9, {3.8358232295932503`*^9, 3.835823360131756*^9}, {
   3.835823456318616*^9, 3.835823512310676*^9}, {3.8358236764035077`*^9, 
   3.8358236773258963`*^9}, {3.8358260292710595`*^9, 3.835826038670243*^9}, {
   3.835826423444823*^9, 3.8358265723107805`*^9}, {3.8358266147568817`*^9, 
   3.8358266173035655`*^9}, {3.8358266625022097`*^9, 3.8358266711308155`*^9}, 
   3.8358267031127253`*^9, {3.8358267335766387`*^9, 3.8358267407946615`*^9}, {
   3.835826810547619*^9, 3.835826852988552*^9}, 3.835826980147374*^9, {
   3.8358276325078793`*^9, 3.8358276523032556`*^9}, 3.835827962347533*^9, {
   3.8358280443154216`*^9, 3.835828087738422*^9}, 3.8358281459414263`*^9, {
   3.835828431215108*^9, 3.835828460938102*^9}, {3.835836138304884*^9, 
   3.835836262358919*^9}, 3.835836311778715*^9, {3.8358365451676097`*^9, 
   3.8358365792536097`*^9}, {3.8358372391590652`*^9, 
   3.8358372552019377`*^9}, {3.8358372853679466`*^9, 
   3.8358373861157827`*^9}, {3.8358376189909883`*^9, 
   3.8358376903092103`*^9}, {3.8358379872708416`*^9, 
   3.8358380424232316`*^9}, {3.8358382851129265`*^9, 3.835838499543785*^9}, {
   3.8358386026885195`*^9, 3.8358388293045015`*^9}, {3.8358389105083838`*^9, 
   3.835838939285411*^9}, {3.8358389738813343`*^9, 3.835838976059703*^9}, {
   3.835839272331639*^9, 3.8358392727337775`*^9}, {3.83583930985205*^9, 
   3.8358393367886887`*^9}, {3.835839391821905*^9, 3.835839508020535*^9}, {
   3.835840196020256*^9, 3.83584026622651*^9}, {3.8358403370200396`*^9, 
   3.835840349035859*^9}, {3.835840397680949*^9, 3.835840563484748*^9}, {
   3.835840780182455*^9, 3.835840870814933*^9}, {3.83584090178135*^9, 
   3.8358410096261644`*^9}, {3.835841472198824*^9, 3.8358415092879033`*^9}, {
   3.8358441181696315`*^9, 3.83584418010133*^9}, {3.835844263397464*^9, 
   3.8358443426491055`*^9}, {3.835844488025111*^9, 3.8358444929183245`*^9}, {
   3.835844568991685*^9, 3.835844611044815*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"cadb2597-bca6-4ce0-9212-64077c71bd89"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sg01", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.08"}], "+", "0.1"}], ",", 
        RowBox[{"0.7783", "+", "0.1"}], ",", 
        RowBox[{"0.6226", "+", "0.1"}]}], "}"}]}], ",", "80", ",", "1"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sgE01", "=", 
  RowBox[{
   RowBox[{"sgEnergy", "[", "sg01", "]"}], "//", 
   "N"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"asg01", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.08"}], ",", "0.7783", ",", "0.6226"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.9916556173432377`", ",", "0.`", ",", "0.1289152302546209`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.10033556345783397`", ",", "0.6278845198785931`", ",", 
       RowBox[{"-", "0.7718120265987228`"}]}], "}"}], ",", 
     "14.062291109618892`", ",", "21.651231911491642`", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"asgE01", "=", 
   RowBox[{"asgEnergyEx", "[", "asg01", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sg02", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "80", ",", "1"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"asgDotSg", "[", 
   RowBox[{"asg01", ",", "sg01"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"sgDot", "[", 
      RowBox[{"sg01", ",", "sg02"}], "]"}], "//", 
     RowBox[{"N", "\[IndentingNewLine]", 
      RowBox[{"sgProductIntegral", "[", 
       RowBox[{"sg01", ",", "sg02"}], "]"}]}]}], "//", "N"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8358436406670246`*^9, 3.835843677958351*^9}, {
  3.8358448283843307`*^9, 3.8358448952237716`*^9}, {3.835845048621834*^9, 
  3.835845116652738*^9}, {3.8358451600604343`*^9, 3.8358451870607324`*^9}, {
  3.835845335661515*^9, 3.835845559980213*^9}, {3.835845648174348*^9, 
  3.8358457004300995`*^9}, {3.8358459050882654`*^9, 3.83584591291004*^9}, {
  3.8358459474216146`*^9, 3.8358459608708687`*^9}, {3.835846394896817*^9, 
  3.8358466214932175`*^9}},ExpressionUUID->"c0acf3ef-2c6b-4e14-8695-\
ab41373b2024"],

Cell[BoxData["0.07853981633974483`"], "Output",
 CellChangeTimes->{{3.8358436734917583`*^9, 3.835843678439552*^9}, {
   3.8358448327334027`*^9, 3.8358448965226083`*^9}, {3.835845084716425*^9, 
   3.8358450976826363`*^9}, {3.8358451658117924`*^9, 3.835845187528714*^9}, 
   3.8358453125818357`*^9, 3.8358453633601832`*^9, {3.8358454035550213`*^9, 
   3.8358455605117674`*^9}, {3.835845621628376*^9, 3.8358457008242955`*^9}, {
   3.835845806068036*^9, 3.8358458287252903`*^9}, {3.835845906110671*^9, 
   3.8358459133472977`*^9}, {3.8358459487678685`*^9, 3.835845961288059*^9}, {
   3.8358463963206654`*^9, 3.835846418899205*^9}, {3.83584645360321*^9, 
   3.835846523187747*^9}, {3.8358465706099777`*^9, 3.835846593963249*^9}},
 CellLabel->
  "Out[553]=",ExpressionUUID->"918aa22a-2a3d-4e1e-838f-9985411bce70"],

Cell[BoxData["0.18004477592438847`"], "Output",
 CellChangeTimes->{{3.8358436734917583`*^9, 3.835843678439552*^9}, {
   3.8358448327334027`*^9, 3.8358448965226083`*^9}, {3.835845084716425*^9, 
   3.8358450976826363`*^9}, {3.8358451658117924`*^9, 3.835845187528714*^9}, 
   3.8358453125818357`*^9, 3.8358453633601832`*^9, {3.8358454035550213`*^9, 
   3.8358455605117674`*^9}, {3.835845621628376*^9, 3.8358457008242955`*^9}, {
   3.835845806068036*^9, 3.8358458287252903`*^9}, {3.835845906110671*^9, 
   3.8358459133472977`*^9}, {3.8358459487678685`*^9, 3.835845961288059*^9}, {
   3.8358463963206654`*^9, 3.835846418899205*^9}, {3.83584645360321*^9, 
   3.835846523187747*^9}, {3.8358465706099777`*^9, 3.835846593975232*^9}},
 CellLabel->
  "Out[555]=",ExpressionUUID->"5e1cbbf1-755a-4103-b7b3-db71ae628136"],

Cell[BoxData["0.8978815356736225`"], "Output",
 CellChangeTimes->{{3.8358436734917583`*^9, 3.835843678439552*^9}, {
   3.8358448327334027`*^9, 3.8358448965226083`*^9}, {3.835845084716425*^9, 
   3.8358450976826363`*^9}, {3.8358451658117924`*^9, 3.835845187528714*^9}, 
   3.8358453125818357`*^9, 3.8358453633601832`*^9, {3.8358454035550213`*^9, 
   3.8358455605117674`*^9}, {3.835845621628376*^9, 3.8358457008242955`*^9}, {
   3.835845806068036*^9, 3.8358458287252903`*^9}, {3.835845906110671*^9, 
   3.8358459133472977`*^9}, {3.8358459487678685`*^9, 3.835845961288059*^9}, {
   3.8358463963206654`*^9, 3.835846418899205*^9}, {3.83584645360321*^9, 
   3.835846523187747*^9}, {3.8358465706099777`*^9, 3.8358465939772263`*^9}},
 CellLabel->
  "Out[557]=",ExpressionUUID->"08c8e525-80b4-4368-b81b-d81967c7b014"],

Cell[BoxData["9.605715253330055`*^-9"], "Output",
 CellChangeTimes->{{3.8358436734917583`*^9, 3.835843678439552*^9}, {
   3.8358448327334027`*^9, 3.8358448965226083`*^9}, {3.835845084716425*^9, 
   3.8358450976826363`*^9}, {3.8358451658117924`*^9, 3.835845187528714*^9}, 
   3.8358453125818357`*^9, 3.8358453633601832`*^9, {3.8358454035550213`*^9, 
   3.8358455605117674`*^9}, {3.835845621628376*^9, 3.8358457008242955`*^9}, {
   3.835845806068036*^9, 3.8358458287252903`*^9}, {3.835845906110671*^9, 
   3.8358459133472977`*^9}, {3.8358459487678685`*^9, 3.835845961288059*^9}, {
   3.8358463963206654`*^9, 3.835846418899205*^9}, {3.83584645360321*^9, 
   3.835846523187747*^9}, {3.8358465706099777`*^9, 3.8358465939792213`*^9}},
 CellLabel->
  "Out[558]=",ExpressionUUID->"32ce145c-134a-4f99-b63f-6c1053a43399"],

Cell[BoxData["1.9908653309069255`*^-8"], "Output",
 CellChangeTimes->{{3.8358436734917583`*^9, 3.835843678439552*^9}, {
   3.8358448327334027`*^9, 3.8358448965226083`*^9}, {3.835845084716425*^9, 
   3.8358450976826363`*^9}, {3.8358451658117924`*^9, 3.835845187528714*^9}, 
   3.8358453125818357`*^9, 3.8358453633601832`*^9, {3.8358454035550213`*^9, 
   3.8358455605117674`*^9}, {3.835845621628376*^9, 3.8358457008242955`*^9}, {
   3.835845806068036*^9, 3.8358458287252903`*^9}, {3.835845906110671*^9, 
   3.8358459133472977`*^9}, {3.8358459487678685`*^9, 3.835845961288059*^9}, {
   3.8358463963206654`*^9, 3.835846418899205*^9}, {3.83584645360321*^9, 
   3.835846523187747*^9}, {3.8358465706099777`*^9, 3.835846593981248*^9}},
 CellLabel->
  "Out[559]=",ExpressionUUID->"d740b6fc-89e7-4fde-b412-053ca8b26887"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gDGGX", "[", 
  RowBox[{"0.1", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.8358438161627398`*^9, 3.8358438343466487`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"92f3338c-4e16-44e2-9bc2-823c13455a12"],

Cell[BoxData["31.830988618379017`"], "Output",
 CellChangeTimes->{{3.8358438245753703`*^9, 3.835843834680196*^9}},
 CellLabel->"Out[32]=",ExpressionUUID->"3cd2d1dc-b139-426d-ab0e-22747ded3866"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"a", ",", "b", ",", "c", ",", "p1", ",", "p2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"Plot", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sgPolar", "[", 
         RowBox[{"\[Theta]", ",", 
          RowBox[{"2", "\[Lambda]"}], ",", "1"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"asgPolar", "[", 
         RowBox[{"\[Theta]", ",", 
          RowBox[{
           RowBox[{"\[Pi]", "/", "2"}], "-", "\[Theta]"}], ",", 
          RowBox[{"\[Pi]", "/", "2"}], ",", "\[Lambda]", ",", "\[Lambda]", 
          ",", "1"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]", ",", "2", ",", "20"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8358461974607735`*^9, 3.83584620555521*^9}, {
   3.8358462414765797`*^9, 3.835846256339672*^9}, {3.8358466259712534`*^9, 
   3.83584674307537*^9}, 3.835846847999342*^9, {3.8358469153659744`*^9, 
   3.8358469540059767`*^9}, {3.8358469958118453`*^9, 3.835847119995497*^9}, 
   3.8358471638529015`*^9},
 CellLabel->
  "In[611]:=",ExpressionUUID->"7222e3b1-7582-4fe2-9db5-2873997643fb"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Lambda]$$ = 3.98, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`\[Lambda]$$], 2, 20}}, Typeset`size$$ = {
    396., {119., 125.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`\[Lambda]$12955769$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`\[Lambda]$$ = 2}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Lambda]$$, $CellContext`\[Lambda]$12955769$$, 0]},
       "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[{
         sgCommon`sgPolar[$CellContext`\[Theta], 2 $CellContext`\[Lambda]$$, 
          1], 
         sgCommon`asgPolar[$CellContext`\[Theta], 
          Pi/2 - $CellContext`\[Theta], Pi/
          2, $CellContext`\[Lambda]$$, $CellContext`\[Lambda]$$, 
          1]}, {$CellContext`\[Theta], 0, Pi/2}], 
      "Specifications" :> {{$CellContext`\[Lambda]$$, 2, 20}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{451., {169., 176.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.835846743581278*^9, 3.8358469544747734`*^9, 3.8358469973216743`*^9, {
   3.8358470825073586`*^9, 3.8358471205818415`*^9}, {3.835847160777935*^9, 
   3.835847164473545*^9}},
 CellLabel->
  "Out[612]=",ExpressionUUID->"4ab5b21f-bb63-445f-8075-e376e6635e53"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"sgPolar", "[", 
  RowBox[{"0.1", ",", "a", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"asgVector", "[", 
  RowBox[{"0.1", ",", 
   RowBox[{
    RowBox[{"\[Pi]", "/", "2"}], "-", "0.1"}], ",", 
   RowBox[{"\[Pi]", "/", "2"}], ",", "\[Lambda]2", ",", "b", ",", "1"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.835846779283205*^9, 3.8358468117870927`*^9}, {
  3.8358469235840416`*^9, 3.835846924565014*^9}, {3.835846973386942*^9, 
  3.8358469803230515`*^9}},
 CellLabel->
  "In[637]:=",ExpressionUUID->"d47cd4cd-3d02-4b86-a9a2-5ab1c1fdc17b"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   RowBox[{"-", "0.0049958347219741794`"}], " ", "a"}]]], "Output",
 CellChangeTimes->{{3.8358467752256355`*^9, 3.8358467797847753`*^9}, 
   3.8358468123817196`*^9, 3.8358469250329733`*^9, {3.8358469816042495`*^9, 
   3.8358469890668697`*^9}, 3.835848724299121*^9},
 CellLabel->
  "Out[637]=",ExpressionUUID->"864635b3-6b58-4882-8683-f45f9197ddbb"],

Cell[BoxData[
 RowBox[{"asgVector", "[", 
  RowBox[{"0.1`", ",", "1.4707963267948965`", ",", 
   FractionBox["\[Pi]", "2"], ",", "5", ",", "b", ",", "1"}], "]"}]], "Output",
 CellChangeTimes->{{3.8358467752256355`*^9, 3.8358467797847753`*^9}, 
   3.8358468123817196`*^9, 3.8358469250329733`*^9, {3.8358469816042495`*^9, 
   3.8358469890668697`*^9}, 3.8358487243076124`*^9},
 CellLabel->
  "Out[638]=",ExpressionUUID->"7fc6ba4a-2d65-44e5-ab81-93a8dd51c7ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Plot", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"4", " ", 
             SuperscriptBox["m", "4"]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["m", "2"], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["m", "2"]}], ")"}], " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Theta]L", "-", 
                  RowBox[{"ArcTan", "[", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Sec", "[", "\[Theta]L", "]"}], "2"], " ", 
                    RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "+", 
                    RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]}], 
                 "]"}]}]}], ")"}], "2"]], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "0", ",", "\[Theta]a"}], "}"}]}], "]"}], 
         "*", 
         RowBox[{"gDGGX", "[", 
          RowBox[{"m", ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               SqrtBox["\[Pi]"], " ", 
               RowBox[{"Erf", "[", 
                RowBox[{
                 SqrtBox["k"], " ", 
                 RowBox[{"Sin", "[", "\[Theta]a", "]"}]}], "]"}]}], 
              RowBox[{"2", " ", 
               SqrtBox["k"]}]], "*", 
             RowBox[{"gDGGX", "[", 
              RowBox[{"m", ",", "1"}], "]"}]}], ")"}], "/.", 
           RowBox[{"k", "->", 
            FractionBox[
             RowBox[{"0.233", " ", 
              RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
             RowBox[{"m", "^", "2"}]]}]}], ","}], "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SqrtBox["\[Pi]"], 
            RowBox[{"2", " ", 
             SqrtBox["k"]}]], 
           RowBox[{"Min", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", 
               SqrtBox["k"], 
               RowBox[{"Sin", "[", " ", "\[Theta]a", "]"}]}], 
              SqrtBox["\[Pi]"]], ",", "1"}], "]"}], "*", 
           RowBox[{"gDGGX", "[", 
            RowBox[{"m", ",", "1"}], "]"}]}], ")"}], "/.", 
         RowBox[{"k", "->", 
          FractionBox[
           RowBox[{"0.233", " ", 
            RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
           RowBox[{"m", "^", "2"}]]}]}]}], "\[IndentingNewLine]", "        ", 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\[Theta]a", ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "*)"}], "]"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "0.1"}], "}"}], ",", "0.01", ",", "0.9"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]L", ",", 
        RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", 
      RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.835845819512385*^9, 3.8358458203406878`*^9}, {
  3.835846165418825*^9, 3.835846190252902*^9}, {3.835846767239151*^9, 
  3.8358467726877174`*^9}},ExpressionUUID->"f883c28c-a2d2-4b8e-952c-\
e7d05fd33890"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.8358439315884013`*^9, 3.8358439396986356`*^9}, 
   3.8358461815028205`*^9, 3.8358467694635396`*^9},
 CellLabel->
  "Out[575]=",ExpressionUUID->"df5805eb-8fc6-4a38-9a56-5f2eadfdaaa5"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`m$$ = 0.1, $CellContext`\[Theta]L$$ = 
    Rational[1, 4] Pi, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`m$$], 0.1}, 0.01, 0.9}, {{
       Hold[$CellContext`\[Theta]L$$], Rational[1, 4] Pi}, 0, Rational[1, 2] 
      Pi}}, Typeset`size$$ = {396., {119., 125.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`m$12803310$$ = 0, $CellContext`\[Theta]L$12803311$$ = 
    0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`m$$ = 0.1, $CellContext`\[Theta]L$$ = 
        Rational[1, 4] Pi}, "ControllerVariables" :> {
        Hold[$CellContext`m$$, $CellContext`m$12803310$$, 0], 
        Hold[$CellContext`\[Theta]L$$, $CellContext`\[Theta]L$12803311$$, 0]},
       "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Plot[{NIntegrate[
          4 $CellContext`m$$^4/(
            1 + $CellContext`m$$^2 + (-1 + $CellContext`m$$^2) 
             Cos[$CellContext`\[Theta]L$$ - ArcTan[
               Sec[$CellContext`\[Theta]L$$]^2 Tan[$CellContext`\[Theta]] + 
                Tan[$CellContext`\[Theta]L$$]]])^2, {$CellContext`\[Theta], 
            0, $CellContext`\[Theta]a}] gBRDF`gDGGX[$CellContext`m$$, 1], 
         ReplaceAll[(Sqrt[Pi]/(2 Sqrt[$CellContext`k])) 
          Min[2 Sqrt[$CellContext`k] Sin[$CellContext`\[Theta]a]/Sqrt[Pi], 1] 
          gBRDF`gDGGX[$CellContext`m$$, 1], $CellContext`k -> 
          0.233 Cos[$CellContext`\[Theta]L$$]/$CellContext`m$$^2]}, \
{$CellContext`\[Theta]a, 0, Pi/2}], 
      "Specifications" :> {{{$CellContext`m$$, 0.1}, 0.01, 
         0.9}, {{$CellContext`\[Theta]L$$, Rational[1, 4] Pi}, 0, 
         Rational[1, 2] Pi}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{451., {184., 191.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8358439315884013`*^9, 3.8358439396986356`*^9}, 
   3.8358461815028205`*^9, 3.8358467694995604`*^9},
 CellLabel->
  "Out[576]=",ExpressionUUID->"96cc98d0-a6a3-4e65-812e-0e87ca234ab8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"myAssert", "[", 
     RowBox[{"test_", ",", "msg_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"Assert", "[", 
       RowBox[{"test", ",", "msg"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{"i_", ",", "callFrom_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "k", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"k", "=", "i"}], ";", "\[IndentingNewLine]", 
       RowBox[{"msg1", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"callFrom", ",", "\"\<func\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myAssert", "[", 
        RowBox[{
         RowBox[{"k", ">", "0"}], ",", "msg1"}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"func1", "[", "i_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"func", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", "\"\<func1\>\"", "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"func1", "[", 
  RowBox[{"-", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.835847968164816*^9, 3.8358479681652627`*^9}, {
  3.8358480475269585`*^9, 3.835848063079176*^9}, {3.8358481095488205`*^9, 
  3.8358481131691694`*^9}, {3.8358482704934664`*^9, 3.835848401502473*^9}, {
  3.8358484420760727`*^9, 3.835848477448693*^9}, {3.8358486787535796`*^9, 
  3.8358486789853487`*^9}},
 CellLabel->
  "In[633]:=",ExpressionUUID->"af61c70c-05c5-4bbe-8709-20bc4490ec73"],

Cell[BoxData[
 TemplateBox[{
  "Assert","asrtfe",
   "\"Assertion \\!\\(\\*RowBox[{\\\"False\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Assert\\\", \\\"[\\\", RowBox[{\\\"False\\\", \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\\\\\\\"func1\\\\\\\"\\\", \\\",\\\", \\\"\\\\\
\\\"func\\\\\\\"\\\"}], \\\"}\\\"}]}], \\\"]\\\"}]\\) failed.\"",2,636,138,
   30185220469566489625,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.835847968896978*^9, {3.8358482792193165`*^9, 3.835848292042758*^9}, 
   3.835848332655695*^9, {3.8358483817294855`*^9, 3.835848402338954*^9}, {
   3.8358484682163057`*^9, 3.835848484459717*^9}},
 CellLabel->
  "During evaluation of \
In[633]:=",ExpressionUUID->"4c4f9b29-1bea-4e19-93a7-02209f9c666c"]
}, Open  ]]
},
WindowSize->{1081, 804},
WindowMargins->{{458, Automatic}, {-344, Automatic}},
CellContext->Notebook,
Magnification:>1.1 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 24429, 516, 2343, "Input",ExpressionUUID->"cadb2597-bca6-4ce0-9212-64077c71bd89"],
Cell[CellGroupData[{
Cell[25012, 540, 2405, 64, 297, "Input",ExpressionUUID->"c0acf3ef-2c6b-4e14-8695-ab41373b2024"],
Cell[27420, 606, 807, 11, 36, "Output",ExpressionUUID->"918aa22a-2a3d-4e1e-838f-9985411bce70"],
Cell[28230, 619, 807, 11, 36, "Output",ExpressionUUID->"5e1cbbf1-755a-4103-b7b3-db71ae628136"],
Cell[29040, 632, 808, 11, 36, "Output",ExpressionUUID->"08c8e525-80b4-4368-b81b-d81967c7b014"],
Cell[29851, 645, 811, 11, 38, "Output",ExpressionUUID->"32ce145c-134a-4f99-b63f-6c1053a43399"],
Cell[30665, 658, 810, 11, 38, "Output",ExpressionUUID->"d740b6fc-89e7-4fde-b412-053ca8b26887"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31512, 674, 232, 4, 32, "Input",ExpressionUUID->"92f3338c-4e16-44e2-9bc2-823c13455a12"],
Cell[31747, 680, 193, 2, 36, "Output",ExpressionUUID->"3cd2d1dc-b139-426d-ab0e-22747ded3866"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31977, 687, 1567, 36, 275, "Input",ExpressionUUID->"7222e3b1-7582-4fe2-9db5-2873997643fb"],
Cell[33547, 725, 2141, 43, 366, "Output",ExpressionUUID->"4ab5b21f-bb63-445f-8075-e376e6635e53"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35725, 773, 573, 13, 55, "Input",ExpressionUUID->"d47cd4cd-3d02-4b86-a9a2-5ab1c1fdc17b"],
Cell[36301, 788, 409, 8, 38, "Output",ExpressionUUID->"864635b3-6b58-4882-8683-f45f9197ddbb"],
Cell[36713, 798, 456, 8, 51, "Output",ExpressionUUID->"7fc6ba4a-2d65-44e5-ab81-93a8dd51c7ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37206, 811, 4385, 115, 691, "Input",ExpressionUUID->"f883c28c-a2d2-4b8e-952c-e7d05fd33890"],
Cell[41594, 928, 233, 4, 36, "Output",ExpressionUUID->"df5805eb-8fc6-4a38-9a56-5f2eadfdaaa5"],
Cell[41830, 934, 2831, 53, 396, "Output",ExpressionUUID->"96cc98d0-a6a3-4e65-812e-0e87ca234ab8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44698, 992, 1731, 48, 209, "Input",ExpressionUUID->"af61c70c-05c5-4bbe-8709-20bc4490ec73"],
Cell[46432, 1042, 741, 15, 23, "Message",ExpressionUUID->"4c4f9b29-1bea-4e19-93a7-02209f9c666c"]
}, Open  ]]
}
]
*)

