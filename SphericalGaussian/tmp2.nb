(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27435,        534]
NotebookOptionsPosition[     26792,        515]
NotebookOutlinePosition[     27159,        531]
CellTagsIndexPosition[     27116,        528]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"CellContext", "\[Rule]", "Notebook"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "shadingPt0", ",", "lightDir0", ",", "viewDir0", ",", "halfDir0", ",", 
    "shadingPt1", ",", "lightDir0", ",", "viewDir0", ",", "halfDir0"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"shadingPt0", "=", 
     RowBox[{"gCalcGgxPeakOnPlane", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", "lightPoint", ",", "viewPoint"}],
       "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"lightDir0", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightPoint", "-", "shadingPt0"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"viewDir0", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"viewPoint", "-", "shadingPt0"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"halfDir0", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lightDir0", "+", "viewDir0"}], ")"}], "/", "2"}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"shadingPt1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"shadingPt0", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "shadingPt1Offset"}], ",", 
       "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"lightDir1", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightPoint", "-", "shadingPt1"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"viewDir1", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"viewPoint", "-", "shadingPt1"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"halfDir1", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lightDir1", "+", "viewDir1"}], ")"}], "/", "2"}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\"\<circles\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"view", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "#viewPoint"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}], ",", 
               RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<View\>\""}]}], "|>"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"light", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "#lightPoint"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Magenta"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}], ",", 
               RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<Light\>\""}]}], 
              "|>"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"peak", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "shadingPt0"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"offset", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "shadingPt1"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}]}], "|>"}]}], 
            "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<lightPoint\>\"", "\[Rule]", "lightPoint"}], ",", 
           RowBox[{"\"\<viewPoint\>\"", "\[Rule]", "viewPoint"}]}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<lines\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"half", " ", "dir"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt0"}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "halfDir0"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt1"}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "halfDir1"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}]}], "|>"}]}], 
            "\[IndentingNewLine]", "}"}]}], "&"}], "[", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
       "\[IndentingNewLine]", "|>"}], ",", "Medium"}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightPoint", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewPoint", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPt1Offset", ",", "0.5"}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.1"}], "}"}], ",", "0.01", ",", "0.99"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "lightCenter", ",", "rightWallHeight", ",", "representPt", ",", 
     "representCone", ",", "repSgSolved", ",", "\[IndentingNewLine]", "\t", 
     "wallNormal", ",", "reflectSgAxisPt", ",", "representSG"}], "]"}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8328889412895775`*^9, 3.832888943829444*^9}, 
   3.8329105814363804`*^9, 3.832911658214327*^9, {3.832915422319006*^9, 
   3.832915429550082*^9}, {3.8329154722806787`*^9, 3.832915476772599*^9}, {
   3.832915570542097*^9, 3.8329156282965984`*^9}, {3.832915661051976*^9, 
   3.832915761196766*^9}, {3.832915854105765*^9, 3.8329158545000343`*^9}, 
   3.8329159284747925`*^9, {3.832916038039627*^9, 3.8329160794187365`*^9}, {
   3.8329163010990877`*^9, 3.832916338590598*^9}, {3.8329259282106915`*^9, 
   3.8329260088439074`*^9}, 3.832972206505047*^9, {3.832972578645569*^9, 
   3.8329726211552844`*^9}, {3.832972657934229*^9, 3.832972679476902*^9}, {
   3.8329736515768385`*^9, 3.8329737181620116`*^9}, 3.8329741272349186`*^9, {
   3.8329748391562*^9, 3.8329749519685273`*^9}, {3.832975049742714*^9, 
   3.832975244861807*^9}, {3.832975309946328*^9, 3.83297533243433*^9}, 
   3.8329756992236834`*^9, {3.832976036868046*^9, 3.8329761084378605`*^9}, {
   3.832976280222788*^9, 3.832976289341758*^9}, 3.832976363090472*^9, {
   3.8329765164379635`*^9, 3.832976669459014*^9}, {3.8329767064390707`*^9, 
   3.8329767102798*^9}, {3.832976768979664*^9, 3.8329767693452764`*^9}, {
   3.8329862161456156`*^9, 3.8329862746932898`*^9}, 3.832986319260833*^9, {
   3.8329866236605783`*^9, 3.8329866940199547`*^9}, {3.8329867396457815`*^9, 
   3.8329867817967525`*^9}, {3.8329868429093847`*^9, 3.832986848447735*^9}, {
   3.8329869121904964`*^9, 3.8329869216406126`*^9}, {3.8329869590106916`*^9, 
   3.8329869845563993`*^9}, {3.8329870710350056`*^9, 
   3.8329870868271523`*^9}, {3.832987117777122*^9, 3.8329871304494476`*^9}, {
   3.8329871840840254`*^9, 3.83298719640114*^9}, {3.832987252110629*^9, 
   3.832987297680984*^9}, {3.8329875782121964`*^9, 3.8329876779974585`*^9}, 
   3.8329891108207664`*^9, 3.8329891509603167`*^9, {3.8329893124673257`*^9, 
   3.832989341889273*^9}, {3.832989372343317*^9, 3.832989380094492*^9}, {
   3.832989469023359*^9, 3.8329895116222334`*^9}, 3.832989550475444*^9, {
   3.8329895812925844`*^9, 3.8329896430291557`*^9}, 3.832989710389038*^9, {
   3.832989794380674*^9, 3.832989840515479*^9}, {3.8329900359119043`*^9, 
   3.8329900392269583`*^9}, 3.8329902300451517`*^9, {3.8329902850595045`*^9, 
   3.832990290634919*^9}, {3.832990400692901*^9, 3.8329904167990813`*^9}, {
   3.8329905340857077`*^9, 3.8329905519651194`*^9}, 3.832990814613847*^9, {
   3.8329909286939344`*^9, 3.832990970544267*^9}, {3.8329912138491836`*^9, 
   3.83299127662766*^9}, {3.8329913594125805`*^9, 3.8329913604285154`*^9}, 
   3.832991535927836*^9, {3.832991587536005*^9, 3.8329916363961196`*^9}, {
   3.8329917763022046`*^9, 3.832991806289969*^9}, {3.832992044473613*^9, 
   3.8329920639739323`*^9}, {3.83299238485332*^9, 3.8329923989212475`*^9}, {
   3.83299289699961*^9, 3.8329929313175583`*^9}, {3.832993059234866*^9, 
   3.8329931404701014`*^9}, {3.832993176216199*^9, 3.832993302041716*^9}, {
   3.832993332818115*^9, 3.832993374134757*^9}, {3.832993556022413*^9, 
   3.8329935579497795`*^9}, {3.8329935965431356`*^9, 
   3.8329935967349715`*^9}, {3.8329938447455964`*^9, 
   3.8329938490018787`*^9}, {3.8329941687479954`*^9, 
   3.8329942177993145`*^9}, {3.832994320512024*^9, 3.83299432882345*^9}, {
   3.8329943747957373`*^9, 3.8329944018957214`*^9}, 3.8329946066161766`*^9, {
   3.8329948156526885`*^9, 3.83299486356558*^9}, {3.832994928855524*^9, 
   3.8329949310471373`*^9}, {3.8329954643185854`*^9, 
   3.8329955703042583`*^9}, {3.8329975892542048`*^9, 
   3.8329976034978075`*^9}, {3.832997720467806*^9, 3.8329977384848337`*^9}, {
   3.832997825146538*^9, 3.832997972287462*^9}, {3.832999139865249*^9, 
   3.832999151009587*^9}, {3.832999523891568*^9, 3.832999579518628*^9}, {
   3.8329997835944915`*^9, 3.8329998096426773`*^9}, {3.832999861059485*^9, 
   3.8329998665428133`*^9}, {3.832999901518716*^9, 3.8329999035050645`*^9}, {
   3.832999965715056*^9, 3.8329999659628916`*^9}, {3.833000248057844*^9, 
   3.8330002703796377`*^9}, {3.8330086307851515`*^9, 
   3.8330086314800177`*^9}, {3.8330116721059823`*^9, 3.8330116901242375`*^9}, 
   3.8330118144119864`*^9, {3.833260509242383*^9, 3.833260532726719*^9}, 
   3.83326059542842*^9, {3.83331895259422*^9, 3.8333189746131296`*^9}, {
   3.8333190050278015`*^9, 3.83331926555818*^9}, {3.833319382213415*^9, 
   3.8333193829254627`*^9}, {3.8333194316362424`*^9, 3.833319439123098*^9}, 
   3.833319508970419*^9, 3.8333196118855934`*^9, {3.8333197676968827`*^9, 
   3.8333198019308753`*^9}, {3.8333201103548093`*^9, 3.833320240495877*^9}, {
   3.8333204307413893`*^9, 3.8333204743409805`*^9}, 3.833320641070021*^9, {
   3.833320679633854*^9, 3.833320684179978*^9}, {3.833320725109133*^9, 
   3.833320770213649*^9}, {3.833321406229538*^9, 3.8333214847256823`*^9}, {
   3.8333218469118156`*^9, 3.8333218605613775`*^9}, {3.8333219114367228`*^9, 
   3.8333219378644495`*^9}, {3.8333224199338226`*^9, 
   3.8333224222153296`*^9}, {3.83332249646138*^9, 3.83332254335675*^9}, {
   3.8333226230663557`*^9, 3.8333226296067815`*^9}, 3.8333232487768145`*^9, {
   3.833330293490199*^9, 3.8333304298012342`*^9}, {3.8333304869075694`*^9, 
   3.8333305445620337`*^9}, {3.833330835346212*^9, 3.8333308491056247`*^9}, {
   3.8333309088669276`*^9, 3.833330942146261*^9}, {3.833331077394272*^9, 
   3.8333311028474646`*^9}, {3.833331156202497*^9, 3.8333312029869423`*^9}, {
   3.833331275630114*^9, 3.833331298772786*^9}, {3.833331385470051*^9, 
   3.833331823580577*^9}, {3.833331886738572*^9, 3.833331992476428*^9}, {
   3.833332036883777*^9, 3.833332061252361*^9}, 3.833332197875369*^9, {
   3.833332255700096*^9, 3.833332266027401*^9}, {3.8333323000888214`*^9, 
   3.8333323003479934`*^9}, {3.8333323353518453`*^9, 
   3.8333324039267735`*^9}, {3.8333324548812404`*^9, 3.833332511540322*^9}, 
   3.8333325471160827`*^9, {3.8334410816987944`*^9, 3.833441098009453*^9}, 
   3.8334411426123343`*^9, {3.8334411932344227`*^9, 3.8334412060181723`*^9}, {
   3.833441253709015*^9, 3.8334412543509283`*^9}, {3.833493917633191*^9, 
   3.833493926818567*^9}, {3.8334940184285316`*^9, 3.8334940843248806`*^9}, {
   3.8334942895230937`*^9, 3.833494385695155*^9}, {3.833494464854192*^9, 
   3.833494615108282*^9}, {3.833494769372739*^9, 3.833494781579114*^9}, 
   3.8335194285707364`*^9, {3.8335283167824755`*^9, 3.8335283810364556`*^9}, {
   3.8335284127990685`*^9, 3.83352844901112*^9}, 3.8335294431712337`*^9, {
   3.8335309349762573`*^9, 3.833530988032769*^9}, 3.833576042620776*^9, {
   3.8335762471543083`*^9, 3.833576255400976*^9}, {3.8335763626494617`*^9, 
   3.8335763893769565`*^9}, {3.8335764250587*^9, 3.833576453198905*^9}, {
   3.8335764927640114`*^9, 3.833576567900053*^9}, {3.8335766213050413`*^9, 
   3.8335769981030416`*^9}, 3.8335770285467224`*^9, {3.833577551656293*^9, 
   3.8335775684841022`*^9}, {3.833577864546466*^9, 3.8335779469644547`*^9}, {
   3.833578012992875*^9, 3.833578191933509*^9}, 3.833853640177655*^9, {
   3.8338536837815876`*^9, 3.833853757469604*^9}, {3.8338539073620253`*^9, 
   3.8338539366517353`*^9}, {3.833853974214424*^9, 3.833854060501629*^9}, {
   3.833854147513137*^9, 3.8338541484135838`*^9}, {3.833856414920023*^9, 
   3.8338564365648518`*^9}, {3.8338565292645845`*^9, 3.833856626984906*^9}, {
   3.833856834032948*^9, 3.8338570181652784`*^9}, {3.8338570494595757`*^9, 
   3.8338570719057226`*^9}, 3.8338573385382524`*^9, 3.8338574282028074`*^9, {
   3.833857472135005*^9, 3.8338574911639194`*^9}, 3.833857522317996*^9, 
   3.8338591587841325`*^9, 3.8338593801337214`*^9, {3.8338641924647865`*^9, 
   3.833864250435149*^9}, 3.8338642910286026`*^9, {3.8338644618578043`*^9, 
   3.8338645089374084`*^9}, {3.8339252290186443`*^9, 
   3.8339253030466757`*^9}, {3.8339254076038756`*^9, 
   3.8339254216065435`*^9}, {3.833925553156355*^9, 3.833925591846663*^9}, {
   3.833925718047925*^9, 3.833925743907548*^9}, {3.833935488897256*^9, 
   3.833935518420246*^9}, {3.83393570348908*^9, 3.833935703739694*^9}, {
   3.8339367570617642`*^9, 3.8339367639650764`*^9}, 3.8339466999282565`*^9, {
   3.8339476418582783`*^9, 3.8339476549515247`*^9}, {3.833949295993275*^9, 
   3.833949389293672*^9}, {3.8339495753438516`*^9, 3.833949625624083*^9}, {
   3.8339502696801405`*^9, 3.8339502755888853`*^9}, 3.8339512878804855`*^9, 
   3.8340293998185296`*^9, {3.8340295288527527`*^9, 3.8340295624235663`*^9}, {
   3.8340297849334517`*^9, 3.834029807738781*^9}, {3.834030378533352*^9, 
   3.8340303826507225`*^9}, {3.834032279589088*^9, 3.8340324105153847`*^9}, {
   3.834033255174012*^9, 3.8340332585427914`*^9}, {3.834034137583666*^9, 
   3.834034147609353*^9}, {3.8340342135388203`*^9, 3.8340343506055784`*^9}, {
   3.834034629297623*^9, 3.8340347027692957`*^9}, {3.8340350670421963`*^9, 
   3.834035067659018*^9}, {3.834035204930944*^9, 3.8340352298412466`*^9}, {
   3.8340353312176247`*^9, 3.8340353734415736`*^9}, {3.834036602864271*^9, 
   3.834036611948369*^9}, {3.8340368186500645`*^9, 3.8340369066226573`*^9}, 
   3.8340370560801544`*^9, {3.834037090648588*^9, 3.834037144795958*^9}, {
   3.8340371814227295`*^9, 3.834037190562812*^9}, {3.834037698997343*^9, 
   3.8340378864697695`*^9}, {3.8340379203350167`*^9, 3.83403800937167*^9}, {
   3.83403805403773*^9, 3.83403812165363*^9}, {3.834038192883667*^9, 
   3.8340382281563673`*^9}, {3.8340383296294565`*^9, 3.834038386103199*^9}, {
   3.8340384386895204`*^9, 3.8340384909434743`*^9}, 3.8340385348794765`*^9, {
   3.83403886480797*^9, 3.8340389340487595`*^9}, {3.834038982911268*^9, 
   3.834039040195171*^9}, {3.834043957120733*^9, 3.8340439613173113`*^9}, {
   3.8340441125779066`*^9, 3.834044126181677*^9}, {3.834044203927685*^9, 
   3.834044237352617*^9}, {3.834044292670416*^9, 3.8340443492795315`*^9}, {
   3.834094405447332*^9, 3.8340945076364346`*^9}, 3.834539731714303*^9, {
   3.834540669646422*^9, 3.834540844531643*^9}, {3.8345408856886272`*^9, 
   3.8345409052911615`*^9}, {3.8345410430032616`*^9, 3.834541053630067*^9}, {
   3.834542460790608*^9, 3.8345424959228096`*^9}, {3.8345426136088643`*^9, 
   3.8345426946717343`*^9}, {3.8345429757010202`*^9, 
   3.8345429836720047`*^9}, {3.8345430149155807`*^9, 
   3.8345430383595376`*^9}, {3.834543244197147*^9, 3.8345432540072927`*^9}, 
   3.834543284018117*^9, {3.8345433651753964`*^9, 3.834543415400238*^9}, 
   3.834543548655075*^9, {3.834543840017641*^9, 3.8345438402403665`*^9}, {
   3.834544360785243*^9, 3.834544374427394*^9}, {3.8345449027787027`*^9, 
   3.834544922387636*^9}, {3.8345450613375144`*^9, 3.8345450777065096`*^9}, {
   3.8345451695921164`*^9, 3.834545265018984*^9}, {3.834545343138561*^9, 
   3.834545490060678*^9}, {3.8345455240120163`*^9, 3.8345456026735353`*^9}, {
   3.834545641486715*^9, 3.834545687161783*^9}, 3.8345457351477757`*^9, 
   3.8345458371493187`*^9, {3.834549857282398*^9, 3.8345498718717327`*^9}, {
   3.834549906183552*^9, 3.834549908573479*^9}, {3.834550755701886*^9, 
   3.834550778582715*^9}, 3.834550853886871*^9, {3.8345511367498465`*^9, 
   3.8345511469671044`*^9}, {3.8345512084552326`*^9, 
   3.8345512273238726`*^9}, {3.8345517765036683`*^9, 3.834551929535435*^9}, {
   3.8345549053950086`*^9, 3.8345549673267975`*^9}, {3.8345550411617846`*^9, 
   3.8345555305810614`*^9}, 3.8345557920577693`*^9},
 CellLabel->
  "In[960]:=",ExpressionUUID->"de46ef57-a359-4ec4-a7d3-aea9f5198032"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lightPoint$$ = {3, 
    3}, $CellContext`roughness$$ = 0.1, $CellContext`shadingPt1Offset$$ = 
    0.5, $CellContext`viewPoint$$ = {-3, 3}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightPoint$$], {3, 3}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`viewPoint$$], {-3, 3}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`shadingPt1Offset$$], 0.5}, -2, 2}, {{
       Hold[$CellContext`roughness$$], 0.1}, 0.01, 0.99}}, Typeset`size$$ = {
    434., {177., 183.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightPoint$1238684$$ = {0, 
    0}, $CellContext`viewPoint$1238685$$ = {0, 
    0}, $CellContext`shadingPt1Offset$1238686$$ = 
    0, $CellContext`roughness$1238687$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`lightPoint$$ = {3, 
         3}, $CellContext`roughness$$ = 0.1, $CellContext`shadingPt1Offset$$ = 
        0.5, $CellContext`viewPoint$$ = {-3, 3}}, "ControllerVariables" :> {
        Hold[$CellContext`lightPoint$$, $CellContext`lightPoint$1238684$$, {0,
          0}], 
        Hold[$CellContext`viewPoint$$, $CellContext`viewPoint$1238685$$, {0, 
         0}], 
        Hold[$CellContext`shadingPt1Offset$$, \
$CellContext`shadingPt1Offset$1238686$$, 0], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$1238687$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`shadingPt0 = 
        gBRDF`gCalcGgxPeakOnPlane[{0, 0}, {0, 
          1}, $CellContext`lightPoint$$, $CellContext`viewPoint$$]; \
$CellContext`lightDir0 = 
        Normalize[$CellContext`lightPoint$$ - $CellContext`shadingPt0]; \
$CellContext`viewDir0 = 
        Normalize[$CellContext`viewPoint$$ - $CellContext`shadingPt0]; \
$CellContext`halfDir0 = 
        Normalize[($CellContext`lightDir0 + $CellContext`viewDir0)/
          2]; $CellContext`shadingPt1 = {
         Part[$CellContext`shadingPt0, 1] + $CellContext`shadingPt1Offset$$, 
          0}; $CellContext`lightDir1 = 
        Normalize[$CellContext`lightPoint$$ - $CellContext`shadingPt1]; \
$CellContext`viewDir1 = 
        Normalize[$CellContext`viewPoint$$ - $CellContext`shadingPt1]; \
$CellContext`halfDir1 = 
        Normalize[($CellContext`lightDir1 + $CellContext`viewDir1)/2]; 
       gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["viewPoint"], "radius" -> 0.1, "color" -> Gray, 
             "thickness" -> 0.01, "label" -> "View"], 
            Association[
            "center" -> Slot["lightPoint"], "radius" -> 0.1, "color" -> 
             Magenta, "thickness" -> 0.01, "label" -> "Light"], 
            Association[
            "center" -> $CellContext`shadingPt0, "radius" -> 0.1, "color" -> 
             Blue, "thickness" -> 0.01], 
            Association[
            "center" -> $CellContext`shadingPt1, "radius" -> 0.1, "color" -> 
             Red, "thickness" -> 0.01]}& )[
           Association[
           "lightPoint" -> $CellContext`lightPoint$$, 
            "viewPoint" -> $CellContext`viewPoint$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> $CellContext`shadingPt0, 
             "dirVec" -> $CellContext`halfDir0, "length" -> 1, "color" -> 
             Blue, "thickness" -> 0.01], 
            Association[
            "startPos" -> $CellContext`shadingPt1, 
             "dirVec" -> $CellContext`halfDir1, "length" -> 1, "color" -> Red,
              "thickness" -> 0.01]}& )[], "axisExtent" -> 5], Medium]), 
      "Specifications" :> {{{$CellContext`lightPoint$$, {3, 3}}, {-4, -4}, {4,
          4}}, {{$CellContext`viewPoint$$, {-3, 3}}, {-4, -4}, {4, 
         4}}, {{$CellContext`shadingPt1Offset$$, 0.5}, -2, 
         2}, {{$CellContext`roughness$$, 0.1}, 0.01, 0.99}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{485., {322., 328.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8345517674526825`*^9, 3.8345517806263723`*^9}, {
   3.834551828069339*^9, 3.834551889235299*^9}, {3.8345549388024893`*^9, 
   3.8345549681908283`*^9}, {3.8345551624780936`*^9, 3.834555198146237*^9}, 
   3.8345552323294425`*^9, {3.8345554374689007`*^9, 3.8345554641803503`*^9}, {
   3.83455552295683*^9, 3.8345555312706013`*^9}, 3.8345557934616055`*^9},
 CellLabel->
  "Out[969]=",ExpressionUUID->"9483a483-16ec-44f2-9936-a49a350300a2"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.834544885627576*^9, 
  3.8345448861686726`*^9}},ExpressionUUID->"4d880b37-1c08-4821-9baf-\
b8c2587ab6ab"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.834541164682822*^9, 
  3.834541166940769*^9}},ExpressionUUID->"6fc7a78a-84cc-433c-a616-\
bfeb2759d032"]
},
WindowSize->{1083, 706},
WindowMargins->{{Automatic, 196}, {44, Automatic}},
CellContext->Notebook,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 20439, 373, 1017, "Input",ExpressionUUID->"de46ef57-a359-4ec4-a7d3-aea9f5198032"],
Cell[21022, 397, 5442, 105, 669, "Output",ExpressionUUID->"9483a483-16ec-44f2-9936-a49a350300a2"]
}, Open  ]],
Cell[26479, 505, 154, 3, 28, "Input",ExpressionUUID->"4d880b37-1c08-4821-9baf-b8c2587ab6ab"],
Cell[26636, 510, 152, 3, 28, "Input",ExpressionUUID->"6fc7a78a-84cc-433c-a616-bfeb2759d032"]
}
]
*)

