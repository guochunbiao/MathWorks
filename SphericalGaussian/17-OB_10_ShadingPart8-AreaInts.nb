(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     52069,       1212]
NotebookOptionsPosition[     50162,       1175]
NotebookOutlinePosition[     50529,       1191]
CellTagsIndexPosition[     50486,       1188]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
      "\"\<Shared\>\""}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlotsEx`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3DEx`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gTexStyles`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBlochSphere`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResetDirectory", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "regDisk", ",", "regQuad", ",", "regRect", ",", "rectCenter", ",", 
     "rectMajorAxis", ",", "rectMajorRadius", ",", "rectMinorRadius", ",", 
     "\[IndentingNewLine]", "\t", "pointLT", ",", "pointRT", ",", "pointRB", 
     ",", "pointLB", ",", "realArea", ",", "approxArea"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "disk", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"circleCenter", "=", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"circleRadius", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"regDisk", "=", 
   RowBox[{"Disk", "[", 
    RowBox[{"circleCenter", ",", "circleRadius"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regQuad", "=", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"circleCenter", "-", 
       RowBox[{"{", 
        RowBox[{"circleRadius", ",", "circleRadius"}], "}"}]}], ",", 
      RowBox[{"circleCenter", "+", 
       RowBox[{"{", 
        RowBox[{"circleRadius", ",", "circleRadius"}], "}"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "rect", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rectCenter", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rectMajorAxis", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rectMajorRadius", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rectMinorRadius", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"pointLT", ",", "pointRT", ",", "pointRB", ",", "pointLB"}], 
    "}"}], "=", "\n", "\t\t", 
   RowBox[{"gCalcRect2DEdgePts", "[", 
    RowBox[{
    "rectCenter", ",", "rectMajorAxis", ",", "rectMajorRadius", ",", 
     "rectMinorRadius"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regRect", "=", 
    RowBox[{"Rectangle", "[", 
     RowBox[{"pointLB", ",", "pointRT"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.83556677251548*^9, 3.8355667905878143`*^9}, {
   3.835567128546254*^9, 3.835567129455933*^9}, {3.8355684470263543`*^9, 
   3.8355684773835554`*^9}, 3.835568645711259*^9, {3.8355689911103387`*^9, 
   3.8355690191965914`*^9}, {3.835569092439534*^9, 3.835569223745946*^9}, {
   3.8355693013477325`*^9, 3.8355693064316397`*^9}, {3.8355707860766497`*^9, 
   3.835570797530777*^9}, 3.8355714148867865`*^9, {3.8355716898572817`*^9, 
   3.8355716955648108`*^9}, {3.835571737265605*^9, 3.8355717444358616`*^9}, {
   3.8355781821490135`*^9, 3.835578183888484*^9}, {3.8355782204170237`*^9, 
   3.8355782295069995`*^9}, 3.8355782653412085`*^9, {3.8355808183298645`*^9, 
   3.8355808201215796`*^9}, {3.8355808940991764`*^9, 3.835580899695227*^9}, {
   3.835581577271477*^9, 3.8355816184339347`*^9}, {3.8355816632407055`*^9, 
   3.835581700698842*^9}, {3.835945735360832*^9, 3.835945738611524*^9}, {
   3.8359460417686405`*^9, 3.835946065337908*^9}, {3.835946196008292*^9, 
   3.835946201885378*^9}, {3.8359466070417814`*^9, 3.835946608912119*^9}, 
   3.8359472637941694`*^9, {3.8359503604476857`*^9, 3.835950408079445*^9}, {
   3.8359504557799397`*^9, 3.8359504893854313`*^9}, {3.8359519022837076`*^9, 
   3.8359519030822144`*^9}, {3.8360342265516543`*^9, 3.836034258227906*^9}, {
   3.8360344010797*^9, 3.8360344206968384`*^9}, {3.8360346974876533`*^9, 
   3.8360347447020097`*^9}, {3.8360348609899364`*^9, 3.836034901585388*^9}, {
   3.836035085006404*^9, 3.836035086236871*^9}, {3.836035129914256*^9, 
   3.836035175813717*^9}, 3.8360353775267143`*^9, {3.836035629983921*^9, 
   3.836035656489356*^9}, {3.836035805068836*^9, 3.8360359580815544`*^9}, {
   3.836036000401772*^9, 3.83603602150823*^9}, {3.836036073538269*^9, 
   3.8360362548450737`*^9}, {3.836036316764929*^9, 3.836036374176069*^9}, 
   3.8360369215588975`*^9, 3.8360371256599035`*^9, {3.8360371699585724`*^9, 
   3.8360372017253747`*^9}, {3.8360372319086123`*^9, 3.836037245044255*^9}, {
   3.836083568120124*^9, 3.8360835708047886`*^9}, 3.836084536183298*^9, 
   3.83608476666572*^9, {3.836084943554319*^9, 3.8360849506888037`*^9}, {
   3.8360849870291257`*^9, 3.8360850431065946`*^9}, {3.836085094825074*^9, 
   3.8360851426954308`*^9}, {3.83608518008132*^9, 3.8360851851482306`*^9}, {
   3.8360853309355*^9, 3.8360854650236216`*^9}, 3.83608552488591*^9, {
   3.8360856499353886`*^9, 3.8360856744308324`*^9}, {3.8360857841179204`*^9, 
   3.8360858122489653`*^9}, {3.8360861576641045`*^9, 
   3.8360861670976925`*^9}, {3.8360862595891647`*^9, 3.836086302081476*^9}, {
   3.836086354169099*^9, 3.836086381630916*^9}, {3.836086463702898*^9, 
   3.836086476019539*^9}, {3.83608654118916*^9, 3.8360866093424854`*^9}, {
   3.8360867699774046`*^9, 3.836086777246688*^9}, 3.8360868073672*^9, 
   3.8360869418860903`*^9, {3.8360870164060936`*^9, 3.8360870549708195`*^9}, {
   3.836087109614787*^9, 3.8360871101125636`*^9}, 3.8360877550251217`*^9, 
   3.8360877930842295`*^9, {3.836087968440213*^9, 3.836087983356969*^9}, {
   3.836088108580552*^9, 3.836088146510844*^9}, {3.8360882160241237`*^9, 
   3.8360882756692734`*^9}, 3.8360885251469297`*^9, {3.836088645229864*^9, 
   3.836088811039167*^9}, {3.8360890176744075`*^9, 3.8360890186804953`*^9}, {
   3.8360894156521053`*^9, 3.8360894273717823`*^9}, {3.836089513920801*^9, 
   3.8360895305794706`*^9}, {3.8360896661901164`*^9, 3.836089718604532*^9}, {
   3.8360897515007973`*^9, 3.8360897528678284`*^9}, {3.8362038594763803`*^9, 
   3.8362038872915583`*^9}, {3.836203931344035*^9, 3.8362039390641828`*^9}, {
   3.8362047001087313`*^9, 3.8362047094032235`*^9}, {3.8362051182436695`*^9, 
   3.836205173987734*^9}, {3.836205606637599*^9, 3.8362056394771814`*^9}, {
   3.8362057075328183`*^9, 3.836205729808622*^9}, {3.8362057846464157`*^9, 
   3.8362057921447916`*^9}, {3.8362076981797795`*^9, 
   3.8362077579466705`*^9}, {3.8362080286906166`*^9, 
   3.8362080314579935`*^9}, {3.8368886173164845`*^9, 
   3.8368886257811937`*^9}, {3.83688869654888*^9, 3.836888743079875*^9}, 
   3.8368887800179596`*^9, 3.8368890203366675`*^9, {3.837244321622088*^9, 
   3.8372443258672066`*^9}, {3.8387989923775544`*^9, 
   3.8387992487847085`*^9}, {3.8388694058449574`*^9, 3.83886950480385*^9}, {
   3.838873329912219*^9, 3.8388733495727806`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"4a3c6b78-aa1a-45a1-a9ff-d84914e37d9f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "circIntsArea", ",", "regDisk1", ",", "regDisk2", ",", "calcArea", ",", 
     "realArea", ",", "approxArea"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"calcArea", "=", 
     RowBox[{"gCircleIntsArea", "[", 
      RowBox[{"R", ",", "r", ",", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"approxArea", "=", 
     RowBox[{"gApproxCircleIntsArea", "[", 
      RowBox[{"R", ",", "r", ",", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"regDisk1", "=", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "R"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"regDisk2", "=", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d", ",", "0"}], "}"}], ",", "r"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"realArea", "=", 
       RowBox[{"Area", "[", 
        RowBox[{"RegionIntersection", "[", 
         RowBox[{"regDisk1", ",", "regDisk2"}], "]"}], "]"}]}], ";"}], "*)"}],
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", "R"}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"d", ",", "0"}], "}"}], ",", "r"}], "]"}], "]"}]}], 
       "\[IndentingNewLine]", "\t\t", "}"}], ",", "\[IndentingNewLine]", 
      "\t\t", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "\t", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R", ",", "2"}], "}"}], ",", "1", ",", "3"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "1"}], "}"}], ",", "0.5", ",", "1.5"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "1.5"}], "}"}], ",", "0.5", ",", "3"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"realArea1", ",", "realArea"}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"calcArea1", ",", "calcArea"}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"approxArea1", ",", "approxArea"}], "}"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8388706847165546`*^9, 3.8388707206101*^9}, {
   3.838870770773571*^9, 3.8388710224163527`*^9}, {3.838871052639887*^9, 
   3.8388714792845726`*^9}, 3.838871520265276*^9, {3.838871560696431*^9, 
   3.8388715676044064`*^9}, 3.838871601012699*^9, {3.838871686351568*^9, 
   3.8388718228500843`*^9}, {3.838872865686708*^9, 3.8388730307115903`*^9}, {
   3.838873067854745*^9, 3.8388731936865444`*^9}, {3.8388760703756075`*^9, 
   3.838876106201687*^9}, {3.8388879181926036`*^9, 
   3.838887923513297*^9}},ExpressionUUID->"55bcc65f-882a-4073-bf69-\
54ec4cd0d8e3"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`approxArea1$$ = 
    2.356194490192345, $CellContext`calcArea1$$ = 
    2.3925498682458235`, $CellContext`d$$ = 1.5, $CellContext`r$$ = 
    1, $CellContext`R$$ = 2, $CellContext`realArea1$$ = $CellContext`realArea,
     Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`R$$], 2}, 1, 3}, {{
       Hold[$CellContext`r$$], 1}, 0.5, 1.5}, {{
       Hold[$CellContext`d$$], 1.5}, 0.5, 3}, {{
       Hold[$CellContext`realArea1$$], $CellContext`realArea}}, {{
       Hold[$CellContext`calcArea1$$], 2.3925498682458235`}}, {{
       Hold[$CellContext`approxArea1$$], 2.356194490192345}}}, 
    Typeset`size$$ = {360., {177., 183.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`R$968048$$ = 0, $CellContext`r$968049$$ = 
    0, $CellContext`d$968050$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`approxArea1$$ = $CellContext`approxArea, \
$CellContext`calcArea1$$ = $CellContext`calcArea, $CellContext`d$$ = 
        1.5, $CellContext`r$$ = 1, $CellContext`R$$ = 
        2, $CellContext`realArea1$$ = $CellContext`realArea}, 
      "ControllerVariables" :> {
        Hold[$CellContext`R$$, $CellContext`R$968048$$, 0], 
        Hold[$CellContext`r$$, $CellContext`r$968049$$, 0], 
        Hold[$CellContext`d$$, $CellContext`d$968050$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`calcArea = 
        gUtils`gCircleIntsArea[$CellContext`R$$, $CellContext`r$$, \
$CellContext`d$$]; $CellContext`approxArea = 
        gUtils`gApproxCircleIntsArea[$CellContext`R$$, $CellContext`r$$, \
$CellContext`d$$]; $CellContext`regDisk1 = 
        Disk[{0, 0}, $CellContext`R$$]; $CellContext`regDisk2 = 
        Disk[{$CellContext`d$$, 0}, $CellContext`r$$]; Show[{
          Graphics[
           Circle[{0, 0}, $CellContext`R$$]], 
          Graphics[
           Circle[{$CellContext`d$$, 0}, $CellContext`r$$]]}, 
         PlotRange -> {{-3, 3}, {-3, 3}}]), 
      "Specifications" :> {{{$CellContext`R$$, 2}, 1, 
         3}, {{$CellContext`r$$, 1}, 0.5, 1.5}, {{$CellContext`d$$, 1.5}, 0.5,
          3}, {{$CellContext`realArea1$$, $CellContext`realArea}}, \
{{$CellContext`calcArea1$$, $CellContext`calcArea}}, \
{{$CellContext`approxArea1$$, $CellContext`approxArea}}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {284., 290.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.838887802959421*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"aea14268-5716-429d-8ec5-2b125fca9346"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"circIntsArea", "[", 
  RowBox[{"R", ",", "r", ",", "d"}], "]"}]], "Input",
 CellChangeTimes->{{3.8388716155896297`*^9, 3.838871619500635*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"bd5f9113-c295-4e81-af8a-29d20913e013"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Re", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d", "+", "r", "-", "R"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"d", "-", "r", "+", "R"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d"}], "+", "r", "+", "R"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "r", "+", "R"}], ")"}]}]]}], "+", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", 
         RowBox[{"ArcCos", "[", 
          FractionBox[
           RowBox[{
            SuperscriptBox["d", "2"], "+", 
            SuperscriptBox["r", "2"], "-", 
            SuperscriptBox["R", "2"]}], 
           RowBox[{"2", " ", "d", " ", "r"}]], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["R", "2"], " ", 
         RowBox[{"ArcCos", "[", 
          FractionBox[
           RowBox[{
            SuperscriptBox["d", "2"], "-", 
            SuperscriptBox["r", "2"], "+", 
            SuperscriptBox["R", "2"]}], 
           RowBox[{"2", " ", "d", " ", "R"}]], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R", ",", "2"}], "}"}], ",", "1", ",", "3"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "1"}], "}"}], ",", "0.5", ",", "1.5"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.83887162940519*^9, 3.838871653654674*^9}, 
   3.83887184981693*^9, {3.8388719015817866`*^9, 3.838871971998498*^9}, {
   3.838872241455743*^9, 3.8388722488212657`*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"adcb8fcc-4e34-4c3c-a420-e2bc6c250ae2"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`r$$ = 0.902, $CellContext`R$$ = 1.454, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`R$$], 2}, 1, 3}, {{
       Hold[$CellContext`r$$], 1}, 0.5, 1.5}}, Typeset`size$$ = {
    360., {108., 114.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`R$230468$$ = 
    0, $CellContext`r$230469$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`r$$ = 1, $CellContext`R$$ = 2}, 
      "ControllerVariables" :> {
        Hold[$CellContext`R$$, $CellContext`R$230468$$, 0], 
        Hold[$CellContext`r$$, $CellContext`r$230469$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[
        Re[(-(1/2)) 
          Sqrt[((($CellContext`d + $CellContext`r$$ - $CellContext`R$$) \
($CellContext`d - $CellContext`r$$ + $CellContext`R$$)) (-$CellContext`d + \
$CellContext`r$$ + $CellContext`R$$)) ($CellContext`d + $CellContext`r$$ + \
$CellContext`R$$)] + $CellContext`r$$^2 
          ArcCos[($CellContext`d^2 + $CellContext`r$$^2 - \
$CellContext`R$$^2)/((
             2 $CellContext`d) $CellContext`r$$)] + $CellContext`R$$^2 
          ArcCos[($CellContext`d^2 - $CellContext`r$$^2 + \
$CellContext`R$$^2)/((2 $CellContext`d) $CellContext`R$$)]], {$CellContext`d, 
         0, 5}], "Specifications" :> {{{$CellContext`R$$, 2}, 1, 
         3}, {{$CellContext`r$$, 1}, 0.5, 1.5}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {169., 175.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Input",
 CellChangeTimes->{3.8388724075650253`*^9},
 CellLabel->
  "In[146]:=",ExpressionUUID->"88ca24a6-aeb5-4aa8-a21a-13fe72eaeb30"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Re", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "+", "r", "-", "R"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"d", "-", "r", "+", "R"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "d"}], "+", "r", "+", "R"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"d", "+", "r", "+", "R"}], ")"}]}]]}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"ArcCos", "[", 
        FractionBox[
         RowBox[{
          SuperscriptBox["d", "2"], "+", 
          SuperscriptBox["r", "2"], "-", 
          SuperscriptBox["R", "2"]}], 
         RowBox[{"2", " ", "d", " ", "r"}]], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["R", "2"], " ", 
       RowBox[{"ArcCos", "[", 
        FractionBox[
         RowBox[{
          SuperscriptBox["d", "2"], "-", 
          SuperscriptBox["r", "2"], "+", 
          SuperscriptBox["R", "2"]}], 
         RowBox[{"2", " ", "d", " ", "R"}]], "]"}]}]}], ")"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"R", "\[Rule]", "1.92"}], ",", 
     RowBox[{"r", "\[Rule]", "0.653"}], ",", 
     RowBox[{"d", "\[Rule]", "0.00001"}]}], "}"}]}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.8388721118852324`*^9, 3.8388721901096373`*^9}, {
  3.83887223269385*^9, 3.8388722339503603`*^9}, {3.838872282951889*^9, 
  3.838872287828785*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"38f1cd56-54b2-4f09-9959-f46f7d6ce6db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "regDisk", ",", "regQuad", ",", "regRect", ",", "rectCenter", ",", 
     "rectMajorAxis", ",", "rectMajorRadius", ",", "rectMinorRadius", ",", 
     "\[IndentingNewLine]", "\t", "pointLT", ",", "pointRT", ",", "pointRB", 
     ",", "pointLB", ",", "realArea", ",", "approxArea", ",", "closePt", ",", 
     "centerDist"}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ClearAll", "[", "testClosestCenter", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"testClosestCenter", "[", 
      RowBox[{
      "rectCenter2d_", ",", "rectMajorAxis2d_", ",", "\[IndentingNewLine]", 
       "\t", "rectMajorRadius2d_", ",", "rectMinorRadius2d_", ",", 
       "\[IndentingNewLine]", "\t", "diskCenter2d_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"majorOffset", ",", "closeCenter2d"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"majorOffset", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"diskCenter2d", "-", "rectCenter2d"}], ")"}], ",", 
           "rectMajorAxis2d"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"majorOffset", "<", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "rectMajorRadius2d"}], "+", "rectMinorRadius2d"}], 
            ")"}]}], ",", 
          RowBox[{"majorOffset", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "rectMajorRadius2d"}], "+", "rectMinorRadius2d"}], 
            ")"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"majorOffset", ">", 
           RowBox[{"(", 
            RowBox[{"rectMajorRadius2d", "-", "rectMinorRadius2d"}], ")"}]}], 
          ",", 
          RowBox[{"majorOffset", "=", 
           RowBox[{"(", 
            RowBox[{"rectMajorRadius2d", "-", "rectMinorRadius2d"}], 
            ")"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"closeCenter2d", "=", 
         RowBox[{"rectCenter2d", "+", 
          RowBox[{"majorOffset", "*", "rectMajorAxis2d"}]}]}], ";", 
        "\[IndentingNewLine]", "closeCenter2d"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rectCenter", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"rectMajorAxis", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"rectMajorRadius", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"rectMinorRadius", "=", "0.5"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"regDisk", "=", 
     RowBox[{"Disk", "[", 
      RowBox[{"circleCenter", ",", "circleRadius"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"regQuad", "=", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"circleCenter", "-", 
        RowBox[{"{", 
         RowBox[{"circleRadius", ",", "circleRadius"}], "}"}]}], ",", 
       RowBox[{"circleCenter", "+", 
        RowBox[{"{", 
         RowBox[{"circleRadius", ",", "circleRadius"}], "}"}]}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pointLT", ",", "pointRT", ",", "pointRB", ",", "pointLB"}], 
      "}"}], "=", "\n", "\t\t", 
     RowBox[{"gCalcRect2DEdgePts", "[", 
      RowBox[{
      "rectCenter", ",", "rectMajorAxis", ",", "rectMajorRadius", ",", 
       "rectMinorRadius"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"regRect", "=", 
     RowBox[{"Rectangle", "[", 
      RowBox[{"pointLB", ",", "pointRT"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"closePt", ",", "centerDist"}], "}"}], "=", 
     RowBox[{"gCalcRectShadingCenter", "[", 
      RowBox[{
      "rectCenter", ",", "rectMajorAxis", ",", "rectMajorRadius", ",", 
       "rectMinorRadius", ",", "circleCenter"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"realArea", "=", 
       RowBox[{"Area", "[", 
        RowBox[{"RegionIntersection", "[", 
         RowBox[{"regDisk", ",", "regRect"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"approxArea", "=", 
       RowBox[{"Area", "[", 
        RowBox[{"RegionIntersection", "[", 
         RowBox[{"regQuad", ",", "regRect"}], "]"}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pltRectLine2D", "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<center\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"\"\<majorAxis\>\"", "\[Rule]", "rectMajorAxis"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
           RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}]}], "|>"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltCircle2D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "#center"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "#radius"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
             RowBox[{"\"\<style\>\"", "\[Rule]", "Dashed"}]}], "|>"}], 
           "\[IndentingNewLine]", "\t", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<center\>\"", "\[Rule]", "circleCenter"}], ",", 
           RowBox[{"\"\<radius\>\"", "\[Rule]", "circleRadius"}]}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Point", "[", "closePt", "]"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"AspectRatio", "->", "1"}], ",", "\[IndentingNewLine]", 
      "\t    ", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\""}], "}"}]}], ",", 
      "\[IndentingNewLine]", "\t    ", 
      RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "\[IndentingNewLine]", 
     "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "        ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"circleCenter", ",", 
       RowBox[{"{", 
        RowBox[{"0.5", ",", "0.5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   "        ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"circleRadius", ",", "0.5"}], "}"}], ",", "0.1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "\t", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"realArea1", ",", "realArea"}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "\t", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"approxArea1", ",", "approxArea"}], "}"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.838873367333816*^9, 3.838873396732856*^9}, {
   3.8388734519924035`*^9, 3.838873455741666*^9}, {3.8388735177124476`*^9, 
   3.8388735283977156`*^9}, {3.8388735940138626`*^9, 
   3.8388735995199513`*^9}, {3.838873931669487*^9, 3.838873947776595*^9}, {
   3.838874054239277*^9, 3.838874179815179*^9}, {3.838874368101972*^9, 
   3.8388747015422735`*^9}, {3.838874764366665*^9, 3.8388747646221848`*^9}, 
   3.838874803733221*^9, {3.838874890849422*^9, 3.8388749190616016`*^9}, {
   3.8388756975307503`*^9, 3.8388757000905113`*^9}, {3.838883061057233*^9, 
   3.838883075178032*^9}},ExpressionUUID->"09d15ca6-9340-4dd5-ab1d-\
05d3e542694e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightDir", ",", "viewPoint", ",", "horzCenter", ",", "horzNormal", ",", 
    "vertCenter", ",", "vertNormal", ",", "\[IndentingNewLine]", "\t", 
    "vertAssistMajorAxis", ",", "vertMajorRadius", ",", "vertMinorRadius"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"lightDirX", ",", 
        RowBox[{"-", "1"}], ",", "lightDirZ"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", "debugViewPoint", "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"viewPoint", "=", 
     RowBox[{"{", 
      RowBox[{"1.3", ",", 
       RowBox[{"-", "2.4"}], ",", "2"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"normals", " ", "for", " ", "rectangle"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"horzNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"vertNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"horzCenter", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "0.5"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"vertCenter", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"vertAssistMajorAxis", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"vertMajorRadius", "=", "0.5"}], ";", "\[IndentingNewLine]", 
    RowBox[{"vertMinorRadius", "=", "0.5"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "horzNormal", ",", 
         "horzRoughness", ",", "samplingRadius", ",", "vertCenter", ",", 
         "vertNormal", ",", "vertAssistMajorAxis", ",", "vertMajorRadius", 
         ",", "vertMinorRadius", ",", "vertRoughness", ",", "lightDir", ",", 
         "lightIntensity", ",", "viewPoint"}], "}"}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "  ", 
       RowBox[{"(*", 
        RowBox[{"horizontal", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
       "  ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pltRect3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "horzCenter"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "horzNormal"}], ",", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "50"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"(*", 
                 RowBox[{"Hue", "@"}], "*)"}], 
                RowBox[{
                "sgReflectShadingEx", "[", "\[IndentingNewLine]", "\t\t   ", 
                 RowBox[{"(*", 
                  RowBox[{"shading", " ", "point"}], "*)"}], "\n", 
                 "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                  "horzNormal", ",", "horzRoughness", ",", "samplingRadius", 
                  ",", "\n", "\t\t\t\t\t", 
                  RowBox[{"(*", 
                   RowBox[{"reflection", " ", "rectangle"}], "*)"}], "\n", 
                  "\t\t\t\t\t", "vertCenter", ",", "vertNormal", ",", 
                  "vertAssistMajorAxis", ",", "vertMajorRadius", ",", 
                  "vertMinorRadius", ",", "vertRoughness", ",", "\n", 
                  "\t\t\t\t\t", 
                  RowBox[{"(*", "light", "*)"}], "\n", "\t\t\t\t\t", 
                  "lightDir", ",", "lightIntensity", ",", "viewPoint"}], 
                 "\[IndentingNewLine]", "\t\t", "]"}]}], "]"}]}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "horzRoughness"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "  ", 
        RowBox[{"(*", 
         RowBox[{"vertical", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
        "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRect3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "vertCenter"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "vertNormal"}], ",", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "10"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", "vertAssistMajorAxis"}], 
             ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "vertMajorRadius"}], 
             ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "vertMinorRadius"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Cyan"}], 
               RowBox[{"(*", 
                RowBox[{"Hue", "@", 
                 RowBox[{"reflLightingFunc", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                   "shadingPt", ",", "vertRoughness", ",", "lightIntensity"}],
                   "]"}]}], "*)"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", 
           "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "vertRoughness"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "direction"}], "*)"}], "\[IndentingNewLine]", 
        "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "lightDir"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "    ", 
      RowBox[{"showProps3D", "[", 
       RowBox[{"1", ",", "Medium"}], "]"}]}], "\[IndentingNewLine]", " ", 
     "]"}]}], ",", "\[IndentingNewLine]", "   ", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"horzRoughness", ",", "0.1"}], "}"}], ",", "0.01", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vertRoughness", ",", "0.1"}], "}"}], ",", "0.01", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirX", ",", 
       RowBox[{"-", "0.3"}]}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirZ", ",", "1"}], "}"}], ",", "0.1", ",", "1"}], "}"}], 
   ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "0.1"}], "}"}], ",", "0", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"samplingRadius", ",", "0.3"}], "}"}], ",", "0.1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "    ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8388749904467173`*^9, 3.8388749953352985`*^9}, {
   3.838877577087516*^9, 3.8388775988529716`*^9}, 3.8388776310884657`*^9, {
   3.8388835379068327`*^9, 3.8388835379838824`*^9}, {3.8388863369164104`*^9, 
   3.8388863387245336`*^9}, {3.8388867538917646`*^9, 3.8388867693398185`*^9}, 
   3.838886871655633*^9, {3.8388875658507285`*^9, 3.8388875660482006`*^9}, {
   3.838887972066312*^9, 3.838887972398529*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"60ad0b6b-c996-40bf-b2af-3f82e26b9b08"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`horzRoughness$$ = 
    0.1, $CellContext`lightDirX$$ = -0.3, $CellContext`lightDirZ$$ = 
    1, $CellContext`lightIntensity$$ = 0.1, $CellContext`samplingRadius$$ = 
    0.3, $CellContext`vertRoughness$$ = 0.1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`horzRoughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`vertRoughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`lightDirX$$], -0.3}, -1, 0}, {{
       Hold[$CellContext`lightDirZ$$], 1}, 0.1, 1}, {{
       Hold[$CellContext`lightIntensity$$], 0.1}, 0, 1}, {{
       Hold[$CellContext`samplingRadius$$], 0.3}, 0.1, 1}}, Typeset`size$$ = {
    360., {196., 202.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`horzRoughness$1380149$$ = 
    0, $CellContext`vertRoughness$1380150$$ = 
    0, $CellContext`lightDirX$1380151$$ = 
    0, $CellContext`lightDirZ$1380152$$ = 
    0, $CellContext`lightIntensity$1380153$$ = 
    0, $CellContext`samplingRadius$1380154$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`horzRoughness$$ = 
        0.1, $CellContext`lightDirX$$ = -0.3, $CellContext`lightDirZ$$ = 
        1, $CellContext`lightIntensity$$ = 0.1, $CellContext`samplingRadius$$ = 
        0.3, $CellContext`vertRoughness$$ = 0.1}, "ControllerVariables" :> {
        Hold[$CellContext`horzRoughness$$, \
$CellContext`horzRoughness$1380149$$, 0], 
        Hold[$CellContext`vertRoughness$$, \
$CellContext`vertRoughness$1380150$$, 0], 
        Hold[$CellContext`lightDirX$$, $CellContext`lightDirX$1380151$$, 0], 
        Hold[$CellContext`lightDirZ$$, $CellContext`lightDirZ$1380152$$, 0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$1380153$$, 0], 
        Hold[$CellContext`samplingRadius$$, \
$CellContext`samplingRadius$1380154$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`lightDir = 
        Normalize[{$CellContext`lightDirX$$, -1, $CellContext`lightDirZ$$}]; \
$CellContext`viewPoint = {1.3, -2.4, 2}; $CellContext`horzNormal = 
        Normalize[{0, 0, 1}]; $CellContext`vertNormal = 
        Normalize[{0, -1, 0}]; $CellContext`horzCenter = {
         0, 0, -0.5}; $CellContext`vertCenter = {0, 1, 
         0}; $CellContext`vertAssistMajorAxis = {1, 0, 
         0}; $CellContext`vertMajorRadius = 0.5; $CellContext`vertMinorRadius = 
        0.5; Show[{
          (gPlots3DEx`pltRect3D[
           Association[
           "center" -> $CellContext`horzCenter, 
            "normal" -> $CellContext`horzNormal, "plotPts" -> 50, 
            "majorAxis" -> {0, 1, 0}, "majorRadius" -> 1, "minorRadius" -> 
            0.5, "opacity" -> 1, "colorFunc" -> 
            Function[{$CellContext`x$, $CellContext`y$, $CellContext`z$}, 
              
              sgCommon`sgReflectShadingEx[{$CellContext`x$, $CellContext`y$, \
$CellContext`z$}, $CellContext`horzNormal, $CellContext`horzRoughness$$, \
$CellContext`samplingRadius$$, $CellContext`vertCenter, \
$CellContext`vertNormal, $CellContext`vertAssistMajorAxis, \
$CellContext`vertMajorRadius, $CellContext`vertMinorRadius, \
$CellContext`vertRoughness$$, $CellContext`lightDir, \
$CellContext`lightIntensity$$, $CellContext`viewPoint]]]]& )[
           Association["roughness" -> $CellContext`horzRoughness$$]], 
          (gPlots3DEx`pltRect3D[
           Association[
           "center" -> $CellContext`vertCenter, 
            "normal" -> $CellContext`vertNormal, "plotPts" -> 10, 
            "majorAxis" -> $CellContext`vertAssistMajorAxis, 
            "majorRadius" -> $CellContext`vertMajorRadius, 
            "minorRadius" -> $CellContext`vertMinorRadius, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              Cyan]]]& )[
           Association["roughness" -> $CellContext`vertRoughness$$]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> {0, -1, 1}, "dir" -> -$CellContext`lightDir, "length" -> 
            0.5]]& )[
           Association[]]}, 
         gPlots3DEx`showProps3D[1, Medium]]), 
      "Specifications" :> {{{$CellContext`horzRoughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`vertRoughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`lightDirX$$, -0.3}, -1, 
         0}, {{$CellContext`lightDirZ$$, 1}, 0.1, 
         1}, {{$CellContext`lightIntensity$$, 0.1}, 0, 
         1}, {{$CellContext`samplingRadius$$, 0.3}, 0.1, 1}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {313., 319.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8388875461133227`*^9, 3.838887620262924*^9}, 
   3.8388878097065043`*^9, 3.838887855016821*^9, 3.8388879734578753`*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"a2030229-b9c0-4dde-ae21-d0edaa5b8e3e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sgReflectShadingEx", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0.5", ",", 
     RowBox[{"-", "0.5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "0.1", ",", "0.3", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", "0.5", ",", "0.5", ",", 
   "0.1", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}]}], ",", 
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", "0.1", ",", 
   RowBox[{"{", 
    RowBox[{"1.3", ",", 
     RowBox[{"-", "2.4"}], ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8388777335669885`*^9, 3.8388777436642213`*^9}, {
   3.8388778460017548`*^9, 3.8388778473895206`*^9}, 3.8388831471037188`*^9, {
   3.8388867844472303`*^9, 3.8388867847913723`*^9}, {3.8388871670733414`*^9, 
   3.8388871813919773`*^9}, {3.838887421944435*^9, 3.8388874463442874`*^9}, {
   3.8388875279844737`*^9, 3.838887538257159*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"cb89dacd-063c-4bc0-85df-ce531d1d5a02"],

Cell[BoxData["0.09811698310094519`"], "Output",
 CellChangeTimes->{{3.8388874469925413`*^9, 3.8388874694066925`*^9}, {
  3.838887510274333*^9, 3.838887538861143*^9}},
 CellLabel->"Out[75]=",ExpressionUUID->"51002c11-7063-4cba-b037-2ff3ac47f171"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"sgPolar2", "[", 
  RowBox[{"0", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.7071067811865476`", ",", "0.7071067811865474`"}],
       "}"}], ",", "135.4390510465425`", ",", "1.0082944466433774`"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"sgPolar2", "[", 
  RowBox[{
   RowBox[{"\[Pi]", "/", "10"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.7071067811865476`", ",", "0.7071067811865474`"}],
       "}"}], ",", "135.4390510465425`", ",", "1.0082944466433774`"}], 
    "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8388844938145847`*^9, 3.8388845435524163`*^9}, {
   3.838884575513513*^9, 3.838884575841483*^9}, 3.8388847866919165`*^9},
 CellLabel->
  "In[162]:=",ExpressionUUID->"a05075f3-d629-4a62-aed7-5c7bbed0fc6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"0.288", 
       RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
      RowBox[{"m", "^", "2"}]], "-", "0.673"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]L", "\[Rule]", 
       RowBox[{
        RowBox[{"\[Pi]", "/", "2"}], "-", "0.01"}]}], ",", 
      RowBox[{"m", "\[Rule]", "0.1"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aaa", "=", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[Lambda]"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]], " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"aaa", "/.", 
  RowBox[{"{", 
   RowBox[{"\[Theta]", "\[Rule]", "0"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"aaa", "/.", 
  RowBox[{"{", 
   RowBox[{"\[Theta]", "\[Rule]", 
    RowBox[{"\[Pi]", "/", "10"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.8388847082321715`*^9, 3.838884848970494*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"bb37c934-6145-4658-8d4d-308ec93f5fa5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gBrdfIntegralOverRange", "[", 
  RowBox[{
   FractionBox["1", 
    SqrtBox["2"]], ",", "0.1`", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0.3`"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.838887476047956*^9, 3.838887480025565*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"1ddfd3fa-d09f-40e0-9243-258a38c2a8dd"],

Cell[BoxData["0.014516672377746613`"], "Output",
 CellChangeTimes->{3.838887507650119*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"38da72f6-cd00-40ef-9190-f757b6958798"]
}, Open  ]]
},
WindowSize->{908, 673},
WindowMargins->{{Automatic, 213}, {-39, Automatic}},
CellContext->Notebook,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 7974, 162, 618, "Input",ExpressionUUID->"4a3c6b78-aa1a-45a1-a9ff-d84914e37d9f"],
Cell[CellGroupData[{
Cell[8557, 186, 3772, 100, 466, "Input",ExpressionUUID->"55bcc65f-882a-4073-bf69-54ec4cd0d8e3"],
Cell[12332, 288, 3381, 65, 593, "Output",ExpressionUUID->"aea14268-5716-429d-8ec5-2b125fca9346"]
}, Open  ]],
Cell[15728, 356, 249, 5, 28, "Input",ExpressionUUID->"bd5f9113-c295-4e81-af8a-29d20913e013"],
Cell[15980, 363, 2024, 57, 180, "Input",ExpressionUUID->"adcb8fcc-4e34-4c3c-a420-e2bc6c250ae2"],
Cell[18007, 422, 2470, 49, 359, "Input",ExpressionUUID->"88ca24a6-aeb5-4aa8-a21a-13fe72eaeb30"],
Cell[20480, 473, 1628, 47, 74, "Input",ExpressionUUID->"38f1cd56-54b2-4f09-9959-f46f7d6ce6db"],
Cell[22111, 522, 8684, 205, 1017, "Input",ExpressionUUID->"09d15ca6-9340-4dd5-ab1d-05d3e542694e"],
Cell[CellGroupData[{
Cell[30820, 731, 9494, 215, 1074, "Input",ExpressionUUID->"60ad0b6b-c996-40bf-b2af-3f82e26b9b08"],
Cell[40317, 948, 5680, 106, 651, "Output",ExpressionUUID->"a2030229-b9c0-4dde-ae21-d0edaa5b8e3e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46034, 1059, 1313, 32, 48, "Input",ExpressionUUID->"cb89dacd-063c-4bc0-85df-ce531d1d5a02"],
Cell[47350, 1093, 245, 3, 32, "Output",ExpressionUUID->"51002c11-7063-4cba-b037-2ff3ac47f171"]
}, Open  ]],
Cell[47610, 1099, 841, 21, 48, "Input",ExpressionUUID->"a05075f3-d629-4a62-aed7-5c7bbed0fc6d"],
Cell[48454, 1122, 1151, 34, 110, "Input",ExpressionUUID->"bb37c934-6145-4658-8d4d-308ec93f5fa5"],
Cell[CellGroupData[{
Cell[49630, 1160, 344, 8, 52, "Input",ExpressionUUID->"1ddfd3fa-d09f-40e0-9243-258a38c2a8dd"],
Cell[49977, 1170, 169, 2, 32, "Output",ExpressionUUID->"38da72f6-cd00-40ef-9190-f757b6958798"]
}, Open  ]]
}
]
*)

