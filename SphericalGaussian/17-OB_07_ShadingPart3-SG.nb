(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     56547,       1303]
NotebookOptionsPosition[     55595,       1280]
NotebookOutlinePosition[     55939,       1295]
CellTagsIndexPosition[     55896,       1292]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
      "\"\<Shared\>\""}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3DEx`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBlochSphere`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResetDirectory", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Reflect SG Light\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "lightDir", ",", "dynViewPt", ",", "debugViewPoint", ",", "viewPoint", 
     ",", "realViewDir", ",", "\[IndentingNewLine]", "\t", "horzCenter", ",", 
     "horzNormal", ",", "vertCenter", ",", "vertNormal", ",", "reflPeakPt", 
     ",", "\[IndentingNewLine]", "\t", "reflLightingFunc", ",", "reflSgLight",
      ",", "sgDisplayPt", ",", "getDisplaySg", ",", "sgndf", ",", 
     "reflShading", ",", "\[IndentingNewLine]", "\t", "reflLightingFunc", ",",
      "getDisplaySgFunc"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"reflLightingFunc", "[", 
     RowBox[{
     "reflPt_", ",", "shadingPt_", ",", "reflRoughness_", ",", 
      "lightIntensity_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "reflViewPt", ",", "reflView", ",", "reflHalf", ",", "noh", ",", "nol",
         ",", "lighting"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"reflViewPt", "=", "shadingPt"}], ";", "\[IndentingNewLine]", 
       RowBox[{"reflView", "=", 
        RowBox[{"Normalize", "[", 
         RowBox[{"reflViewPt", "-", "reflPt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"reflHalf", "=", 
        RowBox[{"Normalize", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"reflView", "+", "lightDir"}], ")"}], "/", "2"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"noh", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{"vertNormal", ",", "reflHalf"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nol", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{"vertNormal", ",", "lightDir"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"lighting", "=", 
        RowBox[{
         RowBox[{"gDGGX", "[", 
          RowBox[{"reflRoughness", ",", "noh"}], "]"}], "*", "nol", "*", 
         "lightIntensity"}]}], ";", "\[IndentingNewLine]", "lighting"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getDisplaySgFunc", "[", "sg_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "dispSg", "}"}], ",", 
      RowBox[{
       RowBox[{"dispSg", "=", "sg"}], ";", 
       RowBox[{
        RowBox[{"dispSg", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", "1"}], "*", 
         RowBox[{"dispSg", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "dispSg"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"lightDirX", ",", 
        RowBox[{"-", "1"}], ",", "lightDirZ"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"dynViewPt", "=", 
       RowBox[{
        RowBox[{"Options", "[", 
         RowBox[{"Graphics3D", ",", "ViewPoint"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"debugViewPoint", "=", 
       RowBox[{"Dynamic", "[", "dynViewPt", "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", "debugViewPoint", "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"viewPoint", "=", 
     RowBox[{"{", 
      RowBox[{"1.3", ",", 
       RowBox[{"-", "2.4"}], ",", "2"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"realViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"viewPoint", "-", "shadingPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"normals", " ", "for", " ", "rectangle"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"horzNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"vertNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"horzCenter", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "0.5"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"vertCenter", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"reflPeakPt", ":=", 
     RowBox[{"gCalcPeakPoint", "[", 
      RowBox[{
      "vertNormal", ",", "vertCenter", ",", "lightDir", ",", "shadingPt"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"reflSgLight", "=", 
     RowBox[{"sgReflectLight", "[", 
      RowBox[{
      "shadingPt", ",", "lightDir", ",", "lightIntensity", ",", 
       "vertRoughness", ",", 
       RowBox[{"{", 
        RowBox[{"reflPeakPt", ",", "vertNormal", ",", "samplingRadius"}], 
        "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sgDisplayPt", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5"}], ",", 
       RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"sgndf", "=", 
     RowBox[{"sgNDF", "[", 
      RowBox[{"horzRoughness", ",", 
       RowBox[{"reflSgLight", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "realViewDir", ",", 
       "horzNormal"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"reflShading", ":=", 
     RowBox[{"sgDot", "[", 
      RowBox[{"reflSgLight", ",", "sgndf"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "  ", 
       RowBox[{"(*", 
        RowBox[{"horizontal", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
       "  ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pltRect3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "horzCenter"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "horzNormal"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "LightBlue"}],
                "]"}]}]}], "|>"}], "\[IndentingNewLine]", "  ", "]"}], "&"}], 
         "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "horzRoughness"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "  ", 
        RowBox[{"(*", 
         RowBox[{"vertical", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
        "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRect3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "vertCenter"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "vertNormal"}], ",", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "50"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                RowBox[{"Hue", "@", 
                 RowBox[{"reflLightingFunc", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                   "shadingPt", ",", "vertRoughness", ",", "lightIntensity"}],
                   "]"}]}]}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", "  ", 
           "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "vertRoughness"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", "points", "*)"}], "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "#shadingPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<shadingPt\>\"", "\[Rule]", "shadingPt"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.02"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", 
         RowBox[{"sampling", " ", "area"}], "*)"}], "\[IndentingNewLine]", 
        "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltCircle3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "vertNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "#radius"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                "LightGreen"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", 
           "\t", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", 
         RowBox[{"SG", " ", "Reflection", " ", "Light"}], "*)"}], 
        "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltSphere3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "sgDisplayPt"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "50"}], ",", 
             RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                RowBox[{"Hue", "@", 
                 RowBox[{"sgVector", "[", 
                  RowBox[{
                   RowBox[{"Normalize", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], "-", 
                    "sgDisplayPt"}], "]"}], ",", "#sg"}], "]"}]}]}], 
               "]"}]}]}], "|>"}], "\[IndentingNewLine]", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<sg\>\"", "\[Rule]", 
           RowBox[{"getDisplaySgFunc", "[", "reflSgLight", "]"}]}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "direction"}], "*)"}], "\[IndentingNewLine]", 
        "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "lightDir"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "    ", 
      RowBox[{"showProps3D", "[", "1", 
       RowBox[{"(*", 
        RowBox[{",", "Medium"}], "*)"}], "]"}]}], "\[IndentingNewLine]", 
     "    ", 
     RowBox[{"(*", 
      RowBox[{",", 
       RowBox[{"ViewPoint", "\[Rule]", 
        RowBox[{"Dynamic", "[", "dynViewPt", "]"}]}]}], "*)"}], 
     "\[IndentingNewLine]", " ", "]"}]}], ",", "\[IndentingNewLine]", "   ", 
   "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"horzRoughness", ",", "0.1"}], "}"}], ",", "0.01", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vertRoughness", ",", "0.1"}], "}"}], ",", "0.01", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirX", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirZ", ",", "0.5"}], "}"}], ",", "0.5", ",", "1"}], "}"}],
    ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "0", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPt", ",", 
       RowBox[{"{", 
        RowBox[{"0.5", ",", "0.35", ",", 
         RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5"}], ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "0.5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "1", ",", 
       RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"samplingRadius", ",", "0.3"}], "}"}], ",", "0.1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"reflShading1", ",", "reflShading"}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "    ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8358601390688047`*^9, 3.8358601456084285`*^9}, {
   3.8358618675745816`*^9, 3.8358619473291445`*^9}, {3.835862041750949*^9, 
   3.835862066746735*^9}, {3.8358622418832865`*^9, 3.8358622562379932`*^9}, {
   3.835862286963846*^9, 3.8358622879657707`*^9}, {3.835862325984318*^9, 
   3.8358623838357663`*^9}, {3.8358624295047874`*^9, 
   3.8358624295668592`*^9}, {3.835862569367379*^9, 3.8358627388761253`*^9}, {
   3.835862797976509*^9, 3.835862805853713*^9}, {3.835863261950881*^9, 
   3.8358632877434316`*^9}, {3.83586333669179*^9, 3.8358634843302946`*^9}, {
   3.835863528729794*^9, 3.835863673777313*^9}, {3.835863731310898*^9, 
   3.8358637682550573`*^9}, {3.835863808776508*^9, 3.835863933925885*^9}, {
   3.83586400094868*^9, 3.8358640085692697`*^9}, 3.835864041428153*^9, {
   3.8358641561433935`*^9, 3.8358641625166106`*^9}, {3.83586421426118*^9, 
   3.835864222446626*^9}, {3.8372438605949774`*^9, 3.8372438657063265`*^9}},
 CellLabel->
  "In[821]:=",ExpressionUUID->"c575e3e2-71c4-4df6-9849-2f7ebcf28c37"],

Cell[BoxData[
 StyleBox["\<\" Reflect SG Light\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.835863513942253*^9, 3.8358635512505293`*^9}, {
   3.835863622008937*^9, 3.8358636783926272`*^9}, {3.835863737736973*^9, 
   3.835863769158305*^9}, {3.8358638105693007`*^9, 3.835863831980082*^9}, 
   3.8358638911071973`*^9, {3.8358639350473146`*^9, 3.8358639593491783`*^9}, {
   3.835864009383561*^9, 3.835864041834972*^9}, {3.8358641640126715`*^9, 
   3.8358642231964264`*^9}, 3.8359289042796507`*^9, 3.8372438683892193`*^9},
 CellLabel->
  "During evaluation of \
In[821]:=",ExpressionUUID->"f781d4c2-7efa-4e59-80a9-bcaf08ce6476"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`horzRoughness$$ = 
    0.1, $CellContext`lightDirX$$ = -1, $CellContext`lightDirZ$$ = 
    0.5, $CellContext`lightIntensity$$ = 1, $CellContext`reflShading1$$ = 
    0.0010215486361766118`, $CellContext`samplingRadius$$ = 
    0.3, $CellContext`shadingPt$$ = {0.5, 
    0.35, -0.5}, $CellContext`vertRoughness$$ = 0.1, Typeset`show$$ = False, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`horzRoughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`vertRoughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`lightDirX$$], -1}, -1, 0}, {{
       Hold[$CellContext`lightDirZ$$], 0.5}, 0.5, 1}, {{
       Hold[$CellContext`lightIntensity$$], 1}, 0, 1}, {{
       Hold[$CellContext`shadingPt$$], {0.5, 0.35, -0.5}}, {-0.5, -1, -0.5}, {
      0.5, 1, -0.5}}, {{
       Hold[$CellContext`samplingRadius$$], 0.3}, 0.1, 1}, {{
       Hold[$CellContext`reflShading1$$], 0.0010215486361766118`}}}, 
    Typeset`size$$ = {73., {47., 53.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`horzRoughness$796718$$ = 
    0, $CellContext`vertRoughness$796719$$ = 
    0, $CellContext`lightDirX$796720$$ = 0, $CellContext`lightDirZ$796721$$ = 
    0, $CellContext`lightIntensity$796722$$ = 
    0, $CellContext`shadingPt$796723$$ = {0, 0, 
    0}, $CellContext`samplingRadius$796724$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`horzRoughness$$ = 
        0.1, $CellContext`lightDirX$$ = -1, $CellContext`lightDirZ$$ = 
        0.5, $CellContext`lightIntensity$$ = 
        1, $CellContext`reflShading1$$ = $CellContext`reflShading, \
$CellContext`samplingRadius$$ = 
        0.3, $CellContext`shadingPt$$ = {0.5, 
         0.35, -0.5}, $CellContext`vertRoughness$$ = 0.1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`horzRoughness$$, \
$CellContext`horzRoughness$796718$$, 0], 
        Hold[$CellContext`vertRoughness$$, \
$CellContext`vertRoughness$796719$$, 0], 
        Hold[$CellContext`lightDirX$$, $CellContext`lightDirX$796720$$, 0], 
        Hold[$CellContext`lightDirZ$$, $CellContext`lightDirZ$796721$$, 0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$796722$$, 0], 
        Hold[$CellContext`shadingPt$$, $CellContext`shadingPt$796723$$, {0, 0,
          0}], 
        Hold[$CellContext`samplingRadius$$, \
$CellContext`samplingRadius$796724$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`lightDir = 
        Normalize[{$CellContext`lightDirX$$, -1, $CellContext`lightDirZ$$}]; \
$CellContext`viewPoint = {1.3, -2.4, 2}; $CellContext`realViewDir = 
        Normalize[$CellContext`viewPoint - $CellContext`shadingPt$$]; \
$CellContext`horzNormal = Normalize[{0, 0, 1}]; $CellContext`vertNormal = 
        Normalize[{0, -1, 0}]; $CellContext`horzCenter = {
         0, 0, -0.5}; $CellContext`vertCenter = {0, 1, 
         0}; $CellContext`reflPeakPt := 
        gBRDF`gCalcPeakPoint[$CellContext`vertNormal, \
$CellContext`vertCenter, $CellContext`lightDir, $CellContext`shadingPt$$]; \
$CellContext`reflSgLight = 
        sgCommon`sgReflectLight[$CellContext`shadingPt$$, \
$CellContext`lightDir, $CellContext`lightIntensity$$, \
$CellContext`vertRoughness$$, {$CellContext`reflPeakPt, \
$CellContext`vertNormal, $CellContext`samplingRadius$$}]; \
$CellContext`sgDisplayPt = {-0.5, -0.5, 0.5}; $CellContext`sgndf = 
        sgCommon`sgNDF[$CellContext`horzRoughness$$, 
          
          Part[$CellContext`reflSgLight, 
           1], $CellContext`realViewDir, $CellContext`horzNormal]; \
$CellContext`reflShading := 
        sgCommon`sgDot[$CellContext`reflSgLight, $CellContext`sgndf]; Show[{
          (gPlots3DEx`pltRect3D[
           Association[
           "center" -> $CellContext`horzCenter, 
            "normal" -> $CellContext`horzNormal, "majorAxis" -> {0, 1, 0}, 
            "majorRadius" -> 1, "minorRadius" -> 0.5, "opacity" -> 1, 
            "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              LightBlue]]]& )[
           Association["roughness" -> $CellContext`horzRoughness$$]], 
          (gPlots3DEx`pltRect3D[
           Association[
           "center" -> $CellContext`vertCenter, 
            "normal" -> $CellContext`vertNormal, "plotPts" -> 50, 
            "majorAxis" -> {1, 0, 0}, "majorRadius" -> 0.5, "minorRadius" -> 
            0.5, "colorFunc" -> 
            Function[{$CellContext`x$, $CellContext`y$, $CellContext`z$}, 
              Hue[
               $CellContext`reflLightingFunc[{$CellContext`x$, \
$CellContext`y$, $CellContext`z$}, $CellContext`shadingPt$$, \
$CellContext`vertRoughness$$, $CellContext`lightIntensity$$]]]]]& )[
           Association["roughness" -> $CellContext`vertRoughness$$]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> Slot["shadingPt"], "size" -> 0.01, "color" -> Blue]]& )[
           Association["shadingPt" -> $CellContext`shadingPt$$]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`reflPeakPt, "size" -> 0.02, "color" -> 
            Red]]& )[
           Association[]], 
          (gPlots3DEx`pltCircle3D[
           Association[
           "center" -> $CellContext`reflPeakPt, 
            "normal" -> $CellContext`vertNormal, "radius" -> Slot["radius"], 
            "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              LightGreen]]]& )[
           Association["radius" -> $CellContext`samplingRadius$$]], 
          (gPlots3DEx`pltSphere3D[
           Association[
           "center" -> $CellContext`sgDisplayPt, "radius" -> 0.5, "plotPts" -> 
            50, "mesh" -> None, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              Hue[
               sgCommon`sgVector[
                
                Normalize[{$CellContext`x, $CellContext`y, $CellContext`z} - \
$CellContext`sgDisplayPt], 
                Slot["sg"]]]]]]& )[
           Association[
           "sg" -> $CellContext`getDisplaySgFunc[$CellContext`reflSgLight]]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> {0, -1, 1}, "dir" -> -$CellContext`lightDir, "length" -> 
            0.5]]& )[
           Association[]]}, 
         gPlots3DEx`showProps3D[1]]), 
      "Specifications" :> {{{$CellContext`horzRoughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`vertRoughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`lightDirX$$, -1}, -1, 
         0}, {{$CellContext`lightDirZ$$, 0.5}, 0.5, 
         1}, {{$CellContext`lightIntensity$$, 1}, 0, 
         1}, {{$CellContext`shadingPt$$, {0.5, 
          0.35, -0.5}}, {-0.5, -1, -0.5}, {
         0.5, 1, -0.5}}, {{$CellContext`samplingRadius$$, 0.3}, 0.1, 
         1}, {{$CellContext`reflShading1$$, $CellContext`reflShading}}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{124., {71., 77.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8358635139801517`*^9, 3.835863551275532*^9}, {
   3.835863622030135*^9, 3.835863678415288*^9}, {3.83586373776365*^9, 
   3.835863769187471*^9}, {3.8358638105952635`*^9, 3.835863832007338*^9}, 
   3.8358638911364946`*^9, {3.8358639350711102`*^9, 3.8358639593725753`*^9}, {
   3.835864009406328*^9, 3.8358640418600416`*^9}, {3.835864164043179*^9, 
   3.8358642232242627`*^9}, 3.8359289043285475`*^9, 3.8372438684445496`*^9},
 CellLabel->
  "Out[835]=",ExpressionUUID->"0354ad3f-765a-46ef-9910-8337629b2479"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Circle Intersects Rectangle\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "lightDir", ",", "dynViewPt", ",", "debugViewPoint", ",", "viewPoint", 
     ",", "realViewDir", ",", "\[IndentingNewLine]", "\t", "horzCenter", ",", 
     "horzNormal", ",", "vertCenter", ",", "vertNormal", ",", 
     "\[IndentingNewLine]", "\t", "vertAssistMajorAxis", ",", "vertMajorAxis",
      ",", "vertMinorAxis", ",", "vertMajorRadius", ",", "vertMinorRadius", 
     ",", "\[IndentingNewLine]", "\t", "reflPeakPt", ",", "reflLightingFunc", 
     ",", "reflSgLight", ",", "sgDisplayPt", ",", "getDisplaySg", ",", 
     "sgndf", ",", "reflShading", ",", "\[IndentingNewLine]", "\t", 
     "reflLightingFunc", ",", "getDisplaySgFunc", ",", "circIntsRectPts", ",",
      "circIntsRectArea", ",", "circIntsRect"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"reflLightingFunc", "[", 
     RowBox[{
     "reflPt_", ",", "shadingPt_", ",", "reflRoughness_", ",", 
      "lightIntensity_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "reflViewPt", ",", "reflView", ",", "reflHalf", ",", "noh", ",", "nol",
         ",", "lighting"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"reflViewPt", "=", "shadingPt"}], ";", "\[IndentingNewLine]", 
       RowBox[{"reflView", "=", 
        RowBox[{"Normalize", "[", 
         RowBox[{"reflViewPt", "-", "reflPt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"reflHalf", "=", 
        RowBox[{"Normalize", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"reflView", "+", "lightDir"}], ")"}], "/", "2"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"noh", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{"vertNormal", ",", "reflHalf"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nol", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{"vertNormal", ",", "lightDir"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"lighting", "=", 
        RowBox[{
         RowBox[{"gDGGX", "[", 
          RowBox[{"reflRoughness", ",", "noh"}], "]"}], "*", "nol", "*", 
         "lightIntensity"}]}], ";", "\[IndentingNewLine]", "lighting"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getDisplaySgFunc", "[", "sg_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "dispSg", "}"}], ",", 
      RowBox[{
       RowBox[{"dispSg", "=", "sg"}], ";", 
       RowBox[{
        RowBox[{"dispSg", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", "1"}], "*", 
         RowBox[{"dispSg", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "dispSg"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"lightDirX", ",", 
        RowBox[{"-", "1"}], ",", "lightDirZ"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"dynViewPt", "=", 
       RowBox[{
        RowBox[{"Options", "[", 
         RowBox[{"Graphics3D", ",", "ViewPoint"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"debugViewPoint", "=", 
       RowBox[{"Dynamic", "[", "dynViewPt", "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", "debugViewPoint", "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"viewPoint", "=", 
     RowBox[{"{", 
      RowBox[{"1.3", ",", 
       RowBox[{"-", "2.4"}], ",", "2"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"realViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"viewPoint", "-", "shadingPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"normals", " ", "for", " ", "rectangle"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"horzNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"vertNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"horzCenter", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "0.5"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"vertCenter", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"vertAssistMajorAxis", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vertMajorAxis", ",", "vertMinorAxis"}], "}"}], "=", 
     RowBox[{"gCalcPlaneTangents", "[", 
      RowBox[{"vertNormal", ",", "vertAssistMajorAxis"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"vertMajorRadius", "=", "0.5"}], ";", "\[IndentingNewLine]", 
    RowBox[{"vertMinorRadius", "=", "0.5"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"reflPeakPt", "=", 
     RowBox[{"gCalcPeakPoint", "[", 
      RowBox[{
      "vertNormal", ",", "vertCenter", ",", "lightDir", ",", "shadingPt"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"reflSgLight", "=", 
     RowBox[{"sgReflectLight", "[", 
      RowBox[{
      "shadingPt", ",", "lightDir", ",", "lightIntensity", ",", 
       "vertRoughness", ",", 
       RowBox[{"{", 
        RowBox[{"reflPeakPt", ",", "vertNormal", ",", "samplingRadius"}], 
        "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sgDisplayPt", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5"}], ",", 
       RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"sgndf", "=", 
     RowBox[{"sgNDF", "[", 
      RowBox[{"horzRoughness", ",", 
       RowBox[{"reflSgLight", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "realViewDir", ",", 
       "horzNormal"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"reflShading", "=", 
     RowBox[{"sgDot", "[", 
      RowBox[{"reflSgLight", ",", "sgndf"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"circIntsRectPts", "=", 
     RowBox[{"gCircIntsRectPts", "[", 
      RowBox[{
      "reflPeakPt", ",", "samplingRadius", ",", "vertCenter", ",", 
       "\[IndentingNewLine]", "\t", "vertMajorAxis", ",", "vertMinorAxis", 
       ",", "vertMajorRadius", ",", "vertMinorRadius"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"circIntsRectArea", "=", 
     RowBox[{"gCircIntsRectArea", "[", 
      RowBox[{
      "reflPeakPt", ",", "samplingRadius", ",", "vertCenter", ",", 
       "\[IndentingNewLine]", "\t", "vertMajorAxis", ",", "vertMinorAxis", 
       ",", "vertMajorRadius", ",", "vertMinorRadius"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"circIntsRect", "=", 
     FractionBox["circIntsRectArea", 
      RowBox[{"4", "*", "samplingRadius", "*", "samplingRadius"}]]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "  ", 
       RowBox[{"(*", 
        RowBox[{"horizontal", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
       "  ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pltRect3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "horzCenter"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "horzNormal"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "LightBlue"}],
                "]"}]}]}], "|>"}], "\[IndentingNewLine]", "  ", "]"}], "&"}], 
         "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "horzRoughness"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "  ", 
        RowBox[{"(*", 
         RowBox[{"vertical", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
        "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRect3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "vertCenter"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "vertNormal"}], ",", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "50"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", "vertAssistMajorAxis"}], 
             ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "vertMajorRadius"}], 
             ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "vertMinorRadius"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Black"}], 
               RowBox[{"(*", 
                RowBox[{"Hue", "@", 
                 RowBox[{"reflLightingFunc", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                   "shadingPt", ",", "vertRoughness", ",", "lightIntensity"}],
                   "]"}]}], "*)"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", 
           "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "vertRoughness"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", "points", "*)"}], "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "#shadingPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<shadingPt\>\"", "\[Rule]", "shadingPt"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.02"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", 
         RowBox[{"sampling", " ", "area"}], "*)"}], "\[IndentingNewLine]", 
        "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltCircle3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "vertNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "#radius"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Green"}], 
               "]"}]}]}], "|>"}], "\[IndentingNewLine]", "\t", "]"}], "&"}], 
         "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "  ", 
        RowBox[{"(*", 
         RowBox[{"intersection", " ", "area"}], "*)"}], "\[IndentingNewLine]",
         "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltLine3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<points\>\"", "\[Rule]", "circIntsRectPts"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", 
         RowBox[{"SG", " ", "Reflection", " ", "Light"}], "*)"}], 
        "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltSphere3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "sgDisplayPt"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "50"}], ",", 
             RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                RowBox[{"Hue", "@", 
                 RowBox[{"sgVector", "[", 
                  RowBox[{
                   RowBox[{"Normalize", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], "-", 
                    "sgDisplayPt"}], "]"}], ",", "#sg"}], "]"}]}]}], 
               "]"}]}]}], "|>"}], "\[IndentingNewLine]", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<sg\>\"", "\[Rule]", 
           RowBox[{"getDisplaySgFunc", "[", "reflSgLight", "]"}]}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "direction"}], "*)"}], "\[IndentingNewLine]", 
        "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "lightDir"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "    ", 
      RowBox[{"showProps3D", "[", "1", 
       RowBox[{"(*", 
        RowBox[{",", "Medium"}], "*)"}], "]"}]}], "\[IndentingNewLine]", 
     "    ", 
     RowBox[{"(*", 
      RowBox[{",", 
       RowBox[{"ViewPoint", "\[Rule]", 
        RowBox[{"Dynamic", "[", "dynViewPt", "]"}]}]}], "*)"}], 
     "\[IndentingNewLine]", " ", "]"}]}], ",", "\[IndentingNewLine]", "   ", 
   "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"horzRoughness", ",", "0.1"}], "}"}], ",", "0.01", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vertRoughness", ",", "0.1"}], "}"}], ",", "0.01", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirX", ",", 
       RowBox[{"-", "0"}]}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirZ", ",", "0.5"}], "}"}], ",", "0.1", ",", "1"}], "}"}],
    ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "0", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.5"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5"}], ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "0.5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "1", ",", 
       RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"samplingRadius", ",", "0.3"}], "}"}], ",", "0.1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"reflShading1", ",", "reflShading"}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"circIntsRect1", ",", "circIntsRect"}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "    ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8359288854502954`*^9, 3.835928914244629*^9}},
 CellLabel->
  "In[836]:=",ExpressionUUID->"4227ce91-e8ea-48ec-a769-bd30d6144d66"],

Cell[BoxData[
 StyleBox["\<\" Circle Intersects Rectangle\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.8359288975970173`*^9, 3.8359289153545685`*^9}, 
   3.8372438691331224`*^9},
 CellLabel->
  "During evaluation of \
In[836]:=",ExpressionUUID->"3708833f-7141-4db9-bef7-32602f02c1a8"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`circIntsRect1$$ = 
    0.24999999999999997`, $CellContext`horzRoughness$$ = 
    0.1, $CellContext`lightDirX$$ = 0, $CellContext`lightDirZ$$ = 
    0.5, $CellContext`lightIntensity$$ = 1, $CellContext`reflShading1$$ = 
    3.640073199095238*^-8, $CellContext`samplingRadius$$ = 
    0.3, $CellContext`shadingPt$$ = {-0.5, -1, -0.5}, \
$CellContext`vertRoughness$$ = 0.1, Typeset`show$$ = False, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`horzRoughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`vertRoughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`lightDirX$$], 0}, -1, 0}, {{
       Hold[$CellContext`lightDirZ$$], 0.5}, 0.1, 1}, {{
       Hold[$CellContext`lightIntensity$$], 1}, 0, 1}, {{
       Hold[$CellContext`shadingPt$$], {-0.5, -1, -0.5}}, {-0.5, -1, -0.5}, {
      0.5, 1, -0.5}}, {{
       Hold[$CellContext`samplingRadius$$], 0.3}, 0.1, 1}, {{
       Hold[$CellContext`reflShading1$$], 3.640073199095238*^-8}}, {{
       Hold[$CellContext`circIntsRect1$$], 0.24999999999999997`}}}, 
    Typeset`size$$ = {72., {47., 53.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`horzRoughness$801911$$ = 
    0, $CellContext`vertRoughness$801912$$ = 
    0, $CellContext`lightDirX$801913$$ = 0, $CellContext`lightDirZ$801914$$ = 
    0, $CellContext`lightIntensity$801915$$ = 
    0, $CellContext`shadingPt$801916$$ = {0, 0, 
    0}, $CellContext`samplingRadius$801917$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`circIntsRect1$$ = \
$CellContext`circIntsRect, $CellContext`horzRoughness$$ = 
        0.1, $CellContext`lightDirX$$ = 0, $CellContext`lightDirZ$$ = 
        0.5, $CellContext`lightIntensity$$ = 
        1, $CellContext`reflShading1$$ = $CellContext`reflShading, \
$CellContext`samplingRadius$$ = 
        0.3, $CellContext`shadingPt$$ = {-0.5, -1, -0.5}, \
$CellContext`vertRoughness$$ = 0.1}, "ControllerVariables" :> {
        Hold[$CellContext`horzRoughness$$, \
$CellContext`horzRoughness$801911$$, 0], 
        Hold[$CellContext`vertRoughness$$, \
$CellContext`vertRoughness$801912$$, 0], 
        Hold[$CellContext`lightDirX$$, $CellContext`lightDirX$801913$$, 0], 
        Hold[$CellContext`lightDirZ$$, $CellContext`lightDirZ$801914$$, 0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$801915$$, 0], 
        Hold[$CellContext`shadingPt$$, $CellContext`shadingPt$801916$$, {0, 0,
          0}], 
        Hold[$CellContext`samplingRadius$$, \
$CellContext`samplingRadius$801917$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`lightDir = 
        Normalize[{$CellContext`lightDirX$$, -1, $CellContext`lightDirZ$$}]; \
$CellContext`viewPoint = {1.3, -2.4, 2}; $CellContext`realViewDir = 
        Normalize[$CellContext`viewPoint - $CellContext`shadingPt$$]; \
$CellContext`horzNormal = Normalize[{0, 0, 1}]; $CellContext`vertNormal = 
        Normalize[{0, -1, 0}]; $CellContext`horzCenter = {
         0, 0, -0.5}; $CellContext`vertCenter = {0, 1, 
         0}; $CellContext`vertAssistMajorAxis = {1, 0, 
         0}; {$CellContext`vertMajorAxis, $CellContext`vertMinorAxis} = 
        gUtils`gCalcPlaneTangents[$CellContext`vertNormal, \
$CellContext`vertAssistMajorAxis]; $CellContext`vertMajorRadius = 
        0.5; $CellContext`vertMinorRadius = 0.5; $CellContext`reflPeakPt = 
        gBRDF`gCalcPeakPoint[$CellContext`vertNormal, \
$CellContext`vertCenter, $CellContext`lightDir, $CellContext`shadingPt$$]; \
$CellContext`reflSgLight = 
        sgCommon`sgReflectLight[$CellContext`shadingPt$$, \
$CellContext`lightDir, $CellContext`lightIntensity$$, \
$CellContext`vertRoughness$$, {$CellContext`reflPeakPt, \
$CellContext`vertNormal, $CellContext`samplingRadius$$}]; \
$CellContext`sgDisplayPt = {-0.5, -0.5, 0.5}; $CellContext`sgndf = 
        sgCommon`sgNDF[$CellContext`horzRoughness$$, 
          
          Part[$CellContext`reflSgLight, 
           1], $CellContext`realViewDir, $CellContext`horzNormal]; \
$CellContext`reflShading = 
        sgCommon`sgDot[$CellContext`reflSgLight, $CellContext`sgndf]; \
$CellContext`circIntsRectPts = 
        gUtils`gCircIntsRectPts[$CellContext`reflPeakPt, \
$CellContext`samplingRadius$$, $CellContext`vertCenter, \
$CellContext`vertMajorAxis, $CellContext`vertMinorAxis, \
$CellContext`vertMajorRadius, $CellContext`vertMinorRadius]; \
$CellContext`circIntsRectArea = 
        gUtils`gCircIntsRectArea[$CellContext`reflPeakPt, \
$CellContext`samplingRadius$$, $CellContext`vertCenter, \
$CellContext`vertMajorAxis, $CellContext`vertMinorAxis, \
$CellContext`vertMajorRadius, $CellContext`vertMinorRadius]; \
$CellContext`circIntsRect = $CellContext`circIntsRectArea/(
         4 $CellContext`samplingRadius$$ $CellContext`samplingRadius$$); Show[{
          (gPlots3DEx`pltRect3D[
           Association[
           "center" -> $CellContext`horzCenter, 
            "normal" -> $CellContext`horzNormal, "majorAxis" -> {0, 1, 0}, 
            "majorRadius" -> 1, "minorRadius" -> 0.5, "opacity" -> 1, 
            "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              LightBlue]]]& )[
           Association["roughness" -> $CellContext`horzRoughness$$]], 
          (gPlots3DEx`pltRect3D[
           Association[
           "center" -> $CellContext`vertCenter, 
            "normal" -> $CellContext`vertNormal, "plotPts" -> 50, 
            "majorAxis" -> $CellContext`vertAssistMajorAxis, 
            "majorRadius" -> $CellContext`vertMajorRadius, 
            "minorRadius" -> $CellContext`vertMinorRadius, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              Black]]]& )[
           Association["roughness" -> $CellContext`vertRoughness$$]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> Slot["shadingPt"], "size" -> 0.01, "color" -> Blue]]& )[
           Association["shadingPt" -> $CellContext`shadingPt$$]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`reflPeakPt, "size" -> 0.02, "color" -> 
            Red]]& )[
           Association[]], 
          (gPlots3DEx`pltCircle3D[
           Association[
           "center" -> $CellContext`reflPeakPt, 
            "normal" -> $CellContext`vertNormal, "radius" -> Slot["radius"], 
            "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              Green]]]& )[
           Association["radius" -> $CellContext`samplingRadius$$]], 
          (gPlots3DEx`pltLine3D[
           Association[
           "points" -> $CellContext`circIntsRectPts, "color" -> Blue]]& )[
           Association[]], 
          (gPlots3DEx`pltSphere3D[
           Association[
           "center" -> $CellContext`sgDisplayPt, "radius" -> 0.5, "plotPts" -> 
            50, "mesh" -> None, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              Hue[
               sgCommon`sgVector[
                
                Normalize[{$CellContext`x, $CellContext`y, $CellContext`z} - \
$CellContext`sgDisplayPt], 
                Slot["sg"]]]]]]& )[
           Association[
           "sg" -> $CellContext`getDisplaySgFunc[$CellContext`reflSgLight]]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> {0, -1, 1}, "dir" -> -$CellContext`lightDir, "length" -> 
            0.5]]& )[
           Association[]]}, 
         gPlots3DEx`showProps3D[1]]), 
      "Specifications" :> {{{$CellContext`horzRoughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`vertRoughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`lightDirX$$, 0}, -1, 
         0}, {{$CellContext`lightDirZ$$, 0.5}, 0.1, 
         1}, {{$CellContext`lightIntensity$$, 1}, 0, 
         1}, {{$CellContext`shadingPt$$, {-0.5, -1, -0.5}}, {-0.5, -1, -0.5}, \
{0.5, 1, -0.5}}, {{$CellContext`samplingRadius$$, 0.3}, 0.1, 
         1}, {{$CellContext`reflShading1$$, $CellContext`reflShading}}, \
{{$CellContext`circIntsRect1$$, $CellContext`circIntsRect}}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{123., {71., 77.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.835928897639965*^9, 3.835928915395136*^9}, 
   3.8372438691800613`*^9},
 CellLabel->
  "Out[840]=",ExpressionUUID->"a40cf5e5-c4d0-442a-b474-4a82bf037074"],

Cell[BoxData[
 TemplateBox[{
  "General","munfl",
   "\"\\!\\(\\*RowBox[{\\\"Exp\\\", \\\"[\\\", RowBox[{\\\"-\\\", \
\\\"842.0510019599284`\\\"}], \\\"]\\\"}]\\) is too small to represent as a \
normalized machine number; precision may be lost.\"",2,841,144,
   33888486632502725135,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.83724387054626*^9},
 CellLabel->"",ExpressionUUID->"1401e131-9533-4a59-8ee6-ce570d03de04"]
}, Open  ]]
},
WindowSize->{1191, 804},
WindowMargins->{{43, Automatic}, {-29, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 17706, 430, 1853, "Input",ExpressionUUID->"c575e3e2-71c4-4df6-9849-2f7ebcf28c37"],
Cell[18289, 454, 695, 13, 30, "Print",ExpressionUUID->"f781d4c2-7efa-4e59-80a9-bcaf08ce6476"],
Cell[18987, 469, 8405, 164, 167, "Output",ExpressionUUID->"0354ad3f-765a-46ef-9910-8337629b2479"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27429, 638, 18064, 435, 1990, "Input",ExpressionUUID->"4227ce91-e8ea-48ec-a769-bd30d6144d66"],
Cell[45496, 1075, 356, 9, 30, "Print",ExpressionUUID->"3708833f-7141-4db9-bef7-32602f02c1a8"],
Cell[45855, 1086, 9275, 180, 167, "Output",ExpressionUUID->"a40cf5e5-c4d0-442a-b474-4a82bf037074"],
Cell[55133, 1268, 446, 9, 23, "Message",ExpressionUUID->"1401e131-9533-4a59-8ee6-ce570d03de04"]
}, Open  ]]
}
]
*)

