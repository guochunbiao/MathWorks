(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28930,        750]
NotebookOptionsPosition[     27641,        721]
NotebookOutlinePosition[     28011,        737]
CellTagsIndexPosition[     27968,        734]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"CellContext", "\[Rule]", "Notebook"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gTexStyles`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gBlochSphere`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"blPaperSphere01", "[", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"blPaperIntsDisk02", "[", 
      RowBox[{"diskCenter", ",", 
       RowBox[{"{", 
        RowBox[{"diskNormalTheta", ",", "diskNormalPhi"}], "}"}], ",", 
       "diskRadius"}], "]"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.3"}], ",", "1.3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.3"}], ",", "1.3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.3"}], ",", "1.3"}], "}"}]}], "}"}]}], ",", "\n", 
     "\t\t", 
     RowBox[{"Axes", "\[Rule]", "True"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"AspectRatio", "->", "1"}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", "Right"}], ",", "\[IndentingNewLine]", 
     "\t    ", 
     RowBox[{"ViewProjection", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
     ",", "\[IndentingNewLine]", "\t    ", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskCenter", ",", 
       RowBox[{"{", 
        RowBox[{"0.6", ",", "0.5", ",", "0.5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalTheta", ",", 
       RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalPhi", ",", 
       RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskRadius", ",", "0.35"}], "}"}], ",", "0.1", ",", "0.6"}], 
    "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.83556677251548*^9, 3.8355667905878143`*^9}, {
   3.835567128546254*^9, 3.835567129455933*^9}, {3.8355684470263543`*^9, 
   3.8355684773835554`*^9}, 3.835568645711259*^9, {3.8355689911103387`*^9, 
   3.8355690191965914`*^9}, {3.835569092439534*^9, 3.835569223745946*^9}, {
   3.8355693013477325`*^9, 3.8355693064316397`*^9}, {3.8355707860766497`*^9, 
   3.835570797530777*^9}, 3.8355714148867865`*^9, {3.8355716898572817`*^9, 
   3.8355716955648108`*^9}, {3.835571737265605*^9, 3.8355717444358616`*^9}, {
   3.8355781821490135`*^9, 3.835578183888484*^9}, {3.8355782204170237`*^9, 
   3.8355782295069995`*^9}, 3.8355782653412085`*^9, {3.8355808183298645`*^9, 
   3.8355808201215796`*^9}, {3.8355808940991764`*^9, 3.835580899695227*^9}, {
   3.835581577271477*^9, 3.8355816184339347`*^9}, {3.8355816632407055`*^9, 
   3.835581700698842*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"4a3c6b78-aa1a-45a1-a9ff-d84914e37d9f"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`diskCenter$$ = {1., 0.14, 
    0.}, $CellContext`diskNormalPhi$$ = Rational[1, 4] 
    Pi, $CellContext`diskNormalTheta$$ = Rational[1, 4] 
    Pi, $CellContext`diskRadius$$ = 0.35, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`diskCenter$$], {0.6, 0.5, 0.5}}, {0, 0, 0}, {1, 1, 
      1}}, {{
       Hold[$CellContext`diskNormalTheta$$], Rational[1, 4] Pi}, 0, 
      Rational[1, 2] Pi}, {{
       Hold[$CellContext`diskNormalPhi$$], Rational[1, 4] Pi}, 0, 2 Pi}, {{
       Hold[$CellContext`diskRadius$$], 0.35}, 0.1, 0.6}}, Typeset`size$$ = {
    576., {290., 294.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`diskCenter$376533$$ = {0, 0, 
    0}, $CellContext`diskNormalTheta$376534$$ = 
    0, $CellContext`diskNormalPhi$376535$$ = 
    0, $CellContext`diskRadius$376536$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`diskCenter$$ = {0.6, 0.5, 
         0.5}, $CellContext`diskNormalPhi$$ = 
        Rational[1, 4] Pi, $CellContext`diskNormalTheta$$ = 
        Rational[1, 4] Pi, $CellContext`diskRadius$$ = 0.35}, 
      "ControllerVariables" :> {
        Hold[$CellContext`diskCenter$$, $CellContext`diskCenter$376533$$, {0, 
         0, 0}], 
        Hold[$CellContext`diskNormalTheta$$, \
$CellContext`diskNormalTheta$376534$$, 0], 
        Hold[$CellContext`diskNormalPhi$$, \
$CellContext`diskNormalPhi$376535$$, 0], 
        Hold[$CellContext`diskRadius$$, $CellContext`diskRadius$376536$$, 0]},
       "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[
        gBlochSphere`blPaperSphere01[], 
        gBlochSphere`blPaperIntsDisk02[$CellContext`diskCenter$$, \
{$CellContext`diskNormalTheta$$, $CellContext`diskNormalPhi$$}, \
$CellContext`diskRadius$$], 
        PlotRange -> {{-1.3, 1.3}, {-1.3, 1.3}, {-1.3, 1.3}}, Axes -> True, 
        Boxed -> False, AspectRatio -> 1, ViewPoint -> Right, ViewProjection -> 
        "Orthographic", AxesLabel -> {"X", "Y", "Z"}, ImageSize -> Large], 
      "Specifications" :> {{{$CellContext`diskCenter$$, {0.6, 0.5, 0.5}}, {0, 
         0, 0}, {1, 1, 
         1}}, {{$CellContext`diskNormalTheta$$, Rational[1, 4] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`diskNormalPhi$$, Rational[1, 4] Pi}, 0, 2 
         Pi}, {{$CellContext`diskRadius$$, 0.35}, 0.1, 0.6}}, "Options" :> {},
       "DefaultOptions" :> {}],
     ImageSizeCache->{627., {374., 380.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8355809004995756`*^9, 3.835582582349592*^9, {3.8355826488533354`*^9, 
   3.835582725851102*^9}, 3.835582922293563*^9, {3.8355830597351933`*^9, 
   3.835583111620669*^9}, {3.8355831551591034`*^9, 3.8355831622821007`*^9}},
 CellLabel->
  "Out[202]=",ExpressionUUID->"3053f5c2-a1b9-4171-9b66-0d96800cd3e8"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.835568595322818*^9, 
  3.8355686075848083`*^9}},ExpressionUUID->"d73859ca-2fbb-44b1-afd0-\
b1df2d7d6c82"],

Cell[BoxData[{
 RowBox[{"a1", "=", 
  RowBox[{"FindInstance", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"y", "^", "2"}], "+", 
       RowBox[{"z", "^", "2"}]}], "\[Equal]", "1"}], "&&", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "0.6469966392206306`"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", "0.5391638660171921`"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z", "-", "0.5391638660171921`"}], ")"}], "^", "2"}]}], 
      "\[Equal]", 
      RowBox[{"0.35", "^", "2"}]}], "&&", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], "-", 
         RowBox[{"{", 
          RowBox[{
          "0.6469966392206306`", ",", "0.5391638660171921`", ",", 
           "0.5391638660171921`"}], "}"}]}], ",", 
        RowBox[{"Normalize", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.5"}], ",", 
           RowBox[{"-", "0.5"}], ",", "0"}], "}"}], "]"}]}], "]"}], 
      "\[Equal]", "0"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Reals", ",", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "a1", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a2", "=", 
   RowBox[{"Transpose", "@", "a1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"a2", "[", 
  RowBox[{"[", 
   RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"a2", "[", 
  RowBox[{"[", 
   RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8355790574048204`*^9, 3.8355791934898624`*^9}, {
  3.835579246712286*^9, 3.8355793066574783`*^9}, {3.8355793763325195`*^9, 
  3.8355793765375705`*^9}, {3.8355797147845793`*^9, 3.8355797340226793`*^9}, {
  3.8355797650788965`*^9, 3.8355798529414062`*^9}, {3.8355799095413647`*^9, 
  3.83557998447099*^9}, {3.8355801389021454`*^9, 3.835580180229082*^9}, {
  3.835580240402753*^9, 3.835580263844839*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"0def8419-59c0-4371-bf21-d8f70b12d793"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"c", ",", "r", ",", "nx", ",", "ny", ",", "nz"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "-", "c"}], "]"}], 
     "\[Equal]", "r"}], "&&", 
    RowBox[{
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}], "]"}], "\[Equal]", 
     "0"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8355810212603507`*^9, 3.835581084433463*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"2fcf2990-9b6c-4f40-ae6a-d18088231bf6"],

Cell[BoxData[
 TemplateBox[{
  "Solve","svars",
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"",2,
   35,8,33877601168836337520,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8355810849873867`*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"384a42e7-bbc0-4fd9-ab36-f71a61619897"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "c", " ", "ny", " ", "nz"}], "+", 
        RowBox[{"2", " ", "c", " ", 
         SuperscriptBox["nz", "2"]}], "-", 
        RowBox[{"2", " ", "nx", " ", "ny", " ", "x"}], "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "c", " ", "ny", " ", "nz"}], "-", 
             RowBox[{"2", " ", "c", " ", 
              SuperscriptBox["nz", "2"]}], "+", 
             RowBox[{"2", " ", "nx", " ", "ny", " ", "x"}]}], ")"}], "2"], 
          "-", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["ny", "2"], "+", 
             SuperscriptBox["nz", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", 
              SuperscriptBox["c", "2"], " ", 
              SuperscriptBox["nz", "2"]}], "-", 
             RowBox[{
              SuperscriptBox["nz", "2"], " ", 
              SuperscriptBox["r", "2"]}], "+", 
             RowBox[{"2", " ", "c", " ", "nx", " ", "nz", " ", "x"}], "-", 
             RowBox[{"2", " ", "c", " ", 
              SuperscriptBox["nz", "2"], " ", "x"}], "+", 
             RowBox[{
              SuperscriptBox["nx", "2"], " ", 
              SuperscriptBox["x", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["nz", "2"], " ", 
              SuperscriptBox["x", "2"]}]}], ")"}]}]}]]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["ny", "2"], "+", 
          SuperscriptBox["nz", "2"]}], ")"}]}]]}], ",", 
     RowBox[{"z", "\[Rule]", 
      FractionBox[
       RowBox[{
        FractionBox[
         RowBox[{"c", " ", 
          SuperscriptBox["ny", "2"], " ", "nz"}], 
         RowBox[{
          SuperscriptBox["ny", "2"], "+", 
          SuperscriptBox["nz", "2"]}]], "-", 
        FractionBox[
         RowBox[{"c", " ", "ny", " ", 
          SuperscriptBox["nz", "2"]}], 
         RowBox[{
          SuperscriptBox["ny", "2"], "+", 
          SuperscriptBox["nz", "2"]}]], "-", 
        RowBox[{"nx", " ", "x"}], "+", 
        FractionBox[
         RowBox[{"nx", " ", 
          SuperscriptBox["ny", "2"], " ", "x"}], 
         RowBox[{
          SuperscriptBox["ny", "2"], "+", 
          SuperscriptBox["nz", "2"]}]], "-", 
        FractionBox[
         RowBox[{"ny", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "c", " ", "ny", " ", "nz"}], "-", 
               RowBox[{"2", " ", "c", " ", 
                SuperscriptBox["nz", "2"]}], "+", 
               RowBox[{"2", " ", "nx", " ", "ny", " ", "x"}]}], ")"}], "2"], 
            "-", 
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["ny", "2"], "+", 
               SuperscriptBox["nz", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", " ", 
                SuperscriptBox["c", "2"], " ", 
                SuperscriptBox["nz", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["nz", "2"], " ", 
                SuperscriptBox["r", "2"]}], "+", 
               RowBox[{"2", " ", "c", " ", "nx", " ", "nz", " ", "x"}], "-", 
               RowBox[{"2", " ", "c", " ", 
                SuperscriptBox["nz", "2"], " ", "x"}], "+", 
               RowBox[{
                SuperscriptBox["nx", "2"], " ", 
                SuperscriptBox["x", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["nz", "2"], " ", 
                SuperscriptBox["x", "2"]}]}], ")"}]}]}]]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["ny", "2"], "+", 
            SuperscriptBox["nz", "2"]}], ")"}]}]]}], "nz"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "c", " ", "ny", " ", "nz"}], "+", 
        RowBox[{"2", " ", "c", " ", 
         SuperscriptBox["nz", "2"]}], "-", 
        RowBox[{"2", " ", "nx", " ", "ny", " ", "x"}], "-", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "c", " ", "ny", " ", "nz"}], "-", 
             RowBox[{"2", " ", "c", " ", 
              SuperscriptBox["nz", "2"]}], "+", 
             RowBox[{"2", " ", "nx", " ", "ny", " ", "x"}]}], ")"}], "2"], 
          "-", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["ny", "2"], "+", 
             SuperscriptBox["nz", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", 
              SuperscriptBox["c", "2"], " ", 
              SuperscriptBox["nz", "2"]}], "-", 
             RowBox[{
              SuperscriptBox["nz", "2"], " ", 
              SuperscriptBox["r", "2"]}], "+", 
             RowBox[{"2", " ", "c", " ", "nx", " ", "nz", " ", "x"}], "-", 
             RowBox[{"2", " ", "c", " ", 
              SuperscriptBox["nz", "2"], " ", "x"}], "+", 
             RowBox[{
              SuperscriptBox["nx", "2"], " ", 
              SuperscriptBox["x", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["nz", "2"], " ", 
              SuperscriptBox["x", "2"]}]}], ")"}]}]}]]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["ny", "2"], "+", 
          SuperscriptBox["nz", "2"]}], ")"}]}]]}], ",", 
     RowBox[{"z", "\[Rule]", 
      FractionBox[
       RowBox[{
        FractionBox[
         RowBox[{"c", " ", 
          SuperscriptBox["ny", "2"], " ", "nz"}], 
         RowBox[{
          SuperscriptBox["ny", "2"], "+", 
          SuperscriptBox["nz", "2"]}]], "-", 
        FractionBox[
         RowBox[{"c", " ", "ny", " ", 
          SuperscriptBox["nz", "2"]}], 
         RowBox[{
          SuperscriptBox["ny", "2"], "+", 
          SuperscriptBox["nz", "2"]}]], "-", 
        RowBox[{"nx", " ", "x"}], "+", 
        FractionBox[
         RowBox[{"nx", " ", 
          SuperscriptBox["ny", "2"], " ", "x"}], 
         RowBox[{
          SuperscriptBox["ny", "2"], "+", 
          SuperscriptBox["nz", "2"]}]], "+", 
        FractionBox[
         RowBox[{"ny", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "c", " ", "ny", " ", "nz"}], "-", 
               RowBox[{"2", " ", "c", " ", 
                SuperscriptBox["nz", "2"]}], "+", 
               RowBox[{"2", " ", "nx", " ", "ny", " ", "x"}]}], ")"}], "2"], 
            "-", 
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["ny", "2"], "+", 
               SuperscriptBox["nz", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", " ", 
                SuperscriptBox["c", "2"], " ", 
                SuperscriptBox["nz", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["nz", "2"], " ", 
                SuperscriptBox["r", "2"]}], "+", 
               RowBox[{"2", " ", "c", " ", "nx", " ", "nz", " ", "x"}], "-", 
               RowBox[{"2", " ", "c", " ", 
                SuperscriptBox["nz", "2"], " ", "x"}], "+", 
               RowBox[{
                SuperscriptBox["nx", "2"], " ", 
                SuperscriptBox["x", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["nz", "2"], " ", 
                SuperscriptBox["x", "2"]}]}], ")"}]}]}]]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["ny", "2"], "+", 
            SuperscriptBox["nz", "2"]}], ")"}]}]]}], "nz"]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.835581085003491*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"657ff960-6092-4eae-8122-3305b336cf89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "[", 
   RowBox[{"theta_", ",", "phi_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "theta", "]"}], "*", 
     RowBox[{"Cos", "[", "phi", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Sin", "[", "theta", "]"}], "*", 
     RowBox[{"Sin", "[", "phi", "]"}]}], ",", 
    RowBox[{"Cos", "[", "theta", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ParametricPlot3D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RotationMatrix", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"theta", ",", "phi"}], "]"}]}], "}"}], "]"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", "*", 
           RowBox[{"Sin", "[", 
            RowBox[{"Pi", "/", "2"}], "]"}], "*", 
           RowBox[{"Cos", "[", "Phi", "]"}]}], ",", 
          RowBox[{"r", "*", 
           RowBox[{"Sin", "[", 
            RowBox[{"Pi", "/", "2"}], "]"}], " ", 
           RowBox[{"Sin", "[", "Phi", "]"}]}], ",", 
          RowBox[{"r", "*", 
           RowBox[{"Cos", "[", 
            RowBox[{"Pi", "/", "2"}], "]"}]}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Phi", ",", "0", ",", 
         RowBox[{"2", "*", "Pi"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}], ",", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"n", "[", 
            RowBox[{"theta", ",", "phi"}], "]"}]}], "}"}], "]"}]}], "}"}], 
      "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"theta", ",", "0", ",", 
     RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"phi", ",", "0", ",", "Pi"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.835581206797954*^9, 3.835581215568286*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"dcdc4820-0bd7-4ca0-b388-907121bf135b"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`phi$$ = 
    0.13194689145077132`, $CellContext`theta$$ = 1.0555751316061706`, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`theta$$], 0, 2 Pi}, {
      Hold[$CellContext`phi$$], 0, Pi}}, Typeset`size$$ = {
    360., {200., 204.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`theta$35444$$ = 
    0, $CellContext`phi$35445$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`phi$$ = 0, $CellContext`theta$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`theta$$, $CellContext`theta$35444$$, 0], 
        Hold[$CellContext`phi$$, $CellContext`phi$35445$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[
        ParametricPlot3D[
         Dot[
          RotationMatrix[{{0, 0, 1}, 
            $CellContext`n[$CellContext`theta$$, $CellContext`phi$$]}], \
{$CellContext`r Sin[Pi/2] Cos[$CellContext`Phi], $CellContext`r Sin[Pi/2] 
           Sin[$CellContext`Phi], $CellContext`r Cos[Pi/2]}], {$CellContext`r,
           0, 1}, {$CellContext`Phi, 0, 2 Pi}, 
         PlotRange -> {{-1, 1}, {-1, 1}, {-1, 1}}, 
         AxesLabel -> {$CellContext`x, $CellContext`y, $CellContext`z}], 
        Graphics3D[{Red, 
          Arrow[{{0, 0, 0}, 
            $CellContext`n[$CellContext`theta$$, $CellContext`phi$$]}]}]], 
      "Specifications" :> {{$CellContext`theta$$, 0, 2 
         Pi}, {$CellContext`phi$$, 0, Pi}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {260., 266.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.83558121616556*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"18a88c5e-fb60-4d5a-9c4c-a9515d9233a1"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nlFunc", "[", 
   RowBox[{"theta_", ",", "phi_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "theta", "]"}], "*", 
     RowBox[{"Cos", "[", "phi", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Sin", "[", "theta", "]"}], "*", 
     RowBox[{"Sin", "[", "phi", "]"}]}], ",", 
    RowBox[{"Cos", "[", "theta", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"ParametricPlot3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"RotationMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"n", "[", 
        RowBox[{"nlTheta", ",", "nlPhi"}], "]"}]}], "}"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "*", 
       RowBox[{"Sin", "[", 
        RowBox[{"Pi", "/", "2"}], "]"}], "*", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
      RowBox[{"r", "*", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Pi]", "/", "2"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
      RowBox[{"r", "*", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Pi]", "/", "2"}], "]"}]}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"r", ",", "0", ",", "radius"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.835582125412839*^9, 3.83558217112803*^9}, {
  3.8355822036856422`*^9, 3.835582212427399*^9}, {3.83558224556251*^9, 
  3.835582262008529*^9}, {3.8355824166568947`*^9, 
  3.835582417439953*^9}},ExpressionUUID->"d7c1ae0e-8a10-4686-bc6b-\
3aa0e8c4fb3f"]
},
WindowSize->{1299, 813},
WindowMargins->{{Automatic, -180}, {-119, Automatic}},
CellContext->Notebook,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4517, 111, 523, "Input",ExpressionUUID->"4a3c6b78-aa1a-45a1-a9ff-d84914e37d9f"],
Cell[5100, 135, 3637, 70, 773, "Output",ExpressionUUID->"3053f5c2-a1b9-4171-9b66-0d96800cd3e8"]
}, Open  ]],
Cell[8752, 208, 154, 3, 28, "Input",ExpressionUUID->"d73859ca-2fbb-44b1-afd0-b1df2d7d6c82"],
Cell[8909, 213, 2331, 60, 162, "Input",ExpressionUUID->"0def8419-59c0-4371-bf21-d8f70b12d793"],
Cell[CellGroupData[{
Cell[11265, 277, 855, 25, 48, "Input",ExpressionUUID->"2fcf2990-9b6c-4f40-ae6a-d18088231bf6"],
Cell[12123, 304, 354, 9, 21, "Message",ExpressionUUID->"384a42e7-bbc0-4fd9-ab36-f71a61619897"],
Cell[12480, 315, 8199, 221, 276, "Output",ExpressionUUID->"657ff960-6092-4eae-8122-3305b336cf89"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20716, 541, 2739, 77, 86, "Input",ExpressionUUID->"dcdc4820-0bd7-4ca0-b388-907121bf135b"],
Cell[23458, 620, 2530, 51, 545, "Output",ExpressionUUID->"18a88c5e-fb60-4d5a-9c4c-a9515d9233a1"]
}, Open  ]],
Cell[26003, 674, 1634, 45, 48, "Input",ExpressionUUID->"d7c1ae0e-8a10-4686-bc6b-3aa0e8c4fb3f"]
}
]
*)

