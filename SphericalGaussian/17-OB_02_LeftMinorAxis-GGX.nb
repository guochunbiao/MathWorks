(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    161513,       3775]
NotebookOptionsPosition[    155386,       3685]
NotebookOutlinePosition[    155760,       3701]
CellTagsIndexPosition[    155717,       3698]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
      "\"\<Shared\>\""}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResetDirectory", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Left side of minor axis\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "lightDir", ",", "viewPoint", ",", "\[IndentingNewLine]", "\t     ", 
     "arc1AngleA", ",", "arc1AngleB", ",", "theta1", ",", " ", "shadingPt0", 
     ",", "viewDir0", ",", "viewDist0", ",", "halfDir0", ",", 
     "\[IndentingNewLine]", "\t     ", "arc2AngleA", ",", "arc2AngleB", ",", 
     "theta2", ",", " ", "shadingPt1", ",", "viewDir1", ",", "viewDist1", ",",
      "halfDir1", ",", "\[IndentingNewLine]", "\t     ", "thetaL", ",", 
     "arcLAngleA", ",", "arcLAngleB", ",", "\[IndentingNewLine]", "\t     ", 
     "thetaH1", ",", "arcH1AngleA", ",", "arcH1AngleB", ",", 
     "\[IndentingNewLine]", "\t     ", "thetaH2", ",", "arcH2AngleA", ",", 
     "arcH2AngleB", ",", "\[IndentingNewLine]", "\t", "deltaX", ",", 
     "diskRadius", ",", "distNormal", ",", "viewProjPt", ",", 
     "viewProjDistToCenter"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"diskRadius", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"distNormal", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"viewPoint", "=", 
     RowBox[{"{", 
      RowBox[{"viewPointX", ",", "viewPointY"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"shadingPt0", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"viewDir0", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"viewPoint", "-", "shadingPt0"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"viewDist0", "=", 
     RowBox[{"Norm", "[", 
      RowBox[{"viewPoint", "-", "shadingPt0"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"halfDir0", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"lightDir", "=", 
     RowBox[{"gReflectVector", "[", 
      RowBox[{"viewDir0", ",", "halfDir0"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"shadingPt1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"shadingPt0", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "shadingPt1Offset"}], ",", 
       "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"viewDir1", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"viewPoint", "-", "shadingPt1"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"viewDist1", "=", 
     RowBox[{"Norm", "[", 
      RowBox[{"viewPoint", "-", "shadingPt1"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"halfDir1", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lightDir", "+", "viewDir1"}], ")"}], "/", "2"}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"theta1", "=", 
     RowBox[{"ArcCos", "@", 
      RowBox[{"Dot", "[", 
       RowBox[{"viewDir0", ",", "distNormal"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"theta2", "=", 
     RowBox[{"ArcCos", "@", 
      RowBox[{"Dot", "[", 
       RowBox[{"viewDir1", ",", "distNormal"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"thetaL", "=", 
     RowBox[{"ArcCos", "@", 
      RowBox[{"Dot", "[", 
       RowBox[{"lightDir", ",", "distNormal"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"thetaH1", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"thetaH2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"theta2", "+", "thetaL"}], ")"}], "/", "2"}], "-", 
      "thetaL"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"arc", " ", "angles"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"arc1AngleA", "=", 
     RowBox[{"3", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"arc1AngleB", "=", 
     RowBox[{
      RowBox[{"3", 
       RowBox[{"\[Pi]", "/", "2"}]}], "+", "theta1"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"arc2AngleA", "=", 
     RowBox[{"3", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"arc2AngleB", "=", 
     RowBox[{
      RowBox[{"3", 
       RowBox[{"\[Pi]", "/", "2"}]}], "+", "theta2"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"arcLAngleA", "=", 
     RowBox[{"3", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"arcLAngleB", "=", 
     RowBox[{
      RowBox[{"3", 
       RowBox[{"\[Pi]", "/", "2"}]}], "-", "thetaL"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"arcH1AngleA", "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"arcH1AngleB", "=", 
     RowBox[{"arcH1AngleA", "+", "thetaH1"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"arcH2AngleA", "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"arcH2AngleB", "=", 
     RowBox[{"arcH2AngleA", "+", "thetaH2"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"viewProjPt", "=", 
     RowBox[{"viewPoint", "-", 
      RowBox[{"viewDist0", "*", 
       RowBox[{"Dot", "[", 
        RowBox[{"viewDir0", ",", "distNormal"}], "]"}], "*", 
       "distNormal"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"viewProjDistToCenter", "=", 
     RowBox[{"viewDist0", "*", 
      RowBox[{"Sin", "[", "theta1", "]"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"deltaX", "=", 
     RowBox[{"Norm", "[", 
      RowBox[{"shadingPt1", "-", "shadingPt0"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"validate", " ", "transform", " ", "equation"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"shadingPt1Offset", ">", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Assert", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Cot", "[", "theta1", "]"}], "*", 
         RowBox[{"(", "viewProjDistToCenter", ")"}]}], "\[Equal]", 
        RowBox[{
         RowBox[{"Cot", "[", "theta2", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"viewProjDistToCenter", "+", "deltaX"}], ")"}]}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Assert", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Cot", "[", "theta1", "]"}], "*", 
         RowBox[{"(", "viewProjDistToCenter", ")"}]}], "\[Equal]", 
        RowBox[{
         RowBox[{"Cot", "[", "theta2", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"viewProjDistToCenter", "-", "deltaX"}], ")"}]}]}], "]"}]}],
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\"\<circles\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"view", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "viewPoint"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "0.02"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Magenta"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "shadingPt1"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "0.01"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"helper", " ", "points"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "viewProjPt"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "0.01"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}]}], "|>"}]}], 
            "\[IndentingNewLine]", "}"}]}], "&"}], "[", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<lines\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "diskRadius"}], ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"2", "*", "diskRadius"}], ")"}]}], ",", 
               "\[IndentingNewLine]", "     ", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"view", " ", "dirs"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "viewPoint"}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"-", "viewDir0"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", 
                RowBox[{"viewDist0", "+", "0.5"}]}], ",", 
               "\[IndentingNewLine]", "    ", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "LightGray"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "viewPoint"}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"-", "viewDir1"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", 
                RowBox[{"viewDist1", "+", "0.5"}]}], ",", 
               "\[IndentingNewLine]", "    ", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "LightGray"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"light", " ", "dirs"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "lightDir"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
               "\[IndentingNewLine]", "    ", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"shadingPt1", "-", 
                 RowBox[{"lightDir", "*", "0.25"}]}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "lightDir"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
               "\[IndentingNewLine]", "    ", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", "  ", 
             RowBox[{"(*", 
              RowBox[{"half", " ", "dirs"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "halfDir0"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}], ",", 
               "\[IndentingNewLine]", "    ", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt1"}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", "halfDir1"}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}], ",", 
               "\[IndentingNewLine]", "    ", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", "  ", 
             RowBox[{"(*", 
              RowBox[{"helper", " ", "lines"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"shadingPt1", "-", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0.5"}], "}"}]}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
               "\[IndentingNewLine]", "    ", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"Normalize", "[", 
                 RowBox[{"viewProjPt", "-", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", "    ", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "viewProjDistToCenter"}], 
               ",", "\[IndentingNewLine]", "    ", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}]}], 
            "\[IndentingNewLine]", "}"}]}], "&"}], "[", "]"}], ",", 
        "\[IndentingNewLine]", "  ", 
        RowBox[{"\"\<customPlots\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", "    ", 
          RowBox[{"(*", 
           RowBox[{"line", " ", "labels"}], "*)"}], "\[IndentingNewLine]", 
          "    ", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<l\>\"", ",", "Medium"}], "]"}], ",", 
               RowBox[{"shadingPt1", "+", 
                RowBox[{"lightDir", "*", "0.8"}]}]}], "]"}], "}"}], "]"}], 
           ",", "\[IndentingNewLine]", "    ", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<n\>\"", ",", "Medium"}], "]"}], ",", 
               RowBox[{"shadingPt1", "+", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], "*", "0.55"}]}]}], "]"}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "    ", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<h\>\"", ",", "Medium"}], "]"}], ",", 
               RowBox[{"shadingPt1", "+", 
                RowBox[{"halfDir1", "*", "0.55"}]}]}], "]"}], "}"}], "]"}], 
           ",", "\[IndentingNewLine]", "    ", 
           RowBox[{"(*", 
            RowBox[{"light", " ", "dir"}], "*)"}], "\[IndentingNewLine]", 
           "     ", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", "2"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"2", ",", "2"}], "}"}], "-", "lightDir"}]}], "}"}],
                "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", "    ", 
           RowBox[{"(*", "arc0", "*)"}], "\[IndentingNewLine]", "     ", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", 
              RowBox[{"Circle", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", "0.1", ",", 
                RowBox[{"{", 
                 RowBox[{"arc1AngleA", ",", "arc1AngleB"}], "}"}]}], "]"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "     ", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(1\)]\)\>\"", ",", 
                 "Medium"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"arc1AngleA", "+", "arc1AngleB"}], ")"}], "/", 
                    "2"}], "]"}], ",", 
                  RowBox[{"Sin", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"arc1AngleA", "+", "arc1AngleB"}], ")"}], "/", 
                    "2"}], "]"}]}], "}"}], "*", "0.2"}]}], "]"}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", "    ", 
           RowBox[{"(*", "arc1", "*)"}], "\[IndentingNewLine]", "     ", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Red", ",", 
              RowBox[{"Circle", "[", 
               RowBox[{"shadingPt1", ",", "0.1", ",", 
                RowBox[{"{", 
                 RowBox[{"arc2AngleA", ",", "arc2AngleB"}], "}"}]}], "]"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "     ", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(2\)]\)\>\"", ",", 
                 "Medium"}], "]"}], ",", 
               RowBox[{"shadingPt1", "+", "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"arc2AngleA", "+", "arc2AngleB"}], ")"}], "/", 
                    "2"}], "]"}], ",", 
                   RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"arc2AngleA", "+", "arc2AngleB"}], ")"}], "/", 
                    "2"}], "]"}]}], "}"}], "*", "0.2"}]}]}], "]"}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", "    ", 
           RowBox[{"(*", "arcL", "*)"}], "\[IndentingNewLine]", "     ", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", 
              RowBox[{"Circle", "[", 
               RowBox[{"shadingPt1", ",", "0.2", ",", 
                RowBox[{"{", 
                 RowBox[{"arcLAngleA", ",", "arcLAngleB"}], "}"}]}], "]"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "     ", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(L\)]\)\>\"", ",", 
                 "Medium"}], "]"}], ",", 
               RowBox[{"shadingPt1", "+", "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"arcLAngleA", "+", "arcLAngleB"}], ")"}], "/", 
                    "2"}], "]"}], ",", 
                   RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"arcLAngleA", "+", "arcLAngleB"}], ")"}], "/", 
                    "2"}], "]"}]}], "}"}], "*", "0.3"}]}]}], "]"}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", "    ", 
           RowBox[{"(*", "arcH1", "*)"}], "\[IndentingNewLine]", "     ", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", 
              RowBox[{"Circle", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", "0.2", ",", 
                RowBox[{"{", 
                 RowBox[{"arcH1AngleA", ",", "arcH1AngleB"}], "}"}]}], 
               "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", "     ", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(H1\)]\)\>\"", ",", 
                 "Medium"}], "]"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], "+", "\[IndentingNewLine]", 
                "\t", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"arcH1AngleA", "+", "arcH1AngleB"}], ")"}], "/", 
                    "2"}], "]"}], ",", 
                   RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"arcH1AngleA", "+", "arcH1AngleB"}], ")"}], "/", 
                    "2"}], "]"}]}], "}"}], "*", "0.2"}]}]}], "]"}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", "    ", 
           RowBox[{"(*", "arcH2", "*)"}], "\[IndentingNewLine]", "     ", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", 
              RowBox[{"Circle", "[", 
               RowBox[{"shadingPt1", ",", "0.2", ",", 
                RowBox[{"{", 
                 RowBox[{"arcH2AngleA", ",", "arcH2AngleB"}], "}"}]}], 
               "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", "     ", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(H2\)]\)\>\"", ",", 
                 "Medium"}], "]"}], ",", 
               RowBox[{"shadingPt1", "+", "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"arcH2AngleA", "+", "arcH2AngleB"}], ")"}], "/", 
                    "2"}], "]"}], ",", 
                   RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"arcH2AngleA", "+", "arcH2AngleB"}], ")"}], "/", 
                    "2"}], "]"}]}], "}"}], "*", "0.2"}]}]}], "]"}], "}"}], 
            "]"}]}], "\[IndentingNewLine]", "  ", "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "2"}]}], 
       "\[IndentingNewLine]", "|>"}], ",", "Large"}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewPointX", ",", 
       RowBox[{"-", "0.2"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewPointY", ",", "0.3"}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPt1Offset", ",", "1.5"}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightDir", ",", "viewPoint", ",", "\[IndentingNewLine]", "\t     ", 
    "arc1AngleA", ",", "arc1AngleB", ",", "theta1", ",", " ", "shadingPt0", 
    ",", "viewDir0", ",", "viewDist0", ",", "halfDir0", ",", 
    "\[IndentingNewLine]", "\t     ", "arc2AngleA", ",", "arc2AngleB", ",", 
    "theta2", ",", " ", "shadingPt1", ",", "viewDir1", ",", "viewDist1", ",", 
    "halfDir1", ",", "\[IndentingNewLine]", "\t     ", "thetaL", ",", 
    "arcLAngleA", ",", "arcLAngleB", ",", "\[IndentingNewLine]", "\t     ", 
    "thetaH1", ",", "arcH1AngleA", ",", "arcH1AngleB", ",", 
    "\[IndentingNewLine]", "\t     ", "thetaH2", ",", "arcH2AngleA", ",", 
    "arcH2AngleB", ",", "\[IndentingNewLine]", "\t", "deltaX", ",", 
    "diskRadius", ",", "distNormal", ",", "viewProjPt", ",", 
    "viewProjDistToCenter"}], "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.834821871731368*^9, 3.834821872218521*^9}, {
   3.834822067216666*^9, 3.8348220943880873`*^9}, {3.835245137952238*^9, 
   3.835245160483612*^9}, {3.8353085409057784`*^9, 3.835308546736059*^9}, 
   3.8353085805786023`*^9, {3.835308771458728*^9, 3.8353088175219193`*^9}, {
   3.8372436356974535`*^9, 3.8372436403488817`*^9}},
 CellLabel->
  "In[583]:=",ExpressionUUID->"15046d66-6736-46bc-aec2-e3ab63f7fee4"],

Cell[BoxData[
 StyleBox["\<\" Left side of minor axis\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.835155742868433*^9, 3.8352376501246204`*^9, 3.8352417059953117`*^9, 
   3.8352451395419254`*^9, {3.835308505051236*^9, 3.835308549386634*^9}, 
   3.835308777912712*^9, 3.8353088183107696`*^9, 3.835678460033817*^9, 
   3.8359955434615555`*^9, 3.837243642633087*^9},
 CellLabel->
  "During evaluation of \
In[583]:=",ExpressionUUID->"790f3a79-923a-4428-9f87-2c1cfbfe05a7"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`shadingPt1Offset$$ = 
    1.5, $CellContext`viewPointX$$ = -0.2, $CellContext`viewPointY$$ = 0.3, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`viewPointX$$], -0.2}, -2, 2}, {{
       Hold[$CellContext`viewPointY$$], 0.3}, -2, 2}, {{
       Hold[$CellContext`shadingPt1Offset$$], 1.5}, -2, 2}}, 
    Typeset`size$$ = {596., {259., 264.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`viewPointX$539489$$ = 
    0, $CellContext`viewPointY$539490$$ = 
    0, $CellContext`shadingPt1Offset$539491$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`shadingPt1Offset$$ = 
        1.5, $CellContext`viewPointX$$ = -0.2, $CellContext`viewPointY$$ = 
        0.3}, "ControllerVariables" :> {
        Hold[$CellContext`viewPointX$$, $CellContext`viewPointX$539489$$, 0], 
        Hold[$CellContext`viewPointY$$, $CellContext`viewPointY$539490$$, 0], 
        Hold[$CellContext`shadingPt1Offset$$, \
$CellContext`shadingPt1Offset$539491$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`diskRadius = 
        1; $CellContext`distNormal = {0, 
         1}; $CellContext`viewPoint = {$CellContext`viewPointX$$, \
$CellContext`viewPointY$$}; $CellContext`shadingPt0 = {0, 
         0}; $CellContext`viewDir0 = 
        Normalize[$CellContext`viewPoint - $CellContext`shadingPt0]; \
$CellContext`viewDist0 = 
        Norm[$CellContext`viewPoint - $CellContext`shadingPt0]; \
$CellContext`halfDir0 = {0, 1}; $CellContext`lightDir = 
        gUtils`gReflectVector[$CellContext`viewDir0, $CellContext`halfDir0]; \
$CellContext`shadingPt1 = {
         Part[$CellContext`shadingPt0, 1] + $CellContext`shadingPt1Offset$$, 
          0}; $CellContext`viewDir1 = 
        Normalize[$CellContext`viewPoint - $CellContext`shadingPt1]; \
$CellContext`viewDist1 = 
        Norm[$CellContext`viewPoint - $CellContext`shadingPt1]; \
$CellContext`halfDir1 = 
        Normalize[($CellContext`lightDir + $CellContext`viewDir1)/
          2]; $CellContext`theta1 = ArcCos[
          
          Dot[$CellContext`viewDir0, $CellContext`distNormal]]; \
$CellContext`theta2 = ArcCos[
          
          Dot[$CellContext`viewDir1, $CellContext`distNormal]]; \
$CellContext`thetaL = ArcCos[
          
          Dot[$CellContext`lightDir, $CellContext`distNormal]]; \
$CellContext`thetaH1 = 
        0; $CellContext`thetaH2 = ($CellContext`theta2 + $CellContext`thetaL)/
          2 - $CellContext`thetaL; $CellContext`arc1AngleA = 
        3 (Pi/2); $CellContext`arc1AngleB = 
        3 (Pi/2) + $CellContext`theta1; $CellContext`arc2AngleA = 
        3 (Pi/2); $CellContext`arc2AngleB = 
        3 (Pi/2) + $CellContext`theta2; $CellContext`arcLAngleA = 
        3 (Pi/2); $CellContext`arcLAngleB = 
        3 (Pi/2) - $CellContext`thetaL; $CellContext`arcH1AngleA = 
        Pi/2; $CellContext`arcH1AngleB = $CellContext`arcH1AngleA + \
$CellContext`thetaH1; $CellContext`arcH2AngleA = 
        Pi/2; $CellContext`arcH2AngleB = $CellContext`arcH2AngleA + \
$CellContext`thetaH2; $CellContext`viewProjPt = $CellContext`viewPoint - \
$CellContext`viewDist0 
         Dot[$CellContext`viewDir0, $CellContext`distNormal] \
$CellContext`distNormal; $CellContext`viewProjDistToCenter = \
$CellContext`viewDist0 Sin[$CellContext`theta1]; $CellContext`deltaX = 
        Norm[$CellContext`shadingPt1 - $CellContext`shadingPt0]; 
       If[$CellContext`shadingPt1Offset$$ > 0, 
         Assert[
         Cot[$CellContext`theta1] $CellContext`viewProjDistToCenter == 
          Cot[$CellContext`theta2] ($CellContext`viewProjDistToCenter + \
$CellContext`deltaX)], 
         Assert[
         Cot[$CellContext`theta1] $CellContext`viewProjDistToCenter == 
          Cot[$CellContext`theta2] ($CellContext`viewProjDistToCenter - \
$CellContext`deltaX)]]; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> $CellContext`viewPoint, "radius" -> 0.02, "color" -> 
             Magenta, "thickness" -> 0.01], 
            Association[
            "center" -> $CellContext`shadingPt1, "radius" -> 0.01, "color" -> 
             Red, "thickness" -> 0.01], 
            Association[
            "center" -> $CellContext`viewProjPt, "radius" -> 0.01, "color" -> 
             Gray, "thickness" -> 0.01]}& )[], 
          ("lines" -> {
            Association[
            "startPos" -> {-$CellContext`diskRadius, 0}, "dirVec" -> {1, 0}, 
             "length" -> 2 $CellContext`diskRadius, "color" -> Green, 
             "thickness" -> 0.005], 
            Association[
            "startPos" -> $CellContext`viewPoint, 
             "dirVec" -> -$CellContext`viewDir0, 
             "length" -> $CellContext`viewDist0 + 0.5, "color" -> LightGray, 
             "thickness" -> 0.005], 
            Association[
            "startPos" -> $CellContext`viewPoint, 
             "dirVec" -> -$CellContext`viewDir1, 
             "length" -> $CellContext`viewDist1 + 0.5, "color" -> LightGray, 
             "thickness" -> 0.005], 
            Association[
            "startPos" -> {0, 0}, "dirVec" -> $CellContext`lightDir, "length" -> 
             1, "color" -> Green, "thickness" -> 0.005], 
            Association[
            "startPos" -> $CellContext`shadingPt1 - $CellContext`lightDir 
              0.25, "dirVec" -> $CellContext`lightDir, "length" -> 1, "color" -> 
             Green, "thickness" -> 0.005], 
            Association[
            "startPos" -> {0, 0}, "dirVec" -> $CellContext`halfDir0, "length" -> 
             0.5, "color" -> Blue, "thickness" -> 0.005], 
            Association[
            "startPos" -> $CellContext`shadingPt1, 
             "dirVec" -> $CellContext`halfDir1, "length" -> 0.5, "color" -> 
             Red, "thickness" -> 0.005], 
            Association[
            "startPos" -> $CellContext`shadingPt1 - {0, 0.5}, 
             "dirVec" -> {0, 1}, "length" -> 1, "color" -> Gray, "thickness" -> 
             0.005], 
            Association[
            "startPos" -> {0, 0}, "dirVec" -> 
             Normalize[$CellContext`viewProjPt - {0, 0}], 
             "length" -> $CellContext`viewProjDistToCenter, "color" -> Gray, 
             "thickness" -> 0.005]}& )[], "customPlots" -> {
            Graphics[{
              Text[
               Style[
               "l", Medium], $CellContext`shadingPt1 + $CellContext`lightDir 
                0.8]}], 
            Graphics[{
              Text[
               Style["n", Medium], $CellContext`shadingPt1 + {0, 1} 0.55]}], 
            Graphics[{
              Text[
               Style[
               "h", Medium], $CellContext`shadingPt1 + $CellContext`halfDir1 
                0.55]}], 
            Graphics[{Blue, 
              Arrow[{{2, 2}, {2, 2} - $CellContext`lightDir}]}], 
            Graphics[{Blue, 
              
              Circle[{0, 0}, 
               0.1, {$CellContext`arc1AngleA, $CellContext`arc1AngleB}]}], 
            Graphics[{
              Text[
               Style["\!\(\*SubscriptBox[\(\[Theta]\), \(1\)]\)", Medium], {
                 Cos[($CellContext`arc1AngleA + $CellContext`arc1AngleB)/2], 
                 Sin[($CellContext`arc1AngleA + $CellContext`arc1AngleB)/2]} 
               0.2]}], 
            Graphics[{Red, 
              
              Circle[$CellContext`shadingPt1, 
               0.1, {$CellContext`arc2AngleA, $CellContext`arc2AngleB}]}], 
            Graphics[{
              Text[
               Style[
               "\!\(\*SubscriptBox[\(\[Theta]\), \(2\)]\)", 
                Medium], $CellContext`shadingPt1 + {
                  Cos[($CellContext`arc2AngleA + $CellContext`arc2AngleB)/2], 
                  Sin[($CellContext`arc2AngleA + $CellContext`arc2AngleB)/2]} 
                0.2]}], 
            Graphics[{Blue, 
              
              Circle[$CellContext`shadingPt1, 
               0.2, {$CellContext`arcLAngleA, $CellContext`arcLAngleB}]}], 
            Graphics[{
              Text[
               Style[
               "\!\(\*SubscriptBox[\(\[Theta]\), \(L\)]\)", 
                Medium], $CellContext`shadingPt1 + {
                  Cos[($CellContext`arcLAngleA + $CellContext`arcLAngleB)/2], 
                  Sin[($CellContext`arcLAngleA + $CellContext`arcLAngleB)/2]} 
                0.3]}], 
            Graphics[{Blue, 
              
              Circle[{0, 0}, 
               0.2, {$CellContext`arcH1AngleA, $CellContext`arcH1AngleB}]}], 
            Graphics[{
              Text[
               Style[
               "\!\(\*SubscriptBox[\(\[Theta]\), \(H1\)]\)", Medium], {0, 0} + {
                  
                  Cos[($CellContext`arcH1AngleA + $CellContext`arcH1AngleB)/
                   2], 
                  
                  Sin[($CellContext`arcH1AngleA + $CellContext`arcH1AngleB)/
                   2]} 0.2]}], 
            Graphics[{Blue, 
              
              Circle[$CellContext`shadingPt1, 
               0.2, {$CellContext`arcH2AngleA, $CellContext`arcH2AngleB}]}], 
            Graphics[{
              Text[
               Style[
               "\!\(\*SubscriptBox[\(\[Theta]\), \(H2\)]\)", 
                Medium], $CellContext`shadingPt1 + {
                  
                  Cos[($CellContext`arcH2AngleA + $CellContext`arcH2AngleB)/
                   2], 
                  
                  Sin[($CellContext`arcH2AngleA + $CellContext`arcH2AngleB)/
                   2]} 0.2]}]}, "axisExtent" -> 2], Large]), 
      "Specifications" :> {{{$CellContext`viewPointX$$, -0.2}, -2, 
         2}, {{$CellContext`viewPointY$$, 0.3}, -2, 
         2}, {{$CellContext`shadingPt1Offset$$, 1.5}, -2, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{643., {326., 332.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8351557429108715`*^9, 3.835237652209076*^9, 3.8352417060377207`*^9, 
   3.835245139574108*^9, {3.835308505085516*^9, 3.8353085494155655`*^9}, 
   3.8353087779546995`*^9, 3.8353088183380985`*^9, 3.835678460078973*^9, 
   3.8359955452620792`*^9, 3.837243642681328*^9},
 CellLabel->
  "Out[593]=",ExpressionUUID->"44af0988-c408-4fcf-8318-07ad093054b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"\[Theta]1", 
      RowBox[{"(*", "\[Theta]V", "*)"}], ",", "\[Theta]2", ",", "\[Theta]L", 
      ",", "\[Theta]H1", ",", "\[Theta]H2", ",", "\[IndentingNewLine]", "\t", 
      "vd", 
      RowBox[{"(*", 
       RowBox[{"view", " ", "dist"}], "*)"}], ",", "dd", 
      RowBox[{"(*", 
       RowBox[{"delta", " ", "distance"}], "*)"}], ",", "\[IndentingNewLine]",
       "\t", "k", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"dd", "/", "vd"}], " ", "assuming", " ", "vd"}], "=", "1"}], 
       "*)"}], ",", "\[IndentingNewLine]", "\t", "sg1", 
      RowBox[{"(*", "origin", "*)"}], ",", "sg2", 
      RowBox[{"(*", "shifted", "*)"}], ",", "\[IndentingNewLine]", "\t", 
      "jtheta1", ",", "jphi1", ",", "jtheta2", ",", "jphi2", ",", "jacoDet", 
      ",", "\[IndentingNewLine]", "\t", "jacoSim", ",", "jacoSim1", ",", 
      "divSim", ",", "divSim1", ",", "sol", ",", "m"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"moving", " ", "along", " ", "left", " ", "minor", " ", "axis"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Cot", "[", "theta1", "]"}], "*", 
      RowBox[{"(", "viewProjDistToCenter", ")"}]}], "\[Equal]", 
     RowBox[{
      RowBox[{"Cot", "[", "theta2", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"viewProjDistToCenter", "+", "deltaX"}], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]2", "=", 
     RowBox[{
      RowBox[{"ArcCot", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"Cot", "[", "\[Theta]1", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"vd", "*", 
           RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"vd", "*", 
          RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", "dd"}]], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vd", "\[Rule]", "1"}], ",", 
        RowBox[{"dd", "\[Rule]", "k"}], ",", 
        RowBox[{"\[Theta]1", "\[Rule]", "\[Theta]L"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gPrint", "[", "\"\<\[Theta]2\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "@", "\[Theta]2"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]H1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]H2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Theta]2", "+", "\[Theta]L"}], ")"}], "/", "2"}], "-", 
      "\[Theta]L"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gPrint", "[", "\"\<\[Theta]H2\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "@", "\[Theta]H2"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "\[Theta]1", ",", "\[Theta]2", ",", "\[Theta]L", ",", "\[Theta]H1", ",", 
      "\[Theta]H2", ",", "\[IndentingNewLine]", "\t", "vd", 
      RowBox[{"(*", 
       RowBox[{"view", " ", "dist"}], "*)"}], ",", "dd", 
      RowBox[{"(*", 
       RowBox[{"delta", " ", "distance"}], "*)"}], ",", "\[IndentingNewLine]",
       "\t", "k", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"dd", "/", "vd"}], " ", "assuming", " ", "vd"}], "=", "1"}], 
       "*)"}], ",", "\[IndentingNewLine]", "\t", "sg1", 
      RowBox[{"(*", "origin", "*)"}], ",", "sg2", 
      RowBox[{"(*", "shifted", "*)"}], ",", "\[IndentingNewLine]", "\t", 
      "nov1", ",", "nov2", ",", "nol", ",", "\[IndentingNewLine]", "\t", 
      "jtheta1", ",", "jphi1", ",", "jtheta2", ",", "jphi2", ",", "jacoDet", 
      ",", "\[IndentingNewLine]", "\t", "jacoSim", ",", "jacoSim1", ",", 
      "divSim", ",", "divSim1"}], "]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.834822101434758*^9, 3.8348221016684847`*^9}, {
   3.834822635722204*^9, 3.834822654525103*^9}, {3.834822818529069*^9, 
   3.834822819401681*^9}, {3.8348228878455367`*^9, 3.834823089027585*^9}, {
   3.834823704118558*^9, 3.83482371546492*^9}, {3.834823981764984*^9, 
   3.834823990901426*^9}, 3.8350452715106373`*^9, {3.8350650034104357`*^9, 
   3.835065031305313*^9}, {3.835065061551507*^9, 3.8350650642081833`*^9}, {
   3.8351553458035774`*^9, 3.8351554507991157`*^9}, {3.835155585473077*^9, 
   3.8351557537831535`*^9}, 3.83524139516838*^9, {3.835308868762783*^9, 
   3.8353089558739033`*^9}, {3.83530918308181*^9, 3.835309183257829*^9}, {
   3.8353304431025333`*^9, 3.8353304525665884`*^9}, {3.8353305099134955`*^9, 
   3.8353305104982634`*^9}, {3.835330596028409*^9, 3.8353306259313145`*^9}},
 CellLabel->
  "In[595]:=",ExpressionUUID->"96ea3d5a-7db9-4208-9a62-cb59c0c72e5b"],

Cell[BoxData[
 StyleBox["\<\" \[Theta]2\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.835308956578001*^9, {3.8353305788579073`*^9, 3.8353306265562754`*^9}, 
   3.8359955458364315`*^9, 3.8372436432082477`*^9},
 CellLabel->
  "During evaluation of \
In[595]:=",ExpressionUUID->"b31b2b8e-f3f7-409a-92d8-fcfa3578365f"],

Cell[BoxData[
 RowBox[{"ArcTan", "[", 
  RowBox[{
   RowBox[{"k", " ", 
    RowBox[{"Sec", "[", "\[Theta]L", "]"}]}], "+", 
   RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.83515574322979*^9, 3.83515575461415*^9}, 
   3.835237652959203*^9, 3.835241706312042*^9, {3.8353089236401167`*^9, 
   3.835308956583545*^9}, {3.8353305788848314`*^9, 3.8353306265616875`*^9}, 
   3.8359955458773212`*^9, 3.8372436432864237`*^9},
 CellLabel->
  "Out[598]=",ExpressionUUID->"05d2adb9-52bc-4eae-90d4-6f58d4b18736"],

Cell[BoxData[
 StyleBox["\<\" \[Theta]H2\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.835308956578001*^9, {3.8353305788579073`*^9, 3.8353306265562754`*^9}, 
   3.8359955458364315`*^9, 3.8372436432864237`*^9},
 CellLabel->
  "During evaluation of \
In[595]:=",ExpressionUUID->"1b76cab8-80c7-433e-87f1-d9efab564144"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "\[Theta]L"}], "+", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"k", " ", 
       RowBox[{"Sec", "[", "\[Theta]L", "]"}]}], "+", 
      RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.83515574322979*^9, 3.83515575461415*^9}, 
   3.835237652959203*^9, 3.835241706312042*^9, {3.8353089236401167`*^9, 
   3.835308956583545*^9}, {3.8353305788848314`*^9, 3.8353306265616875`*^9}, 
   3.8359955458773212`*^9, 3.83724364338385*^9},
 CellLabel->
  "Out[602]=",ExpressionUUID->"bbcd885c-3835-4280-89ab-1d4aa19750ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "approxK", ",", "jacoDet", ",", "\[Theta]H2", ",", "sinDiv", ",", "asg1", 
     ",", "\[Theta]", ",", "\[Theta]V", ",", "\[Theta]L", ",", "\[Lambda]", 
     ",", "\[Mu]", ",", "k", ",", "fitLambda"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Approx k\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"approxK", "=", 
  RowBox[{
   FractionBox[
    RowBox[{"Tan", "[", "\[Theta]", "]"}], 
    RowBox[{"Cos", "[", "\[Theta]V", "]"}]], "/.", 
   RowBox[{"{", 
    RowBox[{"\[Theta]V", "\[Rule]", "\[Theta]L"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Approx \[Theta]H2\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Theta]H2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "\[Theta]L"}], "+", 
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{"k", " ", 
          RowBox[{"Sec", "[", "\[Theta]L", "]"}]}], "+", 
         RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]}], ")"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"k", "->", "approxK"}], "}"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<GGX/NoV Attenuation\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nov1", "=", 
   RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nov2", "=", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]2", "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{"approxK", " ", 
         RowBox[{"Sec", "[", "\[Theta]L", "]"}]}], "+", 
        RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nol", "=", 
   RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"gDGGX", "[", 
      RowBox[{"m", ",", 
       RowBox[{"Cos", "[", "\[Theta]H2", "]"}]}], "]"}], 
     RowBox[{"(*", 
      RowBox[{"/", 
       RowBox[{"(", 
        RowBox[{"4", "nol", "*", "nov2"}], ")"}]}], "*)"}]}], 
    RowBox[{
     RowBox[{"gDGGX", "[", 
      RowBox[{"m", ",", "1"}], "]"}], 
     RowBox[{"(*", 
      RowBox[{"/", 
       RowBox[{"(", 
        RowBox[{"4", "nol", "*", "nov1"}], ")"}]}], "*)"}]}]], "//", 
   "FullSimplify"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "approxK", ",", "jacoDet", ",", "\[Theta]H2", ",", "sinDiv", ",", "asg1", 
    ",", "\[Theta]", ",", "\[Theta]V", ",", "\[Theta]L", ",", "\[Lambda]", 
    ",", "\[Mu]", ",", "k", ",", "fitLambda"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8352336099521484`*^9, 3.8352336271594067`*^9}, {
   3.835234231822093*^9, 3.8352342407670927`*^9}, {3.835234486566305*^9, 
   3.8352345157459908`*^9}, {3.8352346397480297`*^9, 3.835234733360139*^9}, {
   3.835234807921933*^9, 3.8352348976180124`*^9}, {3.835235069001074*^9, 
   3.835235086649771*^9}, {3.8352351344379015`*^9, 3.835235203686849*^9}, {
   3.8352352449218535`*^9, 3.835235441119177*^9}, {3.835235475048665*^9, 
   3.83523552222626*^9}, {3.8352361052413416`*^9, 3.8352362141755075`*^9}, {
   3.8352362622863083`*^9, 3.8352364238511763`*^9}, {3.8352365396836343`*^9, 
   3.835236655952241*^9}, {3.8352367084583244`*^9, 3.835236708890445*^9}, 
   3.835241702861417*^9, 3.835242364100749*^9, {3.835308979539379*^9, 
   3.8353091251866865`*^9}, {3.8353091560435886`*^9, 3.835309197981781*^9}, {
   3.83530925283953*^9, 3.8353093062269535`*^9}, {3.8353094459240885`*^9, 
   3.835309455948261*^9}, {3.8353095322523355`*^9, 3.835309553097591*^9}, {
   3.8353097059619083`*^9, 3.8353097154455676`*^9}, 3.8353099391158986`*^9, 
   3.8353099765722227`*^9, {3.835330410502967*^9, 3.835330552838518*^9}, {
   3.835330633384429*^9, 3.8353306565600476`*^9}, {3.8353308272155027`*^9, 
   3.8353308291535335`*^9}},
 CellLabel->
  "In[604]:=",ExpressionUUID->"acc523be-ad6e-4a8a-bc41-33bbdc9fad20"],

Cell[BoxData[
 StyleBox["\<\" Approx k\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8352423657425528`*^9, {3.835309030404313*^9, 3.8353090429440627`*^9}, 
   3.8353090732098494`*^9, {3.835309190106515*^9, 3.8353092136314554`*^9}, {
   3.8353092917449336`*^9, 3.8353093066067533`*^9}, 3.83530945644666*^9, {
   3.835309533533956*^9, 3.8353095533878927`*^9}, 3.835309716627179*^9, 
   3.83530997756456*^9, 3.835330480578251*^9, {3.835330553758012*^9, 
   3.8353305815109034`*^9}, {3.835330641696167*^9, 3.8353306593816566`*^9}, 
   3.8353308310495152`*^9, 3.8359955459415083`*^9, 3.8372436434313946`*^9},
 CellLabel->
  "During evaluation of \
In[604]:=",ExpressionUUID->"c180171d-f313-4b4c-970a-c7fd9a3f0741"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sec", "[", "\[Theta]L", "]"}], " ", 
  RowBox[{"Tan", "[", "\[Theta]", "]"}]}]], "Output",
 CellChangeTimes->{
  3.8352423657505407`*^9, {3.8353090304102964`*^9, 3.8353090429526196`*^9}, 
   3.8353090732128267`*^9, {3.8353091901104755`*^9, 3.835309213634448*^9}, {
   3.8353092917479253`*^9, 3.835309306612051*^9}, 3.8353094564514384`*^9, {
   3.8353095335419345`*^9, 3.8353095533948746`*^9}, 3.8353097166301675`*^9, 
   3.8353099775715346`*^9, 3.835330480580246*^9, {3.83533055376199*^9, 
   3.835330581514892*^9}, {3.835330641699159*^9, 3.8353306593866434`*^9}, 
   3.835330831059489*^9, 3.8359955459445*^9, 3.8372436434469705`*^9},
 CellLabel->
  "Out[606]=",ExpressionUUID->"e6bec5e8-ea60-4309-974d-c76e9c521b1e"],

Cell[BoxData[
 StyleBox["\<\" Approx \[Theta]H2\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8352423657425528`*^9, {3.835309030404313*^9, 3.8353090429440627`*^9}, 
   3.8353090732098494`*^9, {3.835309190106515*^9, 3.8353092136314554`*^9}, {
   3.8353092917449336`*^9, 3.8353093066067533`*^9}, 3.83530945644666*^9, {
   3.835309533533956*^9, 3.8353095533878927`*^9}, 3.835309716627179*^9, 
   3.83530997756456*^9, 3.835330480578251*^9, {3.835330553758012*^9, 
   3.8353305815109034`*^9}, {3.835330641696167*^9, 3.8353306593816566`*^9}, 
   3.8353308310495152`*^9, 3.8359955459415083`*^9, 3.8372436434469705`*^9},
 CellLabel->
  "During evaluation of \
In[604]:=",ExpressionUUID->"f999c8e2-9519-4f78-946e-43a9c1dc4436"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "\[Theta]L"}], "+", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Sec", "[", "\[Theta]L", "]"}], "2"], " ", 
       RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "+", 
      RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8352423657505407`*^9, {3.8353090304102964`*^9, 3.8353090429526196`*^9}, 
   3.8353090732128267`*^9, {3.8353091901104755`*^9, 3.835309213634448*^9}, {
   3.8353092917479253`*^9, 3.835309306612051*^9}, 3.8353094564514384`*^9, {
   3.8353095335419345`*^9, 3.8353095533948746`*^9}, 3.8353097166301675`*^9, 
   3.8353099775715346`*^9, 3.835330480580246*^9, {3.83533055376199*^9, 
   3.835330581514892*^9}, {3.835330641699159*^9, 3.8353306593866434`*^9}, 
   3.835330831059489*^9, 3.8359955459445*^9, 3.8372436436386375`*^9},
 CellLabel->
  "Out[608]=",ExpressionUUID->"65ddc8c2-30c8-4914-9206-7723d00e90a1"],

Cell[BoxData[
 StyleBox["\<\" GGX/NoV Attenuation\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8352423657425528`*^9, {3.835309030404313*^9, 3.8353090429440627`*^9}, 
   3.8353090732098494`*^9, {3.835309190106515*^9, 3.8353092136314554`*^9}, {
   3.8353092917449336`*^9, 3.8353093066067533`*^9}, 3.83530945644666*^9, {
   3.835309533533956*^9, 3.8353095533878927`*^9}, 3.835309716627179*^9, 
   3.83530997756456*^9, 3.835330480578251*^9, {3.835330553758012*^9, 
   3.8353305815109034`*^9}, {3.835330641696167*^9, 3.8353306593816566`*^9}, 
   3.8353308310495152`*^9, 3.8359955459415083`*^9, 3.8372436436446333`*^9},
 CellLabel->
  "During evaluation of \
In[604]:=",ExpressionUUID->"0ff4c5c7-19b8-4412-9abf-4ce479f0cc02"],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", 
   SuperscriptBox["m", "4"]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["m", "2"], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["m", "2"]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]L", "-", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Sec", "[", "\[Theta]L", "]"}], "2"], " ", 
           RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]}], "]"}]}]}], ")"}],
    "2"]]], "Output",
 CellChangeTimes->{
  3.8352423657505407`*^9, {3.8353090304102964`*^9, 3.8353090429526196`*^9}, 
   3.8353090732128267`*^9, {3.8353091901104755`*^9, 3.835309213634448*^9}, {
   3.8353092917479253`*^9, 3.835309306612051*^9}, 3.8353094564514384`*^9, {
   3.8353095335419345`*^9, 3.8353095533948746`*^9}, 3.8353097166301675`*^9, 
   3.8353099775715346`*^9, 3.835330480580246*^9, {3.83533055376199*^9, 
   3.835330581514892*^9}, {3.835330641699159*^9, 3.8353306593866434`*^9}, 
   3.835330831059489*^9, 3.8359955459445*^9, 3.8372436597074194`*^9},
 CellLabel->
  "Out[613]=",ExpressionUUID->"56838226-1fb5-48a9-8933-7428db4e2428"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<GGX Attenuation\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"4", " ", 
       SuperscriptBox["m", "4"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["m", "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["m", "2"]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]L", "-", 
            RowBox[{"ArcTan", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Sec", "[", "\[Theta]L", "]"}], "2"], " ", 
               RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "+", 
              RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]}], "]"}]}]}], 
        ")"}], "2"]], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "0.1"}], "}"}], ",", "0.01", ",", "0.99"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]L", ",", 
       RowBox[{"\[Pi]", "/", "8"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.835309738009637*^9, 3.835309913309681*^9}, {
   3.835330357544809*^9, 3.8353303588013997`*^9}, 3.8353305694914694`*^9, 
   3.8353306733994846`*^9, 3.835330748723181*^9},
 CellLabel->
  "In[615]:=",ExpressionUUID->"194f0809-d403-41e7-a136-82140ffee9d2"],

Cell[BoxData[
 StyleBox["\<\" GGX Attenuation\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8353099142474403`*^9, 3.835330841487733*^9, 
  3.8359955554048805`*^9, 3.837243659776947*^9},
 CellLabel->
  "During evaluation of \
In[615]:=",ExpressionUUID->"55905cb8-ba0b-49e4-9c04-a9534bf5fb06"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`m$$ = 0.1, $CellContext`\[Theta]L$$ = 
    Rational[1, 8] Pi, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`m$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`\[Theta]L$$], Rational[1, 8] Pi}, 0, Rational[1, 2] 
      Pi}}, Typeset`size$$ = {324., {103., 108.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`m$540717$$ = 0, $CellContext`\[Theta]L$540718$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`m$$ = 0.1, $CellContext`\[Theta]L$$ = 
        Rational[1, 8] Pi}, "ControllerVariables" :> {
        Hold[$CellContext`m$$, $CellContext`m$540717$$, 0], 
        Hold[$CellContext`\[Theta]L$$, $CellContext`\[Theta]L$540718$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Plot[4 $CellContext`m$$^4/(
         1 + $CellContext`m$$^2 + (-1 + $CellContext`m$$^2) 
          Cos[$CellContext`\[Theta]L$$ - ArcTan[
            Sec[$CellContext`\[Theta]L$$]^2 Tan[$CellContext`\[Theta]] + 
             Tan[$CellContext`\[Theta]L$$]]])^2, {$CellContext`\[Theta], 0, 
         Pi/2}, PlotRange -> {{0, Pi/2}, {0, 1}}], 
      "Specifications" :> {{{$CellContext`m$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`\[Theta]L$$, Rational[1, 8] Pi}, 0, 
         Rational[1, 2] Pi}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{371., {158., 164.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8353099142805567`*^9, 3.8353308415263977`*^9, 
  3.8359955554351964`*^9, 3.837243659845186*^9},
 CellLabel->
  "Out[616]=",ExpressionUUID->"32255879-ef34-43b4-a7c9-4c8d8ee0be1b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "asg1", ",", "\[Theta]", ",", "\[Lambda]", ",", "\[Mu]", ",", "m"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<ASG along axis\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"asg1", "=", 
   RowBox[{"asgPolar", "[", 
    RowBox[{"\[Theta]", ",", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "2"}], "-", "\[Theta]"}], ",", 
     RowBox[{"\[Pi]", "/", "2"}], ",", "\[Lambda]", ",", "\[Mu]", ",", "1"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Fit Attenuation(0<m<0.5)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Quiet", "@", 
   RowBox[{"FindMinimum", "[", 
    RowBox[{
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"Abs", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         FractionBox[
          RowBox[{"4", " ", 
           SuperscriptBox["m", "4"]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["m", "2"], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["m", "2"]}], ")"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]L", "-", 
                RowBox[{"ArcTan", "[", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"Sec", "[", "\[Theta]L", "]"}], "2"], " ", 
                   RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "+", 
                  RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]}], 
               "]"}]}]}], ")"}], "2"]], "-", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "\[Lambda]"}], " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]], " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"\[Lambda]", "\[Rule]", 
             FractionBox[
              RowBox[{"a", "*", 
               RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
              RowBox[{"m", "^", "2"}]]}], "}"}]}], ")"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]L", ",", "0", ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "0.01", ",", "0.5"}], "}"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"PrecisionGoal", "\[Rule]", "1"}], ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "1"}], ",", " ", 
       RowBox[{"Method", "\[Rule]", "\"\<QuasiMonteCarlo\>\""}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "2"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Lambda]", "=", 
      FractionBox[
       RowBox[{"0.233", " ", 
        RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
       RowBox[{"m", "^", "2"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         FractionBox[
          RowBox[{"4", " ", 
           SuperscriptBox["m", "4"]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["m", "2"], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["m", "2"]}], ")"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]L", "-", 
                RowBox[{"ArcTan", "[", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"Sec", "[", "\[Theta]L", "]"}], "2"], " ", 
                   RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "+", 
                  RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]}], 
               "]"}]}]}], ")"}], "2"]], ",", "\[IndentingNewLine]", "\t\t", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "\[Lambda]"}], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]], " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}]}], 
        "\[IndentingNewLine]", "        ", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "0.1"}], "}"}], ",", "0.01", ",", "0.9"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]L", ",", 
        RowBox[{"\[Pi]", "/", "8"}]}], "}"}], ",", "0", ",", 
      RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"Lambda", ",", "\[Lambda]"}], "}"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "asg1", ",", "\[Theta]", ",", "\[Lambda]", ",", "\[Mu]", ",", "m"}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.835309952933906*^9, 3.8353100008932233`*^9}, {
   3.835310032502142*^9, 3.835310160013218*^9}, {3.8353102008237295`*^9, 
   3.8353102665951777`*^9}, {3.83531759799468*^9, 3.835317643418153*^9}, 
   3.835317707369042*^9, {3.835317778112214*^9, 3.835317801018755*^9}, {
   3.8353208719276667`*^9, 3.835320872299423*^9}, {3.835330716133171*^9, 
   3.835330738149634*^9}},
 CellLabel->
  "In[617]:=",ExpressionUUID->"6f9d1f80-1c38-4bd3-a316-1110423406e4"],

Cell[BoxData[
 StyleBox["\<\" ASG along axis\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.835310004621395*^9, {3.8353100647610598`*^9, 3.835310088815178*^9}, 
   3.8353101646355925`*^9, {3.835310202332054*^9, 3.835310267142138*^9}, {
   3.8353176168760624`*^9, 3.8353176444100704`*^9}, 3.835317718026864*^9, {
   3.8353177821643*^9, 3.8353178018509216`*^9}, 3.8353178342116776`*^9, 
   3.8353208730340323`*^9, 3.8353308468881903`*^9, 3.8359955555176525`*^9, 
   3.8372436600303836`*^9},
 CellLabel->
  "During evaluation of \
In[617]:=",ExpressionUUID->"eaab73ce-9797-4520-b42a-fbd948933fb1"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "\[Lambda]"}], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]], " ", 
  RowBox[{"Cos", "[", "\[Theta]", "]"}]}]], "Output",
 CellChangeTimes->{
  3.8353100046234846`*^9, {3.835310064764041*^9, 3.8353100888221545`*^9}, 
   3.83531016464058*^9, {3.8353102023360434`*^9, 3.83531026714915*^9}, {
   3.8353176168820467`*^9, 3.8353176444160585`*^9}, 3.8353177180308547`*^9, {
   3.8353177821712494`*^9, 3.835317801859895*^9}, 3.835317834215672*^9, 
   3.83532087304254*^9, 3.8353308468921795`*^9, 3.8359955555226393`*^9, 
   3.8372436600460215`*^9},
 CellLabel->
  "Out[619]=",ExpressionUUID->"2f4ca856-87d3-4c0d-b7b4-44fec6e36114"],

Cell[BoxData[
 StyleBox["\<\" Fit Attenuation(0<m<0.5)\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.835310004621395*^9, {3.8353100647610598`*^9, 3.835310088815178*^9}, 
   3.8353101646355925`*^9, {3.835310202332054*^9, 3.835310267142138*^9}, {
   3.8353176168760624`*^9, 3.8353176444100704`*^9}, 3.835317718026864*^9, {
   3.8353177821643*^9, 3.8353178018509216`*^9}, 3.8353178342116776`*^9, 
   3.8353208730340323`*^9, 3.8353308468881903`*^9, 3.8359955555176525`*^9, 
   3.8372436600460215`*^9},
 CellLabel->
  "During evaluation of \
In[617]:=",ExpressionUUID->"35528b9e-da24-4efa-b77e-78ec60b71c80"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.03972913247164619`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "0.2329879670069222`"}], ",", 
     RowBox[{"b", "\[Rule]", "1.`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8353100046234846`*^9, {3.835310064764041*^9, 3.8353100888221545`*^9}, 
   3.83531016464058*^9, {3.8353102023360434`*^9, 3.83531026714915*^9}, {
   3.8353176168820467`*^9, 3.8353176444160585`*^9}, 3.8353177180308547`*^9, {
   3.8353177821712494`*^9, 3.835317801859895*^9}, 3.835317834215672*^9, 
   3.83532087304254*^9, 3.8353308468921795`*^9, 3.8359955555226393`*^9, 
   3.8372436627488117`*^9},
 CellLabel->
  "Out[621]=",ExpressionUUID->"5224ae9e-63fa-48e3-ab15-a625a3c543a1"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`Lambda$$ = 
    21.526393107512977`, $CellContext`m$$ = 0.1, $CellContext`\[Theta]L$$ = 
    Rational[1, 8] Pi, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`m$$], 0.1}, 0.01, 0.9}, {{
       Hold[$CellContext`\[Theta]L$$], Rational[1, 8] Pi}, 0, Rational[1, 2] 
      Pi}, {{
       Hold[$CellContext`Lambda$$], 21.526393107512977`}}}, Typeset`size$$ = {
    324., {103., 108.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`m$542022$$ = 
    0, $CellContext`\[Theta]L$542023$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`Lambda$$ = $CellContext`\[Lambda], \
$CellContext`m$$ = 0.1, $CellContext`\[Theta]L$$ = Rational[1, 8] Pi}, 
      "ControllerVariables" :> {
        Hold[$CellContext`m$$, $CellContext`m$542022$$, 0], 
        Hold[$CellContext`\[Theta]L$$, $CellContext`\[Theta]L$542023$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`\[Lambda] = 
        0.233 Cos[$CellContext`\[Theta]L$$]/$CellContext`m$$^2; 
       Plot[{4 $CellContext`m$$^4/(
           1 + $CellContext`m$$^2 + (-1 + $CellContext`m$$^2) 
            Cos[$CellContext`\[Theta]L$$ - ArcTan[
              Sec[$CellContext`\[Theta]L$$]^2 Tan[$CellContext`\[Theta]] + 
               Tan[$CellContext`\[Theta]L$$]]])^2, 
          E^((-$CellContext`\[Lambda]) Sin[$CellContext`\[Theta]]^2) 
          Cos[$CellContext`\[Theta]]}, {$CellContext`\[Theta], 0, Pi/2}, 
         PlotRange -> {{0, Pi/2}, {0, 1}}]), 
      "Specifications" :> {{{$CellContext`m$$, 0.1}, 0.01, 
         0.9}, {{$CellContext`\[Theta]L$$, Rational[1, 8] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`Lambda$$, $CellContext`\[Lambda]}}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{371., {168., 174.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8353100046234846`*^9, {3.835310064764041*^9, 3.8353100888221545`*^9}, 
   3.83531016464058*^9, {3.8353102023360434`*^9, 3.83531026714915*^9}, {
   3.8353176168820467`*^9, 3.8353176444160585`*^9}, 3.8353177180308547`*^9, {
   3.8353177821712494`*^9, 3.835317801859895*^9}, 3.835317834215672*^9, 
   3.83532087304254*^9, 3.8353308468921795`*^9, 3.8359955555226393`*^9, 
   3.8372436627972603`*^9},
 CellLabel->
  "Out[622]=",ExpressionUUID->"98373d93-8221-4e77-9fe5-098d019d0450"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Visualize Lambda(Attenuation)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "testDisk", ",", "testSphere", ",", "diskNormalAxis", ",", "viewDir", ",", 
    "halfDir", ",", "lightDir", ",", "\[IndentingNewLine]", "   ", 
    "majorAxis", ",", "majorX", ",", "majorY", ",", "minorAxis", ",", 
    "minorX", ",", "minorY", ",", "majorSize", ",", "minorSize", ",", 
    "\[IndentingNewLine]", "  ", "sphereShadingFunc", ",", "\[Lambda]1", ",", 
    "\[Lambda]2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"diskNormalAxis", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"{", 
       RowBox[{"diskNormalX", ",", "diskNormalY", ",", 
        RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"testDisk", "=", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"center", " ", "point"}], "*)"}], "\[IndentingNewLine]", "\t",
        "diskNormalAxis", ",", 
       RowBox[{"(*", 
        RowBox[{"normal", " ", "axis"}], "*)"}], "\[IndentingNewLine]", "\t", 
       "diskRadius"}], 
      RowBox[{"(*", 
       RowBox[{"disk", " ", "radius"}], "*)"}], "\[IndentingNewLine]", 
      "}"}]}], ";", "\[IndentingNewLine]", " ", 
    RowBox[{"testSphere", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"viewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], "-", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"halfDir", "=", "diskNormalAxis"}], ";", "\[IndentingNewLine]", 
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{"Dot", "[", 
         RowBox[{"viewDir", ",", "halfDir"}], "]"}], "*", "halfDir"}], "-", 
       "viewDir"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"solving", " ", "ellipse", " ", "axes"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"majorX", "=", 
     RowBox[{"-", "diskNormalY"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"majorY", "=", "diskNormalX"}], ";", "\[IndentingNewLine]", 
    RowBox[{"majorAxis", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"{", 
       RowBox[{"majorX", ",", "majorY", ",", "0"}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"minorX", "=", 
     RowBox[{"-", "majorY"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"minorY", "=", "majorX"}], ";", "\[IndentingNewLine]", 
    RowBox[{"minorAxis", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"{", 
       RowBox[{"minorX", ",", "minorY", ",", "0"}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"majorSize", "=", "diskRadius"}], ";", "\[IndentingNewLine]", 
    RowBox[{"minorSize", "=", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{"diskNormalAxis", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "*", 
      "diskRadius"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"\[Lambda]1", "=", 
     FractionBox[
      RowBox[{"0.233", " ", 
       RowBox[{"Dot", "[", 
        RowBox[{"lightDir", ",", "diskNormalAxis"}], "]"}]}], 
      RowBox[{"roughness", "^", "2"}]]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"shading", " ", "function", " ", "on", " ", "disk"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"sphereShadingFunc", ":=", 
     RowBox[{"Block", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "spherePt", ",", "diskPt", ",", "tmpRayDir", ",", "tmpDiff", ",", 
         "tmpProd1", ",", "tmpProd2", ",", "tmpProd3", ",", "intsPt", ",", 
         "\[IndentingNewLine]", "\t", "sglight", ",", "refLightDir", ",", 
         "refViewDir", ",", "\[IndentingNewLine]", "\t", "refNormal", ",", 
         "sgndf", ",", "diskLighting1", ",", "finalLighting"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"spherePt", "=", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"hemi", "-", 
          RowBox[{"sphere", " ", "only"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"z", "<", "0"}], ",", 
          RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "find", " ", "related", " ", "point", " ", "on", " ", "disk"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"https", ":"}], "//", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"www", ".", "rosettacode", ".", "org"}], "/", "wiki"}], 
            "/", "Find_the"}], "_intersection", "_of", "_a", "_line", "_with",
            "_a", "_plane", "#C", ".2", "B", ".2", "B"}]}], "*)"}], "\n", 
        "       ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"c", "++"}], " ", "code", " ", "example"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"tmpRayDir", "=", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tmpRayDir", "=", 
         RowBox[{"Normalize", "@", "spherePt"}]}], ";", "\[IndentingNewLine]",
         " ", 
        RowBox[{"tmpDiff", "=", 
         RowBox[{"spherePt", "-", 
          RowBox[{"testDisk", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\n", "        ", 
        RowBox[{"tmpProd1", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{"tmpDiff", ",", "diskNormalAxis"}], "]"}]}], ";", "\n", 
        "        ", 
        RowBox[{"tmpProd2", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{"tmpRayDir", ",", "diskNormalAxis"}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"tmpProd3", "=", 
         RowBox[{"tmpProd1", "/", "tmpProd2"}]}], ";", "\n", "\t ", 
        RowBox[{"intsPt", "=", 
         RowBox[{"spherePt", "-", 
          RowBox[{"tmpRayDir", "*", "tmpProd3"}]}]}], ";", 
        "\[IndentingNewLine]", "  ", 
        RowBox[{"diskPt", "=", "intsPt"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{"intsPt", "-", 
             RowBox[{"testDisk", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ">", "diskRadius"}], 
          ",", 
          RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"calculate", " ", "shading", " ", "on", " ", "disk"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"sglight", "=", 
         RowBox[{"sgDirLight", "[", 
          RowBox[{"lightDir", ",", "lightIntensity", ",", "lightLambda"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"refLightDir", "=", "lightDir"}], ";", "\[IndentingNewLine]", 
        RowBox[{"refViewDir", "=", 
         RowBox[{"Normalize", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], "-", "diskPt"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"refNormal", "=", "diskNormalAxis"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sgndf", "=", 
         RowBox[{"sgNDF", "[", 
          RowBox[{
          "roughness", ",", "refLightDir", ",", "refViewDir", ",", 
           "refNormal"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"diskLighting1", "=", 
         RowBox[{"sgDot", "[", 
          RowBox[{"sglight", ",", "sgndf"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"finalLighting", "=", 
         RowBox[{"diskLighting1", "*", "shadingColorScaling"}]}], ";", 
        "\[IndentingNewLine]", "finalLighting"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", "  ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spheres\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "  ", 
           RowBox[{"(*", 
            RowBox[{"shading", " ", "sphere"}], "*)"}], "\[IndentingNewLine]",
            "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"testSphere", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", 
              RowBox[{"testSphere", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "100"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"(*", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                 "sphereShadingFunc"}], " ", "]"}]}], "*)"}], 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Hue", "@", 
                 RowBox[{"asgVector", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    "minorAxis", ",", "majorAxis", ",", "\[Lambda]1", ",", 
                    "\[Lambda]1", ",", "1"}], "}"}]}], "]"}]}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "|>"}], "\[IndentingNewLine]", " ", 
           "}"}]}], "&"}], "[", "]"}], ",", "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", " ", 
           RowBox[{"(*", 
            RowBox[{"ellipse", " ", "major", " ", "axis"}], "*)"}], 
           "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "majorAxis"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "majorSize"}], ",", 
              RowBox[{"\"\<plotPts\>\"", "\[Rule]", "2"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "minorAxis"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "minorSize"}], ",", 
              RowBox[{"\"\<plotPts\>\"", "\[Rule]", "2"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<disks\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"testDisk", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<normalAxis\>\"", "\[Rule]", 
              RowBox[{"testDisk", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", 
              RowBox[{"testDisk", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "0"}], ",", 
             RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                "Cyan"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", " ", 
           "}"}]}], "&"}], "[", "]"}], ",", "\[IndentingNewLine]", " ", 
       RowBox[{"\"\<customPlots\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"testDisk", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", 
                RowBox[{"lightDir", "*", "2"}]}], ",", 
               RowBox[{
                RowBox[{"testDisk", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", "lightDir"}]}], "}"}], 
             "]"}]}], "}"}], "]"}], "}"}]}], ",", "\[IndentingNewLine]", "  ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\"\<projDisks\>\"", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", "   ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<disk\>\"", "\[Rule]", "#testDisk"}], ",", 
               RowBox[{"\"\<sphCenter\>\"", "\[Rule]", 
                RowBox[{"testSphere", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"\"\<sphRadius\>\"", "\[Rule]", 
                RowBox[{"testSphere", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]",
                "\t", 
               RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
               RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                  "LightBlue"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", 
             " ", "}"}]}], "&"}], "[", 
          RowBox[{"<|", 
           RowBox[{"\"\<testDisk\>\"", "\[Rule]", "testDisk"}], "|>"}], "]"}],
          ","}], "*)"}], "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.6"}]}], 
      "\[IndentingNewLine]", "|>"}], 
     RowBox[{"(*", 
      RowBox[{",", "Large"}], "*)"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "0.1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightLambda", ",", "5"}], "}"}], ",", "sgMinLambda", ",", 
     "50"}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalX", ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "0.1"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalY", ",", 
       RowBox[{"-", "0.5"}]}], "}"}], ",", 
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "0.1"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskRadius", ",", "0.5"}], "}"}], ",", "0.2", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.1"}], "}"}], ",", "0.01", ",", "0.99"}], 
    "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingColorScaling", ",", "0.3"}], "}"}], ",", "0.1", ",", 
     "1"}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"asgData", ",", 
      RowBox[{"{", 
       RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "}"}]}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "testDisk", ",", "testSphere", ",", "diskNormalAxis", ",", "viewDir", ",", 
    "halfDir", ",", "lightDir", ",", "\[IndentingNewLine]", "   ", 
    "majorAxis", ",", "majorX", ",", "majorY", ",", "minorAxis", ",", 
    "minorX", ",", "minorY", ",", "majorSize", ",", "minorSize", ",", 
    "\[IndentingNewLine]", "  ", "sphereShadingFunc", ",", "\[Lambda]1", ",", 
    "\[Lambda]2"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.835319733909803*^9, 3.835319771513985*^9}, 
   3.8353236211128197`*^9, {3.835323664716447*^9, 3.835323722118315*^9}, {
   3.8356629499134007`*^9, 3.835662953385677*^9}, {3.8356633184652643`*^9, 
   3.8356633213434553`*^9}},
 CellLabel->
  "In[624]:=",ExpressionUUID->"e3338945-c2b1-4460-97c7-9ff86f3f0dad"],

Cell[BoxData[
 StyleBox["\<\" Visualize Lambda(Attenuation)\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.835319748552573*^9, 3.835319772123988*^9}, 
   3.8353236229060345`*^9, {3.835323666726648*^9, 3.835323724264129*^9}, 
   3.8356633220210695`*^9, 3.835995556838371*^9, 3.837243663062927*^9},
 CellLabel->
  "During evaluation of \
In[624]:=",ExpressionUUID->"fc9a2f01-38a9-4b4f-93d1-c1b3032ebaaf"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`asgData$$ = {
    10.168953684997245`, $CellContext`\[Lambda]2}, $CellContext`diskNormalX$$ \
= -2, $CellContext`diskNormalY$$ = -0.5, $CellContext`diskRadius$$ = 
    0.5, $CellContext`lightIntensity$$ = 1, $CellContext`lightLambda$$ = 
    5, $CellContext`roughness$$ = 0.1, $CellContext`shadingColorScaling$$ = 
    0.3, Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightIntensity$$], 1}, 0.1, 10}, {{
       Hold[$CellContext`lightLambda$$], 5}, 4.60517, 50}, {{
       Hold[$CellContext`diskNormalX$$], -2}, -3, -0.1}, {{
       Hold[$CellContext`diskNormalY$$], -0.5}, -3, -0.1}, {{
       Hold[$CellContext`diskRadius$$], 0.5}, 0.2, 1}, {{
       Hold[$CellContext`roughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`shadingColorScaling$$], 0.3}, 0.1, 1}, {{
       Hold[$CellContext`asgData$$], {
       10.168953684997245`, $CellContext`\[Lambda]2}}}}, Typeset`size$$ = {
    82., {42., 48.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightIntensity$542103$$ = 
    0, $CellContext`lightLambda$542104$$ = 
    0, $CellContext`diskNormalX$542105$$ = 
    0, $CellContext`diskNormalY$542106$$ = 
    0, $CellContext`diskRadius$542107$$ = 0, $CellContext`roughness$542108$$ =
     0, $CellContext`shadingColorScaling$542109$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`asgData$$ = {$CellContext`\[Lambda]1, \
$CellContext`\[Lambda]2}, $CellContext`diskNormalX$$ = -2, \
$CellContext`diskNormalY$$ = -0.5, $CellContext`diskRadius$$ = 
        0.5, $CellContext`lightIntensity$$ = 1, $CellContext`lightLambda$$ = 
        5, $CellContext`roughness$$ = 0.1, $CellContext`shadingColorScaling$$ = 
        0.3}, "ControllerVariables" :> {
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$542103$$, 0], 
        Hold[$CellContext`lightLambda$$, $CellContext`lightLambda$542104$$, 
         0], 
        Hold[$CellContext`diskNormalX$$, $CellContext`diskNormalX$542105$$, 
         0], 
        Hold[$CellContext`diskNormalY$$, $CellContext`diskNormalY$542106$$, 
         0], 
        Hold[$CellContext`diskRadius$$, $CellContext`diskRadius$542107$$, 0], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$542108$$, 0], 
        Hold[$CellContext`shadingColorScaling$$, \
$CellContext`shadingColorScaling$542109$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`diskNormalAxis = 
        Normalize[{$CellContext`diskNormalX$$, $CellContext`diskNormalY$$, \
-1}]; $CellContext`testDisk = {{0, 0, 
          1}, $CellContext`diskNormalAxis, $CellContext`diskRadius$$}; \
$CellContext`testSphere = {{0, 0, 0}, 1}; $CellContext`viewDir = 
        Normalize[{0, 0, 0} - {0, 0, 
          1}]; $CellContext`halfDir = $CellContext`diskNormalAxis; \
$CellContext`lightDir = 
        Normalize[
         2 Dot[$CellContext`viewDir, $CellContext`halfDir] \
$CellContext`halfDir - $CellContext`viewDir]; $CellContext`majorX = \
-$CellContext`diskNormalY$$; $CellContext`majorY = $CellContext`diskNormalX$$; \
$CellContext`majorAxis = 
        Normalize[{$CellContext`majorX, $CellContext`majorY, 
           0}]; $CellContext`minorX = -$CellContext`majorY; \
$CellContext`minorY = $CellContext`majorX; $CellContext`minorAxis = 
        Normalize[{$CellContext`minorX, $CellContext`minorY, 
           0}]; $CellContext`majorSize = $CellContext`diskRadius$$; \
$CellContext`minorSize = 
        Dot[$CellContext`diskNormalAxis, {0, 0, 
           1}] $CellContext`diskRadius$$; $CellContext`\[Lambda]1 = 
        0.233 
         Dot[$CellContext`lightDir, \
$CellContext`diskNormalAxis]/$CellContext`roughness$$^2; \
$CellContext`sphereShadingFunc := 
        Block[{$CellContext`spherePt, $CellContext`diskPt, \
$CellContext`tmpRayDir, $CellContext`tmpDiff, $CellContext`tmpProd1, \
$CellContext`tmpProd2, $CellContext`tmpProd3, $CellContext`intsPt, \
$CellContext`sglight, $CellContext`refLightDir, $CellContext`refViewDir, \
$CellContext`refNormal, $CellContext`sgndf, $CellContext`diskLighting1, \
$CellContext`finalLighting}, $CellContext`spherePt = {$CellContext`x, \
$CellContext`y, $CellContext`z}; If[$CellContext`z < 0, 
            Return[0]]; $CellContext`tmpRayDir = 
           Normalize[$CellContext`spherePt]; $CellContext`tmpDiff = \
$CellContext`spherePt - Part[$CellContext`testDisk, 1]; $CellContext`tmpProd1 = 
           Dot[$CellContext`tmpDiff, $CellContext`diskNormalAxis]; \
$CellContext`tmpProd2 = 
           Dot[$CellContext`tmpRayDir, $CellContext`diskNormalAxis]; \
$CellContext`tmpProd3 = $CellContext`tmpProd1/$CellContext`tmpProd2; \
$CellContext`intsPt = $CellContext`spherePt - $CellContext`tmpRayDir \
$CellContext`tmpProd3; $CellContext`diskPt = $CellContext`intsPt; 
          If[Norm[$CellContext`intsPt - 
              Part[$CellContext`testDisk, 1]] > $CellContext`diskRadius$$, 
            Return[0]]; $CellContext`sglight = 
           sgCommon`sgDirLight[$CellContext`lightDir, \
$CellContext`lightIntensity$$, $CellContext`lightLambda$$]; \
$CellContext`refLightDir = $CellContext`lightDir; $CellContext`refViewDir = 
           Normalize[{0, 0, 
              0} - $CellContext`diskPt]; $CellContext`refNormal = \
$CellContext`diskNormalAxis; $CellContext`sgndf = 
           sgCommon`sgNDF[$CellContext`roughness$$, $CellContext`refLightDir, \
$CellContext`refViewDir, $CellContext`refNormal]; $CellContext`diskLighting1 = 
           sgCommon`sgDot[$CellContext`sglight, $CellContext`sgndf]; \
$CellContext`finalLighting = $CellContext`diskLighting1 \
$CellContext`shadingColorScaling$$; $CellContext`finalLighting]; 
       gPlots3D`gParamPlot3D[
         Association[
          ("spheres" -> {
            Association[
            "center" -> Part[$CellContext`testSphere, 1], "radius" -> 
             Part[$CellContext`testSphere, 2], "opacity" -> 1, "plotPts" -> 
             100, "mesh" -> None, "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
               Hue[
                
                sgCommon`asgVector[{$CellContext`x, $CellContext`y, \
$CellContext`z}, {{0, 0, 
                  1}, $CellContext`minorAxis, $CellContext`majorAxis, \
$CellContext`\[Lambda]1, $CellContext`\[Lambda]1, 1}]]]]}& )[], 
          ("lines" -> {
            Association[
            "startPos" -> {0, 0, 1}, "dirVec" -> $CellContext`majorAxis, 
             "length" -> $CellContext`majorSize, "plotPts" -> 2, 
             "colorFunc" -> (Green& ), "thickness" -> 0.005], 
            Association[
            "startPos" -> {0, 0, 1}, "dirVec" -> $CellContext`minorAxis, 
             "length" -> $CellContext`minorSize, "plotPts" -> 2, 
             "colorFunc" -> (Green& ), "thickness" -> 0.005]}& )[], 
          ("disks" -> {
            Association[
            "center" -> Part[$CellContext`testDisk, 1], "normalAxis" -> 
             Part[$CellContext`testDisk, 2], "radius" -> 
             Part[$CellContext`testDisk, 3], "opacity" -> 0, "mesh" -> None, 
             "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z, \
$CellContext`p}, Cyan]]}& )[], "customPlots" -> {
            Graphics3D[{Blue, 
              
              Arrow[{Part[$CellContext`testDisk, 1] + $CellContext`lightDir 2,
                 Part[$CellContext`testDisk, 1] + $CellContext`lightDir}]}]}, 
          "axisExtent" -> 1.6]]), 
      "Specifications" :> {{{$CellContext`lightIntensity$$, 1}, 0.1, 
         10}, {{$CellContext`lightLambda$$, 5}, 4.60517, 
         50}, {{$CellContext`diskNormalX$$, -2}, -3, -0.1}, \
{{$CellContext`diskNormalY$$, -0.5}, -3, -0.1}, {{$CellContext`diskRadius$$, 
          0.5}, 0.2, 1}, {{$CellContext`roughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`shadingColorScaling$$, 0.3}, 0.1, 
         1}, {{$CellContext`asgData$$, {$CellContext`\[Lambda]1, \
$CellContext`\[Lambda]2}}}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{129., {64., 70.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8353197485772038`*^9, 3.8353197721703715`*^9}, 
   3.835323622935955*^9, {3.8353236667598133`*^9, 3.8353237242943587`*^9}, 
   3.835663322047588*^9, 3.8359955568572893`*^9, 3.8372436631286125`*^9},
 CellLabel->
  "Out[626]=",ExpressionUUID->"9abfac44-bc29-4f6f-aaa5-d5782cadedae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"k", ",", "m", ",", "\[Theta]L", ",", "\[Theta]a"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Integrate fitted function\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "k"}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]], " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", "\[Theta]a"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Approx Erf\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{"Erf", "[", 
     RowBox[{
      SqrtBox["k"], " ", 
      RowBox[{"Sin", "[", "\[Theta]a", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]a", "]"}], ",", "0", ",", "1"}], "}"}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gPrint", "[", "\"\<Comparing Approx Erf\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"k", "=", 
     FractionBox[
      RowBox[{"0.233", " ", 
       RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
      RowBox[{"m", "^", "2"}]]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Plot", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Erf", "[", 
          RowBox[{
           SqrtBox["k"], " ", 
           RowBox[{"Sin", "[", "\[Theta]a", "]"}]}], "]"}], "/.", 
         RowBox[{"k", "->", 
          FractionBox[
           RowBox[{"0.233", " ", 
            RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
           RowBox[{"m", "^", "2"}]]}]}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"2", " ", 
             SqrtBox["k"], " ", 
             RowBox[{"Sin", "[", "\[Theta]a", "]"}]}], 
            SqrtBox["\[Pi]"]], ",", "1"}], "]"}], "/.", 
         RowBox[{"k", "->", 
          FractionBox[
           RowBox[{"0.233", " ", 
            RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
           RowBox[{"m", "^", "2"}]]}]}]}], "\[IndentingNewLine]", "\t", "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]a", ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "0.1"}], "}"}], ",", "0.01", ",", "0.99"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]L", ",", 
        RowBox[{"\[Pi]", "/", "6"}]}], "}"}], ",", "0", ",", 
      RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Comparing Integrated Function\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Plot", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"4", " ", 
            SuperscriptBox["m", "4"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["m", "2"], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["m", "2"]}], ")"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]L", "-", 
                 RowBox[{"ArcTan", "[", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"Sec", "[", "\[Theta]L", "]"}], "2"], " ", 
                    RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "+", 
                   RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]}], 
                "]"}]}]}], ")"}], "2"]], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "0", ",", "\[Theta]a"}], "}"}]}], "]"}], 
        ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", 
         RowBox[{
          FractionBox[
           RowBox[{
            SqrtBox["\[Pi]"], " ", 
            RowBox[{"Erf", "[", 
             RowBox[{
              SqrtBox["k"], " ", 
              RowBox[{"Sin", "[", "\[Theta]a", "]"}]}], "]"}]}], 
           RowBox[{"2", " ", 
            SqrtBox["k"]}]], "/.", 
          RowBox[{"k", "->", 
           FractionBox[
            RowBox[{"0.233", " ", 
             RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
            RowBox[{"m", "^", "2"}]]}]}], "*)"}], ",", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{
         RowBox[{
          FractionBox[
           SqrtBox["\[Pi]"], 
           RowBox[{"2", " ", 
            SqrtBox["k"]}]], 
          RowBox[{"Min", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"2", " ", 
              SqrtBox["k"], 
              RowBox[{"Sin", "[", " ", "\[Theta]a", "]"}]}], 
             SqrtBox["\[Pi]"]], ",", "1"}], "]"}]}], "/.", 
         RowBox[{"k", "->", 
          FractionBox[
           RowBox[{"0.233", " ", 
            RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
           RowBox[{"m", "^", "2"}]]}]}]}], "\[IndentingNewLine]", "        ", 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\[Theta]a", ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "*)"}], "]"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "0.1"}], "}"}], ",", "0.01", ",", "0.9"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]L", ",", 
        RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", 
      RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "gPrint", "[", 
   "\"\<Comparing Integrated Function(Multiplied with lighting)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Plot", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"4", " ", 
            SuperscriptBox["m", "4"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["m", "2"], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["m", "2"]}], ")"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]L", "-", 
                 RowBox[{"ArcTan", "[", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"Sec", "[", "\[Theta]L", "]"}], "2"], " ", 
                    RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "+", 
                   RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]}], 
                "]"}]}]}], ")"}], "2"]], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "0", ",", "\[Theta]a"}], "}"}]}], "]"}], 
        "*", 
        RowBox[{"gDGGX", "[", 
         RowBox[{"m", ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{
              SqrtBox["\[Pi]"], " ", 
              RowBox[{"Erf", "[", 
               RowBox[{
                SqrtBox["k"], " ", 
                RowBox[{"Sin", "[", "\[Theta]a", "]"}]}], "]"}]}], 
             RowBox[{"2", " ", 
              SqrtBox["k"]}]], "*", 
            RowBox[{"gDGGX", "[", 
             RowBox[{"m", ",", "1"}], "]"}]}], ")"}], "/.", 
          RowBox[{"k", "->", 
           FractionBox[
            RowBox[{"0.233", " ", 
             RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
            RowBox[{"m", "^", "2"}]]}]}], ","}], "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SqrtBox["\[Pi]"], 
           RowBox[{"2", " ", 
            SqrtBox["k"]}]], 
          RowBox[{"Min", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"2", " ", 
              SqrtBox["k"], 
              RowBox[{"Sin", "[", " ", "\[Theta]a", "]"}]}], 
             SqrtBox["\[Pi]"]], ",", "1"}], "]"}], "*", 
          RowBox[{"gDGGX", "[", 
           RowBox[{"m", ",", "1"}], "]"}]}], ")"}], "/.", 
        RowBox[{"k", "->", 
         FractionBox[
          RowBox[{"0.233", " ", 
           RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
          RowBox[{"m", "^", "2"}]]}]}]}], "\[IndentingNewLine]", "        ", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Theta]a", ",", "0", ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "*)"}], "]"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "0.1"}], "}"}], ",", "0.01", ",", "0.9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]L", ",", 
       RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8356632090775576`*^9, 3.8356632124375944`*^9}, {
   3.83566330235246*^9, 3.8356638468800616`*^9}, {3.8356639230660195`*^9, 
   3.8356639400382147`*^9}, {3.8356639866532593`*^9, 3.835664161948839*^9}, 
   3.8356641956702194`*^9, {3.835664270599862*^9, 3.835664292968541*^9}, {
   3.8356645868472967`*^9, 3.8356646248676977`*^9}, {3.8356695098925953`*^9, 
   3.8356695698433585`*^9}, {3.835670994940934*^9, 3.8356710446588*^9}},
 CellLabel->
  "In[628]:=",ExpressionUUID->"414fc9c6-c558-4623-a6bd-1c0357f20b56"],

Cell[BoxData[
 StyleBox["\<\" Integrate fitted function\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8356634605299683`*^9, {3.83566351086264*^9, 3.8356635402795105`*^9}, 
   3.8356636767636156`*^9, {3.835663752503141*^9, 3.835663847613593*^9}, 
   3.8356639248321996`*^9, {3.835664002165132*^9, 3.835664012292181*^9}, {
   3.8356641495588045`*^9, 3.8356641968041205`*^9}, {3.835664271942206*^9, 
   3.835664293360174*^9}, {3.835664580454645*^9, 3.8356645880565214`*^9}, 
   3.835664641027481*^9, 3.8356695710912323`*^9, 3.8356709981720347`*^9, 
   3.8356710298448677`*^9, 3.835995557465172*^9, 3.8372436641695347`*^9},
 CellLabel->
  "During evaluation of \
In[628]:=",ExpressionUUID->"b53cb466-6837-459a-b044-d4cfbcbe42c4"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox["\[Pi]"], " ", 
   RowBox[{"Erf", "[", 
    RowBox[{
     SqrtBox["k"], " ", 
     RowBox[{"Sin", "[", "\[Theta]a", "]"}]}], "]"}]}], 
  RowBox[{"2", " ", 
   SqrtBox["k"]}]]], "Output",
 CellChangeTimes->{{3.8356633987138243`*^9, 3.8356634070578136`*^9}, 
   3.8356634605369806`*^9, {3.8356635108879585`*^9, 3.8356635402865562`*^9}, 
   3.8356636767705965`*^9, {3.835663752529072*^9, 3.8356638476395245`*^9}, 
   3.835663924859125*^9, {3.8356640021960783`*^9, 3.835664012320135*^9}, {
   3.835664149588725*^9, 3.8356641968509645`*^9}, {3.8356642719881124`*^9, 
   3.835664293409045*^9}, {3.835664580484565*^9, 3.835664588103397*^9}, 
   3.8356646410534115`*^9, 3.8356695711381407`*^9, 3.8356709982089453`*^9, 
   3.835671029891757*^9, 3.8359955576128073`*^9, 3.837243664274248*^9},
 CellLabel->
  "Out[630]=",ExpressionUUID->"c6922871-f54c-4edb-8669-a8e9b1f45c6a"],

Cell[BoxData[
 StyleBox["\<\" Approx Erf\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8356634605299683`*^9, {3.83566351086264*^9, 3.8356635402795105`*^9}, 
   3.8356636767636156`*^9, {3.835663752503141*^9, 3.835663847613593*^9}, 
   3.8356639248321996`*^9, {3.835664002165132*^9, 3.835664012292181*^9}, {
   3.8356641495588045`*^9, 3.8356641968041205`*^9}, {3.835664271942206*^9, 
   3.835664293360174*^9}, {3.835664580454645*^9, 3.8356645880565214`*^9}, 
   3.835664641027481*^9, 3.8356695710912323`*^9, 3.8356709981720347`*^9, 
   3.8356710298448677`*^9, 3.835995557465172*^9, 3.837243664295082*^9},
 CellLabel->
  "During evaluation of \
In[628]:=",ExpressionUUID->"e0f983a3-9620-481b-8dd4-38d9f4cb49a4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", 
     SqrtBox["k"], " ", 
     RowBox[{"Sin", "[", "\[Theta]a", "]"}]}], 
    SqrtBox["\[Pi]"]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      RowBox[{"Sin", "[", "\[Theta]a", "]"}], "]"}], "2"],
    SeriesData[
     Sin[$CellContext`\[Theta]a], 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[
   Sin[$CellContext`\[Theta]a], 0, {
   2 $CellContext`k^Rational[1, 2] Pi^Rational[-1, 2]}, 1, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.8356633987138243`*^9, 3.8356634070578136`*^9}, 
   3.8356634605369806`*^9, {3.8356635108879585`*^9, 3.8356635402865562`*^9}, 
   3.8356636767705965`*^9, {3.835663752529072*^9, 3.8356638476395245`*^9}, 
   3.835663924859125*^9, {3.8356640021960783`*^9, 3.835664012320135*^9}, {
   3.835664149588725*^9, 3.8356641968509645`*^9}, {3.8356642719881124`*^9, 
   3.835664293409045*^9}, {3.835664580484565*^9, 3.835664588103397*^9}, 
   3.8356646410534115`*^9, 3.8356695711381407`*^9, 3.8356709982089453`*^9, 
   3.835671029891757*^9, 3.8359955576128073`*^9, 3.837243664295082*^9},
 CellLabel->
  "Out[632]=",ExpressionUUID->"325fe7e6-ca14-434a-aafc-62170cdd71b7"],

Cell[BoxData[
 StyleBox["\<\" Comparing Approx Erf\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8356634605299683`*^9, {3.83566351086264*^9, 3.8356635402795105`*^9}, 
   3.8356636767636156`*^9, {3.835663752503141*^9, 3.835663847613593*^9}, 
   3.8356639248321996`*^9, {3.835664002165132*^9, 3.835664012292181*^9}, {
   3.8356641495588045`*^9, 3.8356641968041205`*^9}, {3.835664271942206*^9, 
   3.835664293360174*^9}, {3.835664580454645*^9, 3.8356645880565214`*^9}, 
   3.835664641027481*^9, 3.8356695710912323`*^9, 3.8356709981720347`*^9, 
   3.8356710298448677`*^9, 3.835995557465172*^9, 3.8372436643096266`*^9},
 CellLabel->
  "During evaluation of \
In[628]:=",ExpressionUUID->"798ff35d-9f1a-4e55-99a1-84dad6311e0b"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`m$$ = 0.1, $CellContext`\[Theta]L$$ = 
    Rational[1, 6] Pi, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`m$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`\[Theta]L$$], Rational[1, 6] Pi}, 0, Rational[1, 2] 
      Pi}}, Typeset`size$$ = {324., {96., 101.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`m$552682$$ = 0, $CellContext`\[Theta]L$552683$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`m$$ = 0.1, $CellContext`\[Theta]L$$ = 
        Rational[1, 6] Pi}, "ControllerVariables" :> {
        Hold[$CellContext`m$$, $CellContext`m$552682$$, 0], 
        Hold[$CellContext`\[Theta]L$$, $CellContext`\[Theta]L$552683$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[{
         ReplaceAll[
          Erf[
          Sqrt[$CellContext`k] Sin[$CellContext`\[Theta]a]], $CellContext`k -> 
          0.233 Cos[$CellContext`\[Theta]L$$]/$CellContext`m$$^2], 
         ReplaceAll[
          Min[
          2 Sqrt[$CellContext`k] Sin[$CellContext`\[Theta]a]/Sqrt[Pi], 
           1], $CellContext`k -> 
          0.233 Cos[$CellContext`\[Theta]L$$]/$CellContext`m$$^2]}, \
{$CellContext`\[Theta]a, 0, Pi/2}], 
      "Specifications" :> {{{$CellContext`m$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`\[Theta]L$$, Rational[1, 6] Pi}, 0, 
         Rational[1, 2] Pi}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{371., {151., 157.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8356633987138243`*^9, 3.8356634070578136`*^9}, 
   3.8356634605369806`*^9, {3.8356635108879585`*^9, 3.8356635402865562`*^9}, 
   3.8356636767705965`*^9, {3.835663752529072*^9, 3.8356638476395245`*^9}, 
   3.835663924859125*^9, {3.8356640021960783`*^9, 3.835664012320135*^9}, {
   3.835664149588725*^9, 3.8356641968509645`*^9}, {3.8356642719881124`*^9, 
   3.835664293409045*^9}, {3.835664580484565*^9, 3.835664588103397*^9}, 
   3.8356646410534115`*^9, 3.8356695711381407`*^9, 3.8356709982089453`*^9, 
   3.835671029891757*^9, 3.8359955576128073`*^9, 3.837243664369065*^9},
 CellLabel->
  "Out[634]=",ExpressionUUID->"3cfc0d38-a8dd-4770-983c-64c7acdb7170"],

Cell[BoxData[
 StyleBox["\<\" Comparing Integrated Function\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8356634605299683`*^9, {3.83566351086264*^9, 3.8356635402795105`*^9}, 
   3.8356636767636156`*^9, {3.835663752503141*^9, 3.835663847613593*^9}, 
   3.8356639248321996`*^9, {3.835664002165132*^9, 3.835664012292181*^9}, {
   3.8356641495588045`*^9, 3.8356641968041205`*^9}, {3.835664271942206*^9, 
   3.835664293360174*^9}, {3.835664580454645*^9, 3.8356645880565214`*^9}, 
   3.835664641027481*^9, 3.8356695710912323`*^9, 3.8356709981720347`*^9, 
   3.8356710298448677`*^9, 3.835995557465172*^9, 3.8372436647582493`*^9},
 CellLabel->
  "During evaluation of \
In[628]:=",ExpressionUUID->"51c7a79e-3b08-4566-ae71-ba51f9225325"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`m$$ = 0.1, $CellContext`\[Theta]L$$ = 
    Rational[1, 4] Pi, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`m$$], 0.1}, 0.01, 0.9}, {{
       Hold[$CellContext`\[Theta]L$$], Rational[1, 4] Pi}, 0, Rational[1, 2] 
      Pi}}, Typeset`size$$ = {324., {96., 101.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`m$552770$$ = 0, $CellContext`\[Theta]L$552771$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`m$$ = 0.1, $CellContext`\[Theta]L$$ = 
        Rational[1, 4] Pi}, "ControllerVariables" :> {
        Hold[$CellContext`m$$, $CellContext`m$552770$$, 0], 
        Hold[$CellContext`\[Theta]L$$, $CellContext`\[Theta]L$552771$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[{
         NIntegrate[
         4 $CellContext`m$$^4/(
           1 + $CellContext`m$$^2 + (-1 + $CellContext`m$$^2) 
            Cos[$CellContext`\[Theta]L$$ - ArcTan[
              Sec[$CellContext`\[Theta]L$$]^2 Tan[$CellContext`\[Theta]] + 
               Tan[$CellContext`\[Theta]L$$]]])^2, {$CellContext`\[Theta], 
           0, $CellContext`\[Theta]a}], Null, 
         ReplaceAll[(Sqrt[Pi]/(2 Sqrt[$CellContext`k])) 
          Min[2 Sqrt[$CellContext`k] Sin[$CellContext`\[Theta]a]/Sqrt[Pi], 
            1], $CellContext`k -> 
          0.233 Cos[$CellContext`\[Theta]L$$]/$CellContext`m$$^2]}, \
{$CellContext`\[Theta]a, 0, Pi/2}], 
      "Specifications" :> {{{$CellContext`m$$, 0.1}, 0.01, 
         0.9}, {{$CellContext`\[Theta]L$$, Rational[1, 4] Pi}, 0, 
         Rational[1, 2] Pi}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{371., {151., 157.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8356633987138243`*^9, 3.8356634070578136`*^9}, 
   3.8356634605369806`*^9, {3.8356635108879585`*^9, 3.8356635402865562`*^9}, 
   3.8356636767705965`*^9, {3.835663752529072*^9, 3.8356638476395245`*^9}, 
   3.835663924859125*^9, {3.8356640021960783`*^9, 3.835664012320135*^9}, {
   3.835664149588725*^9, 3.8356641968509645`*^9}, {3.8356642719881124`*^9, 
   3.835664293409045*^9}, {3.835664580484565*^9, 3.835664588103397*^9}, 
   3.8356646410534115`*^9, 3.8356695711381407`*^9, 3.8356709982089453`*^9, 
   3.835671029891757*^9, 3.8359955576128073`*^9, 3.837243664815547*^9},
 CellLabel->
  "Out[636]=",ExpressionUUID->"06f21364-946a-4138-88af-0317741924d7"],

Cell[BoxData[
 StyleBox["\<\" Comparing Integrated Function(Multiplied with lighting)\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8356634605299683`*^9, {3.83566351086264*^9, 3.8356635402795105`*^9}, 
   3.8356636767636156`*^9, {3.835663752503141*^9, 3.835663847613593*^9}, 
   3.8356639248321996`*^9, {3.835664002165132*^9, 3.835664012292181*^9}, {
   3.8356641495588045`*^9, 3.8356641968041205`*^9}, {3.835664271942206*^9, 
   3.835664293360174*^9}, {3.835664580454645*^9, 3.8356645880565214`*^9}, 
   3.835664641027481*^9, 3.8356695710912323`*^9, 3.8356709981720347`*^9, 
   3.8356710298448677`*^9, 3.835995557465172*^9, 3.837243665562187*^9},
 CellLabel->
  "During evaluation of \
In[628]:=",ExpressionUUID->"b09f4f77-cd65-405f-91cb-514ec08fe497"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`m$$ = 0.1, $CellContext`\[Theta]L$$ = 
    Rational[1, 4] Pi, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`m$$], 0.1}, 0.01, 0.9}, {{
       Hold[$CellContext`\[Theta]L$$], Rational[1, 4] Pi}, 0, Rational[1, 2] 
      Pi}}, Typeset`size$$ = {324., {97., 103.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`m$555315$$ = 0, $CellContext`\[Theta]L$555316$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`m$$ = 0.1, $CellContext`\[Theta]L$$ = 
        Rational[1, 4] Pi}, "ControllerVariables" :> {
        Hold[$CellContext`m$$, $CellContext`m$555315$$, 0], 
        Hold[$CellContext`\[Theta]L$$, $CellContext`\[Theta]L$555316$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Plot[{NIntegrate[
          4 $CellContext`m$$^4/(
            1 + $CellContext`m$$^2 + (-1 + $CellContext`m$$^2) 
             Cos[$CellContext`\[Theta]L$$ - ArcTan[
               Sec[$CellContext`\[Theta]L$$]^2 Tan[$CellContext`\[Theta]] + 
                Tan[$CellContext`\[Theta]L$$]]])^2, {$CellContext`\[Theta], 
            0, $CellContext`\[Theta]a}] gBRDF`gDGGX[$CellContext`m$$, 1], 
         ReplaceAll[(Sqrt[Pi]/(2 Sqrt[$CellContext`k])) 
          Min[2 Sqrt[$CellContext`k] Sin[$CellContext`\[Theta]a]/Sqrt[Pi], 1] 
          gBRDF`gDGGX[$CellContext`m$$, 1], $CellContext`k -> 
          0.233 Cos[$CellContext`\[Theta]L$$]/$CellContext`m$$^2]}, \
{$CellContext`\[Theta]a, 0, Pi/2}], 
      "Specifications" :> {{{$CellContext`m$$, 0.1}, 0.01, 
         0.9}, {{$CellContext`\[Theta]L$$, Rational[1, 4] Pi}, 0, 
         Rational[1, 2] Pi}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{371., {153., 159.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8356633987138243`*^9, 3.8356634070578136`*^9}, 
   3.8356634605369806`*^9, {3.8356635108879585`*^9, 3.8356635402865562`*^9}, 
   3.8356636767705965`*^9, {3.835663752529072*^9, 3.8356638476395245`*^9}, 
   3.835663924859125*^9, {3.8356640021960783`*^9, 3.835664012320135*^9}, {
   3.835664149588725*^9, 3.8356641968509645`*^9}, {3.8356642719881124`*^9, 
   3.835664293409045*^9}, {3.835664580484565*^9, 3.835664588103397*^9}, 
   3.8356646410534115`*^9, 3.8356695711381407`*^9, 3.8356709982089453`*^9, 
   3.835671029891757*^9, 3.8359955576128073`*^9, 3.8372436656268864`*^9},
 CellLabel->
  "Out[638]=",ExpressionUUID->"52031dd9-1944-46a0-9c8b-203f1a9dc2a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Simplifing Approx Function\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "f1", ",", "f2", ",", "f2Approx", ",", "f3", ",", "k", ",", "\[Theta]a", 
    ",", "\[Theta]L", ",", "m", ",", "dr"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Erf Fucntion\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"f0", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       SqrtBox["\[Pi]"], " ", 
       RowBox[{"Erf", "[", 
        RowBox[{
         SqrtBox["k"], " ", 
         RowBox[{"Sin", "[", "\[Theta]a", "]"}]}], "]"}]}], 
      RowBox[{"2", " ", 
       SqrtBox["k"]}]], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k", "->", 
        FractionBox[
         RowBox[{"0.233", " ", 
          RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
         RowBox[{"m", "^", "2"}]]}], ",", 
       RowBox[{"\[Theta]a", "\[Rule]", 
        RowBox[{"ArcTan", "[", "dr", "]"}]}]}], "}"}]}], ",", 
    RowBox[{"0", "<", "m", "<", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Origin Function\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"f1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SqrtBox["\[Pi]"], 
        RowBox[{"2", " ", 
         SqrtBox["k"]}]], 
       RowBox[{"Min", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", 
           SqrtBox["k"], 
           RowBox[{"Sin", "[", " ", "\[Theta]a", "]"}]}], 
          SqrtBox["\[Pi]"]], ",", "1"}], "]"}]}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k", "->", 
        FractionBox[
         RowBox[{"0.233", " ", 
          RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
         RowBox[{"m", "^", "2"}]]}], ",", 
       RowBox[{"\[Theta]a", "\[Rule]", 
        RowBox[{"ArcTan", "[", "dr", "]"}]}]}], "}"}]}], ",", 
    RowBox[{"0", "<", "m", "<", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Splitted functions\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"f2", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     FractionBox[
      SqrtBox["\[Pi]"], 
      RowBox[{"2", " ", 
       SqrtBox["k"]}]], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k", "->", 
        FractionBox[
         RowBox[{"0.233", " ", 
          RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
         RowBox[{"m", "^", "2"}]]}], ",", 
       RowBox[{"\[Theta]a", "\[Rule]", 
        RowBox[{"ArcTan", "[", "dr", "]"}]}]}], "}"}]}], ",", 
    RowBox[{"0", "<", "m", "<", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"f3", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SqrtBox["\[Pi]"], 
        RowBox[{"2", " ", 
         SqrtBox["k"]}]], "*", 
       FractionBox[
        RowBox[{"2", " ", 
         SqrtBox["k"], 
         RowBox[{"Sin", "[", " ", "\[Theta]a", "]"}]}], 
        SqrtBox["\[Pi]"]]}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k", "->", 
        FractionBox[
         RowBox[{"0.233", " ", 
          RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
         RowBox[{"m", "^", "2"}]]}], ",", 
       RowBox[{"\[Theta]a", "\[Rule]", 
        RowBox[{"ArcTan", "[", "dr", "]"}]}]}], "}"}]}], ",", 
    RowBox[{"0", "<", "m", "<", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Approx f2\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Series", "[", 
  RowBox[{
   SqrtBox[
    RowBox[{"Cos", "[", "\[Theta]L", "]"}]], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]L", "]"}], ",", "1", ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"f2Approx", "=", 
  RowBox[{
   FractionBox[
    RowBox[{"1.836", "m"}], 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]L", "]"}], "+", "1"}], ")"}]}]], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Simplified funciton\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Min", "[", 
   RowBox[{
    FractionBox["dr", 
     SqrtBox[
      RowBox[{"1", "+", 
       SuperscriptBox["dr", "2"]}]]], ",", 
    FractionBox[
     RowBox[{"3.672", " ", "m"}], 
     RowBox[{"1", "+", 
      RowBox[{"Cos", "[", "\[Theta]L", "]"}]}]]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gPrint", "[", "\"\<Comparing Approx Function\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Plot", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"4", " ", 
           SuperscriptBox["m", "4"]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["m", "2"], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["m", "2"]}], ")"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]L", "-", 
                RowBox[{"ArcTan", "[", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"Sec", "[", "\[Theta]L", "]"}], "2"], " ", 
                   RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "+", 
                  RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]}], 
               "]"}]}]}], ")"}], "2"]], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "0", ",", "\[Theta]a"}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{
          FractionBox["dr", 
           SqrtBox[
            RowBox[{"1", "+", 
             SuperscriptBox["dr", "2"]}]]], ",", 
          FractionBox[
           RowBox[{"3.672", " ", "m"}], 
           RowBox[{"1", "+", 
            RowBox[{"Cos", "[", "\[Theta]L", "]"}]}]]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"dr", "\[Rule]", 
          RowBox[{"Tan", "[", "\[Theta]a", "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "        ", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Theta]a", ",", "0", ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "*)"}], "]"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "0.1"}], "}"}], ",", "0.01", ",", "0.9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]L", ",", 
       RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8356782807137413`*^9, 3.8356786961803045`*^9}, {
  3.835678735061062*^9, 3.835678816036107*^9}, {3.8356788495075088`*^9, 
  3.835678868526018*^9}, {3.8356790710451555`*^9, 3.83567907460693*^9}, {
  3.8359957447031975`*^9, 3.8359957888361106`*^9}},
 CellLabel->
  "In[639]:=",ExpressionUUID->"bdce4bcd-a32a-49bc-bee2-958a611a2af7"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\" Simplifing Approx Function\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8359957903055687`*^9, 3.8372436662463026`*^9},
 CellLabel->
  "During evaluation of \
In[639]:=",ExpressionUUID->"f2de7689-4f38-405d-ba8b-0bb20443b89a"],

Cell[BoxData[
 StyleBox["\<\" Erf Fucntion\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8359957903055687`*^9, 3.8372436662463026`*^9},
 CellLabel->
  "During evaluation of \
In[639]:=",ExpressionUUID->"87b32f5c-2c2f-4f96-8b8b-d3f3ec8323ea"]
}, Open  ]],

Cell[BoxData[
 FractionBox[
  RowBox[{"1.8359759171158512`", " ", "m", " ", 
   RowBox[{"Erf", "[", 
    FractionBox[
     RowBox[{"0.4827007354458868`", " ", "dr", " ", 
      SqrtBox[
       RowBox[{"Cos", "[", "\[Theta]L", "]"}]]}], 
     RowBox[{
      SqrtBox[
       RowBox[{"1", "+", 
        SuperscriptBox["dr", "2"]}]], " ", "m"}]], "]"}]}], 
  SqrtBox[
   RowBox[{"Cos", "[", "\[Theta]L", "]"}]]]], "Output",
 CellChangeTimes->{3.8359957903111563`*^9, 3.8372436662754393`*^9},
 CellLabel->
  "Out[642]=",ExpressionUUID->"0e72bf27-97b6-4eeb-9bc3-9100b812c4d2"],

Cell[BoxData[
 StyleBox["\<\" Origin Function\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8359957903055687`*^9, 3.837243666315645*^9},
 CellLabel->
  "During evaluation of \
In[639]:=",ExpressionUUID->"87310e7f-f8fd-4792-80ab-5a5711a000a6"],

Cell[BoxData[
 FractionBox[
  RowBox[{"1.8359759171158512`", " ", "m", " ", 
   RowBox[{"Min", "[", 
    RowBox[{"1", ",", 
     FractionBox[
      RowBox[{"0.5446694538188211`", " ", "dr", " ", 
       SqrtBox[
        RowBox[{"Cos", "[", "\[Theta]L", "]"}]]}], 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "+", 
         SuperscriptBox["dr", "2"]}]], " ", "m"}]]}], "]"}]}], 
  SqrtBox[
   RowBox[{"Cos", "[", "\[Theta]L", "]"}]]]], "Output",
 CellChangeTimes->{3.8359957903111563`*^9, 3.8372436663514996`*^9},
 CellLabel->
  "Out[644]=",ExpressionUUID->"497e7709-65e1-4ab2-8de8-c12f80765b62"],

Cell[BoxData[
 StyleBox["\<\" Splitted functions\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8359957903055687`*^9, 3.8372436663664002`*^9},
 CellLabel->
  "During evaluation of \
In[639]:=",ExpressionUUID->"b0864892-630d-469c-8461-23390c0470d3"],

Cell[BoxData[
 FractionBox[
  RowBox[{"1.8359759171158512`", " ", "m"}], 
  SqrtBox[
   RowBox[{"Cos", "[", "\[Theta]L", "]"}]]]], "Output",
 CellChangeTimes->{3.8359957903111563`*^9, 3.8372436663664002`*^9},
 CellLabel->
  "Out[646]=",ExpressionUUID->"e6617eab-2b28-4958-a7bb-1ec6630ecfd0"],

Cell[BoxData[
 FractionBox["dr", 
  SqrtBox[
   RowBox[{"1", "+", 
    SuperscriptBox["dr", "2"]}]]]], "Output",
 CellChangeTimes->{3.8359957903111563`*^9, 3.837243666374689*^9},
 CellLabel->
  "Out[647]=",ExpressionUUID->"e94321e0-59cd-4ba3-9e14-7c0212866a6a"],

Cell[BoxData[
 StyleBox["\<\" Approx f2\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8359957903055687`*^9, 3.8372436663794956`*^9},
 CellLabel->
  "During evaluation of \
In[639]:=",ExpressionUUID->"558670a5-96d6-403c-8183-993809fbf36c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]L", "]"}], "-", "1"}], ")"}]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]L", "]"}], "-", "1"}], "]"}], "2"],
    SeriesData[
     Cos[$CellContext`\[Theta]L], 1, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[
   Cos[$CellContext`\[Theta]L], 1, {1, 
    Rational[1, 2]}, 0, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.8359957903111563`*^9, 3.8372436663794956`*^9},
 CellLabel->
  "Out[649]=",ExpressionUUID->"9a6a827c-e535-4caa-b176-3aeb5a5b97ca"],

Cell[BoxData[
 FractionBox[
  RowBox[{"3.672`", " ", "m"}], 
  RowBox[{"1", "+", 
   RowBox[{"Cos", "[", "\[Theta]L", "]"}]}]]], "Output",
 CellChangeTimes->{3.8359957903111563`*^9, 3.837243666386897*^9},
 CellLabel->
  "Out[650]=",ExpressionUUID->"c87d20d7-0bd6-4868-a027-af3fc5eb7800"],

Cell[BoxData[
 StyleBox["\<\" Simplified funciton\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8359957903055687`*^9, 3.837243666386897*^9},
 CellLabel->
  "During evaluation of \
In[639]:=",ExpressionUUID->"3b0cad33-ea3d-4753-b305-f5844fdaa897"],

Cell[BoxData[
 RowBox[{"Min", "[", 
  RowBox[{
   FractionBox["dr", 
    SqrtBox[
     RowBox[{"1", "+", 
      SuperscriptBox["dr", "2"]}]]], ",", 
   FractionBox[
    RowBox[{"3.672`", " ", "m"}], 
    RowBox[{"1", "+", 
     RowBox[{"Cos", "[", "\[Theta]L", "]"}]}]]}], "]"}]], "Output",
 CellChangeTimes->{3.8359957903111563`*^9, 3.837243666386897*^9},
 CellLabel->
  "Out[652]=",ExpressionUUID->"74f47d64-8a62-4f6b-b18f-1b40c67173be"],

Cell[BoxData[
 StyleBox["\<\" Comparing Approx Function\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8359957903055687`*^9, 3.837243666398587*^9},
 CellLabel->
  "During evaluation of \
In[639]:=",ExpressionUUID->"cba168b7-7ba3-46b6-9675-697e2f65fa86"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`m$$ = 0.1, $CellContext`\[Theta]L$$ = 
    Rational[1, 4] Pi, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`m$$], 0.1}, 0.01, 0.9}, {{
       Hold[$CellContext`\[Theta]L$$], Rational[1, 4] Pi}, 0, Rational[1, 2] 
      Pi}}, Typeset`size$$ = {324., {98., 103.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`m$557908$$ = 0, $CellContext`\[Theta]L$557909$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`m$$ = 0.1, $CellContext`\[Theta]L$$ = 
        Rational[1, 4] Pi}, "ControllerVariables" :> {
        Hold[$CellContext`m$$, $CellContext`m$557908$$, 0], 
        Hold[$CellContext`\[Theta]L$$, $CellContext`\[Theta]L$557909$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[{
         NIntegrate[
         4 $CellContext`m$$^4/(
           1 + $CellContext`m$$^2 + (-1 + $CellContext`m$$^2) 
            Cos[$CellContext`\[Theta]L$$ - ArcTan[
              Sec[$CellContext`\[Theta]L$$]^2 Tan[$CellContext`\[Theta]] + 
               Tan[$CellContext`\[Theta]L$$]]])^2, {$CellContext`\[Theta], 
           0, $CellContext`\[Theta]a}], 
         ReplaceAll[
          
          Min[$CellContext`dr/Sqrt[1 + $CellContext`dr^2], 
           3.672 $CellContext`m$$/(1 + 
           Cos[$CellContext`\[Theta]L$$])], {$CellContext`dr -> 
           Tan[$CellContext`\[Theta]a]}]}, {$CellContext`\[Theta]a, 0, Pi/2}],
       "Specifications" :> {{{$CellContext`m$$, 0.1}, 0.01, 
         0.9}, {{$CellContext`\[Theta]L$$, Rational[1, 4] Pi}, 0, 
         Rational[1, 2] Pi}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{371., {153., 159.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8359957903111563`*^9, 3.837243666418335*^9},
 CellLabel->
  "Out[654]=",ExpressionUUID->"e5f75715-35fa-4b32-a34d-0dcb95c4156d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Testing fit models\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"t1", ",", "t2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Plot", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"4", " ", 
           SuperscriptBox["m", "4"]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["m", "2"], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["m", "2"]}], ")"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]L", "-", 
                RowBox[{"ArcTan", "[", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"Sec", "[", "\[Theta]L", "]"}], "2"], " ", 
                   RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "+", 
                  RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]}], 
               "]"}]}]}], ")"}], "2"]], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "0", ",", "\[Theta]a"}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", 
        RowBox[{
         FractionBox[
          RowBox[{
           SqrtBox["\[Pi]"], " ", 
           RowBox[{"Erf", "[", 
            RowBox[{
             SqrtBox["k"], " ", 
             RowBox[{"Sin", "[", "\[Theta]a", "]"}]}], "]"}]}], 
          RowBox[{"2", " ", 
           SqrtBox["k"]}]], "/.", 
         RowBox[{"k", "->", 
          FractionBox[
           RowBox[{"0.233", " ", 
            RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
           RowBox[{"m", "^", "2"}]]}]}], "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"t1", " ", 
           RowBox[{"Sin", "[", "\[Theta]a", "]"}], 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]a", "]"}], "^", "2"}]}], "/", 
             "t2"}], "*)"}]}], 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Theta]a", "]"}], "^", "2"}]}]], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"t1", "\[Rule]", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"a1", "+", 
               RowBox[{"a2", "*", 
                FractionBox[
                 RowBox[{
                  RowBox[{"Cos", "[", "\[Theta]L", "]"}], "^", "2"}], 
                 "m"]}]}], ",", "0.1"}], "]"}]}], 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"+", "a3"}], "*", 
             FractionBox[
              RowBox[{"Cos", "[", "\[Theta]L", "]"}], "m"]}], "*)"}], ",", 
           RowBox[{"t2", "\[Rule]", 
            RowBox[{"a5", "*", "m", "*", 
             RowBox[{"(", 
              RowBox[{"a3", "+", 
               RowBox[{"a4", "*", 
                RowBox[{
                 RowBox[{"Sin", "[", "\[Theta]L", "]"}], "^", "2"}]}]}], 
              ")"}]}]}]}], "}"}]}], ")"}]}], "\[IndentingNewLine]", 
      "        ", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Theta]a", ",", "0", ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "0.1"}], "}"}], ",", "0.01", ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]L", ",", 
       RowBox[{"\[Pi]", "/", "6"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "1"}], "}"}], ",", "0", ",", "10"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a1", ",", "1.5"}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a2", ",", 
       RowBox[{"-", "0.15"}]}], "}"}], ",", 
     RowBox[{"-", "0.3"}], ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a3", ",", "4.5"}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a4", ",", "50"}], "}"}], ",", "0", ",", "100"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a5", ",", "10"}], "}"}], ",", "1", ",", "100"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"t1", ",", "t2"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8356690704994993`*^9, 3.8356691342443676`*^9}},
 CellLabel->
  "In[655]:=",ExpressionUUID->"50394ada-8cdb-4763-bfd3-dd2a45fcfade"],

Cell[BoxData[
 StyleBox["\<\" Testing fit models\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.8356691068835382`*^9, 3.835669135036709*^9}, 
   3.8359955591942635`*^9, 3.8372436669581585`*^9},
 CellLabel->
  "During evaluation of \
In[655]:=",ExpressionUUID->"b58921ba-54c7-4b8b-a874-ef812bae23bb"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a1$$ = 
    1.5, $CellContext`a2$$ = -0.15, $CellContext`a3$$ = 
    4.5, $CellContext`a4$$ = 50, $CellContext`a5$$ = 10, $CellContext`m$$ = 
    0.1, $CellContext`t$$ = 1, $CellContext`\[Theta]L$$ = Rational[1, 6] Pi, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`m$$], 0.1}, 0.01, 0.3}, {{
       Hold[$CellContext`\[Theta]L$$], Rational[1, 6] Pi}, 0, Rational[1, 4] 
      Pi}, {{
       Hold[$CellContext`t$$], 1}, 0, 10}, {{
       Hold[$CellContext`a1$$], 1.5}, -10, 10}, {{
       Hold[$CellContext`a2$$], -0.15}, -0.3, 0.3}, {{
       Hold[$CellContext`a3$$], 4.5}, -10, 10}, {{
       Hold[$CellContext`a4$$], 50}, 0, 100}, {{
       Hold[$CellContext`a5$$], 10}, 1, 100}}, Typeset`size$$ = {
    324., {103., 108.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`m$560443$$ = 
    0, $CellContext`\[Theta]L$560444$$ = 0, $CellContext`t$560445$$ = 
    0, $CellContext`a1$560446$$ = 0, $CellContext`a2$560447$$ = 
    0, $CellContext`a3$560448$$ = 0, $CellContext`a4$560449$$ = 
    0, $CellContext`a5$560450$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a1$$ = 
        1.5, $CellContext`a2$$ = -0.15, $CellContext`a3$$ = 
        4.5, $CellContext`a4$$ = 50, $CellContext`a5$$ = 10, $CellContext`m$$ = 
        0.1, $CellContext`t$$ = 1, $CellContext`\[Theta]L$$ = 
        Rational[1, 6] Pi}, "ControllerVariables" :> {
        Hold[$CellContext`m$$, $CellContext`m$560443$$, 0], 
        Hold[$CellContext`\[Theta]L$$, $CellContext`\[Theta]L$560444$$, 0], 
        Hold[$CellContext`t$$, $CellContext`t$560445$$, 0], 
        Hold[$CellContext`a1$$, $CellContext`a1$560446$$, 0], 
        Hold[$CellContext`a2$$, $CellContext`a2$560447$$, 0], 
        Hold[$CellContext`a3$$, $CellContext`a3$560448$$, 0], 
        Hold[$CellContext`a4$$, $CellContext`a4$560449$$, 0], 
        Hold[$CellContext`a5$$, $CellContext`a5$560450$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[{
         NIntegrate[
         4 $CellContext`m$$^4/(
           1 + $CellContext`m$$^2 + (-1 + $CellContext`m$$^2) 
            Cos[$CellContext`\[Theta]L$$ - ArcTan[
              Sec[$CellContext`\[Theta]L$$]^2 Tan[$CellContext`\[Theta]] + 
               Tan[$CellContext`\[Theta]L$$]]])^2, {$CellContext`\[Theta], 
           0, $CellContext`\[Theta]a}], 
         ReplaceAll[$CellContext`t1 Sin[$CellContext`\[Theta]a]/(1 + 
          Sin[$CellContext`\[Theta]a]^2), {$CellContext`t1 -> 
           Max[$CellContext`a1$$ + $CellContext`a2$$ (
               Cos[$CellContext`\[Theta]L$$]^2/$CellContext`m$$), 
             0.1], $CellContext`t2 -> $CellContext`a5$$ $CellContext`m$$ \
($CellContext`a3$$ + $CellContext`a4$$ 
              Sin[$CellContext`\[Theta]L$$]^2)}]}, {$CellContext`\[Theta]a, 0,
          Pi/2}, PlotRange -> {{0, Pi/2}, {0, 1}}], 
      "Specifications" :> {{{$CellContext`m$$, 0.1}, 0.01, 
         0.3}, {{$CellContext`\[Theta]L$$, Rational[1, 6] Pi}, 0, 
         Rational[1, 4] Pi}, {{$CellContext`t$$, 1}, 0, 
         10}, {{$CellContext`a1$$, 1.5}, -10, 
         10}, {{$CellContext`a2$$, -0.15}, -0.3, 
         0.3}, {{$CellContext`a3$$, 4.5}, -10, 10}, {{$CellContext`a4$$, 50}, 
         0, 100}, {{$CellContext`a5$$, 10}, 1, 100}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{581., {131., 137.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8356691069184732`*^9, 3.835669135065981*^9}, 
   3.8359955592036486`*^9, 3.8372436669902945`*^9},
 CellLabel->
  "Out[657]=",ExpressionUUID->"bf3e5d39-dcaa-4d2a-b342-6a1534105417"]
}, Open  ]]
},
WindowSize->{1081, 819},
WindowMargins->{{Automatic, 164}, {74, Automatic}},
Magnification:>0.9 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 27589, 621, 2583, "Input",ExpressionUUID->"15046d66-6736-46bc-aec2-e3ab63f7fee4"],
Cell[28172, 645, 543, 12, 27, "Print",ExpressionUUID->"790f3a79-923a-4428-9f87-2c1cfbfe05a7"],
Cell[28718, 659, 11084, 233, 676, "Output",ExpressionUUID->"44af0988-c408-4fcf-8318-07ad093054b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39839, 897, 4862, 109, 536, "Input",ExpressionUUID->"96ea3d5a-7db9-4208-9a62-cb59c0c72e5b"],
Cell[44704, 1008, 387, 10, 27, "Print",ExpressionUUID->"b31b2b8e-f3f7-409a-92d8-fcfa3578365f"],
Cell[45094, 1020, 535, 11, 30, "Output",ExpressionUUID->"05d2adb9-52bc-4eae-90d4-6f58d4b18736"],
Cell[45632, 1033, 388, 10, 27, "Print",ExpressionUUID->"1b76cab8-80c7-433e-87f1-d9efab564144"],
Cell[46023, 1045, 665, 16, 47, "Output",ExpressionUUID->"bbcd885c-3835-4280-89ab-1d4aa19750ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46725, 1066, 4187, 103, 306, "Input",ExpressionUUID->"acc523be-ad6e-4a8a-bc41-33bbdc9fad20"],
Cell[50915, 1171, 782, 15, 27, "Print",ExpressionUUID->"c180171d-f313-4b4c-970a-c7fd9a3f0741"],
Cell[51700, 1188, 752, 13, 30, "Output",ExpressionUUID->"e6bec5e8-ea60-4309-974d-c76e9c521b1e"],
Cell[52455, 1203, 791, 15, 27, "Print",ExpressionUUID->"f999c8e2-9519-4f78-946e-43a9c1dc4436"],
Cell[53249, 1220, 1018, 22, 47, "Output",ExpressionUUID->"65ddc8c2-30c8-4914-9206-7723d00e90a1"],
Cell[54270, 1244, 793, 15, 27, "Print",ExpressionUUID->"0ff4c5c7-19b8-4412-9abf-4ce479f0cc02"],
Cell[55066, 1261, 1315, 32, 54, "Output",ExpressionUUID->"56838226-1fb5-48a9-8933-7428db4e2428"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56418, 1298, 2001, 58, 117, "Input",ExpressionUUID->"194f0809-d403-41e7-a136-82140ffee9d2"],
Cell[58422, 1358, 361, 9, 27, "Print",ExpressionUUID->"55905cb8-ba0b-49e4-9c04-a9534bf5fb06"],
Cell[58786, 1369, 2454, 46, 340, "Output",ExpressionUUID->"32255879-ef34-43b4-a7c9-4c8d8ee0be1b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61277, 1420, 6669, 171, 746, "Input",ExpressionUUID->"6f9d1f80-1c38-4bd3-a316-1110423406e4"],
Cell[67949, 1593, 666, 14, 27, "Print",ExpressionUUID->"eaab73ce-9797-4520-b42a-fbd948933fb1"],
Cell[68618, 1609, 746, 16, 36, "Output",ExpressionUUID->"2f4ca856-87d3-4c0d-b7b4-44fec6e36114"],
Cell[69367, 1627, 676, 14, 27, "Print",ExpressionUUID->"35528b9e-da24-4efa-b77e-78ec60b71c80"],
Cell[70046, 1643, 728, 15, 30, "Output",ExpressionUUID->"5224ae9e-63fa-48e3-ab15-a625a3c543a1"],
Cell[70777, 1660, 3207, 61, 360, "Output",ExpressionUUID->"98373d93-8221-4e77-9fe5-098d019d0450"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74021, 1726, 18558, 428, 2033, "Input",ExpressionUUID->"e3338945-c2b1-4460-97c7-9ff86f3f0dad"],
Cell[92582, 2156, 472, 10, 27, "Print",ExpressionUUID->"fc9a2f01-38a9-4b4f-93d1-c1b3032ebaaf"],
Cell[93057, 2168, 9223, 168, 152, "Output",ExpressionUUID->"9abfac44-bc29-4f6f-aaa5-d5782cadedae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102317, 2341, 11102, 309, 1196, "Input",ExpressionUUID->"414fc9c6-c558-4623-a6bd-1c0357f20b56"],
Cell[113422, 2652, 798, 15, 27, "Print",ExpressionUUID->"b53cb466-6837-459a-b044-d4cfbcbe42c4"],
Cell[114223, 2669, 915, 19, 61, "Output",ExpressionUUID->"c6922871-f54c-4edb-8669-a8e9b1f45c6a"],
Cell[115141, 2690, 781, 15, 27, "Print",ExpressionUUID->"e0f983a3-9620-481b-8dd4-38d9f4cb49a4"],
Cell[115925, 2707, 1228, 28, 59, "Output",ExpressionUUID->"325fe7e6-ca14-434a-aafc-62170cdd71b7"],
Cell[117156, 2737, 793, 15, 27, "Print",ExpressionUUID->"798ff35d-9f1a-4e55-99a1-84dad6311e0b"],
Cell[117952, 2754, 3024, 56, 326, "Output",ExpressionUUID->"3cfc0d38-a8dd-4770-983c-64c7acdb7170"],
Cell[120979, 2812, 802, 15, 27, "Print",ExpressionUUID->"51c7a79e-3b08-4566-ae71-ba51f9225325"],
Cell[121784, 2829, 3230, 58, 326, "Output",ExpressionUUID->"06f21364-946a-4138-88af-0317741924d7"],
Cell[125017, 2889, 826, 15, 27, "Print",ExpressionUUID->"b09f4f77-cd65-405f-91cb-514ec08fe497"],
Cell[125846, 2906, 3293, 58, 330, "Output",ExpressionUUID->"52031dd9-1944-46a0-9c8b-203f1a9dc2a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129176, 2969, 7771, 230, 849, "Input",ExpressionUUID->"bdce4bcd-a32a-49bc-bee2-958a611a2af7"],
Cell[CellGroupData[{
Cell[136972, 3203, 325, 8, 27, "Print",ExpressionUUID->"f2de7689-4f38-405d-ba8b-0bb20443b89a"],
Cell[137300, 3213, 311, 8, 27, "Print",ExpressionUUID->"87b32f5c-2c2f-4f96-8b8b-d3f3ec8323ea"]
}, Open  ]],
Cell[137626, 3224, 570, 16, 73, "Output",ExpressionUUID->"0e72bf27-97b6-4eeb-9bc3-9100b812c4d2"],
Cell[138199, 3242, 312, 8, 27, "Print",ExpressionUUID->"87310e7f-f8fd-4792-80ab-5a5711a000a6"],
Cell[138514, 3252, 603, 17, 73, "Output",ExpressionUUID->"497e7709-65e1-4ab2-8de8-c12f80765b62"],
Cell[139120, 3271, 317, 8, 27, "Print",ExpressionUUID->"b0864892-630d-469c-8461-23390c0470d3"],
Cell[139440, 3281, 291, 7, 53, "Output",ExpressionUUID->"e6617eab-2b28-4958-a7bb-1ec6630ecfd0"],
Cell[139734, 3290, 261, 7, 53, "Output",ExpressionUUID->"e94321e0-59cd-4ba3-9e14-7c0212866a6a"],
Cell[139998, 3299, 308, 8, 27, "Print",ExpressionUUID->"558670a5-96d6-403c-8183-993809fbf36c"],
Cell[140309, 3309, 715, 22, 47, "Output",ExpressionUUID->"9a6a827c-e535-4caa-b176-3aeb5a5b97ca"],
Cell[141027, 3333, 287, 7, 50, "Output",ExpressionUUID->"c87d20d7-0bd6-4868-a027-af3fc5eb7800"],
Cell[141317, 3342, 316, 8, 27, "Print",ExpressionUUID->"3b0cad33-ea3d-4753-b305-f5844fdaa897"],
Cell[141636, 3352, 439, 13, 53, "Output",ExpressionUUID->"74f47d64-8a62-4f6b-b18f-1b40c67173be"],
Cell[142078, 3367, 322, 8, 27, "Print",ExpressionUUID->"cba168b7-7ba3-46b6-9675-697e2f65fa86"],
Cell[142403, 3377, 2696, 52, 330, "Output",ExpressionUUID->"e5f75715-35fa-4b32-a34d-0dcb95c4156d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145136, 3434, 5407, 153, 433, "Input",ExpressionUUID->"50394ada-8cdb-4763-bfd3-dd2a45fcfade"],
Cell[150546, 3589, 369, 9, 27, "Print",ExpressionUUID->"b58921ba-54c7-4b8b-a874-ef812bae23bb"],
Cell[150918, 3600, 4452, 82, 286, "Output",ExpressionUUID->"bf3e5d39-dcaa-4d2a-b342-6a1534105417"]
}, Open  ]]
}
]
*)

