(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     75150,       1721]
NotebookOptionsPosition[     73074,       1683]
NotebookOutlinePosition[     73419,       1698]
CellTagsIndexPosition[     73376,       1695]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
      "\"\<Shared\>\""}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResetDirectory", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "gPrint", "[", "\"\<Solve \[Lambda] with \[Epsilon]=0.05\>\"", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"\[Lambda]", ",", "\[Mu]", ",", "dr", 
    RowBox[{"(*", 
     RowBox[{"diskRadius", "/", "reflectPtDist"}], "*)"}], ",", "c", ",", 
    "e"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"asgPolar", "[", 
      RowBox[{"\[Theta]", ",", 
       RowBox[{
        RowBox[{"\[Pi]", "/", "2"}], "-", "\[Theta]"}], ",", 
       RowBox[{"\[Pi]", "/", "2"}], ",", "\[Lambda]", ",", "\[Mu]", ",", 
       "1"}], "]"}], "\[Equal]", "0.05"}], ",", "\[Lambda]"}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"dr", " ", "\[Equal]", " ", 
    RowBox[{"diskRadius", "/", "reflectPtDist"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"-", " ", 
    SuperscriptBox[
     RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"0.05", 
     RowBox[{"Sec", "[", "\[Theta]", "]"}]}], "]"}]}], "/.", 
  RowBox[{"{", 
   RowBox[{"\[Theta]", "\[Rule]", 
    RowBox[{"ArcTan", "[", "dr", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", " ", 
      SuperscriptBox[
       RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}], " ", 
     RowBox[{"Log", "[", 
      RowBox[{"0.05", 
       RowBox[{"Sec", "[", "\[Theta]", "]"}]}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"ArcTan", "[", "dr", "]"}]}], "}"}]}], "//", "FullSimplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Min", "[", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{" ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "\[VeryThinSpace]", "+", 
          SuperscriptBox["dr", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"1", "\[VeryThinSpace]", "+", 
            SuperscriptBox["dr", "2"]}], "]"}], "-", "5.991"}], ")"}]}]}], 
      RowBox[{"2", 
       SuperscriptBox["dr", "2"]}]]}], ",", "sgMinLambda"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Solve amplitude\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "*", 
      RowBox[{"\[Pi]", "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"\[Lambda]", "*", "\[Mu]"}], "]"}]}]}], "\[Equal]", "e"}], 
    ",", "c"}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"\[Lambda]", ",", "\[Mu]", ",", "dr", 
    RowBox[{"(*", 
     RowBox[{"diskRadius", "/", "reflectPtDist"}], "*)"}], ",", "c", ",", 
    "e"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8356742643727303`*^9, 3.83567431337426*^9}, {
   3.835674356584566*^9, 3.835674591369941*^9}, {3.835674635642462*^9, 
   3.8356746830857563`*^9}, {3.835674718402777*^9, 3.8356747360170183`*^9}, {
   3.835674784625281*^9, 3.8356747951967993`*^9}, 3.835675736172595*^9, {
   3.835675868845649*^9, 3.8356758885001163`*^9}, {3.837243790740478*^9, 
   3.837243795677458*^9}},
 CellLabel->
  "In[748]:=",ExpressionUUID->"24568d69-b4f1-47e4-bee8-1cb606b419fa"],

Cell[BoxData[
 StyleBox["\<\" Solve \[Lambda] with \[Epsilon]=0.05\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.835674360170613*^9, 3.8356743720302544`*^9}, {
   3.8356745111144867`*^9, 3.835674548585717*^9}, {3.8356746302325344`*^9, 
   3.8356746402459083`*^9}, {3.8356747233280525`*^9, 
   3.8356747295357027`*^9}, {3.835674781544238*^9, 3.835674796048501*^9}, 
   3.8356756776287766`*^9, 3.835675739456273*^9, 3.835675889007045*^9, 
   3.8372437980829353`*^9},
 CellLabel->
  "During evaluation of \
In[748]:=",ExpressionUUID->"58d5233c-d34c-47ea-b814-16ca4402ab79"],

Cell[BoxData[
 TemplateBox[{
  "Solve","ifun",
   "\"Inverse functions are being used by \
\\!\\(\\*RowBox[{\\\"Solve\\\"}]\\), so some solutions may not be found; use \
Reduce for complete solution information.\"",2,758,140,33888486632502725135,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.8356743601726074`*^9, 3.835674372033281*^9}, {
   3.835674511116482*^9, 3.8356745485917*^9}, {3.83567463023654*^9, 
   3.83567464024889*^9}, {3.83567472333817*^9, 3.8356747295426874`*^9}, {
   3.8356747815519276`*^9, 3.835674796050495*^9}, 3.835675677631769*^9, 
   3.835675739463255*^9, 3.8356758890080423`*^9, 3.837243798088772*^9},
 CellLabel->
  "During evaluation of \
In[748]:=",ExpressionUUID->"c6211696-6447-4c75-b40a-85e0ae1c2bc7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "1.`"}], " ", 
     SuperscriptBox[
      RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{
      "0.05000000000000000277555756156289135106`15.954589770191005", " ", 
       RowBox[{"Sec", "[", "\[Theta]", "]"}]}], "]"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.835674360184581*^9, 3.8356743720442777`*^9}, {
   3.835674511127453*^9, 3.8356745486016736`*^9}, {3.835674630247466*^9, 
   3.8356746402568684`*^9}, {3.8356747233501253`*^9, 3.835674729554655*^9}, {
   3.835674781560932*^9, 3.835674796060345*^9}, 3.8356756776457605`*^9, 
   3.83567573947622*^9, 3.8356758890210094`*^9, 3.8372437981051545`*^9},
 CellLabel->
  "Out[758]=",ExpressionUUID->"b01b2a76-8aa1-43e1-a44d-94fda644390a"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["dr", "2"]}], ")"}], " ", 
    RowBox[{"Log", "[", 
     RowBox[{"0.05`", " ", 
      SqrtBox[
       RowBox[{"1", "+", 
        SuperscriptBox["dr", "2"]}]]}], "]"}]}], 
   SuperscriptBox["dr", "2"]]}]], "Output",
 CellChangeTimes->{{3.835674360184581*^9, 3.8356743720442777`*^9}, {
   3.835674511127453*^9, 3.8356745486016736`*^9}, {3.835674630247466*^9, 
   3.8356746402568684`*^9}, {3.8356747233501253`*^9, 3.835674729554655*^9}, {
   3.835674781560932*^9, 3.835674796060345*^9}, 3.8356756776457605`*^9, 
   3.83567573947622*^9, 3.8356758890210094`*^9, 3.8372437981051545`*^9},
 CellLabel->
  "Out[759]=",ExpressionUUID->"65f01804-052d-4705-a15a-fbccd94fe989"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"0.5`", " ", 
    RowBox[{"(", 
     RowBox[{"1.`", "\[VeryThinSpace]", "+", 
      SuperscriptBox["dr", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "5.991464547107982`"}], "+", 
      RowBox[{"Log", "[", 
       RowBox[{"1.`", "\[VeryThinSpace]", "+", 
        SuperscriptBox["dr", "2"]}], "]"}]}], ")"}]}], 
   SuperscriptBox["dr", "2"]]}]], "Output",
 CellChangeTimes->{{3.835674360184581*^9, 3.8356743720442777`*^9}, {
   3.835674511127453*^9, 3.8356745486016736`*^9}, {3.835674630247466*^9, 
   3.8356746402568684`*^9}, {3.8356747233501253`*^9, 3.835674729554655*^9}, {
   3.835674781560932*^9, 3.835674796060345*^9}, 3.8356756776457605`*^9, 
   3.83567573947622*^9, 3.8356758890210094`*^9, 3.8372437981766005`*^9},
 CellLabel->
  "Out[760]=",ExpressionUUID->"3cacf1ce-1908-42f0-bcc6-f71f0addd693"],

Cell[BoxData[
 RowBox[{"Min", "[", 
  RowBox[{"4.60517`", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["dr", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "5.991`"}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["dr", "2"]}], "]"}]}], ")"}]}], 
     RowBox[{"2", " ", 
      SuperscriptBox["dr", "2"]}]]}]}], "]"}]], "Output",
 CellChangeTimes->{{3.835674360184581*^9, 3.8356743720442777`*^9}, {
   3.835674511127453*^9, 3.8356745486016736`*^9}, {3.835674630247466*^9, 
   3.8356746402568684`*^9}, {3.8356747233501253`*^9, 3.835674729554655*^9}, {
   3.835674781560932*^9, 3.835674796060345*^9}, 3.8356756776457605`*^9, 
   3.83567573947622*^9, 3.8356758890210094`*^9, 3.8372437981887436`*^9},
 CellLabel->
  "Out[761]=",ExpressionUUID->"b554214f-aea6-46b9-baa6-d831952f4479"],

Cell[BoxData[
 StyleBox["\<\" Solve amplitude\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.835674360170613*^9, 3.8356743720302544`*^9}, {
   3.8356745111144867`*^9, 3.835674548585717*^9}, {3.8356746302325344`*^9, 
   3.8356746402459083`*^9}, {3.8356747233280525`*^9, 
   3.8356747295357027`*^9}, {3.835674781544238*^9, 3.835674796048501*^9}, 
   3.8356756776287766`*^9, 3.835675739456273*^9, 3.835675889007045*^9, 
   3.8372437981887436`*^9},
 CellLabel->
  "During evaluation of \
In[748]:=",ExpressionUUID->"6d191077-fe71-48f6-af46-5e8da789a2d8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"c", "\[Rule]", 
    FractionBox[
     RowBox[{"e", " ", 
      SqrtBox[
       RowBox[{"\[Lambda]", " ", "\[Mu]"}]]}], "\[Pi]"]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.835674360184581*^9, 3.8356743720442777`*^9}, {
   3.835674511127453*^9, 3.8356745486016736`*^9}, {3.835674630247466*^9, 
   3.8356746402568684`*^9}, {3.8356747233501253`*^9, 3.835674729554655*^9}, {
   3.835674781560932*^9, 3.835674796060345*^9}, 3.8356756776457605`*^9, 
   3.83567573947622*^9, 3.8356758890210094`*^9, 3.8372437982052574`*^9},
 CellLabel->
  "Out[763]=",ExpressionUUID->"abbbcb1a-416a-48e8-926e-7353721e8d1f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<ASG Light\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "testDisk", ",", "testSphere", ",", "diskNormalAxis", ",", "viewDir", ",", 
    "halfDir", ",", "lightDir", ",", "\[IndentingNewLine]", "   ", 
    "majorAxis", ",", "minorAxis", ",", "majorSize", ",", "minorSize", ",", 
    "\[IndentingNewLine]", "  ", "asgAxis", ",", "asgAxisL", ",", "asgAxisM", 
    ",", "asgL", ",", "asgM", ",", "asgC", ",", "asgEnergy", ",", 
    "asgLight"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"diskNormalAxis", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"{", 
       RowBox[{"diskNormalX", ",", "diskNormalY", ",", 
        RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"testDisk", "=", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"center", " ", "point"}], "*)"}], "\[IndentingNewLine]", "\t",
        "diskNormalAxis", ",", 
       RowBox[{"(*", 
        RowBox[{"normal", " ", "axis"}], "*)"}], "\[IndentingNewLine]", "\t", 
       "diskRadius"}], 
      RowBox[{"(*", 
       RowBox[{"disk", " ", "radius"}], "*)"}], "\[IndentingNewLine]", 
      "}"}]}], ";", "\[IndentingNewLine]", " ", 
    RowBox[{"testSphere", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"viewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], "-", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"halfDir", "=", "diskNormalAxis"}], ";", "\[IndentingNewLine]", 
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{"Dot", "[", 
         RowBox[{"viewDir", ",", "halfDir"}], "]"}], "*", "halfDir"}], "-", 
       "viewDir"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"solving", " ", "ellipse", " ", "axes"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"majorAxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"diskNormalAxis", ",", "viewDir"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"minorAxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"majorAxis", ",", "viewDir"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"majorSize", "=", 
     RowBox[{"Abs", "@", "diskRadius"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"minorSize", "=", 
     RowBox[{
      RowBox[{"Abs", "@", 
       RowBox[{"Dot", "[", 
        RowBox[{"diskNormalAxis", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "*", 
      "diskRadius"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Assert", "[", 
     RowBox[{"majorAxis", "\[Equal]", 
      RowBox[{"Normalize", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "diskNormalY"}], ",", "diskNormalX", ",", "0"}], "}"}], 
       "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Assert", "[", 
     RowBox[{"minorAxis", "\[Equal]", 
      RowBox[{"Normalize", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "diskNormalX"}], ",", 
         RowBox[{"-", "diskNormalY"}], ",", "0"}], "}"}], "]"}]}], "]"}], ";",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"solving", " ", "asg", " ", "light"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"asgAxis", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"asgAxisL", "=", 
     RowBox[{"Normalize", "@", "majorAxis"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"asgAxisM", "=", 
     RowBox[{"Normalize", "@", "minorAxis"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"asgL", "=", 
     RowBox[{"asgCalcBandwidth", "[", 
      RowBox[{"majorSize", "/", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"asgM", "=", 
     RowBox[{"asgCalcBandwidth", "[", 
      RowBox[{"minorSize", "/", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"asgEnergy", "=", 
     RowBox[{"gIntegrateDiskLighting", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"testDisk", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"testDisk", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"testDisk", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "lightDir", ",", 
       "lightIntensity", ",", "roughness"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"asgC", "=", 
     RowBox[{"asgCalcAmplitude", "[", 
      RowBox[{"asgL", ",", "asgM", ",", "asgEnergy"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"asgLight", "=", 
     RowBox[{"{", 
      RowBox[{
      "asgAxis", ",", "asgAxisL", ",", "asgAxisM", ",", "asgL", ",", "asgM", 
       ",", "asgC"}], "}"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", "  ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spheres\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "  ", 
           RowBox[{"(*", 
            RowBox[{"shading", " ", "sphere"}], "*)"}], "\[IndentingNewLine]",
            "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"testSphere", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", 
              RowBox[{"testSphere", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "100"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                RowBox[{"Hue", "@", 
                 RowBox[{"(", 
                  RowBox[{"asgVector", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    "asgLight"}], "]"}], ")"}]}]}], " ", "]"}]}]}], "|>"}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", " ", 
           RowBox[{"(*", 
            RowBox[{"ellipse", " ", "major", " ", "axis"}], "*)"}], 
           "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "majorAxis"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "majorSize"}], ",", 
              RowBox[{"\"\<plotPts\>\"", "\[Rule]", "2"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "minorAxis"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "minorSize"}], ",", 
              RowBox[{"\"\<plotPts\>\"", "\[Rule]", "2"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<disks\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"testDisk", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<normalAxis\>\"", "\[Rule]", 
              RowBox[{"testDisk", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", 
              RowBox[{"testDisk", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "0"}], ",", 
             RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                "Cyan"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", " ", 
           "}"}]}], "&"}], "[", "]"}], ",", "\[IndentingNewLine]", " ", 
       RowBox[{"\"\<customPlots\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"testDisk", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", 
                RowBox[{"lightDir", "*", "2"}]}], ",", 
               RowBox[{
                RowBox[{"testDisk", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", "lightDir"}]}], "}"}], 
             "]"}]}], "}"}], "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
       "     ", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.6"}]}], 
      "\[IndentingNewLine]", "|>"}], 
     RowBox[{"(*", 
      RowBox[{",", "Large"}], "*)"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "0.05"}], "}"}], ",", "0.01", ",", 
     "0.5"}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightLambda", ",", "5"}], "}"}], ",", "sgMinLambda", ",", 
     "50"}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalX", ",", 
       RowBox[{"-", "1.5"}]}], "}"}], ",", 
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "0.1"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalY", ",", 
       RowBox[{"-", "0.5"}]}], "}"}], ",", 
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "0.1"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskRadius", ",", "0.5"}], "}"}], ",", "0.2", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.1"}], "}"}], ",", "0.01", ",", "0.99"}], 
    "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingColorScaling", ",", "0.3"}], "}"}], ",", "0.1", ",", 
     "1"}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"asgLight1", ",", 
      RowBox[{"{", 
       RowBox[{
       "majorSize", ",", "minorSize", ",", "asgL", ",", "asgM", ",", "asgC", 
        ",", "asgEnergy"}], "}"}]}], "}"}], "}"}], ",", "\[IndentingNewLine]",
    "   ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "testDisk", ",", "testSphere", ",", "diskNormalAxis", ",", "viewDir", ",", 
    "halfDir", ",", "lightDir", ",", "\[IndentingNewLine]", "   ", 
    "majorAxis", ",", "minorAxis", ",", "majorSize", ",", "minorSize", ",", 
    "\[IndentingNewLine]", "  ", "asgAxis", ",", "asgAxisL", ",", "asgAxisM", 
    ",", "asgL", ",", "asgM", ",", "asgC", ",", "asgEnergy", ",", 
    "asgLight"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.835688700598922*^9, 3.8356887687824745`*^9}, {
  3.8356890155300875`*^9, 3.835689017124607*^9}, {3.835736661805726*^9, 
  3.8357366948447137`*^9}, {3.835738609448595*^9, 3.835738618748103*^9}, {
  3.8357386649538727`*^9, 3.8357387170368714`*^9}},
 CellLabel->
  "In[765]:=",ExpressionUUID->"20405f3a-4d01-4620-be57-6abd10012d27"],

Cell[BoxData[
 StyleBox["\<\" ASG Light\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.835688731267994*^9, 3.8356887715570035`*^9}, {
   3.8357366717651544`*^9, 3.835736697237255*^9}, {3.835738613223216*^9, 
   3.8357386348205366`*^9}, {3.835738671148861*^9, 3.8357387182287827`*^9}, 
   3.837243798402769*^9},
 CellLabel->
  "During evaluation of \
In[765]:=",ExpressionUUID->"7362a8d9-8266-41f5-a989-fe1abddbe5a6"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`asgLight1$$ = {0.5, 0.2672612419124244, 
    14.419641121714475`, 44.415053463847855`, 0.27225191133967497`, 
    0.03379702629520507}, $CellContext`diskNormalX$$ = -1.5, \
$CellContext`diskNormalY$$ = -0.5, $CellContext`diskRadius$$ = 
    0.5, $CellContext`lightIntensity$$ = 0.05, $CellContext`lightLambda$$ = 
    5, $CellContext`roughness$$ = 0.1, $CellContext`shadingColorScaling$$ = 
    0.3, Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightIntensity$$], 0.05}, 0.01, 0.5}, {{
       Hold[$CellContext`lightLambda$$], 5}, 4.60517, 50}, {{
       Hold[$CellContext`diskNormalX$$], -1.5}, -3, -0.1}, {{
       Hold[$CellContext`diskNormalY$$], -0.5}, -3, -0.1}, {{
       Hold[$CellContext`diskRadius$$], 0.5}, 0.2, 1}, {{
       Hold[$CellContext`roughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`shadingColorScaling$$], 0.3}, 0.1, 1}, {{
       Hold[$CellContext`asgLight1$$], {0.5, 0.2672612419124244, 
       14.419641121714475`, 44.415053463847855`, 0.27225191133967497`, 
       0.03379702629520507}}}}, Typeset`size$$ = {90., {47., 53.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`lightIntensity$640398$$ = 
    0, $CellContext`lightLambda$640399$$ = 
    0, $CellContext`diskNormalX$640400$$ = 
    0, $CellContext`diskNormalY$640401$$ = 
    0, $CellContext`diskRadius$640402$$ = 0, $CellContext`roughness$640403$$ =
     0, $CellContext`shadingColorScaling$640404$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`asgLight1$$ = {$CellContext`majorSize, \
$CellContext`minorSize, $CellContext`asgL, $CellContext`asgM, \
$CellContext`asgC, 
          sgCommon`asgEnergy}, $CellContext`diskNormalX$$ = -1.5, \
$CellContext`diskNormalY$$ = -0.5, $CellContext`diskRadius$$ = 
        0.5, $CellContext`lightIntensity$$ = 0.05, $CellContext`lightLambda$$ = 
        5, $CellContext`roughness$$ = 0.1, $CellContext`shadingColorScaling$$ = 
        0.3}, "ControllerVariables" :> {
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$640398$$, 0], 
        Hold[$CellContext`lightLambda$$, $CellContext`lightLambda$640399$$, 
         0], 
        Hold[$CellContext`diskNormalX$$, $CellContext`diskNormalX$640400$$, 
         0], 
        Hold[$CellContext`diskNormalY$$, $CellContext`diskNormalY$640401$$, 
         0], 
        Hold[$CellContext`diskRadius$$, $CellContext`diskRadius$640402$$, 0], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$640403$$, 0], 
        Hold[$CellContext`shadingColorScaling$$, \
$CellContext`shadingColorScaling$640404$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`diskNormalAxis = 
        Normalize[{$CellContext`diskNormalX$$, $CellContext`diskNormalY$$, \
-1}]; $CellContext`testDisk = {{0, 0, 
          1}, $CellContext`diskNormalAxis, $CellContext`diskRadius$$}; \
$CellContext`testSphere = {{0, 0, 0}, 1}; $CellContext`viewDir = 
        Normalize[{0, 0, 0} - {0, 0, 
          1}]; $CellContext`halfDir = $CellContext`diskNormalAxis; \
$CellContext`lightDir = 
        Normalize[
         2 Dot[$CellContext`viewDir, $CellContext`halfDir] \
$CellContext`halfDir - $CellContext`viewDir]; $CellContext`majorAxis = 
        Normalize[
          
          Cross[$CellContext`diskNormalAxis, $CellContext`viewDir]]; \
$CellContext`minorAxis = Normalize[
          
          Cross[$CellContext`majorAxis, $CellContext`viewDir]]; \
$CellContext`majorSize = 
        Abs[$CellContext`diskRadius$$]; $CellContext`minorSize = Abs[
           Dot[$CellContext`diskNormalAxis, {0, 0, 
            1}]] $CellContext`diskRadius$$; 
       Assert[$CellContext`majorAxis == 
         Normalize[{-$CellContext`diskNormalY$$, $CellContext`diskNormalX$$, 
            0}]]; Assert[$CellContext`minorAxis == 
         Normalize[{-$CellContext`diskNormalX$$, -$CellContext`diskNormalY$$, 
            0}]]; $CellContext`asgAxis = {0, 0, 1}; $CellContext`asgAxisL = 
        Normalize[$CellContext`majorAxis]; $CellContext`asgAxisM = 
        Normalize[$CellContext`minorAxis]; $CellContext`asgL = 
        sgCommon`asgCalcBandwidth[$CellContext`majorSize/
          1]; $CellContext`asgM = 
        sgCommon`asgCalcBandwidth[$CellContext`minorSize/1]; 
       sgCommon`asgEnergy = gBRDF`gIntegrateDiskLighting[{0, 0, 0}, 
          Part[$CellContext`testDisk, 1], 
          Part[$CellContext`testDisk, 2], 
          
          Part[$CellContext`testDisk, 
           3], $CellContext`lightDir, $CellContext`lightIntensity$$, \
$CellContext`roughness$$]; $CellContext`asgC = 
        sgCommon`asgCalcAmplitude[$CellContext`asgL, $CellContext`asgM, 
          sgCommon`asgEnergy]; $CellContext`asgLight = {$CellContext`asgAxis, \
$CellContext`asgAxisL, $CellContext`asgAxisM, $CellContext`asgL, \
$CellContext`asgM, $CellContext`asgC}; gPlots3D`gParamPlot3D[
         Association[
          ("spheres" -> {
            Association[
            "center" -> Part[$CellContext`testSphere, 1], "radius" -> 
             Part[$CellContext`testSphere, 2], "opacity" -> 1, "plotPts" -> 
             100, "mesh" -> None, "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
               Hue[
                
                sgCommon`asgVector[{$CellContext`x, $CellContext`y, \
$CellContext`z}, $CellContext`asgLight]]]]}& )[], 
          ("lines" -> {
            Association[
            "startPos" -> {0, 0, 1}, "dirVec" -> $CellContext`majorAxis, 
             "length" -> $CellContext`majorSize, "plotPts" -> 2, 
             "colorFunc" -> (Green& ), "thickness" -> 0.005], 
            Association[
            "startPos" -> {0, 0, 1}, "dirVec" -> $CellContext`minorAxis, 
             "length" -> $CellContext`minorSize, "plotPts" -> 2, 
             "colorFunc" -> (Green& ), "thickness" -> 0.005]}& )[], 
          ("disks" -> {
            Association[
            "center" -> Part[$CellContext`testDisk, 1], "normalAxis" -> 
             Part[$CellContext`testDisk, 2], "radius" -> 
             Part[$CellContext`testDisk, 3], "opacity" -> 0, "mesh" -> None, 
             "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z, \
$CellContext`p}, Cyan]]}& )[], "customPlots" -> {
            Graphics3D[{Blue, 
              
              Arrow[{Part[$CellContext`testDisk, 1] + $CellContext`lightDir 2,
                 Part[$CellContext`testDisk, 1] + $CellContext`lightDir}]}]}, 
          "axisExtent" -> 1.6]]), 
      "Specifications" :> {{{$CellContext`lightIntensity$$, 0.05}, 0.01, 
         0.5}, {{$CellContext`lightLambda$$, 5}, 4.60517, 
         50}, {{$CellContext`diskNormalX$$, -1.5}, -3, -0.1}, \
{{$CellContext`diskNormalY$$, -0.5}, -3, -0.1}, {{$CellContext`diskRadius$$, 
          0.5}, 0.2, 1}, {{$CellContext`roughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`shadingColorScaling$$, 0.3}, 0.1, 
         1}, {{$CellContext`asgLight1$$, {$CellContext`majorSize, \
$CellContext`minorSize, $CellContext`asgL, $CellContext`asgM, \
$CellContext`asgC, sgCommon`asgEnergy}}}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{141., {71., 77.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8356887313059206`*^9, 3.8356887715916767`*^9}, {
   3.8357366718054295`*^9, 3.835736697269724*^9}, {3.8357386132560606`*^9, 
   3.835738634860675*^9}, {3.835738671179777*^9, 3.8357387182646866`*^9}, 
   3.837243798469807*^9},
 CellLabel->
  "Out[767]=",ExpressionUUID->"6f74a8eb-51ee-40e5-b782-5887cfef3f7c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<ASG Light in Function\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "testDisk", ",", "testSphere", ",", "diskNormalAxis", ",", "viewDir", ",", 
    "halfDir", ",", "lightDir", ",", "\[IndentingNewLine]", "   ", 
    "majorAxis", ",", "minorAxis", ",", "majorSize", ",", "minorSize", ",", 
    "\[IndentingNewLine]", "  ", "asgEnergy", ",", "asgLight"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"diskNormalAxis", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"{", 
       RowBox[{"diskNormalX", ",", "diskNormalY", ",", 
        RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"testDisk", "=", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"center", " ", "point"}], "*)"}], "\[IndentingNewLine]", "\t",
        "diskNormalAxis", ",", 
       RowBox[{"(*", 
        RowBox[{"normal", " ", "axis"}], "*)"}], "\[IndentingNewLine]", "\t", 
       "diskRadius"}], 
      RowBox[{"(*", 
       RowBox[{"disk", " ", "radius"}], "*)"}], "\[IndentingNewLine]", 
      "}"}]}], ";", "\[IndentingNewLine]", " ", 
    RowBox[{"testSphere", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"viewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], "-", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"halfDir", "=", "diskNormalAxis"}], ";", "\[IndentingNewLine]", 
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{"Dot", "[", 
         RowBox[{"viewDir", ",", "halfDir"}], "]"}], "*", "halfDir"}], "-", 
       "viewDir"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "approximating", " ", "reflection", " ", "light", " ", "as", " ", 
      "ASG"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"asgLight", "=", 
     RowBox[{"asgReflectLight", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "lightDir", ",", 
       "lightIntensity", ",", "roughness", ",", "testDisk"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"majorAxis", "=", 
     RowBox[{"asgLight", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"minorAxis", "=", 
     RowBox[{"asgLight", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\n", "   ", 
    RowBox[{"majorSize", "=", 
     RowBox[{"diskRadius", "/", "1"}]}], ";", "\n", "   ", 
    RowBox[{"minorSize", "=", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{"diskNormalAxis", ",", "viewDir"}], "]"}], "*", 
      RowBox[{"diskRadius", "/", "1"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", "  ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spheres\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "  ", 
           RowBox[{"(*", 
            RowBox[{"shading", " ", "sphere"}], "*)"}], "\[IndentingNewLine]",
            "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"testSphere", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", 
              RowBox[{"testSphere", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "100"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                RowBox[{"Hue", "@", 
                 RowBox[{"(", 
                  RowBox[{"asgVector", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    "asgLight"}], "]"}], ")"}]}]}], " ", "]"}]}]}], "|>"}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", " ", 
           RowBox[{"(*", 
            RowBox[{"ellipse", " ", "major", " ", "axis"}], "*)"}], 
           "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "majorAxis"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "majorSize"}], ",", 
              RowBox[{"\"\<plotPts\>\"", "\[Rule]", "2"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "minorAxis"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "minorSize"}], ",", 
              RowBox[{"\"\<plotPts\>\"", "\[Rule]", "2"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<disks\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"testDisk", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<normalAxis\>\"", "\[Rule]", 
              RowBox[{"testDisk", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", 
              RowBox[{"testDisk", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "0"}], ",", 
             RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                "Cyan"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", " ", 
           "}"}]}], "&"}], "[", "]"}], ",", "\[IndentingNewLine]", " ", 
       RowBox[{"\"\<customPlots\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"testDisk", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", 
                RowBox[{"lightDir", "*", "2"}]}], ",", 
               RowBox[{
                RowBox[{"testDisk", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", "lightDir"}]}], "}"}], 
             "]"}]}], "}"}], "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
       "     ", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.6"}]}], 
      "\[IndentingNewLine]", "|>"}], 
     RowBox[{"(*", 
      RowBox[{",", "Large"}], "*)"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "0.05"}], "}"}], ",", "0.01", ",", 
     "0.5"}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalX", ",", 
       RowBox[{"-", "1.5"}]}], "}"}], ",", 
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "0.1"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalY", ",", 
       RowBox[{"-", "0.5"}]}], "}"}], ",", 
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "0.1"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskRadius", ",", "0.5"}], "}"}], ",", "0.2", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.1"}], "}"}], ",", "0.01", ",", "0.99"}], 
    "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingColorScaling", ",", "0.3"}], "}"}], ",", "0.1", ",", 
     "1"}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"asgLight1", ",", 
      RowBox[{"{", 
       RowBox[{"majorSize", ",", "minorSize", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "asgLight", "]"}], "\[GreaterEqual]", "6"}],
           ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"asgLight", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"asgLight", "[", 
             RowBox[{"[", "5", "]"}], "]"}], ",", 
            RowBox[{"asgLight", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", "Nothing"}], 
         "]"}]}], "}"}]}], "}"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "testDisk", ",", "testSphere", ",", "diskNormalAxis", ",", "viewDir", ",", 
    "halfDir", ",", "lightDir", ",", "\[IndentingNewLine]", "   ", 
    "majorAxis", ",", "minorAxis", ",", "majorSize", ",", "minorSize", ",", 
    "\[IndentingNewLine]", "  ", "asgEnergy", ",", "asgLight"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.835738862417507*^9, 3.835738883929532*^9}},
 CellLabel->
  "In[769]:=",ExpressionUUID->"96e4d330-5040-4cb5-87eb-1e134286636a"],

Cell[BoxData[
 StyleBox["\<\" ASG Light in Function\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.835738884635748*^9, 3.837243799702505*^9},
 CellLabel->
  "During evaluation of \
In[769]:=",ExpressionUUID->"1d21ccd5-f383-498b-af28-62f29544a904"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`asgLight1$$ = {0.5, 
    0.2672612419124244}, $CellContext`diskNormalX$$ = -1.5, \
$CellContext`diskNormalY$$ = -0.5, $CellContext`diskRadius$$ = 
    0.5, $CellContext`lightIntensity$$ = 0.05, $CellContext`roughness$$ = 
    0.1, $CellContext`shadingColorScaling$$ = 0.3, Typeset`show$$ = False, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightIntensity$$], 0.05}, 0.01, 0.5}, {{
       Hold[$CellContext`diskNormalX$$], -1.5}, -3, -0.1}, {{
       Hold[$CellContext`diskNormalY$$], -0.5}, -3, -0.1}, {{
       Hold[$CellContext`diskRadius$$], 0.5}, 0.2, 1}, {{
       Hold[$CellContext`roughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`shadingColorScaling$$], 0.3}, 0.1, 1}, {{
       Hold[$CellContext`asgLight1$$], {0.5, 0.2672612419124244}}}}, 
    Typeset`size$$ = {90., {47., 53.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`lightIntensity$650748$$ = 
    0, $CellContext`diskNormalX$650749$$ = 
    0, $CellContext`diskNormalY$650750$$ = 
    0, $CellContext`diskRadius$650751$$ = 0, $CellContext`roughness$650752$$ =
     0, $CellContext`shadingColorScaling$650753$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`asgLight1$$ = {$CellContext`majorSize, \
$CellContext`minorSize}, $CellContext`diskNormalX$$ = -1.5, \
$CellContext`diskNormalY$$ = -0.5, $CellContext`diskRadius$$ = 
        0.5, $CellContext`lightIntensity$$ = 0.05, $CellContext`roughness$$ = 
        0.1, $CellContext`shadingColorScaling$$ = 0.3}, "ControllerVariables" :> {
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$650748$$, 0], 
        Hold[$CellContext`diskNormalX$$, $CellContext`diskNormalX$650749$$, 
         0], 
        Hold[$CellContext`diskNormalY$$, $CellContext`diskNormalY$650750$$, 
         0], 
        Hold[$CellContext`diskRadius$$, $CellContext`diskRadius$650751$$, 0], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$650752$$, 0], 
        Hold[$CellContext`shadingColorScaling$$, \
$CellContext`shadingColorScaling$650753$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`diskNormalAxis = 
        Normalize[{$CellContext`diskNormalX$$, $CellContext`diskNormalY$$, \
-1}]; $CellContext`testDisk = {{0, 0, 
          1}, $CellContext`diskNormalAxis, $CellContext`diskRadius$$}; \
$CellContext`testSphere = {{0, 0, 0}, 1}; $CellContext`viewDir = 
        Normalize[{0, 0, 0} - {0, 0, 
          1}]; $CellContext`halfDir = $CellContext`diskNormalAxis; \
$CellContext`lightDir = 
        Normalize[
         2 Dot[$CellContext`viewDir, $CellContext`halfDir] \
$CellContext`halfDir - $CellContext`viewDir]; $CellContext`asgLight = 
        sgCommon`asgReflectLight[{0, 0, 
          0}, $CellContext`lightDir, $CellContext`lightIntensity$$, \
$CellContext`roughness$$, $CellContext`testDisk]; $CellContext`majorAxis = 
        Part[$CellContext`asgLight, 2]; $CellContext`minorAxis = 
        Part[$CellContext`asgLight, 
          3]; $CellContext`majorSize = $CellContext`diskRadius$$/
         1; $CellContext`minorSize = 
        Dot[$CellContext`diskNormalAxis, $CellContext`viewDir] \
($CellContext`diskRadius$$/1); gPlots3D`gParamPlot3D[
         Association[
          ("spheres" -> {
            Association[
            "center" -> Part[$CellContext`testSphere, 1], "radius" -> 
             Part[$CellContext`testSphere, 2], "opacity" -> 1, "plotPts" -> 
             100, "mesh" -> None, "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
               Hue[
                
                sgCommon`asgVector[{$CellContext`x, $CellContext`y, \
$CellContext`z}, $CellContext`asgLight]]]]}& )[], 
          ("lines" -> {
            Association[
            "startPos" -> {0, 0, 1}, "dirVec" -> $CellContext`majorAxis, 
             "length" -> $CellContext`majorSize, "plotPts" -> 2, 
             "colorFunc" -> (Green& ), "thickness" -> 0.005], 
            Association[
            "startPos" -> {0, 0, 1}, "dirVec" -> $CellContext`minorAxis, 
             "length" -> $CellContext`minorSize, "plotPts" -> 2, 
             "colorFunc" -> (Green& ), "thickness" -> 0.005]}& )[], 
          ("disks" -> {
            Association[
            "center" -> Part[$CellContext`testDisk, 1], "normalAxis" -> 
             Part[$CellContext`testDisk, 2], "radius" -> 
             Part[$CellContext`testDisk, 3], "opacity" -> 0, "mesh" -> None, 
             "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z, \
$CellContext`p}, Cyan]]}& )[], "customPlots" -> {
            Graphics3D[{Blue, 
              
              Arrow[{Part[$CellContext`testDisk, 1] + $CellContext`lightDir 2,
                 Part[$CellContext`testDisk, 1] + $CellContext`lightDir}]}]}, 
          "axisExtent" -> 1.6]]), 
      "Specifications" :> {{{$CellContext`lightIntensity$$, 0.05}, 0.01, 
         0.5}, {{$CellContext`diskNormalX$$, -1.5}, -3, -0.1}, \
{{$CellContext`diskNormalY$$, -0.5}, -3, -0.1}, {{$CellContext`diskRadius$$, 
          0.5}, 0.2, 1}, {{$CellContext`roughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`shadingColorScaling$$, 0.3}, 0.1, 
         1}, {{$CellContext`asgLight1$$, {$CellContext`majorSize, \
$CellContext`minorSize}}}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{141., {71., 77.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.835738884673647*^9, 3.837243799736329*^9},
 CellLabel->
  "Out[771]=",ExpressionUUID->"a9363470-bccc-4f54-a1c5-3a5dbf8dedaa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Shading with Reflection ASG Light\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "testDisk", ",", "testSphere", ",", "diskNormalAxis", ",", "viewDir", ",", 
    "halfDir", ",", "lightDir", ",", "\[IndentingNewLine]", "   ", 
    "majorAxis", ",", "minorAxis", ",", "majorSize", ",", "minorSize", ",", 
    "realViewDir", ",", "shandingPtNormal", ",", "\[IndentingNewLine]", "  ", 
    "asgEnergy", ",", "asgLight", ",", "asgL", ",", "asgM", ",", "asgC", ",", 
    "sgndf", ",", "reflLighting"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"diskNormalAxis", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"{", 
       RowBox[{"diskNormalX", ",", "diskNormalY", ",", 
        RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"testDisk", "=", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"center", " ", "point"}], "*)"}], "\[IndentingNewLine]", "\t",
        "diskNormalAxis", ",", 
       RowBox[{"(*", 
        RowBox[{"normal", " ", "axis"}], "*)"}], "\[IndentingNewLine]", "\t", 
       "diskRadius"}], 
      RowBox[{"(*", 
       RowBox[{"disk", " ", "radius"}], "*)"}], "\[IndentingNewLine]", 
      "}"}]}], ";", "\[IndentingNewLine]", " ", 
    RowBox[{"testSphere", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"viewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], "-", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"halfDir", "=", "diskNormalAxis"}], ";", "\[IndentingNewLine]", 
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{"Dot", "[", 
         RowBox[{"viewDir", ",", "halfDir"}], "]"}], "*", "halfDir"}], "-", 
       "viewDir"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "approximating", " ", "reflection", " ", "light", " ", "as", " ", 
      "ASG"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"asgLight", "=", 
     RowBox[{"asgReflectLight", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "lightDir", ",", 
       "lightIntensity", ",", "reflRoughness", ",", "testDisk"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"majorAxis", "=", 
     RowBox[{"asgLight", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"minorAxis", "=", 
     RowBox[{"asgLight", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"asgL", "=", 
     RowBox[{"asgLight", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"asgM", "=", 
     RowBox[{"asgLight", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"asgC", "=", 
     RowBox[{"asgLight", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], ";", "\n", "   ", 
    RowBox[{"majorSize", "=", 
     RowBox[{"diskRadius", "/", "1"}]}], ";", "\n", "   ", 
    RowBox[{"minorSize", "=", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{"diskNormalAxis", ",", "viewDir"}], "]"}], "*", 
      RowBox[{"diskRadius", "/", "1"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "reflection", " ", "lighting", " ", "on", " ", "shading", " ", "point"}],
      "*)"}], "\[IndentingNewLine]", 
    RowBox[{"realViewDir", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"shandingPtNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"sgndf", "=", 
     RowBox[{"sgNDF", "[", 
      RowBox[{"shadingRoughness", ",", 
       RowBox[{"asgLight", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "realViewDir", ",", 
       "shandingPtNormal"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"reflLighting", "=", 
     RowBox[{"asgDotSg", "[", 
      RowBox[{"asgLight", ",", "sgndf"}], "]"}]}], ";", "\[IndentingNewLine]",
     "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", "  ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spheres\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "  ", 
           RowBox[{"(*", 
            RowBox[{"shading", " ", "sphere"}], "*)"}], "\[IndentingNewLine]",
            "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"testSphere", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", 
              RowBox[{"testSphere", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "100"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                RowBox[{"Hue", "@", 
                 RowBox[{"(", 
                  RowBox[{"asgVector", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    "asgLight"}], "]"}], ")"}]}]}], " ", "]"}]}]}], "|>"}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", " ", 
           RowBox[{"(*", 
            RowBox[{"ellipse", " ", "major", " ", "axis"}], "*)"}], 
           "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "majorAxis"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "majorSize"}], ",", 
              RowBox[{"\"\<plotPts\>\"", "\[Rule]", "2"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "minorAxis"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "minorSize"}], ",", 
              RowBox[{"\"\<plotPts\>\"", "\[Rule]", "2"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<disks\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"testDisk", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<normalAxis\>\"", "\[Rule]", 
              RowBox[{"testDisk", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", 
              RowBox[{"testDisk", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "0"}], ",", 
             RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                "Cyan"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", " ", 
           "}"}]}], "&"}], "[", "]"}], ",", "\[IndentingNewLine]", " ", 
       RowBox[{"\"\<customPlots\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"testDisk", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", 
                RowBox[{"lightDir", "*", "2"}]}], ",", 
               RowBox[{
                RowBox[{"testDisk", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", "lightDir"}]}], "}"}], 
             "]"}]}], "}"}], "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
       "     ", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.6"}]}], 
      "\[IndentingNewLine]", "|>"}], 
     RowBox[{"(*", 
      RowBox[{",", "Large"}], "*)"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "0.01", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalX", ",", 
       RowBox[{"-", "1.5"}]}], "}"}], ",", 
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "0.1"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalY", ",", 
       RowBox[{"-", "0.5"}]}], "}"}], ",", 
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "0.1"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskRadius", ",", "0.5"}], "}"}], ",", "0.2", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflRoughness", ",", "0.1"}], "}"}], ",", "0.01", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingRoughness", ",", "0.5"}], "}"}], ",", "0.01", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingColorScaling", ",", "0.3"}], "}"}], ",", "0.1", ",", 
     "1"}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"asgLight1", ",", 
      RowBox[{"{", 
       RowBox[{
       "majorSize", ",", "minorSize", ",", "asgL", ",", "asgM", ",", "asgC"}],
        "}"}]}], "}"}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"reflLighting1", ",", "reflLighting"}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "testDisk", ",", "testSphere", ",", "diskNormalAxis", ",", "viewDir", ",", 
    "halfDir", ",", "lightDir", ",", "\[IndentingNewLine]", "   ", 
    "majorAxis", ",", "minorAxis", ",", "majorSize", ",", "minorSize", ",", 
    "realViewDir", ",", "shandingPtNormal", ",", "\[IndentingNewLine]", "  ", 
    "asgEnergy", ",", "asgLight", ",", "asgL", ",", "asgM", ",", "asgC", ",", 
    "sgndf", ",", "reflLighting"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8357404325750585`*^9, 3.8357404702074933`*^9}},
 CellLabel->
  "In[773]:=",ExpressionUUID->"57ca0d11-98d8-427b-bee0-96e9d860bd0e"],

Cell[BoxData[
 StyleBox["\<\" Shading with Reflection ASG Light\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.8357404535084925`*^9, 3.8357404721582994`*^9}, 
   3.8372438008027797`*^9},
 CellLabel->
  "During evaluation of \
In[773]:=",ExpressionUUID->"e921c66e-5ac5-4c9d-890c-544d0efaeadf"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`asgLight1$$ = {0.5, 0.2672612419124244, 
    14.419641121714475`, 44.415053463847855`, 
    5.4450382267935}, $CellContext`diskNormalX$$ = -1.5, \
$CellContext`diskNormalY$$ = -0.5, $CellContext`diskRadius$$ = 
    0.5, $CellContext`lightIntensity$$ = 1, $CellContext`reflLighting1$$ = 
    1.9386635001726402`, $CellContext`reflRoughness$$ = 
    0.1, $CellContext`shadingColorScaling$$ = 
    0.3, $CellContext`shadingRoughness$$ = 0.5, Typeset`show$$ = False, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightIntensity$$], 1}, 0.01, 1}, {{
       Hold[$CellContext`diskNormalX$$], -1.5}, -3, -0.1}, {{
       Hold[$CellContext`diskNormalY$$], -0.5}, -3, -0.1}, {{
       Hold[$CellContext`diskRadius$$], 0.5}, 0.2, 1}, {{
       Hold[$CellContext`reflRoughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`shadingRoughness$$], 0.5}, 0.01, 0.99}, {{
       Hold[$CellContext`shadingColorScaling$$], 0.3}, 0.1, 1}, {{
       Hold[$CellContext`asgLight1$$], {0.5, 0.2672612419124244, 
       14.419641121714475`, 44.415053463847855`, 5.4450382267935}}}, {{
       Hold[$CellContext`reflLighting1$$], 1.9386635001726402`}}}, 
    Typeset`size$$ = {90., {47., 53.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`lightIntensity$661094$$ = 
    0, $CellContext`diskNormalX$661095$$ = 
    0, $CellContext`diskNormalY$661096$$ = 
    0, $CellContext`diskRadius$661097$$ = 
    0, $CellContext`reflRoughness$661098$$ = 
    0, $CellContext`shadingRoughness$661099$$ = 
    0, $CellContext`shadingColorScaling$661100$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`asgLight1$$ = {$CellContext`majorSize, \
$CellContext`minorSize, $CellContext`asgL, $CellContext`asgM, \
$CellContext`asgC}, $CellContext`diskNormalX$$ = -1.5, \
$CellContext`diskNormalY$$ = -0.5, $CellContext`diskRadius$$ = 
        0.5, $CellContext`lightIntensity$$ = 
        1, $CellContext`reflLighting1$$ = $CellContext`reflLighting, \
$CellContext`reflRoughness$$ = 0.1, $CellContext`shadingColorScaling$$ = 
        0.3, $CellContext`shadingRoughness$$ = 0.5}, "ControllerVariables" :> {
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$661094$$, 0], 
        Hold[$CellContext`diskNormalX$$, $CellContext`diskNormalX$661095$$, 
         0], 
        Hold[$CellContext`diskNormalY$$, $CellContext`diskNormalY$661096$$, 
         0], 
        Hold[$CellContext`diskRadius$$, $CellContext`diskRadius$661097$$, 0], 
        Hold[$CellContext`reflRoughness$$, \
$CellContext`reflRoughness$661098$$, 0], 
        Hold[$CellContext`shadingRoughness$$, \
$CellContext`shadingRoughness$661099$$, 0], 
        Hold[$CellContext`shadingColorScaling$$, \
$CellContext`shadingColorScaling$661100$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`diskNormalAxis = 
        Normalize[{$CellContext`diskNormalX$$, $CellContext`diskNormalY$$, \
-1}]; $CellContext`testDisk = {{0, 0, 
          1}, $CellContext`diskNormalAxis, $CellContext`diskRadius$$}; \
$CellContext`testSphere = {{0, 0, 0}, 1}; $CellContext`viewDir = 
        Normalize[{0, 0, 0} - {0, 0, 
          1}]; $CellContext`halfDir = $CellContext`diskNormalAxis; \
$CellContext`lightDir = 
        Normalize[
         2 Dot[$CellContext`viewDir, $CellContext`halfDir] \
$CellContext`halfDir - $CellContext`viewDir]; $CellContext`asgLight = 
        sgCommon`asgReflectLight[{0, 0, 
          0}, $CellContext`lightDir, $CellContext`lightIntensity$$, \
$CellContext`reflRoughness$$, $CellContext`testDisk]; $CellContext`majorAxis = 
        Part[$CellContext`asgLight, 2]; $CellContext`minorAxis = 
        Part[$CellContext`asgLight, 3]; $CellContext`asgL = 
        Part[$CellContext`asgLight, 4]; $CellContext`asgM = 
        Part[$CellContext`asgLight, 5]; $CellContext`asgC = 
        Part[$CellContext`asgLight, 
          6]; $CellContext`majorSize = $CellContext`diskRadius$$/
         1; $CellContext`minorSize = 
        Dot[$CellContext`diskNormalAxis, $CellContext`viewDir] \
($CellContext`diskRadius$$/1); $CellContext`realViewDir = 
        Normalize[{-1, -1, 1}]; $CellContext`shandingPtNormal = 
        Normalize[{0, 0, 1}]; $CellContext`sgndf = 
        sgCommon`sgNDF[$CellContext`shadingRoughness$$, 
          
          Part[$CellContext`asgLight, 
           1], $CellContext`realViewDir, $CellContext`shandingPtNormal]; \
$CellContext`reflLighting = 
        sgCommon`asgDotSg[$CellContext`asgLight, $CellContext`sgndf]; 
       gPlots3D`gParamPlot3D[
         Association[
          ("spheres" -> {
            Association[
            "center" -> Part[$CellContext`testSphere, 1], "radius" -> 
             Part[$CellContext`testSphere, 2], "opacity" -> 1, "plotPts" -> 
             100, "mesh" -> None, "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
               Hue[
                
                sgCommon`asgVector[{$CellContext`x, $CellContext`y, \
$CellContext`z}, $CellContext`asgLight]]]]}& )[], 
          ("lines" -> {
            Association[
            "startPos" -> {0, 0, 1}, "dirVec" -> $CellContext`majorAxis, 
             "length" -> $CellContext`majorSize, "plotPts" -> 2, 
             "colorFunc" -> (Green& ), "thickness" -> 0.005], 
            Association[
            "startPos" -> {0, 0, 1}, "dirVec" -> $CellContext`minorAxis, 
             "length" -> $CellContext`minorSize, "plotPts" -> 2, 
             "colorFunc" -> (Green& ), "thickness" -> 0.005]}& )[], 
          ("disks" -> {
            Association[
            "center" -> Part[$CellContext`testDisk, 1], "normalAxis" -> 
             Part[$CellContext`testDisk, 2], "radius" -> 
             Part[$CellContext`testDisk, 3], "opacity" -> 0, "mesh" -> None, 
             "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z, \
$CellContext`p}, Cyan]]}& )[], "customPlots" -> {
            Graphics3D[{Blue, 
              
              Arrow[{Part[$CellContext`testDisk, 1] + $CellContext`lightDir 2,
                 Part[$CellContext`testDisk, 1] + $CellContext`lightDir}]}]}, 
          "axisExtent" -> 1.6]]), 
      "Specifications" :> {{{$CellContext`lightIntensity$$, 1}, 0.01, 
         1}, {{$CellContext`diskNormalX$$, -1.5}, -3, -0.1}, \
{{$CellContext`diskNormalY$$, -0.5}, -3, -0.1}, {{$CellContext`diskRadius$$, 
          0.5}, 0.2, 1}, {{$CellContext`reflRoughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`shadingRoughness$$, 0.5}, 0.01, 
         0.99}, {{$CellContext`shadingColorScaling$$, 0.3}, 0.1, 
         1}, {{$CellContext`asgLight1$$, {$CellContext`majorSize, \
$CellContext`minorSize, $CellContext`asgL, $CellContext`asgM, \
$CellContext`asgC}}}, {{$CellContext`reflLighting1$$, \
$CellContext`reflLighting}}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{141., {71., 77.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.835740453555367*^9, 3.8357404721876063`*^9}, 
   3.837243800870865*^9},
 CellLabel->
  "Out[775]=",ExpressionUUID->"8b8266d6-ce6d-4274-bfd7-0f7b71594c74"]
}, Open  ]]
},
WindowSize->{1082, 819},
WindowMargins->{{Automatic, 245}, {-38, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4391, 124, 490, "Input",ExpressionUUID->"24568d69-b4f1-47e4-bee8-1cb606b419fa"],
Cell[4974, 148, 641, 13, 30, "Print",ExpressionUUID->"58d5233c-d34c-47ea-b814-16ca4402ab79"],
Cell[5618, 163, 763, 15, 21, "Message",ExpressionUUID->"c6211696-6447-4c75-b40a-85e0ae1c2bc7"],
Cell[6384, 180, 857, 19, 36, "Output",ExpressionUUID->"b01b2a76-8aa1-43e1-a44d-94fda644390a"],
Cell[7244, 201, 783, 19, 60, "Output",ExpressionUUID->"65f01804-052d-4705-a15a-fbccd94fe989"],
Cell[8030, 222, 886, 20, 53, "Output",ExpressionUUID->"3cacf1ce-1908-42f0-bcc6-f71f0addd693"],
Cell[8919, 244, 929, 23, 54, "Output",ExpressionUUID->"b554214f-aea6-46b9-baa6-d831952f4479"],
Cell[9851, 269, 620, 13, 30, "Print",ExpressionUUID->"6d191077-fe71-48f6-af46-5e8da789a2d8"],
Cell[10474, 284, 665, 15, 55, "Output",ExpressionUUID->"abbbcb1a-416a-48e8-926e-7353721e8d1f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11176, 304, 13560, 321, 1435, "Input",ExpressionUUID->"20405f3a-4d01-4620-be57-6abd10012d27"],
Cell[24739, 627, 486, 11, 30, "Print",ExpressionUUID->"7362a8d9-8266-41f5-a989-fe1abddbe5a6"],
Cell[25228, 640, 8436, 158, 167, "Output",ExpressionUUID->"6f74a8eb-51ee-40e5-b782-5887cfef3f7c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33701, 803, 11363, 270, 1207, "Input",ExpressionUUID->"96e4d330-5040-4cb5-87eb-1e134286636a"],
Cell[45067, 1075, 316, 8, 30, "Print",ExpressionUUID->"1d21ccd5-f383-498b-af28-62f29544a904"],
Cell[45386, 1085, 6454, 122, 167, "Output",ExpressionUUID->"a9363470-bccc-4f54-a1c5-3a5dbf8dedaa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51877, 1212, 12825, 303, 1397, "Input",ExpressionUUID->"57ca0d11-98d8-427b-bee0-96e9d860bd0e"],
Cell[64705, 1517, 362, 9, 30, "Print",ExpressionUUID->"e921c66e-5ac5-4c9d-890c-544d0efaeadf"],
Cell[65070, 1528, 7988, 152, 167, "Output",ExpressionUUID->"8b8266d6-ce6d-4274-bfd7-0f7b71594c74"]
}, Open  ]]
}
]
*)

