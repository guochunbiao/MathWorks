(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      9875,        247]
NotebookOptionsPosition[      9329,        229]
NotebookOutlinePosition[      9696,        245]
CellTagsIndexPosition[      9653,        242]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"CellContext", "\[Rule]", "Notebook"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3DEx`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gBlochSphere`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "diskCenter", ",", "diskNormal", ",", "\[Theta]a", ",", "\[Theta]L", ",", 
    "\[Alpha]1", ",", "\[Alpha]2", ",", "VQ", ",", "PQ", ",", "QQ1", ",", 
    "diskRadius", ",", "shadingDist"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]1", "=", "\[Theta]L"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]2", "=", "\[Alpha]1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PQ1", "=", 
   RowBox[{"diskRadius", "*", 
    RowBox[{"Cos", "[", "\[Alpha]2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diskRadius", "=", 
   RowBox[{"shadingDist", "*", "dr"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]a", "=", 
   RowBox[{"ArcTan", "[", 
    RowBox[{"PQ1", "/", "shadingDist"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", "\[Theta]a", "]"}], "^", "2"}], "//", 
   "FullSimplify"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diskCenter", "=", 
   RowBox[{"Normalize", "@", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"diskNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"diskNormalX", ",", "0", ",", 
        RowBox[{"-", "1.5"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"blPaperIntsDisk08", "[", 
        RowBox[{
        "diskCenter", ",", "diskNormal", ",", "diskRadius", ",", 
         "calcPointPercent"}], "]"}], "\[IndentingNewLine]", " ", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], ",", "\n", "\t\t", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"AspectRatio", "->", "1"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", "Front"}], ",", "\[IndentingNewLine]", 
      "\t    ", 
      RowBox[{"ViewProjection", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
      ",", "\[IndentingNewLine]", "\t    ", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
     "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"calcPointPercent", ",", "1"}], "}"}], ",", "0.1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalX", ",", "1"}], "}"}], ",", "0", ",", "2"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskRadius", ",", "0.6"}], "}"}], ",", "0.1", ",", "0.6"}], 
    "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8353222643886895`*^9, 3.835322274118822*^9}, {
   3.8353223058484564`*^9, 3.835322326166722*^9}, {3.8353223644600883`*^9, 
   3.835322411870082*^9}, 3.835323302896367*^9, {3.8353233536007223`*^9, 
   3.8353233577104225`*^9}, 3.835323503701386*^9, {3.8353236539218063`*^9, 
   3.83532365589091*^9}, {3.8353262121176076`*^9, 3.8353262317808833`*^9}, {
   3.8353262979537597`*^9, 3.8353263037256756`*^9}, {3.835331973528861*^9, 
   3.8353320479475107`*^9}, {3.835862844517296*^9, 3.835863065116825*^9}, {
   3.8358631259685574`*^9, 3.835863208572153*^9}, {3.8368850738890266`*^9, 
   3.836885089141992*^9}, {3.836885238968959*^9, 3.8368853386699257`*^9}, {
   3.836885410465516*^9, 3.83688541409077*^9}, {3.8368854608302083`*^9, 
   3.836885478848657*^9}},ExpressionUUID->"08afcbc9-9c20-46bf-9842-\
8619b54a4692"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"1", "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["shadingDist", "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sec", "[", "\[Theta]L", "]"}], "2"]}], 
    SuperscriptBox["diskRadius", "2"]]}]]], "Output",
 CellChangeTimes->{{3.836885075789319*^9, 3.83688508961005*^9}, 
   3.836885339411276*^9, 3.8368854147342887`*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"dae911bb-05ed-479d-96e0-ccc133062062"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`calcPointPercent$$ = 
    1, $CellContext`diskNormalX$$ = 1, $CellContext`diskRadius$$ = 0.6, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`calcPointPercent$$], 1}, 0.1, 1}, {{
       Hold[$CellContext`diskNormalX$$], 1}, 0, 2}, {{
       Hold[$CellContext`diskRadius$$], 0.6}, 0.1, 0.6}}, Typeset`size$$ = {
    576., {288., 293.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`calcPointPercent$393150$$ = 
    0, $CellContext`diskNormalX$393151$$ = 
    0, $CellContext`diskRadius$393152$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`calcPointPercent$$ = 
        1, $CellContext`diskNormalX$$ = 1, $CellContext`diskRadius$$ = 0.6}, 
      "ControllerVariables" :> {
        Hold[$CellContext`calcPointPercent$$, \
$CellContext`calcPointPercent$393150$$, 0], 
        Hold[$CellContext`diskNormalX$$, $CellContext`diskNormalX$393151$$, 
         0], 
        Hold[$CellContext`diskRadius$$, $CellContext`diskRadius$393152$$, 0]},
       "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`diskNormal = 
        Normalize[{$CellContext`diskNormalX$$, 0, -1.5}]; Show[{
          
          gBlochSphere`blPaperIntsDisk08[$CellContext`diskCenter, \
$CellContext`diskNormal, $CellContext`diskRadius$$, \
$CellContext`calcPointPercent$$]}, PlotRange -> {{-1, 1}, {-1, 1}, {0, 2}}, 
         Axes -> True, Boxed -> False, AspectRatio -> 1, ViewPoint -> Front, 
         ViewProjection -> "Orthographic", AxesLabel -> {"X", "Y", "Z"}, 
         ImageSize -> Large]), 
      "Specifications" :> {{{$CellContext`calcPointPercent$$, 1}, 0.1, 
         1}, {{$CellContext`diskNormalX$$, 1}, 0, 
         2}, {{$CellContext`diskRadius$$, 0.6}, 0.1, 0.6}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{627., {363., 369.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.836885075789319*^9, 3.83688508961005*^9}, 
   3.836885339411276*^9, 3.8368854147854414`*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"2fd9b685-9709-4539-a13f-3928895a4280"]
}, Open  ]]
},
WindowSize->{997, 811},
WindowMargins->{{281, Automatic}, {-83, Automatic}},
CellContext->Notebook,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5350, 133, 751, "Input",ExpressionUUID->"08afcbc9-9c20-46bf-9842-8619b54a4692"],
Cell[5933, 157, 453, 11, 64, "Output",ExpressionUUID->"dae911bb-05ed-479d-96e0-ccc133062062"],
Cell[6389, 170, 2924, 56, 751, "Output",ExpressionUUID->"2fd9b685-9709-4539-a13f-3928895a4280"]
}, Open  ]]
}
]
*)

