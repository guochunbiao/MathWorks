(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30209,        663]
NotebookOptionsPosition[     29722,        645]
NotebookOutlinePosition[     30121,        662]
CellTagsIndexPosition[     30078,        659]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"CellContext", "\[Rule]", "Notebook"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "diskCenterPt", ",", "diskNormalAxis", ",", "diskRadius", ",", 
     "\[IndentingNewLine]", "\t", "diskTangentZ", ",", "diskBiTangentZ", ",", 
     "viewPoint", ",", "lightDir", ",", "\[IndentingNewLine]", "\t", 
     "viewDir0", ",", "viewDist0", ",", "viewDir1", ",", "viewDist1", ",", 
     "\[IndentingNewLine]", "\t", "shadingPt1", ",", "shadingPt1Proj", ",", 
     "halfEdgePt", ",", "halfEdgePtProj", ",", "\[IndentingNewLine]", "\t", 
     "debug01", ",", "debug02", ",", "debug03"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "  ", 
  RowBox[{
   RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"shadingPt0", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"viewPoint", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"diskCenterPt", "=", "shadingPt0"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"diskNormalAxis", "=", 
         RowBox[{"Normalize", "@", 
          RowBox[{"{", 
           RowBox[{"0", ",", "diskNormalY", ",", "1"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"diskRadius", "=", "2"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"halfDir0", "=", "diskNormalAxis"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"viewDist0", "=", 
         RowBox[{"Norm", "[", 
          RowBox[{"viewPoint", "-", "shadingPt0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"viewDir0", "=", 
         RowBox[{"Normalize", "[", 
          RowBox[{"viewPoint", "-", "shadingPt0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lightDir", "=", 
         RowBox[{"gReflectVector", "[", 
          RowBox[{"viewDir0", ",", "halfDir0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"diskTangentZ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Dot", "[", 
               RowBox[{"diskNormalAxis", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "x"}], "}"}]}], "]"}], 
              "\[Equal]", "0"}], ",", "x"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"diskTangent", "=", 
         RowBox[{"Normalize", "@", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "diskTangentZ"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"diskBiTangentZ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Dot", "[", 
               RowBox[{"diskNormalAxis", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "x"}], "}"}]}], "]"}], 
              "\[Equal]", "0"}], ",", "x"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"diskBiTangent", "=", 
         RowBox[{"Normalize", "@", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "diskBiTangentZ"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"shadingPt1", "=", 
         RowBox[{"shadingPt0", "+", 
          RowBox[{"diskTangent", "*", "shadingPt1Offset"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"viewDir1", "=", 
         RowBox[{"Normalize", "[", 
          RowBox[{"viewPoint", "-", "shadingPt1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"viewDist1", "=", 
         RowBox[{"Norm", "[", 
          RowBox[{"viewPoint", "-", "shadingPt1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"halfDir1", "=", 
         RowBox[{"Normalize", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"lightDir", "+", "viewDir1"}], ")"}], "/", "2"}], "]"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"halfEdgePt", "=", 
         RowBox[{"shadingPt1", "+", 
          RowBox[{"halfDir1", "*", "1"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"halfEdgePtProj", "=", 
         RowBox[{"halfEdgePt", "-", 
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{"halfDir1", ",", "diskNormalAxis"}], "]"}], "*", 
           "diskNormalAxis"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"debug01", "=", 
         RowBox[{
          RowBox[{"ArcCos", "[", 
           RowBox[{"Abs", "@", 
            RowBox[{"Dot", "[", 
             RowBox[{"viewDir0", ",", "diskNormalAxis"}], "]"}]}], "]"}], "//",
           "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"debug02", "=", 
         RowBox[{
          RowBox[{"ArcCos", "[", 
           RowBox[{"Abs", "@", 
            RowBox[{"Dot", "[", 
             RowBox[{"viewDir1", ",", "diskNormalAxis"}], "]"}]}], "]"}], "//",
           "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"debug03", "=", 
         RowBox[{
          RowBox[{"ArcCos", "[", 
           RowBox[{"Abs", "@", 
            RowBox[{"Dot", "[", 
             RowBox[{"halfDir1", ",", "diskNormalAxis"}], "]"}]}], "]"}], "//",
           "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"debug04", "=", 
         RowBox[{"ArcCos", "[", 
          RowBox[{"Dot", "[", 
           RowBox[{
            RowBox[{"Normalize", "[", 
             RowBox[{"shadingPt1", "-", "halfEdgePtProj"}], "]"}], ",", 
            "diskTangent"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"{", 
            RowBox[{
            "debug01", ",", "debug02", ",", "debug03", ",", "debug04"}], 
            "}"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<disks\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "diskCenterPt"}], ",", 
              RowBox[{"\"\<normalAxis\>\"", "\[Rule]", "diskNormalAxis"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "2"}], ",", 
              RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z", ",", "p"}], "}"}], ",", 
                 "Cyan"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", " ", 
            "}"}]}], "&"}], "[", "]"}]}], ",", "\[IndentingNewLine]", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "  ", 
           RowBox[{"(*", 
            RowBox[{"disk", " ", "tangent"}], "*)"}], "\[IndentingNewLine]", 
           "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "diskCenterPt"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "diskTangent"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "diskRadius"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "LightGreen", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.01"}]}], "|>"}], ",",
             "\[IndentingNewLine]", "   ", 
            RowBox[{"(*", 
             RowBox[{"view", " ", "dirs"}], "*)"}], "\[IndentingNewLine]", 
            "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt0"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "viewDir0"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "viewDist0"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "LightGray", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt1"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "viewDir1"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "viewDist1"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "LightGray", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", "   ", 
            RowBox[{"(*", 
             RowBox[{"light", " ", "dirs"}], "*)"}], "\[IndentingNewLine]", 
            "    ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt0"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "lightDir"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", "    ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt1"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "lightDir"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Green", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", "    ", 
            RowBox[{"(*", 
             RowBox[{"half", " ", "dirs"}], "*)"}], "\[IndentingNewLine]", 
            "     ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt0"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "halfDir0"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", "     ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt1"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "halfDir1"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Red", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", "    ", 
            RowBox[{"(*", 
             RowBox[{"normal", " ", "dirs"}], "*)"}], "\[IndentingNewLine]", 
            "    ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt1"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "diskNormalAxis"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Gray", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", "     ", 
            RowBox[{"(*", 
             RowBox[{"helper", " ", "lines"}], "*)"}], "\[IndentingNewLine]", 
            "     ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"shadingPt1", "+", 
                RowBox[{"halfDir1", "*", "1"}]}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"-", "diskNormalAxis"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "1"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Orange", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", "     ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "shadingPt1"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"Normalize", "[", 
                RowBox[{"halfEdgePtProj", "-", "shadingPt1"}], "]"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", 
               RowBox[{"Norm", "[", 
                RowBox[{"halfEdgePtProj", "-", "shadingPt1"}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Orange", "]"}]}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.005"}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<customPlots\>\"", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{"view", " ", "point"}], "*)"}], "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Magenta", ",", 
             RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
             RowBox[{"Point", "[", "viewPoint", "]"}]}], "}"}], " ", "]"}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
             RowBox[{"Point", "[", "shadingPt1", "]"}]}], "}"}], " ", "]"}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{
           "half", " ", "edge", " ", "point", " ", "project", " ", "onto", 
            " ", "disk"}], "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Gray", ",", 
             RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
             RowBox[{"Point", "[", "halfEdgePtProj", "]"}]}], "}"}], " ", 
           "]"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", "texts", "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<l\>\"", ",", "18"}], "]"}], ",", 
              RowBox[{"shadingPt1", "+", 
               RowBox[{"lightDir", "*", "1.05"}]}]}], "]"}], "}"}], "]"}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<h\>\"", ",", "18"}], "]"}], ",", 
              RowBox[{"shadingPt1", "+", 
               RowBox[{"halfDir1", "*", "1.05"}]}]}], "]"}], "}"}], "]"}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<n\>\"", ",", "18"}], "]"}], ",", 
              RowBox[{"shadingPt1", "+", 
               RowBox[{"diskNormalAxis", "*", "1.05"}]}]}], "]"}], "}"}], 
           "]"}]}], "\[IndentingNewLine]", "\t", "}"}]}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "2"}]}], 
      "\[IndentingNewLine]", "|>"}], ",", "Large"}], "]"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalY", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPt1Offset", ",", "1.5"}], "}"}], ",", "0.01", ",", 
     "2"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.834895035263679*^9, 3.834895040666751*^9}, {
   3.8348951347791367`*^9, 3.8348952061844378`*^9}, {3.834895290735386*^9, 
   3.8348952924204473`*^9}, 3.835082649097495*^9, {3.835082707744936*^9, 
   3.835082720546794*^9}, {3.8351341793564215`*^9, 3.83513427814063*^9}, 
   3.835134750680023*^9, {3.8353245981862097`*^9, 3.835324689828907*^9}, {
   3.835324728319592*^9, 3.835324730346821*^9}, {3.835325757257658*^9, 
   3.8353257908168154`*^9}, {3.8353309423004665`*^9, 3.8353309752871943`*^9}, 
   3.8353325165745106`*^9, {3.835333205615108*^9, 3.8353332736485415`*^9}, {
   3.835333311085712*^9, 3.8353333235444255`*^9}, {3.835333418941411*^9, 
   3.83533346550031*^9}, {3.8353338550372286`*^9, 3.835334030342117*^9}, {
   3.835334217776966*^9, 3.835334251407852*^9}, {3.8353343184335613`*^9, 
   3.835334430666292*^9}, {3.8353344815981264`*^9, 3.8353346809568167`*^9}, {
   3.835334721030372*^9, 3.8353347918605003`*^9}, {3.835334834904867*^9, 
   3.8353349923684096`*^9}, {3.835335050685196*^9, 3.8353350964602423`*^9}, {
   3.8353353687090454`*^9, 3.835335462214314*^9}, {3.835335504849134*^9, 
   3.835335505943939*^9}, {3.835335556484923*^9, 3.835335561267976*^9}, {
   3.8353407157692013`*^9, 3.8353407719046755`*^9}, {3.835340805129814*^9, 
   3.835340967631032*^9}, {3.835341007897066*^9, 3.835341031103798*^9}, {
   3.8353412487098103`*^9, 3.8353412905675964`*^9}, {3.835341352412753*^9, 
   3.8353414417449484`*^9}, {3.8353414762291164`*^9, 
   3.8353415536024733`*^9}, {3.8353416220936594`*^9, 
   3.8353416269619007`*^9}, {3.8353417550934887`*^9, 
   3.8353417854304023`*^9}, {3.8353419426262665`*^9, 
   3.8353419906264153`*^9}, {3.835342057274319*^9, 3.835342107679822*^9}, {
   3.835342181194284*^9, 3.8353422087009964`*^9}, {3.8353433337721424`*^9, 
   3.8353433371606474`*^9}, {3.8353437002426577`*^9, 
   3.8353437562398033`*^9}, {3.835343787145516*^9, 3.835343828342013*^9}, {
   3.8353438775141163`*^9, 3.8353440141870174`*^9}, {3.835344057459896*^9, 
   3.835344060422573*^9}, {3.835344106521313*^9, 3.8353441676304345`*^9}, {
   3.835344259432983*^9, 3.8353442704670153`*^9}, {3.8353443913914986`*^9, 
   3.8353446394594336`*^9}, {3.835344718266373*^9, 3.8353447252939425`*^9}, {
   3.8353455038634963`*^9, 3.835345518941591*^9}, 3.8353460212021356`*^9, 
   3.8353460760376053`*^9, {3.835346108605398*^9, 3.8353463238097234`*^9}, {
   3.8353463568652277`*^9, 3.8353463795220594`*^9}, 
   3.835346488230481*^9},ExpressionUUID->"18d9376b-af26-4d21-84ca-\
03f5389c6014"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`diskNormalY$$ = -1, \
$CellContext`shadingPt1Offset$$ = 1.5, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`diskNormalY$$], -1}, -1, 1}, {{
       Hold[$CellContext`shadingPt1Offset$$], 1.5}, 0.01, 2}}, 
    Typeset`size$$ = {526., {259., 263.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`diskNormalY$4479299$$ = 
    0, $CellContext`shadingPt1Offset$4479300$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`diskNormalY$$ = -1, \
$CellContext`shadingPt1Offset$$ = 1.5}, "ControllerVariables" :> {
        Hold[$CellContext`diskNormalY$$, $CellContext`diskNormalY$4479299$$, 
         0], 
        Hold[$CellContext`shadingPt1Offset$$, \
$CellContext`shadingPt1Offset$4479300$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> gPlots3D`gParamPlot3D[
        Association[$CellContext`shadingPt0 = {0, 0, 
           0}; $CellContext`viewPoint = {0, 0, 
           1}; $CellContext`diskCenterPt = $CellContext`shadingPt0; \
$CellContext`diskNormalAxis = 
          Normalize[{
            0, $CellContext`diskNormalY$$, 1}]; $CellContext`diskRadius = 
          2; $CellContext`halfDir0 = $CellContext`diskNormalAxis; \
$CellContext`viewDist0 = 
          Norm[$CellContext`viewPoint - $CellContext`shadingPt0]; \
$CellContext`viewDir0 = 
          Normalize[$CellContext`viewPoint - $CellContext`shadingPt0]; \
$CellContext`lightDir = 
          gUtils`gReflectVector[$CellContext`viewDir0, $CellContext`halfDir0]; \
$CellContext`diskTangentZ = Part[
            Part[
             Solve[
             Dot[$CellContext`diskNormalAxis, {1, 0, $CellContext`x}] == 
              0, $CellContext`x], All, 1, 2], 1]; $CellContext`diskTangent = 
          Normalize[{
            1, 0, $CellContext`diskTangentZ}]; $CellContext`diskBiTangentZ = 
          Part[
            Part[
             Solve[
             Dot[$CellContext`diskNormalAxis, {0, 1, $CellContext`x}] == 
              0, $CellContext`x], All, 1, 2], 1]; $CellContext`diskBiTangent = 
          Normalize[{
            0, 1, $CellContext`diskBiTangentZ}]; $CellContext`shadingPt1 = \
$CellContext`shadingPt0 + $CellContext`diskTangent \
$CellContext`shadingPt1Offset$$; $CellContext`viewDir1 = 
          Normalize[$CellContext`viewPoint - $CellContext`shadingPt1]; \
$CellContext`viewDist1 = 
          Norm[$CellContext`viewPoint - $CellContext`shadingPt1]; \
$CellContext`halfDir1 = 
          Normalize[($CellContext`lightDir + $CellContext`viewDir1)/
            2]; $CellContext`halfEdgePt = $CellContext`shadingPt1 + \
$CellContext`halfDir1 
            1; $CellContext`halfEdgePtProj = $CellContext`halfEdgePt - 
           Dot[$CellContext`halfDir1, $CellContext`diskNormalAxis] \
$CellContext`diskNormalAxis; $CellContext`debug01 = N[
            ArcCos[
             Abs[
              
              Dot[$CellContext`viewDir0, $CellContext`diskNormalAxis]]]]; \
$CellContext`debug02 = N[
            ArcCos[
             Abs[
              
              Dot[$CellContext`viewDir1, $CellContext`diskNormalAxis]]]]; \
$CellContext`debug03 = N[
            ArcCos[
             Abs[
              
              Dot[$CellContext`halfDir1, $CellContext`diskNormalAxis]]]]; \
$CellContext`debug04 = ArcCos[
            Dot[
             
             Normalize[$CellContext`shadingPt1 - \
$CellContext`halfEdgePtProj], $CellContext`diskTangent]]; 
         Print[{$CellContext`debug01, $CellContext`debug02, \
$CellContext`debug03, $CellContext`debug04}]; ("disks" -> {
            Association[
            "center" -> $CellContext`diskCenterPt, 
             "normalAxis" -> $CellContext`diskNormalAxis, "radius" -> 2, 
             "mesh" -> None, "colorFunc" -> 
             
             Function[{$CellContext`x, $CellContext`y, $CellContext`z, \
$CellContext`p}, Cyan]]}& )[], 
         ("lines" -> {
           Association[
           "startPos" -> $CellContext`diskCenterPt, 
            "dirVec" -> $CellContext`diskTangent, 
            "length" -> $CellContext`diskRadius, 
            "colorFunc" -> (LightGreen& ), "thickness" -> 0.01], 
           Association[
           "startPos" -> $CellContext`shadingPt0, 
            "dirVec" -> $CellContext`viewDir0, 
            "length" -> $CellContext`viewDist0, "colorFunc" -> (LightGray& ), 
            "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt1, 
            "dirVec" -> $CellContext`viewDir1, 
            "length" -> $CellContext`viewDist1, "colorFunc" -> (LightGray& ), 
            "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt0, 
            "dirVec" -> $CellContext`lightDir, "length" -> 1, 
            "colorFunc" -> (Green& ), "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt1, 
            "dirVec" -> $CellContext`lightDir, "length" -> 1, 
            "colorFunc" -> (Green& ), "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt0, 
            "dirVec" -> $CellContext`halfDir0, "length" -> 1, 
            "colorFunc" -> (Blue& ), "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt1, 
            "dirVec" -> $CellContext`halfDir1, "length" -> 1, 
            "colorFunc" -> (Red& ), "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt1, 
            "dirVec" -> $CellContext`diskNormalAxis, "length" -> 1, 
            "colorFunc" -> (Gray& ), "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt1 + $CellContext`halfDir1 1, 
            "dirVec" -> -$CellContext`diskNormalAxis, "length" -> 1, 
            "colorFunc" -> (Orange& ), "thickness" -> 0.005], 
           Association[
           "startPos" -> $CellContext`shadingPt1, "dirVec" -> 
            Normalize[$CellContext`halfEdgePtProj - $CellContext`shadingPt1], 
            "length" -> 
            Norm[$CellContext`halfEdgePtProj - $CellContext`shadingPt1], 
            "colorFunc" -> (Orange& ), "thickness" -> 0.005]}& )[], 
         "customPlots" -> {
           Graphics3D[{Magenta, 
             PointSize[0.02], 
             Point[$CellContext`viewPoint]}], 
           Graphics3D[{Red, 
             PointSize[0.02], 
             Point[$CellContext`shadingPt1]}], 
           Graphics3D[{Gray, 
             PointSize[0.02], 
             Point[$CellContext`halfEdgePtProj]}], 
           Graphics3D[{
             Text[
              Style[
              "l", 18], $CellContext`shadingPt1 + $CellContext`lightDir 
               1.05]}], 
           Graphics3D[{
             Text[
              Style[
              "h", 18], $CellContext`shadingPt1 + $CellContext`halfDir1 
               1.05]}], 
           Graphics3D[{
             Text[
              Style[
              "n", 18], $CellContext`shadingPt1 + $CellContext`diskNormalAxis 
               1.05]}]}, "axisExtent" -> 2], Large], 
      "Specifications" :> {{{$CellContext`diskNormalY$$, -1}, -1, 
         1}, {{$CellContext`shadingPt1Offset$$, 1.5}, 0.01, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{573., {314., 320.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.835345508951166*^9, 3.835345519677496*^9}, {
   3.8353460765702877`*^9, 3.835346086890608*^9}, {3.8353461396034365`*^9, 
   3.835346155622978*^9}, 3.8353461952483435`*^9, {3.8353462632518835`*^9, 
   3.835346324638504*^9}, {3.83534635950212*^9, 3.8353463809359226`*^9}},
 CellLabel->
  "Out[1415]=",ExpressionUUID->"c5978cd7-0a6e-459d-a8a9-e755cfb3877f"]
}, Open  ]]
},
WindowSize->{1068, 813},
WindowMargins->{{Automatic, 380}, {-119, Automatic}},
CellContext->Notebook,
Magnification:>0.9 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 20542, 433, 1683, "Input",ExpressionUUID->"18d9376b-af26-4d21-84ca-03f5389c6014"],
Cell[21125, 457, 8581, 185, 652, "Output",ExpressionUUID->"c5978cd7-0a6e-459d-a8a9-e755cfb3877f"]
}, Open  ]]
}
]
*)

