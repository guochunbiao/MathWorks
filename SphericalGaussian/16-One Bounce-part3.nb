(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    140368,       3129]
NotebookOptionsPosition[    137641,       3081]
NotebookOutlinePosition[    137984,       3096]
CellTagsIndexPosition[    137941,       3093]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
      "\"\<Shared\>\""}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResetDirectory", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "\[Theta]L", ",", "detL", ",", "detH", ",", "\[Theta]L", ",", "\[Theta]V",
      ",", "sD"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<>>>>> Solve One Bounce Method 1\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FullSimplify", "@", 
    RowBox[{"sgSolveOneBounce1", "[", 
     RowBox[{"\[Theta]L", ",", "sD"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gPrint", "[", "\"\<>>>>> Solve One Bounce Method 2\>\"", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sgSolveOneBounce2", "[", 
    RowBox[{"\[Theta]L", ",", "sD"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"Sec", "[", "\[Theta]V", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"sD", "+", 
             RowBox[{"Sin", "[", "\[Theta]V", "]"}]}], ")"}], " ", 
           RowBox[{"Tan", "[", "\[Theta]V", "]"}]}], 
          RowBox[{
           SuperscriptBox["sD", "2"], "+", 
           RowBox[{"2", "sD", " ", "*", 
            RowBox[{"Sin", "[", "\[Theta]V", "]"}]}], "+", 
           SuperscriptBox[
            RowBox[{"Tan", "[", "\[Theta]V", "]"}], "2"]}]], "*", 
         FractionBox[
          RowBox[{
           RowBox[{"Sec", "[", "\[Theta]L", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"sD", "+", 
             RowBox[{"Sin", "[", "\[Theta]L", "]"}]}], ")"}], " ", 
           RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], 
          RowBox[{
           SuperscriptBox["sD", "2"], "+", 
           RowBox[{"2", " ", "sD", "*", 
            RowBox[{"Sin", "[", "\[Theta]L", "]"}]}], "+", 
           SuperscriptBox[
            RowBox[{"Tan", "[", "\[Theta]L", "]"}], "2"]}]]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"sgPolar", "[", 
         RowBox[{
          RowBox[{"ArcSin", "[", "sD", "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"49.467", "+", 
             FractionBox[
              RowBox[{"-", "1.234"}], 
              RowBox[{"0.01", "+", 
               RowBox[{
                RowBox[{"Tan", "[", "\[Theta]L", "]"}], "*", 
                RowBox[{"Tan", "[", "\[Theta]V", "]"}]}]}]]}], ",", 
            "sgMinLambda"}], "]"}], ",", "1"}], "]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"sgPolar", "[", 
         RowBox[{
          RowBox[{"ArcSin", "[", "sD", "]"}], ",", 
          RowBox[{"sgRepresentLambda", "[", 
           RowBox[{
            RowBox[{"Tan", "[", "\[Theta]L", "]"}], ",", 
            RowBox[{"Tan", "[", "\[Theta]V", "]"}]}], "]"}], ",", "1"}], 
         "]"}]}], "\[IndentingNewLine]", "\t", "}"}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"{", 
       RowBox[{"sD", ",", "0", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Green", ",", "Blue", ",", "Red"}], "}"}]}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]V", ",", 
        RowBox[{"\[Pi]", "/", "5"}]}], "}"}], ",", "0.01", ",", 
      RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]L", ",", 
        RowBox[{"\[Pi]", "/", "6"}]}], "}"}], ",", "0.01", ",", 
      RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"Method", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "\[Theta]L", ",", "detL", ",", "detH", ",", "\[Theta]L", ",", "\[Theta]V", 
    ",", "sD"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ3cOWx8Ay4Y0jz+piMK1aepAhEkjzWZ9mA9GdETkq
IPpTY5gqiN5zpndtOZDm3iC4DkQbH+TdBqJ31MduB9FTul6drAHSL42jToHo
c4VO50F01sPS6yD60gNG4zogva1A0gREK9UVOINouaQAFxD96mV2AYhWXv0L
TFeG8vA3A2mujotCILrA7rsEiBZbs04SRNuIiWqBaIn1vDogWkP1hTWITtje
ZAeidy09FgGiu9z2RYFoE6E/8SB6ytknCSA6aFpvAYg+dZW3EERfqRdaBJY/
I7EERNesefbl67Q3js9ydn0F0QBdYZxK
  "],
 CellLabel->
  "In[370]:=",ExpressionUUID->"54e5a7de-9769-4fec-8c4d-39d3dc27ee9d"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\" >>>>> Solve One Bounce Method 1\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.83386459788905*^9, 3.8338649410876074`*^9, 
  3.8338653428192225`*^9, 3.833874198833735*^9, 3.8339253976554356`*^9, 
  3.8372433128201914`*^9},
 CellLabel->
  "During evaluation of \
In[370]:=",ExpressionUUID->"b02d4168-5605-4e1a-9ab7-9a9df959e03e"],

Cell[BoxData[
 StyleBox["\<\" Jacobian of Light SG(Method 1)\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.83386459788905*^9, 3.8338649410876074`*^9, 
  3.8338653428192225`*^9, 3.833874198833735*^9, 3.8339253976554356`*^9, 
  3.8372433128359456`*^9},
 CellLabel->
  "During evaluation of \
In[370]:=",ExpressionUUID->"1f0fa599-9b64-4e36-b939-fb4c41d8af46"],

Cell[BoxData[
 TagBox[
  FormBox[
   FractionBox[
    RowBox[{
     RowBox[{"sD", " ", 
      RowBox[{"sin", "(", "\[Theta]L", ")"}]}], "+", 
     RowBox[{
      RowBox[{"tan", "(", "\[Theta]L", ")"}], " ", 
      RowBox[{"sec", "(", "\[Theta]L", ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sin", "(", "\[Theta]L", ")"}], "+", "sD"}], ")"}]}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["tan", "2"], "(", "\[Theta]L", ")"}], "+", 
     SuperscriptBox["sD", "2"], "+", 
     RowBox[{"2", " ", "sD", " ", 
      RowBox[{"sin", "(", "\[Theta]L", ")"}]}]}]],
   TraditionalForm],
  TraditionalForm,
  Editable->True]], "Print",
 CellChangeTimes->{3.83386459788905*^9, 3.8338649410876074`*^9, 
  3.8338653428192225`*^9, 3.833874198833735*^9, 3.8339253976554356`*^9, 
  3.8372433132248526`*^9},
 CellLabel->
  "During evaluation of \
In[370]:=",ExpressionUUID->"a902060a-c7df-4144-8428-0e5890559e2e"],

Cell[BoxData[
 StyleBox["\<\" Fit jacobian of light vector: a1->-1.322,a2->1.618\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.83386459788905*^9, 3.8338649410876074`*^9, 
  3.8338653428192225`*^9, 3.833874198833735*^9, 3.8339253976554356`*^9, 
  3.8372433132408*^9},
 CellLabel->
  "During evaluation of \
In[370]:=",ExpressionUUID->"49fd4288-2736-4045-bb95-8a3b724e6a03"],

Cell[BoxData[
 StyleBox["\<\" Fit jacobian multiplication: a1->49.467,a2->-1.234,a3->72.114\
\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.83386459788905*^9, 3.8338649410876074`*^9, 
  3.8338653428192225`*^9, 3.833874198833735*^9, 3.8339253976554356`*^9, 
  3.8372433132408*^9},
 CellLabel->
  "During evaluation of \
In[370]:=",ExpressionUUID->"bae0572d-1fca-42da-97d9-39be88373cd2"],

Cell[BoxData[
 StyleBox["\<\" >>>>> Solve One Bounce Method 2\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.83386459788905*^9, 3.8338649410876074`*^9, 
  3.8338653428192225`*^9, 3.833874198833735*^9, 3.8339253976554356`*^9, 
  3.8372433132408*^9},
 CellLabel->
  "During evaluation of \
In[370]:=",ExpressionUUID->"0d6add40-dcc3-4ddc-8a2c-5cfd93e2622c"],

Cell[BoxData[
 StyleBox["\<\" Jacobian of Light SG(Method 2)\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.83386459788905*^9, 3.8338649410876074`*^9, 
  3.8338653428192225`*^9, 3.833874198833735*^9, 3.8339253976554356`*^9, 
  3.83724331347089*^9},
 CellLabel->
  "During evaluation of \
In[370]:=",ExpressionUUID->"82611535-1074-47f2-be23-b7d7be62dc2a"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"Sec", "[", "\[Theta]L", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"sD", "+", 
     RowBox[{"Sin", "[", "\[Theta]L", "]"}]}], ")"}], " ", 
   RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], 
  RowBox[{
   SuperscriptBox["sD", "2"], "+", 
   RowBox[{"2", " ", "sD", " ", 
    RowBox[{"Sin", "[", "\[Theta]L", "]"}]}], "+", 
   SuperscriptBox[
    RowBox[{"Tan", "[", "\[Theta]L", "]"}], "2"]}]]], "Print",
 CellChangeTimes->{3.83386459788905*^9, 3.8338649410876074`*^9, 
  3.8338653428192225`*^9, 3.833874198833735*^9, 3.8339253976554356`*^9, 
  3.83724331347089*^9},
 CellLabel->
  "During evaluation of \
In[370]:=",ExpressionUUID->"20422fa9-82e3-440d-acbf-346efc2fdef8"],

Cell[BoxData[
 StyleBox["\<\" Fit jacobian of light vector: a1->-1.638,a2->2.936\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.83386459788905*^9, 3.8338649410876074`*^9, 
  3.8338653428192225`*^9, 3.833874198833735*^9, 3.8339253976554356`*^9, 
  3.83724331347089*^9},
 CellLabel->
  "During evaluation of \
In[370]:=",ExpressionUUID->"0ff84632-26be-44fd-84ab-d55e131e149e"],

Cell[BoxData[
 StyleBox["\<\" Fit jacobian multiplication: a1->-2.102,a2->3.116\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.83386459788905*^9, 3.8338649410876074`*^9, 
  3.8338653428192225`*^9, 3.833874198833735*^9, 3.8339253976554356`*^9, 
  3.83724331347089*^9},
 CellLabel->
  "During evaluation of \
In[370]:=",ExpressionUUID->"38b429ef-f2c1-4afc-a839-5c909f2c9e75"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Theta]L$$ = Rational[1, 6] 
    Pi, $CellContext`\[Theta]V$$ = Rational[1, 5] Pi, Typeset`show$$ = False, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Theta]V$$], Rational[1, 5] Pi}, 0.01, 
      Rational[1, 2] Pi}, {{
       Hold[$CellContext`\[Theta]L$$], Rational[1, 6] Pi}, 0.01, 
      Rational[1, 2] Pi}}, Typeset`size$$ = {100., {31., 35.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`\[Theta]V$294547$$ = 
    0, $CellContext`\[Theta]L$294548$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`\[Theta]L$$ = 
        Rational[1, 6] Pi, $CellContext`\[Theta]V$$ = Rational[1, 5] Pi}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Theta]V$$, $CellContext`\[Theta]V$294547$$, 0], 
        Hold[$CellContext`\[Theta]L$$, $CellContext`\[Theta]L$294548$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Plot[{(Sec[$CellContext`\[Theta]V$$] ($CellContext`sD + 
           Sin[$CellContext`\[Theta]V$$]) 
          Tan[$CellContext`\[Theta]V$$]/($CellContext`sD^2 + 
          2 $CellContext`sD Sin[$CellContext`\[Theta]V$$] + 
          Tan[$CellContext`\[Theta]V$$]^2)) (
          Sec[$CellContext`\[Theta]L$$] ($CellContext`sD + 
           Sin[$CellContext`\[Theta]L$$]) 
          Tan[$CellContext`\[Theta]L$$]/($CellContext`sD^2 + 
          2 $CellContext`sD Sin[$CellContext`\[Theta]L$$] + 
          Tan[$CellContext`\[Theta]L$$]^2)), 
         sgCommon`sgPolar[
          ArcSin[$CellContext`sD], 
          Max[
          49.467 - 1.234/(0.01 + 
           Tan[$CellContext`\[Theta]L$$] Tan[$CellContext`\[Theta]V$$]), 
           sgCommon`sgMinLambda], 1], 
         sgCommon`sgPolar[
          ArcSin[$CellContext`sD], 
          sgCommon`sgRepresentLambda[
           Tan[$CellContext`\[Theta]L$$], 
           Tan[$CellContext`\[Theta]V$$]], 1]}, {$CellContext`sD, 0, 2}, 
        PlotStyle -> {Green, Blue, Red}, ImageSize -> Tiny], 
      "Specifications" :> {{{$CellContext`\[Theta]V$$, Rational[1, 5] Pi}, 
         0.01, Rational[1, 2] 
         Pi}, {{$CellContext`\[Theta]L$$, Rational[1, 6] Pi}, 0.01, 
         Rational[1, 2] Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{151., {54., 60.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.833864598145396*^9, 3.8338649413576727`*^9, 
  3.833865343065717*^9, 3.833874199117976*^9, 3.8339253979170246`*^9, 
  3.837243313547648*^9},
 CellLabel->
  "Out[383]=",ExpressionUUID->"30f1155f-5612-4e5e-b363-c8be1351f431"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"gPrint", "[", "\"\<One bounce reflectance as SG\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Off", "[", "Assert", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightCenter", ",", "rightWallHeight", ",", "representPt", ",", 
    "representCone", ",", "tangentView", ",", "tangentLight", ",", 
    "\[IndentingNewLine]", "\t", "representEnergy", ",", "representLight", 
    ",", "represectNDF", ",", "\[IndentingNewLine]", "\t", "groundViewDir", 
    ",", "groundLightDir", ",", "wallNormal", ",", "wallViewDir", ",", 
    "wallLightDir", ",", "reflectSgAxisPt", ",", "disbFunc"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"rightWallHeight", "=", "2"}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"lightCenter", "=", 
     RowBox[{"{", 
      RowBox[{"lightCenterX", ",", "lightCenterY"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"representPt", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"rightWallHeight", "/", "2"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallNormal", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"representCone", "=", 
     RowBox[{"gCreateCone", "[", 
      RowBox[{"representPt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "10"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"groundViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"eyePoint", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"groundLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}], "-", "representPt"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"wallLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", "representPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"reflectSgAxisPt", "=", 
     RowBox[{"Block", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "viewDist", ",", "lightDist", ",", "viewProjPt", ",", "lightProjPt", 
         ",", "lerpFactor", ",", "axisPt"}], "}"}], ",", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"viewDist", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"shadingPosX", ",", "0"}], "}"}], "-", "representPt"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"lightDist", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"lightCenter", "-", "representPt"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
        RowBox[{"viewProjPt", "=", 
         RowBox[{"{", 
          RowBox[{"2", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"lightProjPt", "=", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"lightCenter", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"axisPt", "=", 
         RowBox[{"gLerp", "[", 
          RowBox[{"viewProjPt", ",", "lightProjPt", ",", 
           RowBox[{"viewDist", "/", 
            RowBox[{"(", 
             RowBox[{"viewDist", "+", "lightDist"}], ")"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", "axisPt"}]}], "\[IndentingNewLine]", 
      "    ", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"tangentView", "=", 
     RowBox[{"Tan", "[", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"Dot", "[", 
        RowBox[{"wallViewDir", ",", "wallNormal"}], "]"}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"tangentLight", "=", 
     RowBox[{"Tan", "[", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"Dot", "[", 
        RowBox[{"wallLightDir", ",", "wallNormal"}], "]"}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"representLight", "=", 
     RowBox[{"sgSphereLight", "[", 
      RowBox[{
      "lightCenter", ",", "lightFadeStart", ",", "lightFadeEnd", ",", 
       "\[IndentingNewLine]", "\t\t", "lightIntensity", ",", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"represectNDF", "=", 
     RowBox[{"sgNDF", "[", 
      RowBox[{
      "roughness", ",", "wallLightDir", ",", "wallViewDir", ",", 
       "wallNormal"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"representEnergy", "=", 
     RowBox[{"sgNDFConvLight", "[", 
      RowBox[{"0", ",", "0", ",", "representLight", ",", "represectNDF"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"light", " ", "circle"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"eye", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#eyePoint"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Magenta"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "eyePoint"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"reflect", " ", "sg", " ", "axis", " ", "line"}], "*)"}],
             "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "reflectSgAxisPt"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgRightWallShading\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}],
              ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<representCone\>\"", "\[Rule]", "representCone"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<wallXRange\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<wallHeights\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#leftWallHeight", ",", "#rightWallHeight"}], "}"}]}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
             ",", 
             RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<eyePoint\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgSphereLight", "[", 
                 RowBox[{
                 "#lightCenter", ",", "#lightFadeStart", ",", "#lightFadeEnd",
                   ",", "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",",
                   "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDF", "[", 
                 RowBox[{
                 "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                  "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDFConvLight", "[", 
                 RowBox[{
                 "#lightRadius", ",", "#shadingDist", ",", "#sgLight", ",", 
                  "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgPercentStrategy\>\"", "\[Rule]", "3"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<Wall Lighting\>\""}]}], 
            "|>"}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}],
           ",", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
          ",", "\t\t", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgDisbs\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<disbCenter\>\"", "\[Rule]", "#center"}], ",", 
             RowBox[{"\"\<sg\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"sgRepresentLambda", "[", 
                 RowBox[{"tangentLight", ",", "tangentView"}], "]"}], ",", 
                "representEnergy"}], "}"}]}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{"\"\<center\>\"", "\[Rule]", "reflectSgAxisPt"}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "\t", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenterX", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "6"}], ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenterY", ",", "2"}], "}"}], ",", "0", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eyePoint", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "4"}], "}"}], ",", "1", ",", "6"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "10"}], "}"}], ",", "3", ",", "20"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "2"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "6"}], "}"}], ",", "1", ",", "6"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "0"}], "}"}], ",", "0", ",", "5"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.15"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", "0.5"}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightCenter", ",", "rightWallHeight", ",", "representPt", ",", 
    "representCone", ",", "tangentView", ",", "tangentLight", ",", 
    "\[IndentingNewLine]", "\t", "representEnergy", ",", "representLight", 
    ",", "represectNDF", ",", "\[IndentingNewLine]", "\t", "groundViewDir", 
    ",", "groundLightDir", ",", "wallNormal", ",", "wallViewDir", ",", 
    "wallLightDir", ",", "reflectSgAxisPt", ",", "disbFunc"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.833602051438299*^9, 3.8336020516146297`*^9}, {
   3.83377613404555*^9, 3.833776182350959*^9}, {3.8337764193858075`*^9, 
   3.8337764267033625`*^9}, {3.833838956431242*^9, 3.8338389605527396`*^9}, {
   3.833839024429834*^9, 3.8338390349218407`*^9}, 3.8338494233294163`*^9, {
   3.8338495529732385`*^9, 3.833849556363999*^9}, {3.833852859389059*^9, 
   3.8338528660993624`*^9}, {3.8338630949486628`*^9, 3.833863157610262*^9}, {
   3.8338634714517145`*^9, 3.833863473639649*^9}, 3.8339253668037753`*^9},
 CellLabel->
  "In[385]:=",ExpressionUUID->"dde9940d-67b7-4b2b-95ea-3e775ea4b97e"],

Cell[BoxData[
 StyleBox["\<\" One bounce reflectance as SG\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8338645982877035`*^9, 3.8338649414834185`*^9, 
  3.8338653431677017`*^9, 3.833874199297496*^9, 3.8339253980302887`*^9, 
  3.837243313799225*^9},
 CellLabel->
  "During evaluation of \
In[385]:=",ExpressionUUID->"9e4066e7-cd3a-42a8-960e-45837e1ed9a7"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eyePoint$$ = {-3, 
    3}, $CellContext`leftWallHeight$$ = 0, $CellContext`lightCenterX$$ = 
    0, $CellContext`lightCenterY$$ = 2, $CellContext`lightFadeEnd$$ = 
    10, $CellContext`lightFadeStart$$ = 4, $CellContext`lightIntensity$$ = 
    2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
    0.15, $CellContext`shadingPosX$$ = 0.5, $CellContext`viewDir$$ = {1, 1}, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenterX$$], 0}, -6, 4}, {{
       Hold[$CellContext`lightCenterY$$], 2}, 0, 5}, {{
       Hold[$CellContext`eyePoint$$], {-3, 3}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightFadeStart$$], 4}, 1, 6}, {{
       Hold[$CellContext`lightFadeEnd$$], 10}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 2}, 1, 10}, {{
       Hold[$CellContext`lightRadius$$], 6}, 1, 6}, {{
       Hold[$CellContext`leftWallHeight$$], 0}, 0, 5}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`roughness$$], 0.15}, 0.05, 1}, {{
       Hold[$CellContext`shadingPosX$$], 0.5}, -2, 2}}, Typeset`size$$ = {
    200., {110., 116.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenterX$294976$$ = 
    0, $CellContext`lightCenterY$294977$$ = 
    0, $CellContext`eyePoint$294978$$ = {0, 
    0}, $CellContext`lightFadeStart$294979$$ = 
    0, $CellContext`lightFadeEnd$294980$$ = 
    0, $CellContext`lightIntensity$294981$$ = 
    0, $CellContext`lightRadius$294982$$ = 
    0, $CellContext`viewDir$294983$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`eyePoint$$ = {-3, 
         3}, $CellContext`leftWallHeight$$ = 0, $CellContext`lightCenterX$$ = 
        0, $CellContext`lightCenterY$$ = 2, $CellContext`lightFadeEnd$$ = 
        10, $CellContext`lightFadeStart$$ = 4, $CellContext`lightIntensity$$ = 
        2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
        0.15, $CellContext`shadingPosX$$ = 
        0.5, $CellContext`viewDir$$ = {1, 1}}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenterX$$, $CellContext`lightCenterX$294976$$, 
         0], 
        Hold[$CellContext`lightCenterY$$, $CellContext`lightCenterY$294977$$, 
         0], 
        Hold[$CellContext`eyePoint$$, $CellContext`eyePoint$294978$$, {0, 0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$294979$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$294980$$, 
         0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$294981$$, 0], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$294982$$, 
         0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$294983$$, {0, 0}]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`rightWallHeight = 
        2; $CellContext`lightCenter = {$CellContext`lightCenterX$$, \
$CellContext`lightCenterY$$}; $CellContext`representPt = {
         2, $CellContext`rightWallHeight/2}; $CellContext`wallNormal = {-1, 
         0}; $CellContext`representCone = 
        gUtils`gCreateCone[$CellContext`representPt, {-2, \
$CellContext`leftWallHeight$$}, {2, 10}]; $CellContext`groundViewDir = 
        Normalize[$CellContext`eyePoint$$ - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`groundLightDir = 
        Normalize[$CellContext`lightCenter - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`wallViewDir = 
        Normalize[{$CellContext`shadingPosX$$, 
            0} - $CellContext`representPt]; $CellContext`wallLightDir = 
        Normalize[$CellContext`lightCenter - $CellContext`representPt]; \
$CellContext`reflectSgAxisPt = 
        Block[{$CellContext`viewDist, $CellContext`lightDist, \
$CellContext`viewProjPt, $CellContext`lightProjPt, $CellContext`lerpFactor, \
$CellContext`axisPt}, $CellContext`viewDist = 
           Dot[{$CellContext`shadingPosX$$, 
               0} - $CellContext`representPt, {-1, 
             0}]; $CellContext`lightDist = 
           Dot[$CellContext`lightCenter - $CellContext`representPt, {-1, 
             0}]; $CellContext`viewProjPt = {2, 
            0}; $CellContext`lightProjPt = {2, 
             Part[$CellContext`lightCenter, 2]}; $CellContext`axisPt = 
           gUtils`gLerp[$CellContext`viewProjPt, $CellContext`lightProjPt, \
$CellContext`viewDist/($CellContext`viewDist + $CellContext`lightDist)]; \
$CellContext`axisPt]; $CellContext`tangentView = Tan[
          ArcCos[
           
           Dot[$CellContext`wallViewDir, $CellContext`wallNormal]]]; \
$CellContext`tangentLight = Tan[
          ArcCos[
           
           Dot[$CellContext`wallLightDir, $CellContext`wallNormal]]]; \
$CellContext`representLight = 
        sgCommon`sgSphereLight[$CellContext`lightCenter, \
$CellContext`lightFadeStart$$, $CellContext`lightFadeEnd$$, \
$CellContext`lightIntensity$$, {$CellContext`shadingPosX$$, 
           0}]; $CellContext`represectNDF = 
        sgCommon`sgNDF[$CellContext`roughness$$, $CellContext`wallLightDir, \
$CellContext`wallViewDir, $CellContext`wallNormal]; \
$CellContext`representEnergy = 
        sgCommon`sgNDFConvLight[
         0, 0, $CellContext`representLight, $CellContext`represectNDF]; 
       gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> 0.1, "color" -> Gray,
              "thickness" -> 0.02], 
            Association[
            "center" -> Slot["lightCenter"], "radius" -> Slot["lightRadius"]], 
            Association[
            "center" -> Slot["eyePoint"], "radius" -> 0.1, "color" -> Magenta,
              "thickness" -> 0.02], 
            Association["center" -> {
               Slot["shadingPosX"], 0}, "radius" -> 0.1, "color" -> Red, 
             "thickness" -> 0.02]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter, 
            "lightRadius" -> $CellContext`lightRadius$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "eyePoint" -> $CellContext`eyePoint$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Green, 
             "thickness" -> 0.015], 
            Association[
            "startPos" -> $CellContext`reflectSgAxisPt, "dirVec" -> {-1, 0}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Red, 
             "thickness" -> 0.02]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("sgRightWallShading" -> {
            Association[
            "lightCenter" -> Slot["lightCenter"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "representCone" -> $CellContext`representCone, 
             "wallXRange" -> {-2, 2}, "wallHeights" -> {
               Slot["leftWallHeight"], 
               Slot["rightWallHeight"]}, "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
             "eyePoint" -> {
               Slot["shadingPosX"], 0}, 
             "sgLightFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
               Slot["roughness"], 
               Slot["lightDir"], 
               Slot["viewDir"], 
               Slot["normalDir"]]& ), 
             "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
               Slot["lightRadius"], 
               Slot["shadingDist"], 
               Slot["sgLight"], 
               Slot["sgNDF"]]& ), "sgPercentStrategy" -> 3, "color" -> Blue, 
             "label" -> "Wall Lighting"]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "lightFadeEnd" -> $CellContext`lightFadeEnd$$, 
            "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight, 
            "roughness" -> $CellContext`roughness$$]], 
          ("sgDisbs" -> {
            Association["disbCenter" -> Slot["center"], "sg" -> {{-1, 0}, 
               
               sgCommon`sgRepresentLambda[$CellContext`tangentLight, \
$CellContext`tangentView], $CellContext`representEnergy}, "color" -> Gray]}& )[
           Association["center" -> $CellContext`reflectSgAxisPt]], 
          "axisExtent" -> 5]]), 
      "Specifications" :> {{{$CellContext`lightCenterX$$, 0}, -6, 
         4}, {{$CellContext`lightCenterY$$, 2}, 0, 
         5}, {{$CellContext`eyePoint$$, {-3, 3}}, {-4, -4}, {4, 
         4}}, {{$CellContext`lightFadeStart$$, 4}, 1, 
         6}, {{$CellContext`lightFadeEnd$$, 10}, 3, 
         20}, {{$CellContext`lightIntensity$$, 2}, 1, 
         10}, {{$CellContext`lightRadius$$, 6}, 1, 
         6}, {{$CellContext`leftWallHeight$$, 0}, 0, 
         5}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`roughness$$, 0.15}, 0.05, 
         1}, {{$CellContext`shadingPosX$$, 0.5}, -2, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{251., {134., 140.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8338645983153625`*^9, 3.8338649415178337`*^9, 
  3.8338653432015285`*^9, 3.8338741993353953`*^9, 3.8339253980649548`*^9, 
  3.8372433138311653`*^9},
 CellLabel->
  "Out[388]=",ExpressionUUID->"d1e602b8-b802-4554-aab2-3424633a54bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", "\"\<Wall reflectance as SG with energy percent\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightCenter", ",", "rightWallHeight", ",", "representPt", ",", 
    "representCone", ",", "tangentView", ",", "tangentLight", ",", 
    "\[IndentingNewLine]", "\t", "representEnergy", ",", "representLight", 
    ",", "represectNDF", ",", "\[IndentingNewLine]", "\t", "groundViewDir", 
    ",", "groundLightDir", ",", "wallNormal", ",", "wallViewDir", ",", 
    "wallLightDir", ",", "reflectSgAxisPt", ",", "disbFunc", ",", 
    "\[IndentingNewLine]", "\t", "representLambda", ",", "representSG", ",", 
    "representThetas", ",", "wallViewDist", ",", "wallEnergyPercent"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"rightWallHeight", "=", "2"}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"lightCenter", "=", 
     RowBox[{"{", 
      RowBox[{"lightCenterX", ",", "lightCenterY"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"representPt", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"rightWallHeight", "/", "2"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallNormal", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"representCone", "=", 
     RowBox[{"gCreateCone", "[", 
      RowBox[{"representPt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "10"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"groundViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"eyePoint", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"groundLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}], "-", "representPt"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"wallViewDist", "=", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}], "-", "representPt"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"wallLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", "representPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"reflectSgAxisPt", "=", 
     RowBox[{"Block", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "viewDist", ",", "lightDist", ",", "viewProjPt", ",", "lightProjPt", 
         ",", "lerpFactor", ",", "axisPt"}], "}"}], ",", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"viewDist", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"shadingPosX", ",", "0"}], "}"}], "-", "representPt"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"lightDist", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"lightCenter", "-", "representPt"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
        RowBox[{"viewProjPt", "=", 
         RowBox[{"{", 
          RowBox[{"2", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"lightProjPt", "=", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"lightCenter", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"axisPt", "=", 
         RowBox[{"gLerp", "[", 
          RowBox[{"viewProjPt", ",", "lightProjPt", ",", 
           RowBox[{"viewDist", "/", 
            RowBox[{"(", 
             RowBox[{"viewDist", "+", "lightDist"}], ")"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", "axisPt"}]}], "\[IndentingNewLine]", 
      "    ", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"tangentView", "=", 
     RowBox[{"Tan", "[", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"Dot", "[", 
        RowBox[{"wallViewDir", ",", "wallNormal"}], "]"}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"tangentLight", "=", 
     RowBox[{"Tan", "[", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"Dot", "[", 
        RowBox[{"wallLightDir", ",", "wallNormal"}], "]"}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"representLight", "=", 
     RowBox[{"sgSphereLight", "[", 
      RowBox[{
      "lightCenter", ",", "lightFadeStart", ",", "lightFadeEnd", ",", 
       "\[IndentingNewLine]", "\t\t", "lightIntensity", ",", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"represectNDF", "=", 
     RowBox[{"sgNDF", "[", 
      RowBox[{
      "roughness", ",", "wallLightDir", ",", "wallViewDir", ",", 
       "wallNormal"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"representEnergy", "=", 
     RowBox[{"sgNDFConvLight", "[", 
      RowBox[{"0", ",", "0", ",", "representLight", ",", "represectNDF"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"representLambda", "=", 
     RowBox[{"sgRepresentLambda", "[", 
      RowBox[{"tangentLight", ",", "tangentView"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"representThetas", "=", 
     RowBox[{"gCalcRepresentThetas", "[", 
      RowBox[{"representPt", ",", 
       RowBox[{"rightWallHeight", "/", "2"}], ",", "wallViewDist", ",", 
       "reflectSgAxisPt", ",", "representLambda"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallEnergyPercent", "=", 
     RowBox[{"sgCalcEnergyPercent", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "representLambda", ",",
          "1"}], "}"}], ",", "representThetas"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"representSG", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "representLambda", ",", 
       RowBox[{"representEnergy", "*", "wallEnergyPercent"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"light", " ", "circle"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"eye", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#eyePoint"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Magenta"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "eyePoint"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"reflect", " ", "sg", " ", "axis", " ", "line"}], "*)"}],
             "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "reflectSgAxisPt"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgRightWallShading\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}],
              ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<representCone\>\"", "\[Rule]", "representCone"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<wallXRange\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<wallHeights\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#leftWallHeight", ",", "#rightWallHeight"}], "}"}]}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
             ",", 
             RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<eyePoint\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgSphereLight", "[", 
                 RowBox[{
                 "#lightCenter", ",", "#lightFadeStart", ",", "#lightFadeEnd",
                   ",", "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",",
                   "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDF", "[", 
                 RowBox[{
                 "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                  "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDFConvLight", "[", 
                 RowBox[{
                 "#lightRadius", ",", "#shadingDist", ",", "#sgLight", ",", 
                  "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgPercentStrategy\>\"", "\[Rule]", "3"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<label\>\"", "\[Rule]", 
              "\"\<Wall Lighting(Energy Percent)\>\""}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}],
           ",", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
          ",", "\t\t", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgDisbs\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<disbCenter\>\"", "\[Rule]", "#center"}], ",", 
             RowBox[{"\"\<sg\>\"", "\[Rule]", "representSG"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{"\"\<center\>\"", "\[Rule]", "reflectSgAxisPt"}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "\t", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenterX", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "6"}], ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenterY", ",", "2"}], "}"}], ",", "0", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eyePoint", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "4"}], "}"}], ",", "1", ",", "6"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "10"}], "}"}], ",", "3", ",", "20"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "2"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "6"}], "}"}], ",", "1", ",", "6"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "0"}], "}"}], ",", "0", ",", "5"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.15"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", "0.5"}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"wallEnergyPercent1", ",", "wallEnergyPercent"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightCenter", ",", "rightWallHeight", ",", "representPt", ",", 
    "representCone", ",", "tangentView", ",", "tangentLight", ",", 
    "\[IndentingNewLine]", "\t", "representEnergy", ",", "representLight", 
    ",", "represectNDF", ",", "\[IndentingNewLine]", "\t", "groundViewDir", 
    ",", "groundLightDir", ",", "wallNormal", ",", "wallViewDir", ",", 
    "wallLightDir", ",", "reflectSgAxisPt", ",", "disbFunc", ",", 
    "\[IndentingNewLine]", "\t", "representLambda", ",", "representSG", ",", 
    "representThetas", ",", "wallViewDist", ",", "wallEnergyPercent"}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.8338576526041346`*^9, 3.8338576557922254`*^9}, 
   3.833863487919369*^9, 3.8339253734248667`*^9},
 CellLabel->
  "In[390]:=",ExpressionUUID->"b4f4500d-c2bf-4d88-9c52-37ea9a7612ad"],

Cell[BoxData[
 StyleBox["\<\" Wall reflectance as SG with energy percent\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8338645985642805`*^9, 3.8338649417896147`*^9, 
  3.8338653434564533`*^9, 3.8338741996361895`*^9, 3.8339253983235393`*^9, 
  3.8372433145208864`*^9},
 CellLabel->
  "During evaluation of \
In[390]:=",ExpressionUUID->"217c6d50-7d13-44bb-81e5-e0ddc9dfc025"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eyePoint$$ = {-3, 
    3}, $CellContext`leftWallHeight$$ = 0, $CellContext`lightCenterX$$ = 
    0, $CellContext`lightCenterY$$ = 2, $CellContext`lightFadeEnd$$ = 
    10, $CellContext`lightFadeStart$$ = 4, $CellContext`lightIntensity$$ = 
    2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
    0.15, $CellContext`shadingPosX$$ = 0.5, $CellContext`viewDir$$ = {1, 
    1}, $CellContext`wallEnergyPercent1$$ = 0.576431939657822, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenterX$$], 0}, -6, 4}, {{
       Hold[$CellContext`lightCenterY$$], 2}, 0, 5}, {{
       Hold[$CellContext`eyePoint$$], {-3, 3}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightFadeStart$$], 4}, 1, 6}, {{
       Hold[$CellContext`lightFadeEnd$$], 10}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 2}, 1, 10}, {{
       Hold[$CellContext`lightRadius$$], 6}, 1, 6}, {{
       Hold[$CellContext`leftWallHeight$$], 0}, 0, 5}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`roughness$$], 0.15}, 0.05, 1}, {{
       Hold[$CellContext`shadingPosX$$], 0.5}, -2, 2}, {
      Hold[$CellContext`wallEnergyPercent1$$], 0.576431939657822}}, 
    Typeset`size$$ = {314., {110., 116.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`lightCenterX$297541$$ = 
    0, $CellContext`lightCenterY$297542$$ = 
    0, $CellContext`eyePoint$297543$$ = {0, 
    0}, $CellContext`lightFadeStart$297544$$ = 
    0, $CellContext`lightFadeEnd$297545$$ = 
    0, $CellContext`lightIntensity$297546$$ = 
    0, $CellContext`lightRadius$297547$$ = 
    0, $CellContext`viewDir$297548$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`eyePoint$$ = {-3, 
         3}, $CellContext`leftWallHeight$$ = 0, $CellContext`lightCenterX$$ = 
        0, $CellContext`lightCenterY$$ = 2, $CellContext`lightFadeEnd$$ = 
        10, $CellContext`lightFadeStart$$ = 4, $CellContext`lightIntensity$$ = 
        2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
        0.15, $CellContext`shadingPosX$$ = 
        0.5, $CellContext`viewDir$$ = {1, 
         1}, $CellContext`wallEnergyPercent1$$ = \
$CellContext`wallEnergyPercent}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenterX$$, $CellContext`lightCenterX$297541$$, 
         0], 
        Hold[$CellContext`lightCenterY$$, $CellContext`lightCenterY$297542$$, 
         0], 
        Hold[$CellContext`eyePoint$$, $CellContext`eyePoint$297543$$, {0, 0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$297544$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$297545$$, 
         0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$297546$$, 0], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$297547$$, 
         0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$297548$$, {0, 0}]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`rightWallHeight = 
        2; $CellContext`lightCenter = {$CellContext`lightCenterX$$, \
$CellContext`lightCenterY$$}; $CellContext`representPt = {
         2, $CellContext`rightWallHeight/2}; $CellContext`wallNormal = {-1, 
         0}; $CellContext`representCone = 
        gUtils`gCreateCone[$CellContext`representPt, {-2, \
$CellContext`leftWallHeight$$}, {2, 10}]; $CellContext`groundViewDir = 
        Normalize[$CellContext`eyePoint$$ - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`groundLightDir = 
        Normalize[$CellContext`lightCenter - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`wallViewDir = 
        Normalize[{$CellContext`shadingPosX$$, 
            0} - $CellContext`representPt]; $CellContext`wallViewDist = 
        Norm[{$CellContext`shadingPosX$$, 
            0} - $CellContext`representPt]; $CellContext`wallLightDir = 
        Normalize[$CellContext`lightCenter - $CellContext`representPt]; \
$CellContext`reflectSgAxisPt = 
        Block[{$CellContext`viewDist, $CellContext`lightDist, \
$CellContext`viewProjPt, $CellContext`lightProjPt, $CellContext`lerpFactor, \
$CellContext`axisPt}, $CellContext`viewDist = 
           Dot[{$CellContext`shadingPosX$$, 
               0} - $CellContext`representPt, {-1, 
             0}]; $CellContext`lightDist = 
           Dot[$CellContext`lightCenter - $CellContext`representPt, {-1, 
             0}]; $CellContext`viewProjPt = {2, 
            0}; $CellContext`lightProjPt = {2, 
             Part[$CellContext`lightCenter, 2]}; $CellContext`axisPt = 
           gUtils`gLerp[$CellContext`viewProjPt, $CellContext`lightProjPt, \
$CellContext`viewDist/($CellContext`viewDist + $CellContext`lightDist)]; \
$CellContext`axisPt]; $CellContext`tangentView = Tan[
          ArcCos[
           
           Dot[$CellContext`wallViewDir, $CellContext`wallNormal]]]; \
$CellContext`tangentLight = Tan[
          ArcCos[
           
           Dot[$CellContext`wallLightDir, $CellContext`wallNormal]]]; \
$CellContext`representLight = 
        sgCommon`sgSphereLight[$CellContext`lightCenter, \
$CellContext`lightFadeStart$$, $CellContext`lightFadeEnd$$, \
$CellContext`lightIntensity$$, {$CellContext`shadingPosX$$, 
           0}]; $CellContext`represectNDF = 
        sgCommon`sgNDF[$CellContext`roughness$$, $CellContext`wallLightDir, \
$CellContext`wallViewDir, $CellContext`wallNormal]; \
$CellContext`representEnergy = 
        sgCommon`sgNDFConvLight[
         0, 0, $CellContext`representLight, $CellContext`represectNDF]; \
$CellContext`representLambda = 
        sgCommon`sgRepresentLambda[$CellContext`tangentLight, \
$CellContext`tangentView]; $CellContext`representThetas = 
        gSphericalCap`gCalcRepresentThetas[$CellContext`representPt, \
$CellContext`rightWallHeight/
          2, $CellContext`wallViewDist, $CellContext`reflectSgAxisPt, \
$CellContext`representLambda]; $CellContext`wallEnergyPercent = 
        sgCommon`sgCalcEnergyPercent[{{-1, 0}, $CellContext`representLambda, 
           1}, $CellContext`representThetas]; $CellContext`representSG = {{-1,
           0}, $CellContext`representLambda, $CellContext`representEnergy \
$CellContext`wallEnergyPercent}; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> 0.1, "color" -> Gray,
              "thickness" -> 0.02], 
            Association[
            "center" -> Slot["lightCenter"], "radius" -> Slot["lightRadius"]], 
            Association[
            "center" -> Slot["eyePoint"], "radius" -> 0.1, "color" -> Magenta,
              "thickness" -> 0.02], 
            Association["center" -> {
               Slot["shadingPosX"], 0}, "radius" -> 0.1, "color" -> Red, 
             "thickness" -> 0.02]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter, 
            "lightRadius" -> $CellContext`lightRadius$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "eyePoint" -> $CellContext`eyePoint$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Green, 
             "thickness" -> 0.015], 
            Association[
            "startPos" -> $CellContext`reflectSgAxisPt, "dirVec" -> {-1, 0}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Red, 
             "thickness" -> 0.02]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("sgRightWallShading" -> {
            Association[
            "lightCenter" -> Slot["lightCenter"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "representCone" -> $CellContext`representCone, 
             "wallXRange" -> {-2, 2}, "wallHeights" -> {
               Slot["leftWallHeight"], 
               Slot["rightWallHeight"]}, "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
             "eyePoint" -> {
               Slot["shadingPosX"], 0}, 
             "sgLightFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
               Slot["roughness"], 
               Slot["lightDir"], 
               Slot["viewDir"], 
               Slot["normalDir"]]& ), 
             "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
               Slot["lightRadius"], 
               Slot["shadingDist"], 
               Slot["sgLight"], 
               Slot["sgNDF"]]& ), "sgPercentStrategy" -> 3, "color" -> Blue, 
             "label" -> "Wall Lighting(Energy Percent)"]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "lightFadeEnd" -> $CellContext`lightFadeEnd$$, 
            "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight, 
            "roughness" -> $CellContext`roughness$$]], 
          ("sgDisbs" -> {
            Association[
            "disbCenter" -> Slot["center"], "sg" -> $CellContext`representSG, 
             "color" -> Gray]}& )[
           Association["center" -> $CellContext`reflectSgAxisPt]], 
          "axisExtent" -> 5]]), 
      "Specifications" :> {{{$CellContext`lightCenterX$$, 0}, -6, 
         4}, {{$CellContext`lightCenterY$$, 2}, 0, 
         5}, {{$CellContext`eyePoint$$, {-3, 3}}, {-4, -4}, {4, 
         4}}, {{$CellContext`lightFadeStart$$, 4}, 1, 
         6}, {{$CellContext`lightFadeEnd$$, 10}, 3, 
         20}, {{$CellContext`lightIntensity$$, 2}, 1, 
         10}, {{$CellContext`lightRadius$$, 6}, 1, 
         6}, {{$CellContext`leftWallHeight$$, 0}, 0, 
         5}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`roughness$$, 0.15}, 0.05, 
         1}, {{$CellContext`shadingPosX$$, 0.5}, -2, 
         2}, {$CellContext`wallEnergyPercent1$$, \
$CellContext`wallEnergyPercent}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{365., {134., 140.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.833864598585245*^9, 3.833864941823618*^9, 
  3.833865343485325*^9, 3.8338741996671047`*^9, 3.8339253983519964`*^9, 
  3.8372433145521255`*^9},
 CellLabel->
  "Out[392]=",ExpressionUUID->"8fb75ab3-3893-43f1-b26a-e48a7ef28cab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Wrap function[sgReflectLight2D]\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightCenter", ",", "rightWallHeight", ",", "representPt", ",", 
    "representCone", ",", "tangentView", ",", "tangentLight", ",", 
    "\[IndentingNewLine]", "\t", "representEnergy", ",", "representLight", 
    ",", "represectNDF", ",", "representSolved", ",", "\[IndentingNewLine]", 
    "\t", "groundViewDir", ",", "groundLightDir", ",", "wallNormal", ",", 
    "wallViewDir", ",", "wallLightDir", ",", "reflectSgAxisPt", ",", 
    "disbFunc", ",", "\[IndentingNewLine]", "\t", "representLambda", ",", 
    "representSG", ",", "representThetas", ",", "wallViewDist", ",", 
    "wallEnergyPercent"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"rightWallHeight", "=", "2"}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"lightCenter", "=", 
     RowBox[{"{", 
      RowBox[{"lightCenterX", ",", "lightCenterY"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"representPt", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"rightWallHeight", "/", "2"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallNormal", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"representCone", "=", 
     RowBox[{"gCreateCone", "[", 
      RowBox[{"representPt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "10"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"groundViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"eyePoint", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"groundLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}], "-", "representPt"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"wallViewDist", "=", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}], "-", "representPt"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"wallLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", "representPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"reflectSgAxisPt", "=", 
     RowBox[{"Block", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "viewDist", ",", "lightDist", ",", "viewProjPt", ",", "lightProjPt", 
         ",", "lerpFactor", ",", "axisPt"}], "}"}], ",", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"viewDist", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"shadingPosX", ",", "0"}], "}"}], "-", "representPt"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"lightDist", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"lightCenter", "-", "representPt"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
        RowBox[{"viewProjPt", "=", 
         RowBox[{"{", 
          RowBox[{"2", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"lightProjPt", "=", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"lightCenter", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
        RowBox[{"axisPt", "=", 
         RowBox[{"gLerp", "[", 
          RowBox[{"viewProjPt", ",", "lightProjPt", ",", 
           RowBox[{"viewDist", "/", 
            RowBox[{"(", 
             RowBox[{"viewDist", "+", "lightDist"}], ")"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", "axisPt"}]}], "\[IndentingNewLine]", 
      "    ", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"tangentView", "=", 
     RowBox[{"Tan", "[", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"Dot", "[", 
        RowBox[{"wallViewDir", ",", "wallNormal"}], "]"}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"tangentLight", "=", 
     RowBox[{"Tan", "[", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"Dot", "[", 
        RowBox[{"wallLightDir", ",", "wallNormal"}], "]"}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"representLight", "=", 
     RowBox[{"sgSphereLight", "[", 
      RowBox[{
      "lightCenter", ",", "lightFadeStart", ",", "lightFadeEnd", ",", 
       "\[IndentingNewLine]", "\t\t", "lightIntensity", ",", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"represectNDF", "=", 
     RowBox[{"sgNDF", "[", 
      RowBox[{
      "roughness", ",", "wallLightDir", ",", "wallViewDir", ",", 
       "wallNormal"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"representEnergy", "=", 
     RowBox[{"sgNDFConvLight", "[", 
      RowBox[{"0", ",", "0", ",", "representLight", ",", "represectNDF"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"representLambda", "=", 
     RowBox[{"sgRepresentLambda", "[", 
      RowBox[{"tangentLight", ",", "tangentView"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"representThetas", "=", 
     RowBox[{"gCalcRepresentThetas", "[", 
      RowBox[{"representPt", ",", 
       RowBox[{"rightWallHeight", "/", "2"}], ",", "wallViewDist", ",", 
       "reflectSgAxisPt", ",", "representLambda"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallEnergyPercent", "=", 
     RowBox[{"sgCalcEnergyPercent", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "representLambda", ",",
          "1"}], "}"}], ",", "representThetas"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"representSG", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "representLambda", ",", 
       RowBox[{"representEnergy", "*", "wallEnergyPercent"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"representSolved", "=", 
     RowBox[{"sgReflectLight2D", "[", 
      RowBox[{"representPt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
       RowBox[{"rightWallHeight", "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
       "\t\t", "lightCenter", ",", "lightFadeStart", ",", "lightFadeEnd", ",",
        "lightIntensity", ",", "roughness"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"representSG2", "=", 
     RowBox[{"representSolved", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\"\<circles\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"light", " ", "circle"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], 
              "|>"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"eye", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "#eyePoint"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Magenta"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"shading", " ", "point"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}]}], 
            "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
           RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
           RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "eyePoint"}]}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<lines\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"reflect", " ", "sg", " ", "axis", " ", "line"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", "reflectSgAxisPt"}], 
               ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}]}], 
            "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
           ",", 
           RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<sgRightWallShading\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", " ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",",
               "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<representCone\>\"", "\[Rule]", "representCone"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallXRange\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallHeights\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#leftWallHeight", ",", "#rightWallHeight"}], "}"}]}],
               ",", "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
              ",", 
              RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<eyePoint\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgSphereLight", "[", 
                  RowBox[{
                  "#lightCenter", ",", "#lightFadeStart", ",", 
                   "#lightFadeEnd", ",", "\[IndentingNewLine]", "\t\t", 
                   "#lightIntensity", ",", "#shadingPos"}], "]"}], "&"}], 
                ")"}]}], ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDF", "[", 
                  RowBox[{
                  "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                   "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDFConvLight", "[", 
                  RowBox[{
                  "#lightRadius", ",", "#shadingDist", ",", "#sgLight", ",", 
                   "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgPercentStrategy\>\"", "\[Rule]", "3"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", 
               "\"\<Wall Lighting(Energy Percent)\>\""}]}], "|>"}], 
            "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
           ",", 
           RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
           "\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}], ",", 
           RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
           ",", 
           RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
           ",", "\t\t", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
         "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgDisbs\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<disbCenter\>\"", "\[Rule]", "#center"}], ",", 
              RowBox[{"\"\<sg\>\"", "\[Rule]", "representSG"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.03"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<disbCenter\>\"", "\[Rule]", "#center"}], ",", 
              RowBox[{"\"\<sg\>\"", "\[Rule]", "representSG2"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{"\"\<center\>\"", "\[Rule]", "reflectSgAxisPt"}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "\t", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenterX", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "6"}], ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenterY", ",", "1"}], "}"}], ",", "0", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eyePoint", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "4"}], "}"}], ",", "1", ",", "6"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "10"}], "}"}], ",", "3", ",", "20"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "2"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "6"}], "}"}], ",", "1", ",", "6"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "0"}], "}"}], ",", "0", ",", "5"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.15"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", "0.5"}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"wallEnergyPercent1", ",", "wallEnergyPercent"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightCenter", ",", "rightWallHeight", ",", "representPt", ",", 
    "representCone", ",", "tangentView", ",", "tangentLight", ",", 
    "\[IndentingNewLine]", "\t", "representEnergy", ",", "representLight", 
    ",", "represectNDF", ",", "\[IndentingNewLine]", "\t", "groundViewDir", 
    ",", "groundLightDir", ",", "wallNormal", ",", "wallViewDir", ",", 
    "wallLightDir", ",", "reflectSgAxisPt", ",", "disbFunc", ",", 
    "\[IndentingNewLine]", "\t", "representLambda", ",", "representSG", ",", 
    "representThetas", ",", "wallViewDist", ",", "wallEnergyPercent"}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.83386409207434*^9, 3.8338641149459453`*^9}, {
   3.8338643892958283`*^9, 3.8338643893008146`*^9}, {3.833865368517728*^9, 
   3.833865387451644*^9}, 3.8339253835007353`*^9, {3.8358521587021723`*^9, 
   3.8358521626088133`*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"8a1ced88-e0a2-44f9-8fdb-2dc9e4b665e4"],

Cell[BoxData[
 StyleBox["\<\" Wrap function[sgReflectLight2D]\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8338649420998397`*^9, 3.8338653437512054`*^9, 
  3.833865388701087*^9, 3.8338741999643984`*^9, 3.8339253986171827`*^9, 
  3.8372433151595383`*^9},
 CellLabel->
  "During evaluation of \
In[394]:=",ExpressionUUID->"5ef6adf6-6cfa-4568-8c73-968e2f4f0ab7"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eyePoint$$ = {-3, 
    3}, $CellContext`leftWallHeight$$ = 0, $CellContext`lightCenterX$$ = 
    0, $CellContext`lightCenterY$$ = 1, $CellContext`lightFadeEnd$$ = 
    10, $CellContext`lightFadeStart$$ = 4, $CellContext`lightIntensity$$ = 
    2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
    0.15, $CellContext`shadingPosX$$ = 0.5, $CellContext`viewDir$$ = {1, 
    1}, $CellContext`wallEnergyPercent1$$ = 0.9998866144222746, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenterX$$], 0}, -6, 4}, {{
       Hold[$CellContext`lightCenterY$$], 1}, 0, 5}, {{
       Hold[$CellContext`eyePoint$$], {-3, 3}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightFadeStart$$], 4}, 1, 6}, {{
       Hold[$CellContext`lightFadeEnd$$], 10}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 2}, 1, 10}, {{
       Hold[$CellContext`lightRadius$$], 6}, 1, 6}, {{
       Hold[$CellContext`leftWallHeight$$], 0}, 0, 5}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`roughness$$], 0.15}, 0.05, 1}, {{
       Hold[$CellContext`shadingPosX$$], 0.5}, -2, 2}, {
      Hold[$CellContext`wallEnergyPercent1$$], 0.9998866144222746}}, 
    Typeset`size$$ = {146., {47., 53.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`lightCenterX$300113$$ = 
    0, $CellContext`lightCenterY$300114$$ = 
    0, $CellContext`eyePoint$300115$$ = {0, 
    0}, $CellContext`lightFadeStart$300116$$ = 
    0, $CellContext`lightFadeEnd$300117$$ = 
    0, $CellContext`lightIntensity$300118$$ = 
    0, $CellContext`lightRadius$300119$$ = 
    0, $CellContext`viewDir$300120$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`eyePoint$$ = {-3, 
         3}, $CellContext`leftWallHeight$$ = 0, $CellContext`lightCenterX$$ = 
        0, $CellContext`lightCenterY$$ = 1, $CellContext`lightFadeEnd$$ = 
        10, $CellContext`lightFadeStart$$ = 4, $CellContext`lightIntensity$$ = 
        2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
        0.15, $CellContext`shadingPosX$$ = 
        0.5, $CellContext`viewDir$$ = {1, 
         1}, $CellContext`wallEnergyPercent1$$ = \
$CellContext`wallEnergyPercent}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenterX$$, $CellContext`lightCenterX$300113$$, 
         0], 
        Hold[$CellContext`lightCenterY$$, $CellContext`lightCenterY$300114$$, 
         0], 
        Hold[$CellContext`eyePoint$$, $CellContext`eyePoint$300115$$, {0, 0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$300116$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$300117$$, 
         0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$300118$$, 0], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$300119$$, 
         0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$300120$$, {0, 0}]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`rightWallHeight = 
        2; $CellContext`lightCenter = {$CellContext`lightCenterX$$, \
$CellContext`lightCenterY$$}; $CellContext`representPt = {
         2, $CellContext`rightWallHeight/2}; $CellContext`wallNormal = {-1, 
         0}; $CellContext`representCone = 
        gUtils`gCreateCone[$CellContext`representPt, {-2, \
$CellContext`leftWallHeight$$}, {2, 10}]; $CellContext`groundViewDir = 
        Normalize[$CellContext`eyePoint$$ - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`groundLightDir = 
        Normalize[$CellContext`lightCenter - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`wallViewDir = 
        Normalize[{$CellContext`shadingPosX$$, 
            0} - $CellContext`representPt]; $CellContext`wallViewDist = 
        Norm[{$CellContext`shadingPosX$$, 
            0} - $CellContext`representPt]; $CellContext`wallLightDir = 
        Normalize[$CellContext`lightCenter - $CellContext`representPt]; \
$CellContext`reflectSgAxisPt = 
        Block[{$CellContext`viewDist, $CellContext`lightDist, \
$CellContext`viewProjPt, $CellContext`lightProjPt, $CellContext`lerpFactor, \
$CellContext`axisPt}, $CellContext`viewDist = 
           Dot[{$CellContext`shadingPosX$$, 
               0} - $CellContext`representPt, {-1, 
             0}]; $CellContext`lightDist = 
           Dot[$CellContext`lightCenter - $CellContext`representPt, {-1, 
             0}]; $CellContext`viewProjPt = {2, 
            0}; $CellContext`lightProjPt = {2, 
             Part[$CellContext`lightCenter, 2]}; $CellContext`axisPt = 
           gUtils`gLerp[$CellContext`viewProjPt, $CellContext`lightProjPt, \
$CellContext`viewDist/($CellContext`viewDist + $CellContext`lightDist)]; \
$CellContext`axisPt]; $CellContext`tangentView = Tan[
          ArcCos[
           
           Dot[$CellContext`wallViewDir, $CellContext`wallNormal]]]; \
$CellContext`tangentLight = Tan[
          ArcCos[
           
           Dot[$CellContext`wallLightDir, $CellContext`wallNormal]]]; \
$CellContext`representLight = 
        sgCommon`sgSphereLight[$CellContext`lightCenter, \
$CellContext`lightFadeStart$$, $CellContext`lightFadeEnd$$, \
$CellContext`lightIntensity$$, {$CellContext`shadingPosX$$, 
           0}]; $CellContext`represectNDF = 
        sgCommon`sgNDF[$CellContext`roughness$$, $CellContext`wallLightDir, \
$CellContext`wallViewDir, $CellContext`wallNormal]; \
$CellContext`representEnergy = 
        sgCommon`sgNDFConvLight[
         0, 0, $CellContext`representLight, $CellContext`represectNDF]; \
$CellContext`representLambda = 
        sgCommon`sgRepresentLambda[$CellContext`tangentLight, \
$CellContext`tangentView]; $CellContext`representThetas = 
        gSphericalCap`gCalcRepresentThetas[$CellContext`representPt, \
$CellContext`rightWallHeight/
          2, $CellContext`wallViewDist, $CellContext`reflectSgAxisPt, \
$CellContext`representLambda]; $CellContext`wallEnergyPercent = 
        sgCommon`sgCalcEnergyPercent[{{-1, 0}, $CellContext`representLambda, 
           1}, $CellContext`representThetas]; $CellContext`representSG = {{-1,
           0}, $CellContext`representLambda, $CellContext`representEnergy \
$CellContext`wallEnergyPercent}; $CellContext`representSolved = 
        sgCommon`sgReflectLight2D[$CellContext`representPt, {-1, 
          0}, $CellContext`rightWallHeight/
          2, {$CellContext`shadingPosX$$, 
           0}, $CellContext`lightCenter, $CellContext`lightFadeStart$$, \
$CellContext`lightFadeEnd$$, $CellContext`lightIntensity$$, \
$CellContext`roughness$$]; $CellContext`representSG2 = 
        Part[$CellContext`representSolved, 2]; gPlots`gParamPlot[
         Association[
          ("sgDisbs" -> {
            Association[
            "disbCenter" -> Slot["center"], "sg" -> $CellContext`representSG, 
             "color" -> Gray, "thickness" -> 0.03], 
            Association[
            "disbCenter" -> Slot["center"], "sg" -> $CellContext`representSG2,
              "color" -> Red]}& )[
           Association["center" -> $CellContext`reflectSgAxisPt]], 
          "axisExtent" -> 5]]), 
      "Specifications" :> {{{$CellContext`lightCenterX$$, 0}, -6, 
         4}, {{$CellContext`lightCenterY$$, 1}, 0, 
         5}, {{$CellContext`eyePoint$$, {-3, 3}}, {-4, -4}, {4, 
         4}}, {{$CellContext`lightFadeStart$$, 4}, 1, 
         6}, {{$CellContext`lightFadeEnd$$, 10}, 3, 
         20}, {{$CellContext`lightIntensity$$, 2}, 1, 
         10}, {{$CellContext`lightRadius$$, 6}, 1, 
         6}, {{$CellContext`leftWallHeight$$, 0}, 0, 
         5}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`roughness$$, 0.15}, 0.05, 
         1}, {{$CellContext`shadingPosX$$, 0.5}, -2, 
         2}, {$CellContext`wallEnergyPercent1$$, \
$CellContext`wallEnergyPercent}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{197., {71., 77.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8338645988646336`*^9, {3.833864938491048*^9, 3.8338649421238084`*^9}, 
   3.833865343783553*^9, 3.8338653887270193`*^9, 3.833874199998308*^9, 
   3.8339253986500945`*^9, 3.837243315192606*^9},
 CellLabel->
  "Out[396]=",ExpressionUUID->"be39b92c-8152-40ac-a151-94c70b4096b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", "\"\<Encapsuled function[sgReflectLight2D]\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightCenter", ",", "rightWallHeight", ",", "representPt", ",", 
    "representCone", ",", "repSgSolved", ",", "\[IndentingNewLine]", "\t", 
    "wallNormal", ",", "reflectSgAxisPt", ",", "representSG"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"rightWallHeight", "=", "2"}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"lightCenter", "=", 
     RowBox[{"{", 
      RowBox[{"lightCenterX", ",", "lightCenterY"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"representPt", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"rightWallHeight", "/", "2"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallNormal", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"representCone", "=", 
     RowBox[{"gCreateCone", "[", 
      RowBox[{"representPt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "10"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"repSgSolved", "=", 
     RowBox[{"sgReflectLight2D", "[", 
      RowBox[{"representPt", ",", "wallNormal", ",", 
       RowBox[{"rightWallHeight", "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
       "\t\t", "lightCenter", ",", "lightFadeStart", ",", "lightFadeEnd", ",",
        "lightIntensity", ",", "roughness"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"reflectSgAxisPt", "=", 
     RowBox[{"repSgSolved", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"representSG", "=", 
     RowBox[{"repSgSolved", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"light", " ", "circle"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"eye", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#eyePoint"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Magenta"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "eyePoint"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"reflect", " ", "sg", " ", "axis", " ", "line"}], "*)"}],
             "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "reflectSgAxisPt"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgRightWallShading\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}],
              ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<representCone\>\"", "\[Rule]", "representCone"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<wallXRange\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<wallHeights\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#leftWallHeight", ",", "#rightWallHeight"}], "}"}]}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
             ",", 
             RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<eyePoint\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgSphereLight", "[", 
                 RowBox[{
                 "#lightCenter", ",", "#lightFadeStart", ",", "#lightFadeEnd",
                   ",", "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",",
                   "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDF", "[", 
                 RowBox[{
                 "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                  "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDFConvLight", "[", 
                 RowBox[{
                 "#lightRadius", ",", "#shadingDist", ",", "#sgLight", ",", 
                  "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgPercentStrategy\>\"", "\[Rule]", "3"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<label\>\"", "\[Rule]", 
              "\"\<Wall Lighting(Energy Percent)\>\""}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}],
           ",", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
          ",", "\t\t", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgDisbs\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<disbCenter\>\"", "\[Rule]", "#center"}], ",", 
             RowBox[{"\"\<sg\>\"", "\[Rule]", "representSG"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{"\"\<center\>\"", "\[Rule]", "reflectSgAxisPt"}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "\t", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenterX", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "6"}], ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenterY", ",", "2"}], "}"}], ",", "0", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eyePoint", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "4"}], "}"}], ",", "1", ",", "6"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "10"}], "}"}], ",", "3", ",", "20"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "2"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "6"}], "}"}], ",", "1", ",", "6"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "0"}], "}"}], ",", "0", ",", "5"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.15"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", "0.5"}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightCenter", ",", "rightWallHeight", ",", "representPt", ",", 
    "representCone", ",", "repSgSolved", ",", "\[IndentingNewLine]", "\t", 
    "wallNormal", ",", "reflectSgAxisPt", ",", "representSG"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8338772452584085`*^9, 3.833877249697301*^9}, {
   3.833877725951251*^9, 3.833877730114359*^9}, {3.8339251721385427`*^9, 
   3.8339251729136686`*^9}, 3.833925392375128*^9, {3.8358521502970657`*^9, 
   3.835852152440369*^9}},
 CellLabel->
  "In[398]:=",ExpressionUUID->"f4d2e5ea-ac60-432b-8223-9ba7b7d3e276"],

Cell[BoxData[
 StyleBox["\<\" Encapsuled function[sgReflectLight2D]\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.833874216910981*^9, 3.8338772504567485`*^9, {3.8338777222115335`*^9, 
   3.833877731379384*^9}, 3.833925178655097*^9, 3.8339253987658997`*^9, 
   3.83724331543515*^9},
 CellLabel->
  "During evaluation of \
In[398]:=",ExpressionUUID->"3446bd77-c06f-4c8c-8bb6-336a6e78bcb4"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eyePoint$$ = {-3, 
    3}, $CellContext`leftWallHeight$$ = 0, $CellContext`lightCenterX$$ = 
    0, $CellContext`lightCenterY$$ = 2, $CellContext`lightFadeEnd$$ = 
    10, $CellContext`lightFadeStart$$ = 4, $CellContext`lightIntensity$$ = 
    2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
    0.15, $CellContext`shadingPosX$$ = 0.5, $CellContext`viewDir$$ = {1, 1}, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenterX$$], 0}, -6, 4}, {{
       Hold[$CellContext`lightCenterY$$], 2}, 0, 5}, {{
       Hold[$CellContext`eyePoint$$], {-3, 3}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightFadeStart$$], 4}, 1, 6}, {{
       Hold[$CellContext`lightFadeEnd$$], 10}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 2}, 1, 10}, {{
       Hold[$CellContext`lightRadius$$], 6}, 1, 6}, {{
       Hold[$CellContext`leftWallHeight$$], 0}, 0, 5}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`roughness$$], 0.15}, 0.05, 1}, {{
       Hold[$CellContext`shadingPosX$$], 0.5}, -2, 2}}, Typeset`size$$ = {
    314., {110., 116.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenterX$300346$$ = 
    0, $CellContext`lightCenterY$300347$$ = 
    0, $CellContext`eyePoint$300348$$ = {0, 
    0}, $CellContext`lightFadeStart$300349$$ = 
    0, $CellContext`lightFadeEnd$300350$$ = 
    0, $CellContext`lightIntensity$300351$$ = 
    0, $CellContext`lightRadius$300352$$ = 
    0, $CellContext`viewDir$300353$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`eyePoint$$ = {-3, 
         3}, $CellContext`leftWallHeight$$ = 0, $CellContext`lightCenterX$$ = 
        0, $CellContext`lightCenterY$$ = 2, $CellContext`lightFadeEnd$$ = 
        10, $CellContext`lightFadeStart$$ = 4, $CellContext`lightIntensity$$ = 
        2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
        0.15, $CellContext`shadingPosX$$ = 
        0.5, $CellContext`viewDir$$ = {1, 1}}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenterX$$, $CellContext`lightCenterX$300346$$, 
         0], 
        Hold[$CellContext`lightCenterY$$, $CellContext`lightCenterY$300347$$, 
         0], 
        Hold[$CellContext`eyePoint$$, $CellContext`eyePoint$300348$$, {0, 0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$300349$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$300350$$, 
         0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$300351$$, 0], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$300352$$, 
         0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$300353$$, {0, 0}]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`rightWallHeight = 
        2; $CellContext`lightCenter = {$CellContext`lightCenterX$$, \
$CellContext`lightCenterY$$}; $CellContext`representPt = {
         2, $CellContext`rightWallHeight/2}; $CellContext`wallNormal = {-1, 
         0}; $CellContext`representCone = 
        gUtils`gCreateCone[$CellContext`representPt, {-2, \
$CellContext`leftWallHeight$$}, {2, 10}]; $CellContext`repSgSolved = 
        sgCommon`sgReflectLight2D[$CellContext`representPt, \
$CellContext`wallNormal, $CellContext`rightWallHeight/
          2, {$CellContext`shadingPosX$$, 
           0}, $CellContext`lightCenter, $CellContext`lightFadeStart$$, \
$CellContext`lightFadeEnd$$, $CellContext`lightIntensity$$, \
$CellContext`roughness$$]; $CellContext`reflectSgAxisPt = 
        Part[$CellContext`repSgSolved, 1]; $CellContext`representSG = 
        Part[$CellContext`repSgSolved, 2]; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> 0.1, "color" -> Gray,
              "thickness" -> 0.02], 
            Association[
            "center" -> Slot["lightCenter"], "radius" -> Slot["lightRadius"]], 
            Association[
            "center" -> Slot["eyePoint"], "radius" -> 0.1, "color" -> Magenta,
              "thickness" -> 0.02], 
            Association["center" -> {
               Slot["shadingPosX"], 0}, "radius" -> 0.1, "color" -> Red, 
             "thickness" -> 0.02]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter, 
            "lightRadius" -> $CellContext`lightRadius$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "eyePoint" -> $CellContext`eyePoint$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Green, 
             "thickness" -> 0.015], 
            Association[
            "startPos" -> $CellContext`reflectSgAxisPt, "dirVec" -> {-1, 0}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Red, 
             "thickness" -> 0.02]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("sgRightWallShading" -> {
            Association[
            "lightCenter" -> Slot["lightCenter"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "representCone" -> $CellContext`representCone, 
             "wallXRange" -> {-2, 2}, "wallHeights" -> {
               Slot["leftWallHeight"], 
               Slot["rightWallHeight"]}, "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
             "eyePoint" -> {
               Slot["shadingPosX"], 0}, 
             "sgLightFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
               Slot["roughness"], 
               Slot["lightDir"], 
               Slot["viewDir"], 
               Slot["normalDir"]]& ), 
             "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
               Slot["lightRadius"], 
               Slot["shadingDist"], 
               Slot["sgLight"], 
               Slot["sgNDF"]]& ), "sgPercentStrategy" -> 3, "color" -> Blue, 
             "label" -> "Wall Lighting(Energy Percent)"]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "lightFadeEnd" -> $CellContext`lightFadeEnd$$, 
            "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight, 
            "roughness" -> $CellContext`roughness$$]], 
          ("sgDisbs" -> {
            Association[
            "disbCenter" -> Slot["center"], "sg" -> $CellContext`representSG, 
             "color" -> Gray]}& )[
           Association["center" -> $CellContext`reflectSgAxisPt]], 
          "axisExtent" -> 5]]), 
      "Specifications" :> {{{$CellContext`lightCenterX$$, 0}, -6, 
         4}, {{$CellContext`lightCenterY$$, 2}, 0, 
         5}, {{$CellContext`eyePoint$$, {-3, 3}}, {-4, -4}, {4, 
         4}}, {{$CellContext`lightFadeStart$$, 4}, 1, 
         6}, {{$CellContext`lightFadeEnd$$, 10}, 3, 
         20}, {{$CellContext`lightIntensity$$, 2}, 1, 
         10}, {{$CellContext`lightRadius$$, 6}, 1, 
         6}, {{$CellContext`leftWallHeight$$, 0}, 0, 
         5}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`roughness$$, 0.15}, 0.05, 
         1}, {{$CellContext`shadingPosX$$, 0.5}, -2, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{365., {134., 140.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.833874216960848*^9, 3.833877250504281*^9, {3.833877722240485*^9, 
   3.8338777314252605`*^9}, 3.833925178683048*^9, 3.8339253987997746`*^9, 
   3.837243315467235*^9},
 CellLabel->
  "Out[400]=",ExpressionUUID->"de7717b0-a649-4062-9748-4a24765de55f"]
}, Open  ]]
},
WindowSize->{1083, 662},
WindowMargins->{{Automatic, 330}, {8, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5731, 153, 713, "Input",ExpressionUUID->"54e5a7de-9769-4fec-8c4d-39d3dc27ee9d"],
Cell[CellGroupData[{
Cell[6336, 179, 427, 10, 30, "Print",ExpressionUUID->"b02d4168-5605-4e1a-9ab7-9a9df959e03e"],
Cell[6766, 191, 426, 10, 30, "Print",ExpressionUUID->"1f0fa599-9b64-4e36-b939-fb4c41d8af46"],
Cell[7195, 203, 924, 27, 44, "Print",ExpressionUUID->"a902060a-c7df-4144-8428-0e5890559e2e"],
Cell[8122, 232, 442, 10, 30, "Print",ExpressionUUID->"49fd4288-2736-4045-bb95-8a3b724e6a03"],
Cell[8567, 244, 455, 11, 30, "Print",ExpressionUUID->"bae0572d-1fca-42da-97d9-39be88373cd2"],
Cell[9025, 257, 423, 10, 30, "Print",ExpressionUUID->"0d6add40-dcc3-4ddc-8a2c-5cfd93e2622c"],
Cell[9451, 269, 423, 10, 30, "Print",ExpressionUUID->"82611535-1074-47f2-be23-b7d7be62dc2a"],
Cell[9877, 281, 716, 19, 44, "Print",ExpressionUUID->"20422fa9-82e3-440d-acbf-346efc2fdef8"],
Cell[10596, 302, 443, 10, 30, "Print",ExpressionUUID->"0ff84632-26be-44fd-84ab-d55e131e149e"],
Cell[11042, 314, 442, 10, 30, "Print",ExpressionUUID->"38b429ef-f2c1-4afc-a839-5c909f2c9e75"]
}, Open  ]],
Cell[11499, 327, 3428, 70, 133, "Output",ExpressionUUID->"30f1155f-5612-4e5e-b363-c8be1351f431"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14964, 402, 19940, 454, 1967, "Input",ExpressionUUID->"dde9940d-67b7-4b2b-95ea-3e775ea4b97e"],
Cell[34907, 858, 425, 10, 30, "Print",ExpressionUUID->"9e4066e7-cd3a-42a8-960e-45837e1ed9a7"],
Cell[35335, 870, 11079, 213, 293, "Output",ExpressionUUID->"d1e602b8-b802-4554-aab2-3424633a54bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46451, 1088, 20955, 483, 2100, "Input",ExpressionUUID->"b4f4500d-c2bf-4d88-9c52-37ea9a7612ad"],
Cell[67409, 1573, 443, 10, 30, "Print",ExpressionUUID->"217c6d50-7d13-44bb-81e5-e0ddc9dfc025"],
Cell[67855, 1585, 12050, 231, 293, "Output",ExpressionUUID->"8fb75ab3-3893-43f1-b26a-e48a7ef28cab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79942, 1821, 22479, 513, 2176, "Input",ExpressionUUID->"8a1ced88-e0a2-44f9-8fdb-2dc9e4b665e4"],
Cell[102424, 2336, 430, 10, 30, "Print",ExpressionUUID->"5ef6adf6-6cfa-4568-8c73-968e2f4f0ab7"],
Cell[102857, 2348, 9161, 171, 167, "Output",ExpressionUUID->"be39b92c-8152-40ac-a151-94c70b4096b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112055, 2524, 15641, 357, 1511, "Input",ExpressionUUID->"f4d2e5ea-ac60-432b-8223-9ba7b7d3e276"],
Cell[127699, 2883, 460, 11, 30, "Print",ExpressionUUID->"3446bd77-c06f-4c8c-8bb6-336a6e78bcb4"],
Cell[128162, 2896, 9463, 182, 293, "Output",ExpressionUUID->"de7717b0-a649-4062-9748-4a24765de55f"]
}, Open  ]]
}
]
*)

