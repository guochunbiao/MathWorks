(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     68648,       1579]
NotebookOptionsPosition[     67147,       1547]
NotebookOutlinePosition[     67490,       1562]
CellTagsIndexPosition[     67447,       1559]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
      "\"\<Shared\>\""}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3DEx`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBlochSphere`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResetDirectory", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Environment\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "lightDir", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lightDir", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"lightDirZ", "^", "2"}]}], "]"}]}], ",", "lightDirZ"}], 
      "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "  ", 
       RowBox[{"(*", 
        RowBox[{"horizontal", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
       "  ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pltRect3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                "LightGreen"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", 
           "  ", "]"}], "&"}], "[", "]"}], ",", "\[IndentingNewLine]", "  ", 
        RowBox[{"(*", 
         RowBox[{"vertical", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
        "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRect3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0.5"}], "}"}]}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", "]"}], ",", 
        "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "direction"}], "*)"}], "\[IndentingNewLine]", 
        "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "lightDir"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<lightDirZ\>\"", "\[Rule]", "lightDirZ"}], "|>"}], 
         "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "    ", 
      RowBox[{"showProps3D", "[", 
       RowBox[{"1", ",", "Medium"}], "]"}]}], "\[IndentingNewLine]", " ", 
     "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirZ", ",", "0.7"}], "}"}], ",", "0", ",", "1"}], "}"}], 
   ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "0", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "    ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "lightDir", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8357624150241756`*^9, 3.835762435296138*^9}, {
  3.8357624991891823`*^9, 3.8357625102491074`*^9}, {3.8357665182743187`*^9, 
  3.835766522297717*^9}, {3.837243813186365*^9, 3.83724382050422*^9}, {
  3.8385920182897167`*^9, 3.838592021245219*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"076f3c7a-f4f9-47fd-abf1-b26aae8cc360"],

Cell[BoxData[
 StyleBox["\<\" Environment\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.835762510741612*^9, 3.835765912894205*^9, 
  3.835766525569392*^9, 3.8358370469448385`*^9, 3.8358601179482107`*^9, 
  3.8372438257162457`*^9, 3.838592025105692*^9},
 CellLabel->
  "During evaluation of \
In[196]:=",ExpressionUUID->"0b2817b8-7aa6-4a89-8799-76199ad5d288"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lightDirZ$$ = 
    0.7, $CellContext`lightIntensity$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightDirZ$$], 0.7}, 0, 1}, {{
       Hold[$CellContext`lightIntensity$$], 1}, 0, 1}}, Typeset`size$$ = {
    360., {196., 202.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightDirZ$519935$$ = 
    0, $CellContext`lightIntensity$519936$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`lightDirZ$$ = 
        0.7, $CellContext`lightIntensity$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`lightDirZ$$, $CellContext`lightDirZ$519935$$, 0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$519936$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`lightDir = {
         0, -Sqrt[1 - $CellContext`lightDirZ$$^2], $CellContext`lightDirZ$$}; 
       Show[{
          (gPlots3DEx`pltRect3D[
           Association[
           "center" -> {0, 0, 0}, "normal" -> {0, 0, 1}, 
            "majorAxis" -> {0, 1, 0}, "majorRadius" -> 1, "minorRadius" -> 
            0.5, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              LightGreen]]]& )[], 
          (gPlots3DEx`pltRect3D[
           Association[
           "center" -> {0, 1, 0.5}, "normal" -> {0, -1, 0}, 
            "majorAxis" -> {1, 0, 0}, "majorRadius" -> 0.5, "minorRadius" -> 
            0.5]]& )[], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> {0, -1, 1}, "dir" -> -$CellContext`lightDir, "length" -> 
            0.5]]& )[
           Association["lightDirZ" -> $CellContext`lightDirZ$$]]}, 
         gPlots3DEx`showProps3D[1, Medium]]), 
      "Specifications" :> {{{$CellContext`lightDirZ$$, 0.7}, 0, 
         1}, {{$CellContext`lightIntensity$$, 1}, 0, 1}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {257., 263.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.835762440244441*^9, {3.8357624933289776`*^9, 3.8357625107605615`*^9}, 
   3.835765912920314*^9, 3.8357665255972795`*^9, 3.8358370488827634`*^9, 
   3.8358601195997963`*^9, 3.837243825743929*^9, 3.8385920251366158`*^9},
 CellLabel->
  "Out[208]=",ExpressionUUID->"4d81fc6d-4628-4ae5-8b5f-968f244d73c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<BRDF Lighting\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightDir", ",", "dynViewPt", ",", "debugViewPoint", ",", "viewPoint", ",",
     "\[IndentingNewLine]", "\t", "horzNormal", ",", "vertNormal"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"lightDirX", ",", 
        RowBox[{"-", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"lightDirX", "^", "2"}]}], "]"}]}], ",", "0"}], "}"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"dynViewPt", "=", 
     RowBox[{
      RowBox[{"Options", "[", 
       RowBox[{"Graphics3D", ",", "ViewPoint"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"debugViewPoint", "=", 
     RowBox[{"Dynamic", "[", "dynViewPt", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", "debugViewPoint", "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"viewPoint", "=", 
     RowBox[{"{", 
      RowBox[{"1.3", ",", 
       RowBox[{"-", "2.4"}], ",", "2"}], "}"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"normals", " ", "for", " ", "rectangle"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"horzNormal", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"vertNormal", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "  ", 
       RowBox[{"(*", 
        RowBox[{"horizontal", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
       "  ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pltRect3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "horzNormal"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "LightBlue"}],
                "]"}]}]}], "|>"}], "\[IndentingNewLine]", "  ", "]"}], "&"}], 
         "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "horzRoughness"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "  ", 
        RowBox[{"(*", 
         RowBox[{"vertical", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
        "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRect3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0.5"}], "}"}]}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "vertNormal"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"gBrdfFunc", "[", 
                 RowBox[{
                 "#roughness", ",", "vertNormal", ",", "lightDir", ",", 
                  RowBox[{"Normalize", "[", 
                   RowBox[{"viewPoint", "-", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], 
                 "]"}]}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", "  ", 
           "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "vertRoughness"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", 
         RowBox[{"shading", " ", "point", " ", "on", " ", "ground"}], "*)"}], 
        "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "#shadingPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<shadingPt\>\"", "\[Rule]", "shadingPt"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "direction"}], "*)"}], "\[IndentingNewLine]", 
        "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "lightDir"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "    ", 
      RowBox[{"showProps3D", "[", 
       RowBox[{"1", ",", "Large"}], "]"}], ",", "\[IndentingNewLine]", "   ", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"Dynamic", "[", "dynViewPt", "]"}]}]}], "\[IndentingNewLine]", 
     " ", "]"}]}], ",", "\[IndentingNewLine]", "   ", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"horzRoughness", ",", "0.1"}], "}"}], ",", "0.01", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vertRoughness", ",", "0.1"}], "}"}], ",", "0.01", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirX", ",", 
       RowBox[{"-", "0.5"}]}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "0", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPt", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5"}], ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "    ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8357658906009407`*^9, 3.8357659309326153`*^9}, {
   3.83576653357514*^9, 3.835766550117061*^9}, {3.8358235446595273`*^9, 
   3.8358235647393475`*^9}, 3.8358236970097075`*^9, {3.8385920105651183`*^9, 
   3.838592014911972*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"2bb78b72-22f2-4c97-a21a-65b5d2177798"],

Cell[BoxData[
 StyleBox["\<\" BRDF Lighting\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.83576591506248*^9, 3.835765931853345*^9}, 
   3.835766551134929*^9, {3.835823545940611*^9, 3.8358235689839487`*^9}, 
   3.835823699251544*^9, 3.835837049251967*^9, 3.8358601199309216`*^9, 
   3.837243826129759*^9, 3.8385920253558717`*^9},
 CellLabel->
  "During evaluation of \
In[210]:=",ExpressionUUID->"90a9e6c8-9420-483c-a476-d659ade90c2c"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`horzRoughness$$ = 
    0.1, $CellContext`lightDirX$$ = -0.5, $CellContext`lightIntensity$$ = 
    1, $CellContext`shadingPt$$ = {
    0.040000000000000036`, -0.07999999999999996, 
    0.}, $CellContext`vertRoughness$$ = 0.1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`horzRoughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`vertRoughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`lightDirX$$], -0.5}, -1, 0}, {{
       Hold[$CellContext`lightIntensity$$], 1}, 0, 1}, {{
       Hold[$CellContext`shadingPt$$], {0, 0, 0}}, {-0.5, -1, 0}, {
      0.5, 1, 0}}}, Typeset`size$$ = {576., {313., 317.}}, Typeset`update$$ = 
    0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`horzRoughness$520048$$ = 
    0, $CellContext`vertRoughness$520049$$ = 
    0, $CellContext`lightDirX$520050$$ = 
    0, $CellContext`lightIntensity$520051$$ = 
    0, $CellContext`shadingPt$520052$$ = {0, 0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`horzRoughness$$ = 
        0.1, $CellContext`lightDirX$$ = -0.5, $CellContext`lightIntensity$$ = 
        1, $CellContext`shadingPt$$ = {0, 0, 0}, $CellContext`vertRoughness$$ = 
        0.1}, "ControllerVariables" :> {
        Hold[$CellContext`horzRoughness$$, \
$CellContext`horzRoughness$520048$$, 0], 
        Hold[$CellContext`vertRoughness$$, \
$CellContext`vertRoughness$520049$$, 0], 
        Hold[$CellContext`lightDirX$$, $CellContext`lightDirX$520050$$, 0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$520051$$, 0], 
        Hold[$CellContext`shadingPt$$, $CellContext`shadingPt$520052$$, {0, 0,
          0}]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`lightDir = 
        Normalize[{$CellContext`lightDirX$$, -
           Sqrt[1 - $CellContext`lightDirX$$^2], 0}]; $CellContext`dynViewPt = 
        Part[
          Options[Graphics3D, ViewPoint], 1, 2]; $CellContext`debugViewPoint = 
        Dynamic[$CellContext`dynViewPt]; $CellContext`viewPoint = {
         1.3, -2.4, 2}; $CellContext`horzNormal = {0, 0, 
         1}; $CellContext`vertNormal = {0, -1, 0}; Show[{
          (gPlots3DEx`pltRect3D[
           Association[
           "center" -> {0, 0, 0}, "normal" -> $CellContext`horzNormal, 
            "majorAxis" -> {0, 1, 0}, "majorRadius" -> 1, "minorRadius" -> 
            0.5, "opacity" -> 0.3, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              LightBlue]]]& )[
           Association["roughness" -> $CellContext`horzRoughness$$]], 
          (gPlots3DEx`pltRect3D[
           Association[
           "center" -> {0, 1, 0.5}, "normal" -> $CellContext`vertNormal, 
            "majorAxis" -> {1, 0, 0}, "majorRadius" -> 0.5, "minorRadius" -> 
            0.5, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              gBRDF`gBrdfFunc[
               Slot[
               "roughness"], $CellContext`vertNormal, $CellContext`lightDir, 
               
               Normalize[$CellContext`viewPoint - {$CellContext`x, \
$CellContext`y, $CellContext`z}]]]]]& )[
           Association["roughness" -> $CellContext`vertRoughness$$]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> Slot["shadingPt"], "size" -> 0.01, "color" -> Blue]]& )[
           Association["shadingPt" -> $CellContext`shadingPt$$]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> {0, -1, 1}, "dir" -> -$CellContext`lightDir, "length" -> 
            0.5]]& )[
           Association[]]}, 
         gPlots3DEx`showProps3D[1, Large], ViewPoint -> 
         Dynamic[$CellContext`dynViewPt]]), 
      "Specifications" :> {{{$CellContext`horzRoughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`vertRoughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`lightDirX$$, -0.5}, -1, 
         0}, {{$CellContext`lightIntensity$$, 1}, 0, 
         1}, {{$CellContext`shadingPt$$, {0, 0, 0}}, {-0.5, -1, 0}, {
         0.5, 1, 0}}}, "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{627., {411., 417.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8357659080812826`*^9, 3.8357659318711643`*^9}, 
   3.8357665511468973`*^9, {3.8358235459740973`*^9, 3.8358235690124197`*^9}, 
   3.8358236992840357`*^9, 3.8358370492619395`*^9, 3.8358601199630117`*^9, 
   3.8372438261934905`*^9, 3.8385920253936944`*^9},
 CellLabel->
  "Out[212]=",ExpressionUUID->"041c1c5a-9f14-4801-ad44-40968ed34a2c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Peak Point & Sampling Disk\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightDir", ",", "dynViewPt", ",", "debugViewPoint", ",", "viewPoint", ",",
     "\[IndentingNewLine]", "\t", "horzCenter", ",", "horzNormal", ",", 
    "vertCenter", ",", "vertNormal", ",", "refPeakPt"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"lightDirX", ",", 
        RowBox[{"-", "1"}], ",", "lightDirZ"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dynViewPt", "=", 
     RowBox[{
      RowBox[{"Options", "[", 
       RowBox[{"Graphics3D", ",", "ViewPoint"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"debugViewPoint", "=", 
     RowBox[{"Dynamic", "[", "dynViewPt", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", "debugViewPoint", "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"viewPoint", "=", 
     RowBox[{"{", 
      RowBox[{"1.3", ",", 
       RowBox[{"-", "2.4"}], ",", "2"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"normals", " ", "for", " ", "rectangle"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"horzNormal", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"vertNormal", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"horzCenter", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "0.5"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"vertCenter", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"refPeakPt", "=", 
     RowBox[{"gCalcPeakPoint", "[", 
      RowBox[{
      "vertNormal", ",", "vertCenter", ",", "lightDir", ",", "shadingPt"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "  ", 
       RowBox[{"(*", 
        RowBox[{"horizontal", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
       "  ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pltRect3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "horzCenter"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "horzNormal"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "LightBlue"}],
                "]"}]}]}], "|>"}], "\[IndentingNewLine]", "  ", "]"}], "&"}], 
         "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "horzRoughness"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "  ", 
        RowBox[{"(*", 
         RowBox[{"vertical", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
        "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRect3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "vertCenter"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "vertNormal"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"gBrdfFunc", "[", 
                 RowBox[{
                 "#roughness", ",", "vertNormal", ",", "lightDir", ",", 
                  RowBox[{"Normalize", "[", 
                   RowBox[{"viewPoint", "-", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], 
                 "]"}]}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", "  ", 
           "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "vertRoughness"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", "points", "*)"}], "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "#shadingPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<shadingPt\>\"", "\[Rule]", "shadingPt"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "refPeakPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.02"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", 
         RowBox[{"sampling", " ", "area"}], "*)"}], "\[IndentingNewLine]", 
        "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltCircle3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "refPeakPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "vertNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "#radius"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                "LightGreen"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", 
           "\t", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "direction"}], "*)"}], "\[IndentingNewLine]", 
        "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "lightDir"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "    ", 
      RowBox[{"showProps3D", "[", 
       RowBox[{"1", ",", "Large"}], "]"}], ",", "\[IndentingNewLine]", "   ", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"Dynamic", "[", "dynViewPt", "]"}]}]}], "\[IndentingNewLine]", 
     " ", "]"}]}], ",", "\[IndentingNewLine]", "   ", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"horzRoughness", ",", "0.1"}], "}"}], ",", "0.01", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vertRoughness", ",", "0.1"}], "}"}], ",", "0.01", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirX", ",", 
       RowBox[{"-", "0.5"}]}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirZ", ",", "1"}], "}"}], ",", "0.5", ",", "1"}], "}"}], 
   ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "0", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPt", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5"}], ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "0.5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "1", ",", 
       RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"samplingRadius", ",", "1"}], "}"}], ",", "0.5", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", "    ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.835837002100026*^9, 3.8358370211411424`*^9}, {
  3.8358370577774763`*^9, 3.835837061420633*^9}, {3.8385919859826145`*^9, 
  3.8385919906565113`*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"8ff3d4a8-d8b9-4970-8a28-c41b0f6c1d27"],

Cell[BoxData[
 StyleBox["\<\" Peak Point & Sampling Disk\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.835837049335972*^9, 3.8358370622481337`*^9}, 
   3.8358601202066545`*^9, 3.837243826612567*^9, 3.8385920256208563`*^9},
 CellLabel->
  "During evaluation of \
In[213]:=",ExpressionUUID->"be05973f-e9f8-4360-b7e2-7214c60f9811"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`horzRoughness$$ = 
    0.1, $CellContext`lightDirX$$ = -0.40800000000000003`, \
$CellContext`lightDirZ$$ = 0.8360000000000001, $CellContext`lightIntensity$$ =
     1, $CellContext`samplingRadius$$ = 1, $CellContext`shadingPt$$ = {0.245, 
    0.33000000000000007`, -0.5}, $CellContext`vertRoughness$$ = 0.1, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`horzRoughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`vertRoughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`lightDirX$$], -0.5}, -1, 0}, {{
       Hold[$CellContext`lightDirZ$$], 1}, 0.5, 1}, {{
       Hold[$CellContext`lightIntensity$$], 1}, 0, 1}, {{
       Hold[$CellContext`shadingPt$$], {0, 0, -0.5}}, {-0.5, -1, -0.5}, {
      0.5, 1, -0.5}}, {{
       Hold[$CellContext`samplingRadius$$], 1}, 0.5, 2}}, Typeset`size$$ = {
    576., {313., 317.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`horzRoughness$520977$$ = 
    0, $CellContext`vertRoughness$520978$$ = 
    0, $CellContext`lightDirX$520979$$ = 0, $CellContext`lightDirZ$520980$$ = 
    0, $CellContext`lightIntensity$520981$$ = 
    0, $CellContext`shadingPt$520982$$ = {0, 0, 
    0}, $CellContext`samplingRadius$520983$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`horzRoughness$$ = 
        0.1, $CellContext`lightDirX$$ = -0.5, $CellContext`lightDirZ$$ = 
        1, $CellContext`lightIntensity$$ = 1, $CellContext`samplingRadius$$ = 
        1, $CellContext`shadingPt$$ = {
         0, 0, -0.5}, $CellContext`vertRoughness$$ = 0.1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`horzRoughness$$, \
$CellContext`horzRoughness$520977$$, 0], 
        Hold[$CellContext`vertRoughness$$, \
$CellContext`vertRoughness$520978$$, 0], 
        Hold[$CellContext`lightDirX$$, $CellContext`lightDirX$520979$$, 0], 
        Hold[$CellContext`lightDirZ$$, $CellContext`lightDirZ$520980$$, 0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$520981$$, 0], 
        Hold[$CellContext`shadingPt$$, $CellContext`shadingPt$520982$$, {0, 0,
          0}], 
        Hold[$CellContext`samplingRadius$$, \
$CellContext`samplingRadius$520983$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`lightDir = 
        Normalize[{$CellContext`lightDirX$$, -1, $CellContext`lightDirZ$$}]; \
$CellContext`dynViewPt = Part[
          Options[Graphics3D, ViewPoint], 1, 2]; $CellContext`debugViewPoint = 
        Dynamic[$CellContext`dynViewPt]; $CellContext`viewPoint = {
         1.3, -2.4, 2}; $CellContext`horzNormal = {0, 0, 
         1}; $CellContext`vertNormal = {0, -1, 0}; $CellContext`horzCenter = {
         0, 0, -0.5}; $CellContext`vertCenter = {0, 1, 
         0}; $CellContext`refPeakPt = 
        gBRDF`gCalcPeakPoint[$CellContext`vertNormal, \
$CellContext`vertCenter, $CellContext`lightDir, $CellContext`shadingPt$$]; 
       Show[{
          (gPlots3DEx`pltRect3D[
           Association[
           "center" -> $CellContext`horzCenter, 
            "normal" -> $CellContext`horzNormal, "majorAxis" -> {0, 1, 0}, 
            "majorRadius" -> 1, "minorRadius" -> 0.5, "opacity" -> 0.3, 
            "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              LightBlue]]]& )[
           Association["roughness" -> $CellContext`horzRoughness$$]], 
          (gPlots3DEx`pltRect3D[
           Association[
           "center" -> $CellContext`vertCenter, 
            "normal" -> $CellContext`vertNormal, "majorAxis" -> {1, 0, 0}, 
            "majorRadius" -> 0.5, "minorRadius" -> 0.5, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              gBRDF`gBrdfFunc[
               Slot[
               "roughness"], $CellContext`vertNormal, $CellContext`lightDir, 
               
               Normalize[$CellContext`viewPoint - {$CellContext`x, \
$CellContext`y, $CellContext`z}]]]]]& )[
           Association["roughness" -> $CellContext`vertRoughness$$]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> Slot["shadingPt"], "size" -> 0.01, "color" -> Blue]]& )[
           Association["shadingPt" -> $CellContext`shadingPt$$]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`refPeakPt, "size" -> 0.02, "color" -> 
            Red]]& )[
           Association[]], 
          (gPlots3DEx`pltCircle3D[
           Association[
           "center" -> $CellContext`refPeakPt, 
            "normal" -> $CellContext`vertNormal, "radius" -> Slot["radius"], 
            "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              LightGreen]]]& )[
           Association["radius" -> $CellContext`samplingRadius$$]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> {0, -1, 1}, "dir" -> -$CellContext`lightDir, "length" -> 
            0.5]]& )[
           Association[]]}, 
         gPlots3DEx`showProps3D[1, Large], ViewPoint -> 
         Dynamic[$CellContext`dynViewPt]]), 
      "Specifications" :> {{{$CellContext`horzRoughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`vertRoughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`lightDirX$$, -0.5}, -1, 
         0}, {{$CellContext`lightDirZ$$, 1}, 0.5, 
         1}, {{$CellContext`lightIntensity$$, 1}, 0, 
         1}, {{$CellContext`shadingPt$$, {0, 0, -0.5}}, {-0.5, -1, -0.5}, {
         0.5, 1, -0.5}}, {{$CellContext`samplingRadius$$, 1}, 0.5, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{627., {439., 445.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8358370493442125`*^9, 3.8358370622653284`*^9}, 
   3.83586012021661*^9, 3.8372438267011147`*^9, 3.838592025640788*^9},
 CellLabel->
  "Out[215]=",ExpressionUUID->"c5f4b3a0-a8c3-40d5-94e9-3267b6d63d0f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Reflect ASG Light\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightDir", ",", "dynViewPt", ",", "debugViewPoint", ",", "viewPoint", ",",
     "realViewDir", ",", "\[IndentingNewLine]", "\t", "horzCenter", ",", 
    "horzNormal", ",", "vertCenter", ",", "vertNormal", ",", "reflPeakPt", 
    ",", "\[IndentingNewLine]", "\t", "reflLightingFunc", ",", "reflAsgLight",
     ",", "asgDisplayPt", ",", "reflDisplayAsg", ",", "sgndf", ",", 
    "reflShading"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"lightDirX", ",", 
        RowBox[{"-", "1"}], ",", "lightDirZ"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dynViewPt", "=", 
     RowBox[{
      RowBox[{"Options", "[", 
       RowBox[{"Graphics3D", ",", "ViewPoint"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"debugViewPoint", "=", 
     RowBox[{"Dynamic", "[", "dynViewPt", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", "debugViewPoint", "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"viewPoint", "=", 
     RowBox[{"{", 
      RowBox[{"1.3", ",", 
       RowBox[{"-", "2.4"}], ",", "2"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"realViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"viewPoint", "-", "shadingPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"normals", " ", "for", " ", "rectangle"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"horzNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"vertNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"horzCenter", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "0.5"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"vertCenter", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"reflPeakPt", "=", 
     RowBox[{"gCalcPeakPoint", "[", 
      RowBox[{
      "vertNormal", ",", "vertCenter", ",", "lightDir", ",", "shadingPt"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reflLightingFunc", "[", "reflPt_", "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "reflViewPt", ",", "reflView", ",", "reflHalf", ",", "noh", ",", 
         "nol", ",", "lighting"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reflViewPt", "=", "shadingPt"}], ";", "\[IndentingNewLine]", 
        RowBox[{"reflView", "=", 
         RowBox[{"Normalize", "[", 
          RowBox[{"reflViewPt", "-", "reflPt"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"reflHalf", "=", 
         RowBox[{"Normalize", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"reflView", "+", "lightDir"}], ")"}], "/", "2"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"noh", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{"vertNormal", ",", "reflHalf"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nol", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{"vertNormal", ",", "lightDir"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"lighting", "=", 
         RowBox[{
          RowBox[{"gDGGX", "[", 
           RowBox[{"vertRoughness", ",", "noh"}], "]"}], "*", "nol", "*", 
          "lightIntensity"}]}], ";", "\[IndentingNewLine]", "lighting"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"reflAsgLight", "=", 
     RowBox[{"asgReflectLight", "[", 
      RowBox[{
      "shadingPt", ",", "lightDir", ",", "lightIntensity", ",", 
       "vertRoughness", ",", 
       RowBox[{"{", 
        RowBox[{"reflPeakPt", ",", "vertNormal", ",", "samplingRadius"}], 
        "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"asgDisplayPt", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5"}], ",", 
       RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"reflDisplayAsg", "=", "reflAsgLight"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reflDisplayAsg", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"-", "1"}], "*", 
      RowBox[{"reflDisplayAsg", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"sgndf", "=", 
     RowBox[{"sgNDF", "[", 
      RowBox[{"horzRoughness", ",", 
       RowBox[{"reflAsgLight", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "realViewDir", ",", 
       "horzNormal"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"reflShading", "=", 
     RowBox[{"asgDotSg", "[", 
      RowBox[{"reflAsgLight", ",", "sgndf"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "  ", 
       RowBox[{"(*", 
        RowBox[{"horizontal", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
       "  ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pltRect3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "horzCenter"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "horzNormal"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "LightBlue"}],
                "]"}]}]}], "|>"}], "\[IndentingNewLine]", "  ", "]"}], "&"}], 
         "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "horzRoughness"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "  ", 
        RowBox[{"(*", 
         RowBox[{"vertical", " ", "rect"}], "*)"}], "\[IndentingNewLine]", 
        "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRect3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "vertCenter"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "vertNormal"}], ",", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "50"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                RowBox[{"Hue", "@", 
                 RowBox[{"reflLightingFunc", "[", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}]}], 
               "]"}]}]}], "|>"}], "\[IndentingNewLine]", "  ", "]"}], "&"}], 
         "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "vertRoughness"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", "points", "*)"}], "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "#shadingPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<shadingPt\>\"", "\[Rule]", "shadingPt"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.02"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", 
         RowBox[{"sampling", " ", "area"}], "*)"}], "\[IndentingNewLine]", 
        "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltCircle3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "vertNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "#radius"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                "LightGreen"}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", 
           "\t", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", 
         RowBox[{"ASG", " ", "Reflection", " ", "Light"}], "*)"}], 
        "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltSphere3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "asgDisplayPt"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "50"}], ",", 
             RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                RowBox[{"Hue", "@", 
                 RowBox[{"asgVector", "[", 
                  RowBox[{
                   RowBox[{"Normalize", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], "-", 
                    "asgDisplayPt"}], "]"}], ",", "reflDisplayAsg"}], 
                  "]"}]}]}], "]"}]}]}], "|>"}], "\[IndentingNewLine]", "]"}], 
          "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", "   ", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "direction"}], "*)"}], "\[IndentingNewLine]", 
        "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "lightDir"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "    ", 
      RowBox[{"showProps3D", "[", 
       RowBox[{"1", ",", "Large"}], "]"}], ",", "\[IndentingNewLine]", "   ", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"Dynamic", "[", "dynViewPt", "]"}]}]}], "\[IndentingNewLine]", 
     " ", "]"}]}], ",", "\[IndentingNewLine]", "   ", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"horzRoughness", ",", "0.1"}], "}"}], ",", "0.01", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vertRoughness", ",", "0.1"}], "}"}], ",", "0.01", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirX", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirZ", ",", "0.5"}], "}"}], ",", "0.5", ",", "1"}], "}"}],
    ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "0", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPt", ",", 
       RowBox[{"{", 
        RowBox[{"0.5", ",", "0.35", ",", 
         RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5"}], ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "0.5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "1", ",", 
       RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"samplingRadius", ",", "0.3"}], "}"}], ",", "0.1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"reflShading1", ",", "reflShading"}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "    ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.835841066707006*^9, 3.8358411240949965`*^9}, {
  3.835841325738722*^9, 3.8358413332849526`*^9}, {3.835864183221839*^9, 
  3.835864184179719*^9}, {3.8385920001201715`*^9, 3.8385920032167883`*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"c13cb579-c84e-4b9f-baf6-efbd7d73695f"],

Cell[BoxData[
 StyleBox["\<\" Reflect ASG Light\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.835841076085662*^9, {3.835841109597105*^9, 3.8358411251696844`*^9}, 
   3.8358413349367743`*^9, 3.8358601203510575`*^9, 3.8372438271754103`*^9, 
   3.8385920258922234`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"def38c31-0d9c-4ab7-8aa9-74f44a788c55"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`horzRoughness$$ = 
    0.1, $CellContext`lightDirX$$ = -1, $CellContext`lightDirZ$$ = 
    0.5, $CellContext`lightIntensity$$ = 1, $CellContext`reflShading1$$ = 
    0.4302998233845109, $CellContext`samplingRadius$$ = 
    0.3, $CellContext`shadingPt$$ = {0.5, 
    0.35, -0.5}, $CellContext`vertRoughness$$ = 0.1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`horzRoughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`vertRoughness$$], 0.1}, 0.01, 0.99}, {{
       Hold[$CellContext`lightDirX$$], -1}, -1, 0}, {{
       Hold[$CellContext`lightDirZ$$], 0.5}, 0.5, 1}, {{
       Hold[$CellContext`lightIntensity$$], 1}, 0, 1}, {{
       Hold[$CellContext`shadingPt$$], {0.5, 0.35, -0.5}}, {-0.5, -1, -0.5}, {
      0.5, 1, -0.5}}, {{
       Hold[$CellContext`samplingRadius$$], 0.3}, 0.1, 1}, {{
       Hold[$CellContext`reflShading1$$], 0.4302998233845109}}}, 
    Typeset`size$$ = {576., {313., 317.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`horzRoughness$521932$$ = 
    0, $CellContext`vertRoughness$521933$$ = 
    0, $CellContext`lightDirX$521934$$ = 0, $CellContext`lightDirZ$521935$$ = 
    0, $CellContext`lightIntensity$521936$$ = 
    0, $CellContext`shadingPt$521937$$ = {0, 0, 
    0}, $CellContext`samplingRadius$521938$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`horzRoughness$$ = 
        0.1, $CellContext`lightDirX$$ = -1, $CellContext`lightDirZ$$ = 
        0.5, $CellContext`lightIntensity$$ = 
        1, $CellContext`reflShading1$$ = $CellContext`reflShading, \
$CellContext`samplingRadius$$ = 
        0.3, $CellContext`shadingPt$$ = {0.5, 
         0.35, -0.5}, $CellContext`vertRoughness$$ = 0.1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`horzRoughness$$, \
$CellContext`horzRoughness$521932$$, 0], 
        Hold[$CellContext`vertRoughness$$, \
$CellContext`vertRoughness$521933$$, 0], 
        Hold[$CellContext`lightDirX$$, $CellContext`lightDirX$521934$$, 0], 
        Hold[$CellContext`lightDirZ$$, $CellContext`lightDirZ$521935$$, 0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$521936$$, 0], 
        Hold[$CellContext`shadingPt$$, $CellContext`shadingPt$521937$$, {0, 0,
          0}], 
        Hold[$CellContext`samplingRadius$$, \
$CellContext`samplingRadius$521938$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`lightDir = 
        Normalize[{$CellContext`lightDirX$$, -1, $CellContext`lightDirZ$$}]; \
$CellContext`dynViewPt = Part[
          Options[Graphics3D, ViewPoint], 1, 2]; $CellContext`debugViewPoint = 
        Dynamic[$CellContext`dynViewPt]; $CellContext`viewPoint = {
         1.3, -2.4, 2}; $CellContext`realViewDir = 
        Normalize[$CellContext`viewPoint - $CellContext`shadingPt$$]; \
$CellContext`horzNormal = Normalize[{0, 0, 1}]; $CellContext`vertNormal = 
        Normalize[{0, -1, 0}]; $CellContext`horzCenter = {
         0, 0, -0.5}; $CellContext`vertCenter = {0, 1, 
         0}; $CellContext`reflPeakPt = 
        gBRDF`gCalcPeakPoint[$CellContext`vertNormal, \
$CellContext`vertCenter, $CellContext`lightDir, $CellContext`shadingPt$$]; \
$CellContext`reflLightingFunc[
          Pattern[$CellContext`reflPt$, 
           Blank[]]] := 
        Module[{$CellContext`reflViewPt$, $CellContext`reflView$, \
$CellContext`reflHalf$, $CellContext`noh$, $CellContext`nol$, \
$CellContext`lighting$}, $CellContext`reflViewPt$ = $CellContext`shadingPt$$; \
$CellContext`reflView$ = 
           Normalize[$CellContext`reflViewPt$ - $CellContext`reflPt$]; \
$CellContext`reflHalf$ = 
           Normalize[($CellContext`reflView$ + $CellContext`lightDir)/
             2]; $CellContext`noh$ = 
           Dot[$CellContext`vertNormal, $CellContext`reflHalf$]; \
$CellContext`nol$ = 
           Dot[$CellContext`vertNormal, $CellContext`lightDir]; \
$CellContext`lighting$ = 
           gBRDF`gDGGX[$CellContext`vertRoughness$$, $CellContext`noh$] \
$CellContext`nol$ $CellContext`lightIntensity$$; $CellContext`lighting$]; \
$CellContext`reflAsgLight = 
        sgCommon`asgReflectLight[$CellContext`shadingPt$$, \
$CellContext`lightDir, $CellContext`lightIntensity$$, \
$CellContext`vertRoughness$$, {$CellContext`reflPeakPt, \
$CellContext`vertNormal, $CellContext`samplingRadius$$}]; \
$CellContext`asgDisplayPt = {-0.5, -0.5, 
         0.5}; $CellContext`reflDisplayAsg = $CellContext`reflAsgLight; 
       Part[$CellContext`reflDisplayAsg, 1] = -
         Part[$CellContext`reflDisplayAsg, 1]; $CellContext`sgndf = 
        sgCommon`sgNDF[$CellContext`horzRoughness$$, 
          
          Part[$CellContext`reflAsgLight, 
           1], $CellContext`realViewDir, $CellContext`horzNormal]; \
$CellContext`reflShading = 
        sgCommon`asgDotSg[$CellContext`reflAsgLight, $CellContext`sgndf]; 
       Show[{
          (gPlots3DEx`pltRect3D[
           Association[
           "center" -> $CellContext`horzCenter, 
            "normal" -> $CellContext`horzNormal, "majorAxis" -> {0, 1, 0}, 
            "majorRadius" -> 1, "minorRadius" -> 0.5, "opacity" -> 0.3, 
            "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              LightBlue]]]& )[
           Association["roughness" -> $CellContext`horzRoughness$$]], 
          (gPlots3DEx`pltRect3D[
           Association[
           "center" -> $CellContext`vertCenter, 
            "normal" -> $CellContext`vertNormal, "plotPts" -> 50, 
            "majorAxis" -> {1, 0, 0}, "majorRadius" -> 0.5, "minorRadius" -> 
            0.5, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              Hue[
               $CellContext`reflLightingFunc[{$CellContext`x, $CellContext`y, \
$CellContext`z}]]]]]& )[
           Association["roughness" -> $CellContext`vertRoughness$$]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> Slot["shadingPt"], "size" -> 0.01, "color" -> Blue]]& )[
           Association["shadingPt" -> $CellContext`shadingPt$$]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`reflPeakPt, "size" -> 0.02, "color" -> 
            Red]]& )[
           Association[]], 
          (gPlots3DEx`pltCircle3D[
           Association[
           "center" -> $CellContext`reflPeakPt, 
            "normal" -> $CellContext`vertNormal, "radius" -> Slot["radius"], 
            "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              LightGreen]]]& )[
           Association["radius" -> $CellContext`samplingRadius$$]], 
          (gPlots3DEx`pltSphere3D[
           Association[
           "center" -> $CellContext`asgDisplayPt, "radius" -> 0.5, "plotPts" -> 
            50, "mesh" -> None, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              Hue[
               sgCommon`asgVector[
                
                Normalize[{$CellContext`x, $CellContext`y, $CellContext`z} - \
$CellContext`asgDisplayPt], $CellContext`reflDisplayAsg]]]]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> {0, -1, 1}, "dir" -> -$CellContext`lightDir, "length" -> 
            0.5]]& )[
           Association[]]}, 
         gPlots3DEx`showProps3D[1, Large], ViewPoint -> 
         Dynamic[$CellContext`dynViewPt]]), 
      "Specifications" :> {{{$CellContext`horzRoughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`vertRoughness$$, 0.1}, 0.01, 
         0.99}, {{$CellContext`lightDirX$$, -1}, -1, 
         0}, {{$CellContext`lightDirZ$$, 0.5}, 0.5, 
         1}, {{$CellContext`lightIntensity$$, 1}, 0, 
         1}, {{$CellContext`shadingPt$$, {0.5, 
          0.35, -0.5}}, {-0.5, -1, -0.5}, {
         0.5, 1, -0.5}}, {{$CellContext`samplingRadius$$, 0.3}, 0.1, 
         1}, {{$CellContext`reflShading1$$, $CellContext`reflShading}}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{945., {344., 350.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8358410761256576`*^9, {3.83584110962529*^9, 3.835841125201254*^9}, 
   3.835841334974157*^9, 3.8358601203649006`*^9, 3.8372438272054768`*^9, 
   3.8385920259211845`*^9},
 CellLabel->
  "Out[218]=",ExpressionUUID->"b2216d65-4fa0-41d0-88f4-2f87ada3adbd"]
}, Open  ]]
},
WindowSize->{1081, 804},
WindowMargins->{{36, Automatic}, {Automatic, 40}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 6094, 151, 770, "Input",ExpressionUUID->"076f3c7a-f4f9-47fd-abf1-b26aae8cc360"],
Cell[6677, 175, 428, 10, 30, "Print",ExpressionUUID->"0b2817b8-7aa6-4a89-8799-76199ad5d288"],
Cell[7108, 187, 3213, 66, 539, "Output",ExpressionUUID->"4d81fc6d-4628-4ae5-8b5f-968f244d73c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10358, 258, 8418, 203, 884, "Input",ExpressionUUID->"2bb78b72-22f2-4c97-a21a-65b5d2177798"],
Cell[18779, 463, 505, 11, 30, "Print",ExpressionUUID->"90a9e6c8-9420-483c-a476-d659ade90c2c"],
Cell[19287, 476, 5421, 105, 847, "Output",ExpressionUUID->"041c1c5a-9f14-4801-ad44-40968ed34a2c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24745, 586, 10420, 250, 1093, "Input",ExpressionUUID->"8ff3d4a8-d8b9-4970-8a28-c41b0f6c1d27"],
Cell[35168, 838, 399, 9, 30, "Print",ExpressionUUID->"be05973f-e9f8-4360-b7e2-7214c60f9811"],
Cell[35570, 849, 6783, 132, 903, "Output",ExpressionUUID->"c5f4b3a0-a8c3-40d5-94e9-3267b6d63d0f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42390, 986, 15031, 359, 1606, "Input",ExpressionUUID->"c13cb579-c84e-4b9f-baf6-efbd7d73695f"],
Cell[57424, 1347, 445, 11, 30, "Print",ExpressionUUID->"def38c31-0d9c-4ab7-8aa9-74f44a788c55"],
Cell[57872, 1360, 9259, 184, 713, "Output",ExpressionUUID->"b2216d65-4fa0-41d0-88f4-2f87ada3adbd"]
}, Open  ]]
}
]
*)

