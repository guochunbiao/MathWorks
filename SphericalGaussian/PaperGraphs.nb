(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    173652,       3842]
NotebookOptionsPosition[    170410,       3787]
NotebookOutlinePosition[    170782,       3803]
CellTagsIndexPosition[    170739,       3800]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
      "\"\<Shared\>\""}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3DEx`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gTexStyles`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBlochSphere`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResetDirectory", "[", "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8381045114551363`*^9, 3.838104621306058*^9}, {
   3.8381047318712387`*^9, 3.8381047322481966`*^9}, {3.838104794488738*^9, 
   3.838105018474309*^9}, {3.8381051299062104`*^9, 3.838105146536306*^9}, {
   3.838105374402709*^9, 3.838105377296275*^9}, {3.838105554141843*^9, 
   3.838105659984576*^9}, {3.8381060886546383`*^9, 3.8381060930153093`*^9}, {
   3.8381062316590977`*^9, 3.8381062893154573`*^9}, {3.838106350865511*^9, 
   3.838106359414567*^9}, 3.8381064092334566`*^9, {3.83810687288235*^9, 
   3.8381069367815385`*^9}, {3.838106984663814*^9, 3.8381069951275673`*^9}, {
   3.8381071398045254`*^9, 3.8381072658717337`*^9}, {3.8381073503072834`*^9, 
   3.8381075332543845`*^9}, {3.8381077236884565`*^9, 
   3.8381077468396764`*^9}, {3.838107865615464*^9, 3.8381082317647915`*^9}, {
   3.838108263607842*^9, 3.8381083210600543`*^9}, {3.838108363584729*^9, 
   3.838108423001891*^9}, {3.838108490317093*^9, 3.838108512995843*^9}, {
   3.838590300439362*^9, 3.83859030125344*^9}, 3.838591772389261*^9, {
   3.8385921678668203`*^9, 3.838592181930876*^9}, {3.838595366170927*^9, 
   3.838595391521434*^9}, {3.8385955016339736`*^9, 3.838595530726467*^9}, {
   3.8387130559878073`*^9, 3.8387130564817243`*^9}, 3.8390587601131177`*^9},
 EmphasizeSyntaxErrors->True,
 CellLabel->"In[3]:=",ExpressionUUID->"869dad65-2627-40c4-a516-a065be9f81e5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "reflCenter", ",", "reflNormal", ",", "lightDir", ",", "pltLighting", ",", 
    "reflPeakPt", ",", "recvPt", ",", "\[IndentingNewLine]", "\t", 
    "bounceDir", ",", "outDir", ",", "minorAxis", ",", "majorAxis", ",", 
    "intsMin", ",", "intsMax", ",", "intsCenter"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"reflCenter", "=", 
     RowBox[{"{", 
      RowBox[{"reflCenterX", ",", "reflCenterY", ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"reflNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "reflNormalY", ",", "reflNormalZ"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"lightDirX", ",", "lightDirY", ",", "lightDirZ"}], "}"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"pltLighting", "=", 
       RowBox[{"{", 
        RowBox[{"\"\<Directional\>\"", ",", "White", ",", 
         RowBox[{"{", 
          RowBox[{"testLightDir", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"recvPt", "=", 
     RowBox[{"{", 
      RowBox[{"recvPtX", ",", "recvPtY", ",", "0"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"reflPeakPt", "=", 
     RowBox[{"gCalcPeakPoint", "[", 
      RowBox[{"reflNormal", ",", "reflCenter", ",", 
       RowBox[{"-", "lightDir"}], ",", "recvPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"bounceDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"outDir", "=", 
     RowBox[{"gReflectVector", "[", 
      RowBox[{
       RowBox[{"-", "bounceDir"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"approximate", " ", "intersection", " ", "area"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"minorAxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"reflNormal", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}]}], ";", "\n", 
    "   ", 
    RowBox[{"majorAxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"minorAxis", ",", "reflNormal"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsMin", "=", 
     RowBox[{"reflPeakPt", "+", 
      RowBox[{"majorAxis", "*", 
       RowBox[{"(", 
        RowBox[{"samplingRadius", "+", "intsCenterXOffset"}], ")"}]}], "-", 
      RowBox[{"minorAxis", "*", 
       RowBox[{"(", 
        RowBox[{"0.3", "+", "intsCenterYOffset"}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsMax", "=", 
     RowBox[{"reflPeakPt", "-", 
      RowBox[{"majorAxis", "*", "samplingRadius"}], "+", 
      RowBox[{"minorAxis", "*", "samplingRadius"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsCenter", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"intsMin", "+", "intsMax"}], ")"}], "/", "2"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"pltLighting", "=", "Automatic"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", "receiver", "*)"}], "\[IndentingNewLine]", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pltRectLine3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"ints", " ", "area"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pltPoint3D", "[", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<pos\>\"", "\[Rule]", "intsMax"}], ",", 
               RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
             "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
           RowBox[{"<|", "|>"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRectLine3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "intsCenter"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
             RowBox[{"\"\<style\>\"", "\[Rule]", "Dashed"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", 
              RowBox[{"samplingRadius", "*", "intsCenterWidthMultiply"}]}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "#intsMinorRadius"}], 
             ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Orange"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<intsMinorRadius\>\"", "\[Rule]", "intsMinorRadius"}], 
          "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "reflector", "*)"}], "\[IndentingNewLine]", "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRectLine3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "#centerPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<centerPt\>\"", "\[Rule]", "reflCenter"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "arrow"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"reflPeakPt", "+", 
               RowBox[{"lightDir", "*", "1.5"}]}]}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "lightDir"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "1.5"}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.3"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"one", " ", "bounce", " ", "arrow"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"Normalize", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", 
              RowBox[{"Norm", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.5"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"out", " ", "dir", " ", "arrow"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "recvPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", "outDir"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "2"}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.8"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"recv", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "recvPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"reflector", " ", "normal"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "reflNormal"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.6"}], ",", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"recv", " ", "normal"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "recvPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.6"}], ",", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"refl", " ", "peak", " ", "point"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"sampling", " ", "disk"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltCircle3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}]}], "|>"}], 
           "\[IndentingNewLine]", "\t", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "text", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<R'\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Orange", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{"0.3", ",", "0", ",", "0.46"}], "}"}]}]}], "]"}], "}"}],
          "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Light\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"lightDir", "*", "1.65"}]}]}], "]"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<-i\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"lightDir", "*", "1.2"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.05"}], ",", "0", ",", 
               RowBox[{"-", "0.1"}]}], "}"}]}]}], "]"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<y\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{"0.07", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<r\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{
              RowBox[{"Normalize", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}], "*", "0.5"}], 
             "+", 
             RowBox[{"{", 
              RowBox[{"0.1", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<o\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{"outDir", "*", "1.6"}], "+", 
             RowBox[{"{", 
              RowBox[{"0.1", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<x\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{"{", 
              RowBox[{"0.08", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\!\(\*SubscriptBox[\(n\), \(r\)]\)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", "Red", 
              ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "-", 
             RowBox[{"reflNormal", "*", "0.65"}]}]}], "]"}], "}"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\!\(\*SubscriptBox[\(n\), \(x\)]\)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", "Red", 
              ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}], "*", "0.7"}]}]}], 
           "]"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Rectangle R\\n(reflector)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{"0.8", ",", "0", ",", "0.7"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<receiver\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "0.3"}]}], "}"}]}]}], "]"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<D\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", "Blue",
               ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0.55"}], "}"}]}]}], "]"}], "}"}], 
         "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"imgMinX", ",", 
           RowBox[{"imgMinX", "+", "imgSize"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"imgMinY", ",", 
           RowBox[{"imgMinY", "+", "imgSize"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"imgMinZ", ",", 
           RowBox[{"imgMinZ", "+", "imgSizeZ"}]}], "}"}]}], "}"}]}], ",", 
      "\n", "\t\t", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "2"}], ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
      "\t    ", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
      ",", "\[IndentingNewLine]", "\t    ", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflCenterX", ",", "0.814"}], "}"}], ",", "0", ",", "1.3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflCenterY", ",", "0.3"}], "}"}], ",", "0", ",", "1"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflNormalY", ",", "1."}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflNormalZ", ",", "0.145"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"recvPtX", ",", "0.39"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"recvPtY", ",", 
       RowBox[{"-", "0.208"}]}], "}"}], ",", 
     RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirX", ",", 
       RowBox[{"-", "4.4"}]}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirY", ",", 
       RowBox[{"-", "2.38"}]}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirZ", ",", "3.54"}], "}"}], ",", "1", ",", "10"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinX", ",", 
       RowBox[{"-", "1.06"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinY", ",", 
       RowBox[{"-", "1.5"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinZ", ",", 
       RowBox[{"-", "0.15"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgSize", ",", "2.865"}], "}"}], ",", "2", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgSizeZ", ",", "2.005"}], "}"}], ",", "2", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"samplingRadius", ",", "0.45"}], "}"}], ",", "0.2", ",", 
     "1.5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsCenterWidthMultiply", ",", "1.0295"}], "}"}], ",", "0.9", 
     ",", "1.1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsCenterXOffset", ",", 
       RowBox[{"-", "0.018"}]}], "}"}], ",", 
     RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsCenterYOffset", ",", 
       RowBox[{"-", "0.062"}]}], "}"}], ",", 
     RowBox[{"-", "0.2"}], ",", "0.2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsMinorRadius", ",", "0.4"}], "}"}], ",", "0.3", ",", 
     "0.5"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8381045114551363`*^9, 3.838104621306058*^9}, {
   3.8381047318712387`*^9, 3.8381047322481966`*^9}, {3.838104794488738*^9, 
   3.838105018474309*^9}, {3.8381051299062104`*^9, 3.838105146536306*^9}, {
   3.838105374402709*^9, 3.838105377296275*^9}, {3.838105554141843*^9, 
   3.838105659984576*^9}, {3.8381060886546383`*^9, 3.8381060930153093`*^9}, {
   3.8381062316590977`*^9, 3.8381062893154573`*^9}, {3.838106350865511*^9, 
   3.838106359414567*^9}, 3.8381064092334566`*^9, {3.83810687288235*^9, 
   3.8381069367815385`*^9}, {3.838106984663814*^9, 3.8381069951275673`*^9}, {
   3.8381071398045254`*^9, 3.8381072658717337`*^9}, {3.8381073503072834`*^9, 
   3.8381075332543845`*^9}, {3.8381077236884565`*^9, 
   3.8381077468396764`*^9}, {3.838107865615464*^9, 3.8381082317647915`*^9}, {
   3.838108263607842*^9, 3.8381083210600543`*^9}, {3.838108363584729*^9, 
   3.838108423001891*^9}, {3.838108490317093*^9, 3.838108512995843*^9}, {
   3.838590300439362*^9, 3.83859030125344*^9}, 3.838591772389261*^9, {
   3.8385921678668203`*^9, 3.838592181930876*^9}, {3.838595366170927*^9, 
   3.838595391521434*^9}, {3.8385955016339736`*^9, 3.838595530726467*^9}, {
   3.8387130559878073`*^9, 3.8387130564817243`*^9}, {3.8390587601131177`*^9, 
   3.8390587741025543`*^9}, {3.8390595766422176`*^9, 
   3.8390596155031347`*^9}, {3.8390596605241776`*^9, 3.83905975650671*^9}, {
   3.8390598162399225`*^9, 3.839060224983287*^9}, {3.839060565658577*^9, 
   3.8390606329551983`*^9}, {3.839060777791469*^9, 3.839060934879589*^9}, {
   3.8390609933000793`*^9, 3.8390611449516*^9}, {3.8390611764490485`*^9, 
   3.839061239199666*^9}, {3.8390612708643975`*^9, 3.839061406852685*^9}, {
   3.8392995311563835`*^9, 3.8392995319148836`*^9}, {3.8393006656541204`*^9, 
   3.8393007041070304`*^9}, {3.839300977291467*^9, 3.839300999572774*^9}, {
   3.8393010507126527`*^9, 3.8393010839473534`*^9}, {3.839301805794608*^9, 
   3.8393018185856514`*^9}, {3.8393077869435596`*^9, 
   3.8393078149637184`*^9}, {3.839307852285992*^9, 3.8393079044528666`*^9}, {
   3.8393166232329187`*^9, 3.8393166613672514`*^9}, {3.8393167388870745`*^9, 
   3.839316746625222*^9}, {3.839316819007837*^9, 3.8393168458627396`*^9}, {
   3.8393168848790874`*^9, 3.839316926802112*^9}, {3.839316982152668*^9, 
   3.83931706192227*^9}, {3.8393171104902377`*^9, 3.8393171976314726`*^9}, {
   3.839317230951835*^9, 3.8393175033154755`*^9}, {3.839317547802697*^9, 
   3.839317554450119*^9}, {3.8393175996978827`*^9, 3.839317632113021*^9}, {
   3.8393176792887383`*^9, 3.839317758072201*^9}, {3.8393177883614473`*^9, 
   3.8393178946640844`*^9}, {3.8393179446652236`*^9, 
   3.8393181553521194`*^9}, {3.839318221610052*^9, 3.8393182272965755`*^9}, {
   3.8393691531543207`*^9, 3.839369192577217*^9}, {3.8395546620420523`*^9, 
   3.8395546629175167`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"32509c09-4e03-4cf7-b0a4-9a78146cb38e"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`imgMinX$$ = -1.06, $CellContext`imgMinY$$ = \
-1.5, $CellContext`imgMinZ$$ = -0.15, $CellContext`imgSize$$ = 
    2.865, $CellContext`imgSizeZ$$ = 
    2.005, $CellContext`intsCenterWidthMultiply$$ = 
    1.0295, $CellContext`intsCenterXOffset$$ = -0.018, \
$CellContext`intsCenterYOffset$$ = -0.062, $CellContext`intsMinorRadius$$ = 
    0.4, $CellContext`lightDirX$$ = -4.4, $CellContext`lightDirY$$ = -2.38, \
$CellContext`lightDirZ$$ = 3.54, $CellContext`recvPtX$$ = 
    0.39, $CellContext`recvPtY$$ = -0.208, $CellContext`reflCenterX$$ = 
    0.814, $CellContext`reflCenterY$$ = 0.3, $CellContext`reflNormalY$$ = 
    1., $CellContext`reflNormalZ$$ = 0.145, $CellContext`samplingRadius$$ = 
    0.45, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reflCenterX$$], 0.814}, 0, 1.3}, {{
       Hold[$CellContext`reflCenterY$$], 0.3}, 0, 1}, {{
       Hold[$CellContext`reflNormalY$$], 1.}, -1, 1}, {{
       Hold[$CellContext`reflNormalZ$$], 0.145}, -1, 1}, {{
       Hold[$CellContext`recvPtX$$], 0.39}, -1, 1}, {{
       Hold[$CellContext`recvPtY$$], -0.208}, -0.5, 0.5}, {{
       Hold[$CellContext`lightDirX$$], -4.4}, -5, 5}, {{
       Hold[$CellContext`lightDirY$$], -2.38}, -5, 5}, {{
       Hold[$CellContext`lightDirZ$$], 3.54}, 1, 10}, {{
       Hold[$CellContext`imgMinX$$], -1.06}, -2, 2}, {{
       Hold[$CellContext`imgMinY$$], -1.5}, -2, 2}, {{
       Hold[$CellContext`imgMinZ$$], -0.15}, -2, 2}, {{
       Hold[$CellContext`imgSize$$], 2.865}, 2, 5}, {{
       Hold[$CellContext`imgSizeZ$$], 2.005}, 2, 5}, {{
       Hold[$CellContext`samplingRadius$$], 0.45}, 0.2, 1.5}, {{
       Hold[$CellContext`intsCenterWidthMultiply$$], 1.0295}, 0.9, 1.1}, {{
       Hold[$CellContext`intsCenterXOffset$$], -0.018}, -0.1, 0.1}, {{
       Hold[$CellContext`intsCenterYOffset$$], -0.062}, -0.2, 0.2}, {{
       Hold[$CellContext`intsMinorRadius$$], 0.4}, 0.3, 0.5}}, 
    Typeset`size$$ = {518., {204., 209.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`reflCenterX$3242$$ = 
    0, $CellContext`reflCenterY$3243$$ = 0, $CellContext`reflNormalY$3244$$ = 
    0, $CellContext`reflNormalZ$3245$$ = 0, $CellContext`recvPtX$3246$$ = 
    0, $CellContext`recvPtY$3247$$ = 0, $CellContext`lightDirX$3248$$ = 
    0, $CellContext`lightDirY$3249$$ = 0, $CellContext`lightDirZ$3250$$ = 
    0, $CellContext`imgMinX$3251$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`imgMinX$$ = -1.06, $CellContext`imgMinY$$ = \
-1.5, $CellContext`imgMinZ$$ = -0.15, $CellContext`imgSize$$ = 
        2.865, $CellContext`imgSizeZ$$ = 
        2.005, $CellContext`intsCenterWidthMultiply$$ = 
        1.0295, $CellContext`intsCenterXOffset$$ = -0.018, \
$CellContext`intsCenterYOffset$$ = -0.062, $CellContext`intsMinorRadius$$ = 
        0.4, $CellContext`lightDirX$$ = -4.4, $CellContext`lightDirY$$ = \
-2.38, $CellContext`lightDirZ$$ = 3.54, $CellContext`recvPtX$$ = 
        0.39, $CellContext`recvPtY$$ = -0.208, $CellContext`reflCenterX$$ = 
        0.814, $CellContext`reflCenterY$$ = 0.3, $CellContext`reflNormalY$$ = 
        1., $CellContext`reflNormalZ$$ = 0.145, $CellContext`samplingRadius$$ = 
        0.45}, "ControllerVariables" :> {
        Hold[$CellContext`reflCenterX$$, $CellContext`reflCenterX$3242$$, 0], 
        Hold[$CellContext`reflCenterY$$, $CellContext`reflCenterY$3243$$, 0], 
        Hold[$CellContext`reflNormalY$$, $CellContext`reflNormalY$3244$$, 0], 
        Hold[$CellContext`reflNormalZ$$, $CellContext`reflNormalZ$3245$$, 0], 
        Hold[$CellContext`recvPtX$$, $CellContext`recvPtX$3246$$, 0], 
        Hold[$CellContext`recvPtY$$, $CellContext`recvPtY$3247$$, 0], 
        Hold[$CellContext`lightDirX$$, $CellContext`lightDirX$3248$$, 0], 
        Hold[$CellContext`lightDirY$$, $CellContext`lightDirY$3249$$, 0], 
        Hold[$CellContext`lightDirZ$$, $CellContext`lightDirZ$3250$$, 0], 
        Hold[$CellContext`imgMinX$$, $CellContext`imgMinX$3251$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`reflCenter = {$CellContext`reflCenterX$$, \
$CellContext`reflCenterY$$, 1}; $CellContext`reflNormal = 
        Normalize[{
          1, $CellContext`reflNormalY$$, $CellContext`reflNormalZ$$}]; \
$CellContext`lightDir = 
        Normalize[{$CellContext`lightDirX$$, $CellContext`lightDirY$$, \
$CellContext`lightDirZ$$}]; $CellContext`recvPt = {$CellContext`recvPtX$$, \
$CellContext`recvPtY$$, 0}; $CellContext`reflPeakPt = 
        gBRDF`gCalcPeakPoint[$CellContext`reflNormal, \
$CellContext`reflCenter, -$CellContext`lightDir, $CellContext`recvPt]; \
$CellContext`bounceDir = 
        Normalize[$CellContext`recvPt - $CellContext`reflPeakPt]; \
$CellContext`outDir = 
        gUtils`gReflectVector[-$CellContext`bounceDir, {0, 0, 
          1}]; $CellContext`minorAxis = Normalize[
          Cross[$CellContext`reflNormal, {0, 1, 0}]]; $CellContext`majorAxis = 
        Normalize[
          
          Cross[$CellContext`minorAxis, $CellContext`reflNormal]]; \
$CellContext`intsMin = $CellContext`reflPeakPt + $CellContext`majorAxis \
($CellContext`samplingRadius$$ + $CellContext`intsCenterXOffset$$) - \
$CellContext`minorAxis (
          0.3 + $CellContext`intsCenterYOffset$$); $CellContext`intsMax = \
$CellContext`reflPeakPt - $CellContext`majorAxis \
$CellContext`samplingRadius$$ + $CellContext`minorAxis \
$CellContext`samplingRadius$$; $CellContext`intsCenter = \
($CellContext`intsMin + $CellContext`intsMax)/2; $CellContext`pltLighting = 
        Automatic; Show[{
          (gPlots3DEx`pltRectLine3D[
           Association[
           "center" -> {0, 0, 0}, "normal" -> {0, 0, 1}, 
            "majorAxis" -> {1, 0, 0}, "majorRadius" -> 1, "minorRadius" -> 
            0.5, "color" -> Black]]& )[
           Association[]], 
          (gPlots3DEx`pltRectLine3D[
           Association[
           "center" -> $CellContext`intsCenter, 
            "normal" -> $CellContext`reflNormal, "style" -> Dashed, 
            "majorAxis" -> {0, 1, 0}, 
            "majorRadius" -> $CellContext`samplingRadius$$ \
$CellContext`intsCenterWidthMultiply$$, "minorRadius" -> 
            Slot["intsMinorRadius"], "color" -> Orange]]& )[
           Association["intsMinorRadius" -> $CellContext`intsMinorRadius$$]], 
          (gPlots3DEx`pltRectLine3D[
           Association[
           "center" -> Slot["centerPt"], "normal" -> $CellContext`reflNormal, 
            "majorAxis" -> {0, 1, 0}, "majorRadius" -> 1, "minorRadius" -> 
            0.5, "color" -> Black]]& )[
           Association["centerPt" -> $CellContext`reflCenter]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt + $CellContext`lightDir 1.5, 
            "dir" -> -$CellContext`lightDir, "length" -> 1.5, "arrowPos" -> 
            0.3]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, "dir" -> 
            Normalize[$CellContext`recvPt - $CellContext`reflPeakPt], 
            "length" -> Norm[$CellContext`recvPt - $CellContext`reflPeakPt], 
            "arrowPos" -> 0.5]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`recvPt, "dir" -> $CellContext`outDir, 
            "length" -> 2, "arrowPos" -> 0.8]]& )[
           Association[]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`recvPt, "size" -> 0.01, "color" -> Black]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, 
            "dir" -> -$CellContext`reflNormal, "length" -> 0.6, "thickness" -> 
            0.5, "color" -> Red]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`recvPt, "dir" -> {0, 0, 1}, "length" -> 
            0.6, "thickness" -> 0.5, "color" -> Red]]& )[
           Association[]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`reflPeakPt, "size" -> 0.01, "color" -> 
            Black]]& )[
           Association[]], 
          (gPlots3DEx`pltCircle3D[
           Association[
           "center" -> $CellContext`reflPeakPt, 
            "normal" -> $CellContext`reflNormal, "radius" -> 0.5, "thickness" -> 
            1, "color" -> Blue]]& )[
           Association["radius" -> $CellContext`samplingRadius$$]], 
          Graphics3D[{
            Text[
             Style[
             "R'", FontSize -> 16, Orange, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {0.3, 0, 0.46}]}], 
          Graphics3D[{
            Text[
             Style[
             "Light", FontSize -> 16, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + $CellContext`lightDir 
              1.65]}], 
          Graphics3D[{
            Text[
             Style[
             "-i", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + $CellContext`lightDir 
              1.2 + {-0.05, 0, -0.1}]}], 
          Graphics3D[{
            Text[
             Style[
             "y", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {0.07, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "r", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + 
             Normalize[$CellContext`recvPt - $CellContext`reflPeakPt] 0.5 + {
              0.1, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "o", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`recvPt + $CellContext`outDir 1.6 + {
              0.1, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "x", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`recvPt + {0.08, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "\!\(\*SubscriptBox[\(n\), \(r\)]\)", FontSize -> 16, Bold, Red, 
              FontFamily -> 
              "Times"], $CellContext`reflPeakPt - $CellContext`reflNormal 
             0.65]}], 
          Graphics3D[{
            Text[
             Style[
             "\!\(\*SubscriptBox[\(n\), \(x\)]\)", FontSize -> 16, Bold, Red, 
              FontFamily -> "Times"], $CellContext`recvPt + {0, 0, 1} 0.7]}], 
          Graphics3D[{
            Text[
             Style[
             "Rectangle R\n(reflector)", FontSize -> 16, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {0.8, 0, 0.7}]}], 
          Graphics3D[{
            Text[
             Style[
             "receiver", FontSize -> 16, FontFamily -> 
              "Times"], $CellContext`recvPt + {0, 0, -0.3}]}], 
          Graphics3D[{
            Text[
             Style[
             "D", FontSize -> 16, Bold, Blue, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {0, 0, 0.55}]}]}, 
         PlotRange -> {{$CellContext`imgMinX$$, $CellContext`imgMinX$$ + \
$CellContext`imgSize$$}, {$CellContext`imgMinY$$, $CellContext`imgMinY$$ + \
$CellContext`imgSize$$}, {$CellContext`imgMinZ$$, $CellContext`imgMinZ$$ + \
$CellContext`imgSizeZ$$}}, Axes -> False, Boxed -> False, 
         ViewPoint -> {0, -2, 1}, AxesLabel -> {"X", "Y", "Z"}, ImageSize -> 
         Large]), 
      "Specifications" :> {{{$CellContext`reflCenterX$$, 0.814}, 0, 
         1.3}, {{$CellContext`reflCenterY$$, 0.3}, 0, 
         1}, {{$CellContext`reflNormalY$$, 1.}, -1, 
         1}, {{$CellContext`reflNormalZ$$, 0.145}, -1, 
         1}, {{$CellContext`recvPtX$$, 0.39}, -1, 
         1}, {{$CellContext`recvPtY$$, -0.208}, -0.5, 
         0.5}, {{$CellContext`lightDirX$$, -4.4}, -5, 
         5}, {{$CellContext`lightDirY$$, -2.38}, -5, 
         5}, {{$CellContext`lightDirZ$$, 3.54}, 1, 
         10}, {{$CellContext`imgMinX$$, -1.06}, -2, 
         2}, {{$CellContext`imgMinY$$, -1.5}, -2, 
         2}, {{$CellContext`imgMinZ$$, -0.15}, -2, 
         2}, {{$CellContext`imgSize$$, 2.865}, 2, 
         5}, {{$CellContext`imgSizeZ$$, 2.005}, 2, 
         5}, {{$CellContext`samplingRadius$$, 0.45}, 0.2, 
         1.5}, {{$CellContext`intsCenterWidthMultiply$$, 1.0295}, 0.9, 
         1.1}, {{$CellContext`intsCenterXOffset$$, -0.018}, -0.1, 
         0.1}, {{$CellContext`intsCenterYOffset$$, -0.062}, -0.2, 
         0.2}, {{$CellContext`intsMinorRadius$$, 0.4}, 0.3, 0.5}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{869., {252., 258.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.839058762957086*^9, 3.839058775644432*^9}, {
   3.8390596044271526`*^9, 3.839059615995593*^9}, {3.839059713102023*^9, 
   3.83905975699415*^9}, {3.839059820404539*^9, 3.8390599217598886`*^9}, {
   3.839060001675419*^9, 3.8390601126900644`*^9}, {3.839060148192834*^9, 
   3.839060187645644*^9}, {3.8390602200720105`*^9, 3.8390602253423567`*^9}, {
   3.839060779371044*^9, 3.839060862763859*^9}, {3.839060924852326*^9, 
   3.8390609353523235`*^9}, 3.839061007219391*^9, {3.8390610410364275`*^9, 
   3.8390610806082196`*^9}, {3.839061215089179*^9, 3.8390612396770897`*^9}, {
   3.8390612716804094`*^9, 3.8390613016122427`*^9}, {3.8390613567579145`*^9, 
   3.8390614073182683`*^9}, {3.8392995230566034`*^9, 3.839299533041233*^9}, 
   3.839300673806241*^9, 3.8393009789999847`*^9, 3.839301054406039*^9, 
   3.83930108581306*^9, {3.8393018093524055`*^9, 3.8393018196259375`*^9}, {
   3.8393077987133646`*^9, 3.839307905148016*^9}, 3.8393079710088544`*^9, {
   3.8393170145255795`*^9, 3.8393171358239803`*^9}, {3.8393173491749716`*^9, 
   3.839317355481311*^9}, 3.839317407690111*^9, 3.8393175841068597`*^9, 
   3.839317632680503*^9, {3.8393176799213953`*^9, 3.839317714218418*^9}, 
   3.8393177588508005`*^9, {3.8393178170550957`*^9, 3.8393178638602805`*^9}, 
   3.8393179267151318`*^9, {3.8393179713319335`*^9, 3.8393180527644672`*^9}, {
   3.8393180966528845`*^9, 3.839318155803913*^9}, {3.839318222336144*^9, 
   3.839318227702458*^9}, 3.8393683316454372`*^9, {3.839369154135232*^9, 
   3.8393691929711633`*^9}, 3.8393932458282347`*^9, {3.8395546575073123`*^9, 
   3.839554664987511*^9}, 3.839567454166438*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"97c3f28e-43a7-4411-a943-1b3bf88afe25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "reflCenter", ",", "reflNormal", ",", "lightDir", ",", "pltLighting", ",", 
    "reflPeakPt", ",", "recvPt", ",", "\[IndentingNewLine]", "\t", 
    "bounceDir", ",", "outDir", ",", "minorAxis", ",", "majorAxis", ",", 
    "intsMin", ",", "intsMax", ",", "intsCenter", ",", "\[IndentingNewLine]", 
    "\t", "uaxis", ",", "vaxis", ",", "coneApertureNormal"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"reflCenter", "=", 
     RowBox[{"{", 
      RowBox[{"reflCenterX", ",", "reflCenterY", ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"reflNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "reflNormalY", ",", "reflNormalZ"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"lightDirX", ",", "lightDirY", ",", "lightDirZ"}], "}"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"pltLighting", "=", 
       RowBox[{"{", 
        RowBox[{"\"\<Directional\>\"", ",", "White", ",", 
         RowBox[{"{", 
          RowBox[{"testLightDir", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"recvPt", "=", 
     RowBox[{"{", 
      RowBox[{"recvPtX", ",", "recvPtY", ",", "0"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"reflPeakPt", "=", 
     RowBox[{"gCalcPeakPoint", "[", 
      RowBox[{"reflNormal", ",", "reflCenter", ",", 
       RowBox[{"-", "lightDir"}], ",", "recvPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"bounceDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"outDir", "=", 
     RowBox[{"gReflectVector", "[", 
      RowBox[{
       RowBox[{"-", "bounceDir"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"uv", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"vaxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"recvPt", "-", "reflPeakPt"}], ",", "reflNormal"}], "]"}]}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"uaxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"reflNormal", ",", "vaxis"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"approximate", " ", "intersection", " ", "area"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"minorAxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"reflNormal", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}]}], ";", "\n", 
    "   ", 
    RowBox[{"majorAxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"minorAxis", ",", "reflNormal"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsMin", "=", 
     RowBox[{"reflPeakPt", "+", 
      RowBox[{"majorAxis", "*", 
       RowBox[{"(", 
        RowBox[{"samplingRadius", "+", "intsCenterXOffset"}], ")"}]}], "-", 
      RowBox[{"minorAxis", "*", 
       RowBox[{"(", 
        RowBox[{"0.3", "+", "intsCenterYOffset"}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsMax", "=", 
     RowBox[{"reflPeakPt", "-", 
      RowBox[{"majorAxis", "*", "samplingRadius"}], "+", 
      RowBox[{"minorAxis", "*", "samplingRadius"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsCenter", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"intsMin", "+", "intsMax"}], ")"}], "/", "2"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"cone", " ", "aperture"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"coneApertureNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"recvPt", "-", "reflPeakPt"}], ",", "vaxis"}], "]"}]}]}], ";",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"pltLighting", "=", "Automatic"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", "cone", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", "0.3", "]"}], ",", "Cyan", ",", 
             RowBox[{"Cone", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"reflPeakPt", ",", "recvPt"}], "}"}], ",", 
               "#coneRadius"}], "]"}]}], "}"}], "\[IndentingNewLine]", "]"}], 
          "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<coneRadius\>\"", "\[Rule]", "coneRadius"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"sampling", " ", "disk"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pltCircle3D", "[", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "reflPeakPt"}], ",", 
               RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "0.5"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}]}], "|>"}], 
             "\[IndentingNewLine]", "\t", "]"}], "&"}], "[", 
           RowBox[{"<|", 
            RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], "|>"}], 
           "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArc3DDirect", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<\[Phi]1\>\"", "\[Rule]", "#\[Phi]1"}], ",", 
             RowBox[{"\"\<\[Phi]2\>\"", "\[Rule]", "#\[Phi]2"}], ",", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}]}], "|>"}], 
           "\[IndentingNewLine]", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], ",", 
           RowBox[{"\"\<\[Phi]1\>\"", "->", "diskPhi1"}], ",", 
           RowBox[{"\"\<\[Phi]2\>\"", "->", "diskPhi2"}]}], "|>"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArc3DDirect", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<\[Phi]1\>\"", "\[Rule]", "#\[Phi]2"}], ",", 
             RowBox[{"\"\<\[Phi]2\>\"", "\[Rule]", "#\[Phi]1"}], ",", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
             RowBox[{"\"\<style\>\"", "\[Rule]", "Dashed"}]}], "|>"}], 
           "\[IndentingNewLine]", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], ",", 
           RowBox[{"\"\<\[Phi]1\>\"", "->", "diskPhi1"}], ",", 
           RowBox[{"\"\<\[Phi]2\>\"", "->", "diskPhi2"}]}], "|>"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"u", "-", 
          RowBox[{"v", " ", "axis"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "uaxis"}]}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "1"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", "vaxis"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "1"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"cone", " ", "aperture"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArc3DDirect", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "recvPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "coneApertureNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.3"}], ",", 
             RowBox[{"\"\<style\>\"", "\[Rule]", "Dashed"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<\[Phi]1\>\"", "\[Rule]", "#\[Phi]1"}], ",", 
             RowBox[{"\"\<\[Phi]2\>\"", "\[Rule]", "#\[Phi]2"}], ",", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], ",", 
           RowBox[{"\"\<\[Phi]1\>\"", "\[Rule]", "apertPhi1"}], ",", 
           RowBox[{"\"\<\[Phi]2\>\"", "->", "apertPhi2"}]}], "|>"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "receiver", "*)"}], "\[IndentingNewLine]", "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRectLine3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "reflector", "*)"}], "\[IndentingNewLine]", "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRectLine3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "#centerPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<centerPt\>\"", "\[Rule]", "reflCenter"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "arrow"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"reflPeakPt", "+", 
               RowBox[{"lightDir", "*", "1.5"}]}]}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "lightDir"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "1.5"}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.3"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"one", " ", "bounce", " ", "arrow"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"Normalize", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", 
              RowBox[{"Norm", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.5"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"out", " ", "dir", " ", "arrow"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pltArrow3D", "[", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<origin\>\"", "\[Rule]", "recvPt"}], ",", 
               RowBox[{"\"\<dir\>\"", "\[Rule]", "outDir"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "2"}], ",", 
               RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.8"}]}], "|>"}], 
             "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
           RowBox[{"<|", "|>"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"recv", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "recvPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"reflector", " ", "normal"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "reflNormal"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.6"}], ",", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Orange"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"recv", " ", "normal"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pltArrow3D", "[", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<origin\>\"", "\[Rule]", "recvPt"}], ",", 
               RowBox[{"\"\<dir\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "0.6"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.5"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
             "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
           RowBox[{"<|", "|>"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"refl", " ", "peak", " ", "point"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "text", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Light\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"lightDir", "*", "1.65"}]}]}], "]"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<-i\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"lightDir", "*", "1.2"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.05"}], ",", "0", ",", 
               RowBox[{"-", "0.1"}]}], "}"}]}]}], "]"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<y\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{"0.07", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<r\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{
              RowBox[{"Normalize", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}], "*", "0.5"}], 
             "+", 
             RowBox[{"{", 
              RowBox[{"0.1", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<o\>\"", ",", 
                RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
              ",", 
              RowBox[{"recvPt", "+", 
               RowBox[{"outDir", "*", "1.6"}], "+", 
               RowBox[{"{", 
                RowBox[{"0.1", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
           "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<x\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{"{", 
              RowBox[{"0.08", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\!\(\*SubscriptBox[\(n\), \(r\)]\)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              "Orange", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "-", 
             RowBox[{"reflNormal", "*", "0.65"}]}]}], "]"}], "}"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<\!\(\*SubscriptBox[\(n\), \(x\)]\)\>\"", ",", 
                RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
                "Red", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
              ",", 
              RowBox[{"recvPt", "+", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}], "*", "0.7"}]}]}], 
             "]"}], "}"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Rectangle R\\n(reflector)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.3"}], ",", "0", ",", "0.9"}], "}"}]}]}], "]"}],
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<receiver\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "0.3"}]}], "}"}]}]}], "]"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<D\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", "Blue",
               ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0.55"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"OverBar", "[", "\"\<u\>\"", "]"}], ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "-", 
             RowBox[{"uaxis", "*", "0.5"}], "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0.05"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"OverBar", "[", "\"\<v\>\"", "]"}], ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"vaxis", "*", "0.5"}], "+", 
             RowBox[{"{", 
              RowBox[{"0.05", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\[Alpha]\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{"{", 
              RowBox[{"0.12", ",", "0", ",", "0.28"}], "}"}]}]}], "]"}], 
          "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"imgMinX", ",", 
           RowBox[{"imgMinX", "+", "imgSize"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"imgMinY", ",", 
           RowBox[{"imgMinY", "+", "imgSize"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"imgMinZ", ",", 
           RowBox[{"imgMinZ", "+", "imgSizeZ"}]}], "}"}]}], "}"}]}], ",", 
      "\n", "\t\t", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "2"}], ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
      "\t    ", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
      ",", "\[IndentingNewLine]", "\t    ", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"apertPhi1", ",", "0.351858"}], "}"}], ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"apertPhi2", ",", "0.942478"}], "}"}], ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskPhi1", ",", "2.50071"}], "}"}], ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskPhi2", ",", "5.51664"}], "}"}], ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"coneRadius", ",", "0.442"}], "}"}], ",", "0.1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflCenterX", ",", "0.814"}], "}"}], ",", "0", ",", "1.3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflCenterY", ",", "0.3"}], "}"}], ",", "0", ",", "1"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflNormalY", ",", "1."}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflNormalZ", ",", "0.145"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"recvPtX", ",", "0.39"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"recvPtY", ",", 
       RowBox[{"-", "0.208"}]}], "}"}], ",", 
     RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirX", ",", 
       RowBox[{"-", "4.4"}]}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirY", ",", 
       RowBox[{"-", "2.38"}]}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirZ", ",", "3.54"}], "}"}], ",", "1", ",", "10"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinX", ",", 
       RowBox[{"-", "0.36"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinY", ",", 
       RowBox[{"-", "0.62"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinZ", ",", 
       RowBox[{"-", "0.19"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgSize", ",", "1.6"}], "}"}], ",", "1", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgSizeZ", ",", "2.005"}], "}"}], ",", "2", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"samplingRadius", ",", "0.45"}], "}"}], ",", "0.2", ",", 
     "1.5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsCenterWidthMultiply", ",", "1.0295"}], "}"}], ",", "0.9", 
     ",", "1.1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsCenterXOffset", ",", 
       RowBox[{"-", "0.018"}]}], "}"}], ",", 
     RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsCenterYOffset", ",", 
       RowBox[{"-", "0.062"}]}], "}"}], ",", 
     RowBox[{"-", "0.2"}], ",", "0.2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsMinorRadius", ",", "0.4"}], "}"}], ",", "0.3", ",", 
     "0.5"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.839404094746642*^9, 3.839404101527314*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"61d6c217-67ca-459c-81f4-23382bf91bc5"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`apertPhi1$$ = 
    0.351858, $CellContext`apertPhi2$$ = 0.942478, $CellContext`coneRadius$$ =
     0.442, $CellContext`diskPhi1$$ = 2.50071, $CellContext`diskPhi2$$ = 
    5.51664, $CellContext`imgMinX$$ = -0.36, $CellContext`imgMinY$$ = -0.62, \
$CellContext`imgMinZ$$ = -0.19, $CellContext`imgSize$$ = 
    1.6, $CellContext`imgSizeZ$$ = 
    2.005, $CellContext`intsCenterWidthMultiply$$ = 
    1.0295, $CellContext`intsCenterXOffset$$ = -0.018, \
$CellContext`intsCenterYOffset$$ = -0.062, $CellContext`intsMinorRadius$$ = 
    0.4, $CellContext`lightDirX$$ = -4.4, $CellContext`lightDirY$$ = -2.38, \
$CellContext`lightDirZ$$ = 3.54, $CellContext`recvPtX$$ = 
    0.39, $CellContext`recvPtY$$ = -0.208, $CellContext`reflCenterX$$ = 
    0.814, $CellContext`reflCenterY$$ = 0.3, $CellContext`reflNormalY$$ = 
    1., $CellContext`reflNormalZ$$ = 0.145, $CellContext`samplingRadius$$ = 
    0.45, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`apertPhi1$$], 0.351858}, 0, 2 Pi}, {{
       Hold[$CellContext`apertPhi2$$], 0.942478}, 0, 2 Pi}, {{
       Hold[$CellContext`diskPhi1$$], 2.50071}, 0, 2 Pi}, {{
       Hold[$CellContext`diskPhi2$$], 5.51664}, 0, 2 Pi}, {{
       Hold[$CellContext`coneRadius$$], 0.442}, 0.1, 1}, {{
       Hold[$CellContext`reflCenterX$$], 0.814}, 0, 1.3}, {{
       Hold[$CellContext`reflCenterY$$], 0.3}, 0, 1}, {{
       Hold[$CellContext`reflNormalY$$], 1.}, -1, 1}, {{
       Hold[$CellContext`reflNormalZ$$], 0.145}, -1, 1}, {{
       Hold[$CellContext`recvPtX$$], 0.39}, -1, 1}, {{
       Hold[$CellContext`recvPtY$$], -0.208}, -0.5, 0.5}, {{
       Hold[$CellContext`lightDirX$$], -4.4}, -5, 5}, {{
       Hold[$CellContext`lightDirY$$], -2.38}, -5, 5}, {{
       Hold[$CellContext`lightDirZ$$], 3.54}, 1, 10}, {{
       Hold[$CellContext`imgMinX$$], -0.36}, -2, 2}, {{
       Hold[$CellContext`imgMinY$$], -0.62}, -2, 2}, {{
       Hold[$CellContext`imgMinZ$$], -0.19}, -2, 2}, {{
       Hold[$CellContext`imgSize$$], 1.6}, 1, 5}, {{
       Hold[$CellContext`imgSizeZ$$], 2.005}, 2, 5}, {{
       Hold[$CellContext`samplingRadius$$], 0.45}, 0.2, 1.5}, {{
       Hold[$CellContext`intsCenterWidthMultiply$$], 1.0295}, 0.9, 1.1}, {{
       Hold[$CellContext`intsCenterXOffset$$], -0.018}, -0.1, 0.1}, {{
       Hold[$CellContext`intsCenterYOffset$$], -0.062}, -0.2, 0.2}, {{
       Hold[$CellContext`intsMinorRadius$$], 0.4}, 0.3, 0.5}}, 
    Typeset`size$$ = {518., {287., 293.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`apertPhi1$3453$$ = 0, $CellContext`apertPhi2$3454$$ = 
    0, $CellContext`diskPhi1$3455$$ = 0, $CellContext`diskPhi2$3456$$ = 
    0, $CellContext`coneRadius$3457$$ = 0, $CellContext`reflCenterX$3458$$ = 
    0, $CellContext`reflCenterY$3459$$ = 0, $CellContext`reflNormalY$3460$$ = 
    0, $CellContext`reflNormalZ$3461$$ = 0, $CellContext`recvPtX$3462$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`apertPhi1$$ = 
        0.351858, $CellContext`apertPhi2$$ = 
        0.942478, $CellContext`coneRadius$$ = 0.442, $CellContext`diskPhi1$$ = 
        2.50071, $CellContext`diskPhi2$$ = 
        5.51664, $CellContext`imgMinX$$ = -0.36, $CellContext`imgMinY$$ = \
-0.62, $CellContext`imgMinZ$$ = -0.19, $CellContext`imgSize$$ = 
        1.6, $CellContext`imgSizeZ$$ = 
        2.005, $CellContext`intsCenterWidthMultiply$$ = 
        1.0295, $CellContext`intsCenterXOffset$$ = -0.018, \
$CellContext`intsCenterYOffset$$ = -0.062, $CellContext`intsMinorRadius$$ = 
        0.4, $CellContext`lightDirX$$ = -4.4, $CellContext`lightDirY$$ = \
-2.38, $CellContext`lightDirZ$$ = 3.54, $CellContext`recvPtX$$ = 
        0.39, $CellContext`recvPtY$$ = -0.208, $CellContext`reflCenterX$$ = 
        0.814, $CellContext`reflCenterY$$ = 0.3, $CellContext`reflNormalY$$ = 
        1., $CellContext`reflNormalZ$$ = 0.145, $CellContext`samplingRadius$$ = 
        0.45}, "ControllerVariables" :> {
        Hold[$CellContext`apertPhi1$$, $CellContext`apertPhi1$3453$$, 0], 
        Hold[$CellContext`apertPhi2$$, $CellContext`apertPhi2$3454$$, 0], 
        Hold[$CellContext`diskPhi1$$, $CellContext`diskPhi1$3455$$, 0], 
        Hold[$CellContext`diskPhi2$$, $CellContext`diskPhi2$3456$$, 0], 
        Hold[$CellContext`coneRadius$$, $CellContext`coneRadius$3457$$, 0], 
        Hold[$CellContext`reflCenterX$$, $CellContext`reflCenterX$3458$$, 0], 
        Hold[$CellContext`reflCenterY$$, $CellContext`reflCenterY$3459$$, 0], 
        Hold[$CellContext`reflNormalY$$, $CellContext`reflNormalY$3460$$, 0], 
        Hold[$CellContext`reflNormalZ$$, $CellContext`reflNormalZ$3461$$, 0], 
        Hold[$CellContext`recvPtX$$, $CellContext`recvPtX$3462$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`reflCenter = {$CellContext`reflCenterX$$, \
$CellContext`reflCenterY$$, 1}; $CellContext`reflNormal = 
        Normalize[{
          1, $CellContext`reflNormalY$$, $CellContext`reflNormalZ$$}]; \
$CellContext`lightDir = 
        Normalize[{$CellContext`lightDirX$$, $CellContext`lightDirY$$, \
$CellContext`lightDirZ$$}]; $CellContext`recvPt = {$CellContext`recvPtX$$, \
$CellContext`recvPtY$$, 0}; $CellContext`reflPeakPt = 
        gBRDF`gCalcPeakPoint[$CellContext`reflNormal, \
$CellContext`reflCenter, -$CellContext`lightDir, $CellContext`recvPt]; \
$CellContext`bounceDir = 
        Normalize[$CellContext`recvPt - $CellContext`reflPeakPt]; \
$CellContext`outDir = 
        gUtils`gReflectVector[-$CellContext`bounceDir, {0, 0, 
          1}]; $CellContext`vaxis = Normalize[
          
          Cross[$CellContext`recvPt - $CellContext`reflPeakPt, \
$CellContext`reflNormal]]; $CellContext`uaxis = Normalize[
          
          Cross[$CellContext`reflNormal, $CellContext`vaxis]]; \
$CellContext`minorAxis = Normalize[
          Cross[$CellContext`reflNormal, {0, 1, 0}]]; $CellContext`majorAxis = 
        Normalize[
          
          Cross[$CellContext`minorAxis, $CellContext`reflNormal]]; \
$CellContext`intsMin = $CellContext`reflPeakPt + $CellContext`majorAxis \
($CellContext`samplingRadius$$ + $CellContext`intsCenterXOffset$$) - \
$CellContext`minorAxis (
          0.3 + $CellContext`intsCenterYOffset$$); $CellContext`intsMax = \
$CellContext`reflPeakPt - $CellContext`majorAxis \
$CellContext`samplingRadius$$ + $CellContext`minorAxis \
$CellContext`samplingRadius$$; $CellContext`intsCenter = \
($CellContext`intsMin + $CellContext`intsMax)/
         2; $CellContext`coneApertureNormal = Normalize[
          
          Cross[$CellContext`recvPt - $CellContext`reflPeakPt, \
$CellContext`vaxis]]; $CellContext`pltLighting = Automatic; Show[{
          (Graphics3D[{
            Opacity[0.3], Cyan, 
            Cone[{$CellContext`reflPeakPt, $CellContext`recvPt}, 
             Slot["coneRadius"]]}]& )[
           Association["coneRadius" -> $CellContext`coneRadius$$]], 
          (gPlots3DEx`pltArc3DDirect[
           Association[
           "center" -> $CellContext`reflPeakPt, 
            "normal" -> $CellContext`reflNormal, "radius" -> 0.5, "\[Phi]1" -> 
            Slot["\[Phi]1"], "\[Phi]2" -> Slot["\[Phi]2"], "thickness" -> 1, 
            "color" -> Blue]]& )[
           Association[
           "radius" -> $CellContext`samplingRadius$$, 
            "\[Phi]1" -> $CellContext`diskPhi1$$, 
            "\[Phi]2" -> $CellContext`diskPhi2$$]], 
          (gPlots3DEx`pltArc3DDirect[
           Association[
           "center" -> $CellContext`reflPeakPt, 
            "normal" -> $CellContext`reflNormal, "radius" -> 0.5, "\[Phi]1" -> 
            Slot["\[Phi]2"], "\[Phi]2" -> Slot["\[Phi]1"], "thickness" -> 1, 
            "color" -> Blue, "style" -> Dashed]]& )[
           Association[
           "radius" -> $CellContext`samplingRadius$$, 
            "\[Phi]1" -> $CellContext`diskPhi1$$, 
            "\[Phi]2" -> $CellContext`diskPhi2$$]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, "dir" -> -$CellContext`uaxis, 
            "color" -> Red, "length" -> 0.5, "arrowPos" -> 1]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, "dir" -> $CellContext`vaxis, 
            "color" -> Red, "length" -> 0.5, "arrowPos" -> 1]]& )[
           Association[]], 
          (gPlots3DEx`pltArc3DDirect[
           Association[
           "center" -> $CellContext`recvPt, 
            "normal" -> $CellContext`coneApertureNormal, "radius" -> 0.3, 
            "style" -> Dashed, "\[Phi]1" -> Slot["\[Phi]1"], "\[Phi]2" -> 
            Slot["\[Phi]2"], "thickness" -> 1, "color" -> Black]]& )[
           Association[
           "radius" -> $CellContext`samplingRadius$$, 
            "\[Phi]1" -> $CellContext`apertPhi1$$, 
            "\[Phi]2" -> $CellContext`apertPhi2$$]], 
          (gPlots3DEx`pltRectLine3D[
           Association[
           "center" -> {0, 0, 0}, "normal" -> {0, 0, 1}, 
            "majorAxis" -> {1, 0, 0}, "majorRadius" -> 1, "minorRadius" -> 
            0.5, "color" -> Black]]& )[
           Association[]], 
          (gPlots3DEx`pltRectLine3D[
           Association[
           "center" -> Slot["centerPt"], "normal" -> $CellContext`reflNormal, 
            "majorAxis" -> {0, 1, 0}, "majorRadius" -> 1, "minorRadius" -> 
            0.5, "color" -> Black]]& )[
           Association["centerPt" -> $CellContext`reflCenter]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt + $CellContext`lightDir 1.5, 
            "dir" -> -$CellContext`lightDir, "length" -> 1.5, "arrowPos" -> 
            0.3]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, "dir" -> 
            Normalize[$CellContext`recvPt - $CellContext`reflPeakPt], 
            "length" -> Norm[$CellContext`recvPt - $CellContext`reflPeakPt], 
            "arrowPos" -> 0.5]]& )[
           Association[]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`recvPt, "size" -> 0.01, "color" -> Black]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, 
            "dir" -> -$CellContext`reflNormal, "length" -> 0.6, "thickness" -> 
            0.5, "color" -> Orange]]& )[
           Association[]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`reflPeakPt, "size" -> 0.01, "color" -> 
            Black]]& )[
           Association[]], 
          Graphics3D[{
            Text[
             Style[
             "Light", FontSize -> 16, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + $CellContext`lightDir 
              1.65]}], 
          Graphics3D[{
            Text[
             Style[
             "-i", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + $CellContext`lightDir 
              1.2 + {-0.05, 0, -0.1}]}], 
          Graphics3D[{
            Text[
             Style[
             "y", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {0.07, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "r", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + 
             Normalize[$CellContext`recvPt - $CellContext`reflPeakPt] 0.5 + {
              0.1, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "x", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`recvPt + {0.08, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "\!\(\*SubscriptBox[\(n\), \(r\)]\)", FontSize -> 16, Bold, 
              Orange, FontFamily -> 
              "Times"], $CellContext`reflPeakPt - $CellContext`reflNormal 
             0.65]}], 
          Graphics3D[{
            Text[
             Style[
             "Rectangle R\n(reflector)", FontSize -> 16, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {-0.3, 0, 0.9}]}], 
          Graphics3D[{
            Text[
             Style[
             "receiver", FontSize -> 16, FontFamily -> 
              "Times"], $CellContext`recvPt + {0, 0, -0.3}]}], 
          Graphics3D[{
            Text[
             Style[
             "D", FontSize -> 16, Bold, Blue, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {0, 0, 0.55}]}], 
          Graphics3D[{
            Text[
             Style[
              OverBar["u"], FontSize -> 16, Red, FontFamily -> 
              "Times"], $CellContext`reflPeakPt - $CellContext`uaxis 
             0.5 + {0, 0, 0.05}]}], 
          Graphics3D[{
            Text[
             Style[
              OverBar["v"], FontSize -> 16, Red, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + $CellContext`vaxis 0.5 + {
              0.05, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "\[Alpha]", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`recvPt + {0.12, 0, 0.28}]}]}, 
         PlotRange -> {{$CellContext`imgMinX$$, $CellContext`imgMinX$$ + \
$CellContext`imgSize$$}, {$CellContext`imgMinY$$, $CellContext`imgMinY$$ + \
$CellContext`imgSize$$}, {$CellContext`imgMinZ$$, $CellContext`imgMinZ$$ + \
$CellContext`imgSizeZ$$}}, Axes -> False, Boxed -> False, 
         ViewPoint -> {0, -2, 1}, AxesLabel -> {"X", "Y", "Z"}, ImageSize -> 
         Large]), 
      "Specifications" :> {{{$CellContext`apertPhi1$$, 0.351858}, 0, 2 
         Pi}, {{$CellContext`apertPhi2$$, 0.942478}, 0, 2 
         Pi}, {{$CellContext`diskPhi1$$, 2.50071}, 0, 2 
         Pi}, {{$CellContext`diskPhi2$$, 5.51664}, 0, 2 
         Pi}, {{$CellContext`coneRadius$$, 0.442}, 0.1, 
         1}, {{$CellContext`reflCenterX$$, 0.814}, 0, 
         1.3}, {{$CellContext`reflCenterY$$, 0.3}, 0, 
         1}, {{$CellContext`reflNormalY$$, 1.}, -1, 
         1}, {{$CellContext`reflNormalZ$$, 0.145}, -1, 
         1}, {{$CellContext`recvPtX$$, 0.39}, -1, 
         1}, {{$CellContext`recvPtY$$, -0.208}, -0.5, 
         0.5}, {{$CellContext`lightDirX$$, -4.4}, -5, 
         5}, {{$CellContext`lightDirY$$, -2.38}, -5, 
         5}, {{$CellContext`lightDirZ$$, 3.54}, 1, 
         10}, {{$CellContext`imgMinX$$, -0.36}, -2, 
         2}, {{$CellContext`imgMinY$$, -0.62}, -2, 
         2}, {{$CellContext`imgMinZ$$, -0.19}, -2, 
         2}, {{$CellContext`imgSize$$, 1.6}, 1, 
         5}, {{$CellContext`imgSizeZ$$, 2.005}, 2, 
         5}, {{$CellContext`samplingRadius$$, 0.45}, 0.2, 
         1.5}, {{$CellContext`intsCenterWidthMultiply$$, 1.0295}, 0.9, 
         1.1}, {{$CellContext`intsCenterXOffset$$, -0.018}, -0.1, 
         0.1}, {{$CellContext`intsCenterYOffset$$, -0.062}, -0.2, 
         0.2}, {{$CellContext`intsMinorRadius$$, 0.4}, 0.3, 0.5}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{869., {316., 322.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8393890074820137`*^9, 3.839393246445585*^9, {3.8395674476375237`*^9, 
   3.839567454494589*^9}},
 CellLabel->"Out[16]=",ExpressionUUID->"42a799a0-352b-4985-b9f2-3c8f77be361c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "diskCenter", ",", "diskNormal", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
    "radius", ",", "dr", ",", "dx", ",", "\[Phi]", ",", "\[Phi]i", ",", 
    "\[Phi]o", ",", "QQ1", ",", "PQ1"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radius", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]1", "=", "\[Phi]i"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QQ1", "=", 
   RowBox[{"radius", "*", 
    RowBox[{"Cos", "[", "\[Alpha]1", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PQ1", "=", 
   RowBox[{"radius", "*", 
    RowBox[{"Sin", "[", "\[Alpha]1", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]2", "=", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"dr", "+", "PQ1"}], ")"}], "/", "QQ1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]o", "=", "\[Alpha]2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dr", "=", 
   RowBox[{"dx", "*", "radius"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Phi]i", "+", "\[Phi]o"}], ")"}], "/", "2"}], "-", 
     "\[Phi]i"}], "//", "Simplify"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diskCenter", "=", 
   RowBox[{"Normalize", "@", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diskNormal", "=", 
   RowBox[{"Normalize", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", 
      RowBox[{"-", "1.5"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"blPaperIntsDisk10", "[", 
       RowBox[{
       "diskCenter", ",", "diskNormal", ",", "diskRadius", ",", 
        "calcPointPercent"}], "]"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", " ", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], ",", "\n", "\t\t", 
     RowBox[{"Axes", "\[Rule]", "True"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"AspectRatio", "->", "1"}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", "Front"}], ",", "\[IndentingNewLine]", 
     "\t    ", 
     RowBox[{"ViewProjection", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
     ",", "\[IndentingNewLine]", "\t    ", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
    "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"calcPointPercent", ",", "0.8"}], "}"}], ",", "0.1", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskRadius", ",", "0.6"}], "}"}], ",", "0.1", ",", "0.6"}], 
    "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.838591199702325*^9, 3.838591337293561*^9}, 
   3.8385917159706817`*^9, 3.838595490013892*^9, {3.838595755631129*^9, 
   3.838595792330063*^9}, 3.838705098834033*^9, {3.838705198068845*^9, 
   3.8387052547296543`*^9}, {3.838710356243922*^9, 3.8387104205158715`*^9}, {
   3.838710457834075*^9, 3.8387104772503433`*^9}, {3.8387105602265053`*^9, 
   3.8387106453182497`*^9}, {3.838710691110968*^9, 3.8387107026595526`*^9}, {
   3.838710760950264*^9, 3.8387107741555157`*^9}, {3.83871081058805*^9, 
   3.8387108842281995`*^9}, {3.8387109557796297`*^9, 3.838710962771296*^9}, {
   3.8387110579159527`*^9, 3.8387110659404736`*^9}, 3.83871115302098*^9, {
   3.8387112018303523`*^9, 3.838711225944543*^9}, {3.838711357957591*^9, 
   3.8387114052290945`*^9}, {3.838711463876541*^9, 3.8387114851587057`*^9}, {
   3.838711527140164*^9, 3.8387115592453966`*^9}, {3.8387116107116127`*^9, 
   3.8387116152321033`*^9}, {3.838711698541105*^9, 3.838711826163373*^9}, {
   3.8387119425001335`*^9, 3.8387120479172487`*^9}, {3.838712198285242*^9, 
   3.8387122420538263`*^9}, {3.8387123341239777`*^9, 3.838712428933677*^9}, {
   3.8387125745236473`*^9, 3.838712790668149*^9}, {3.83871282780429*^9, 
   3.8387129440765405`*^9}, {3.8387134662939687`*^9, 3.838713596672432*^9}, {
   3.8387137060366974`*^9, 3.838713721979744*^9}, {3.838713777120103*^9, 
   3.83871380899654*^9}, {3.839309805061955*^9, 3.8393099924920273`*^9}, {
   3.839310024752675*^9, 3.839310046330528*^9}, {3.839314746283371*^9, 
   3.839314780323186*^9}, {3.839315001441532*^9, 3.839315271795656*^9}, {
   3.839315322227222*^9, 3.8393156164676065`*^9}, {3.8393156522051506`*^9, 
   3.8393157084066873`*^9}, {3.8393157791724143`*^9, 3.8393158712205234`*^9}, 
   3.8393933058810225`*^9, 3.839455041436775*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"c7857d34-d240-432f-ba2e-2264d397a06b"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "\[Phi]i"}], "+", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"Sec", "[", "\[Phi]i", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"dx", "+", 
        RowBox[{"Sin", "[", "\[Phi]i", "]"}]}], ")"}]}], "]"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.8394550423775*^9, 3.8395674547788296`*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"e7b4415a-9d53-4f82-98ce-a15c6f08c2fa"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`calcPointPercent$$ = 
    0.8, $CellContext`diskRadius$$ = 0.6, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`calcPointPercent$$], 0.8}, 0.1, 0.99}, {{
       Hold[$CellContext`diskRadius$$], 0.6}, 0.1, 0.6}}, Typeset`size$$ = {
    518., {200., 205.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`calcPointPercent$3697$$ = 
    0, $CellContext`diskRadius$3698$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`calcPointPercent$$ = 
        0.8, $CellContext`diskRadius$$ = 0.6}, "ControllerVariables" :> {
        Hold[$CellContext`calcPointPercent$$, \
$CellContext`calcPointPercent$3697$$, 0], 
        Hold[$CellContext`diskRadius$$, $CellContext`diskRadius$3698$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[{
         gBlochSphere`blPaperIntsDisk10[$CellContext`diskCenter, \
$CellContext`diskNormal, $CellContext`diskRadius$$, \
$CellContext`calcPointPercent$$]}, PlotRange -> {{-1, 1}, {-1, 1}, {0, 2}}, 
        Axes -> True, Boxed -> False, AspectRatio -> 1, ViewPoint -> Front, 
        ViewProjection -> "Orthographic", AxesLabel -> {"X", "Y", "Z"}, 
        ImageSize -> Large], 
      "Specifications" :> {{{$CellContext`calcPointPercent$$, 0.8}, 0.1, 
         0.99}, {{$CellContext`diskRadius$$, 0.6}, 0.1, 0.6}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{565., {255., 261.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8394550423775*^9, 3.839567454790799*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"ad1ee88f-60f3-4c3a-9278-f3fd74132d57"],

Cell[BoxData[
 TemplateBox[{
  "Assert","asrtfe",
   "\"Assertion \\!\\(\\*RowBox[{RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{\\\"gPlots3DEx`Private`rotPt$145471\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"]\\\"}], \\\"<\\\", \\\"0.001`\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Assert\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"Abs\\\
\", \\\"[\\\", RowBox[{\\\"gPlots3DEx`Private`rotPt$145471\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"]\\\
\"}], \\\"<\\\", \\\"0.001`\\\"}], \\\",\\\", \\\"\\\\\\\"calcPhiOnCircle3D\\\
\\\\\"\\\"}], \\\"]\\\"}]\\) failed.\"",2,41,7,30209639296794112294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.839567462496394*^9},
 CellLabel->"",ExpressionUUID->"b7a4b3b4-50f2-4de8-b785-28f02cfb6e11"],

Cell[BoxData[
 TemplateBox[{
  "Assert","asrtfe",
   "\"Assertion \\!\\(\\*RowBox[{RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{\\\"gPlots3DEx`Private`rotPt$145480\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"]\\\"}], \\\"<\\\", \\\"0.001`\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Assert\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"Abs\\\
\", \\\"[\\\", RowBox[{\\\"gPlots3DEx`Private`rotPt$145480\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"]\\\
\"}], \\\"<\\\", \\\"0.001`\\\"}], \\\",\\\", \\\"\\\\\\\"calcPhiOnCircle3D\\\
\\\\\"\\\"}], \\\"]\\\"}]\\) failed.\"",2,41,8,30209639296794112294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.839567462513379*^9},
 CellLabel->"",ExpressionUUID->"f165039c-2aa4-4925-ae51-e06402a22a29"],

Cell[BoxData[
 TemplateBox[{
  "Assert","asrtfe",
   "\"Assertion \\!\\(\\*RowBox[{RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{\\\"gPlots3DEx`Private`rotPt$145499\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"]\\\"}], \\\"<\\\", \\\"0.001`\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Assert\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"Abs\\\
\", \\\"[\\\", RowBox[{\\\"gPlots3DEx`Private`rotPt$145499\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"]\\\
\"}], \\\"<\\\", \\\"0.001`\\\"}], \\\",\\\", \\\"\\\\\\\"calcPhiOnCircle3D\\\
\\\\\"\\\"}], \\\"]\\\"}]\\) failed.\"",2,41,9,30209639296794112294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.839567462547289*^9},
 CellLabel->"",ExpressionUUID->"b9fdfccd-aeeb-41d3-a7b4-ed8daed72423"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Assert\\\", \\\"::\\\", \
\\\"asrtfe\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,41,10,30209639296794112294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.839567462578207*^9},
 CellLabel->"",ExpressionUUID->"6d46df6c-f98f-4282-a825-4d38e7f9c215"],

Cell[BoxData[
 TemplateBox[{
  "Assert","asrtfe",
   "\"Assertion \\!\\(\\*RowBox[{RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{\\\"gPlots3DEx`Private`rotPt$286532\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"]\\\"}], \\\"<\\\", \\\"0.001`\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Assert\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"Abs\\\
\", \\\"[\\\", RowBox[{\\\"gPlots3DEx`Private`rotPt$286532\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"]\\\
\"}], \\\"<\\\", \\\"0.001`\\\"}], \\\",\\\", \\\"\\\\\\\"calcPhiOnCircle3D\\\
\\\\\"\\\"}], \\\"]\\\"}]\\) failed.\"",2,41,11,30209639296794112294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8395674691549983`*^9},
 CellLabel->"",ExpressionUUID->"14fedc17-d644-47f0-b3fe-f7890d200eea"],

Cell[BoxData[
 TemplateBox[{
  "Assert","asrtfe",
   "\"Assertion \\!\\(\\*RowBox[{RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{\\\"gPlots3DEx`Private`rotPt$286538\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"]\\\"}], \\\"<\\\", \\\"0.001`\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Assert\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"Abs\\\
\", \\\"[\\\", RowBox[{\\\"gPlots3DEx`Private`rotPt$286538\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"]\\\
\"}], \\\"<\\\", \\\"0.001`\\\"}], \\\",\\\", \\\"\\\\\\\"calcPhiOnCircle3D\\\
\\\\\"\\\"}], \\\"]\\\"}]\\) failed.\"",2,41,12,30209639296794112294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.839567469160982*^9},
 CellLabel->"",ExpressionUUID->"6fb5de70-51b6-4b0d-8023-6eb0dfb30b21"],

Cell[BoxData[
 TemplateBox[{
  "Assert","asrtfe",
   "\"Assertion \\!\\(\\*RowBox[{RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{\\\"gPlots3DEx`Private`rotPt$286559\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"]\\\"}], \\\"<\\\", \\\"0.001`\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Assert\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"Abs\\\
\", \\\"[\\\", RowBox[{\\\"gPlots3DEx`Private`rotPt$286559\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"]\\\
\"}], \\\"<\\\", \\\"0.001`\\\"}], \\\",\\\", \\\"\\\\\\\"calcPhiOnCircle3D\\\
\\\\\"\\\"}], \\\"]\\\"}]\\) failed.\"",2,41,13,30209639296794112294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8395674691669664`*^9},
 CellLabel->"",ExpressionUUID->"e53d5b66-a642-4789-bd0f-e5ac9b023f03"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Assert\\\", \\\"::\\\", \
\\\"asrtfe\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,41,14,30209639296794112294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8395674691709557`*^9},
 CellLabel->"",ExpressionUUID->"49277940-bcb4-4c7e-9bd6-387831d1d726"],

Cell[BoxData[
 TemplateBox[{
  "Assert","asrtfe",
   "\"Assertion \\!\\(\\*RowBox[{RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{\\\"gPlots3DEx`Private`rotPt$298167\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"]\\\"}], \\\"<\\\", \\\"0.001`\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Assert\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"Abs\\\
\", \\\"[\\\", RowBox[{\\\"gPlots3DEx`Private`rotPt$298167\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"]\\\
\"}], \\\"<\\\", \\\"0.001`\\\"}], \\\",\\\", \\\"\\\\\\\"calcPhiOnCircle3D\\\
\\\\\"\\\"}], \\\"]\\\"}]\\) failed.\"",2,41,15,30209639296794112294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8395679977090435`*^9},
 CellLabel->"",ExpressionUUID->"28c2418d-05bb-49c7-95bc-260221312472"],

Cell[BoxData[
 TemplateBox[{
  "Assert","asrtfe",
   "\"Assertion \\!\\(\\*RowBox[{RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{\\\"gPlots3DEx`Private`rotPt$298175\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"]\\\"}], \\\"<\\\", \\\"0.001`\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Assert\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"Abs\\\
\", \\\"[\\\", RowBox[{\\\"gPlots3DEx`Private`rotPt$298175\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"]\\\
\"}], \\\"<\\\", \\\"0.001`\\\"}], \\\",\\\", \\\"\\\\\\\"calcPhiOnCircle3D\\\
\\\\\"\\\"}], \\\"]\\\"}]\\) failed.\"",2,41,16,30209639296794112294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8395679977629004`*^9},
 CellLabel->"",ExpressionUUID->"ed8f41c2-1510-4be9-bc69-8a0ae5e92007"],

Cell[BoxData[
 TemplateBox[{
  "Assert","asrtfe",
   "\"Assertion \\!\\(\\*RowBox[{RowBox[{\\\"Abs\\\", \\\"[\\\", \
RowBox[{\\\"gPlots3DEx`Private`rotPt$298196\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"]\\\"}], \\\"<\\\", \\\"0.001`\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"Assert\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\"Abs\\\
\", \\\"[\\\", RowBox[{\\\"gPlots3DEx`Private`rotPt$298196\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}], \\\"]\\\
\"}], \\\"<\\\", \\\"0.001`\\\"}], \\\",\\\", \\\"\\\\\\\"calcPhiOnCircle3D\\\
\\\\\"\\\"}], \\\"]\\\"}]\\) failed.\"",2,41,17,30209639296794112294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8395679977958117`*^9},
 CellLabel->"",ExpressionUUID->"e6bfe2f7-26ad-4d83-9b24-2a7b23a9e1e1"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Assert\\\", \\\"::\\\", \
\\\"asrtfe\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,41,18,30209639296794112294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8395679978267293`*^9},
 CellLabel->"",ExpressionUUID->"779e5bb1-b1a0-4e58-8072-42852bce0295"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"m", ",", "\[Theta]", ",", "\[Theta]L", ",", "\[Lambda]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]", "=", 
     RowBox[{
      FractionBox[
       RowBox[{"0.288", 
        RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
       RowBox[{"m", "^", "2"}]], "-", "0.673"}]}], ";", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", 
          SuperscriptBox["m", "4"], " "}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["m", "2"], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["m", "2"]}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]L", "-", 
               RowBox[{"ArcTan", "[", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"Sec", "[", "\[Theta]L", "]"}], "2"], " ", 
                  RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "+", 
                 RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]}], "]"}]}]}],
            ")"}], "2"]], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", 
          RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"ColorFunction", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ",", "Blue"}], "]"}]}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[Lambda]"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]], " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", 
          RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"ColorFunction", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ",", "Orange"}], "]"}]}]}], "]"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "legends", " ", "in", " ", "the", " ", "Epilog", " ", 
        "are", " ", "starting", " ", "here"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Epilog", "\[Rule]", 
       RowBox[{"Inset", "[", 
        RowBox[{
         RowBox[{"LineLegend", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Blue", ",", "Orange"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Origin\>\"", ",", "\"\<Fitted\>\""}], "}"}]}], "]"}],
          ",", 
         RowBox[{"Scaled", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
         RowBox[{"Scaled", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}]}]}], "\n", 
     RowBox[{"(*", 
      RowBox[{"End", " ", "of", " ", "the", " ", "Legends"}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "0.7"}], "}"}], ",", "0.01", ",", "0.9"}], "}"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]L", ",", 
       RowBox[{"\[Pi]", "/", "6"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"Lambda", ",", "\[Lambda]"}], "}"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.839568007208395*^9, 3.8395680112483444`*^9}, {
  3.8395680542991667`*^9, 3.839568098730796*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"9a27f70b-80df-408a-a262-6271b112fa2e"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`Lambda$$ = -0.16398915042873807`, \
$CellContext`m$$ = 0.7, $CellContext`\[Theta]L$$ = Rational[1, 6] Pi, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`m$$], 0.7}, 0.01, 0.9}, {{
       Hold[$CellContext`\[Theta]L$$], Rational[1, 6] Pi}, 0, Rational[1, 2] 
      Pi}, {{
       Hold[$CellContext`Lambda$$], -0.16398915042873807`}}}, 
    Typeset`size$$ = {324., {103., 108.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`m$300483$$ = 0, $CellContext`\[Theta]L$300484$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`Lambda$$ = $CellContext`\[Lambda], \
$CellContext`m$$ = 0.7, $CellContext`\[Theta]L$$ = Rational[1, 6] Pi}, 
      "ControllerVariables" :> {
        Hold[$CellContext`m$$, $CellContext`m$300483$$, 0], 
        Hold[$CellContext`\[Theta]L$$, $CellContext`\[Theta]L$300484$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`\[Lambda] = 
        0.288 Cos[$CellContext`\[Theta]L$$]/$CellContext`m$$^2 - 0.673; Show[
         Plot[
         4 $CellContext`m$$^4/(
           1 + $CellContext`m$$^2 + (-1 + $CellContext`m$$^2) 
            Cos[$CellContext`\[Theta]L$$ - ArcTan[
              Sec[$CellContext`\[Theta]L$$]^2 Tan[$CellContext`\[Theta]] + 
               Tan[$CellContext`\[Theta]L$$]]])^2, {$CellContext`\[Theta], 0, 
           Pi/2}, PlotRange -> {{0, Pi/2}, {0, 1}}, ColorFunction -> 
          Function[{$CellContext`x, $CellContext`y}, Blue]], 
         Plot[
         E^((-$CellContext`\[Lambda]) Sin[$CellContext`\[Theta]]^2) 
          Cos[$CellContext`\[Theta]], {$CellContext`\[Theta], 0, Pi/2}, 
          PlotRange -> {{0, Pi/2}, {0, 1}}, ColorFunction -> 
          Function[{$CellContext`x, $CellContext`y}, Orange]], Epilog -> Inset[
           LineLegend[{Blue, Orange}, {"Origin", "Fitted"}], 
           Scaled[{1, 1}], 
           Scaled[{1, 1}]]]), 
      "Specifications" :> {{{$CellContext`m$$, 0.7}, 0.01, 
         0.9}, {{$CellContext`\[Theta]L$$, Rational[1, 6] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`Lambda$$, $CellContext`\[Lambda]}}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{371., {168., 174.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.839468341557228*^9, 3.839567455104927*^9, {3.839568030928995*^9, 
   3.839568099221574*^9}},
 CellLabel->"Out[54]=",ExpressionUUID->"18136361-c37f-42a5-bdf5-e79c24f8489e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "diskCenter", ",", "diskNormal", ",", "axisSize", ",", "camViewPt"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axisSize", "=", "1.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"diskCenter", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"diskCenterX", ",", "diskCenterY", ",", "diskCenterZ"}], 
       "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"diskNormal", "=", 
        RowBox[{"Normalize", "@", 
         RowBox[{"{", 
          RowBox[{"diskNormalX", ",", "diskNormalY", ",", "diskNormalZ"}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pltSphere3D", "[", " ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<plotPts\>\"", "\[Rule]", "100"}], ",", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"\"\<mesh\>\"", "\[Rule]", "10"}], ","}], "*)"}], 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
              RowBox[{"\"\<lighting\>\"", "\[Rule]", "Automatic"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "x", ",", "y", ",", "z", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "}"}], ",", "LightBlue"}], "]"}]}]}], "|>"}], 
            "\[IndentingNewLine]", "]"}], "&"}], "[", 
          RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"pltDisk3D", "[", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "diskCenter"}], ",", 
              RowBox[{"\"\<normal\>\"", "\[Rule]", "diskNormal"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#radius"}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Green"}], 
                "]"}]}]}], "|>"}], "\[IndentingNewLine]", "\t", "]"}], "&"}], 
          "[", 
          RowBox[{"<|", 
           RowBox[{"\"\<radius\>\"", "\[Rule]", "diskRadius"}], "|>"}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"pltDiskProjArea3D", "[", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<diskCenter\>\"", "\[Rule]", "diskCenter"}], ",", 
              RowBox[{"\"\<diskNormal\>\"", "\[Rule]", "diskNormal"}], ",", 
              RowBox[{"\"\<diskRadius\>\"", "\[Rule]", "#diskRadius"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Red"}], 
                "]"}]}], ",", 
              RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}]}], "|>"}], 
            "\[IndentingNewLine]", "\t", "]"}], "&"}], "[", 
          RowBox[{"<|", 
           RowBox[{"\"\<diskRadius\>\"", "\[Rule]", "diskRadius"}], "|>"}], 
          "]"}]}], "\[IndentingNewLine]", " ", "}"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{"Axes", "\[Rule]", "False"}], ",", "\n", "\t\t", 
        RowBox[{"AxesLabel", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
        ",", "\n", "\t\t", 
        RowBox[{"Boxed", "->", "False"}], ",", "\n", "\t\t", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}]}], "}"}]}], 
        ",", "\n", "\t\t", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "\n", "\t", "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskCenterX", ",", "1"}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskCenterY", ",", 
       RowBox[{"-", "0.3"}]}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskCenterZ", ",", "1"}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalX", ",", 
       RowBox[{"-", "4.2"}]}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalY", ",", 
       RowBox[{"-", "8."}]}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalZ", ",", "7.95"}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskRadius", ",", "0.473"}], "}"}], ",", "0.1", ",", "0.6"}], 
    "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8387140062764063`*^9, 3.8387140103327026`*^9}, {
   3.838714082557334*^9, 3.8387141153961573`*^9}, {3.8387141474867234`*^9, 
   3.83871417594713*^9}, {3.8387142377486773`*^9, 3.8387142980108094`*^9}, {
   3.8387144294289217`*^9, 3.8387144364714947`*^9}, 3.839480660046486*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"ee6a1a37-aed0-4f7a-b85e-72fb42133cae"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`diskCenterX$$ = 
    1, $CellContext`diskCenterY$$ = -0.3, $CellContext`diskCenterZ$$ = 
    1, $CellContext`diskNormalX$$ = -4.2, $CellContext`diskNormalY$$ = -8., \
$CellContext`diskNormalZ$$ = 7.95, $CellContext`diskRadius$$ = 0.473, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`diskCenterX$$], 1}, -10, 10}, {{
       Hold[$CellContext`diskCenterY$$], -0.3}, -10, 10}, {{
       Hold[$CellContext`diskCenterZ$$], 1}, -10, 10}, {{
       Hold[$CellContext`diskNormalX$$], -4.2}, -10, 10}, {{
       Hold[$CellContext`diskNormalY$$], -8.}, -10, 10}, {{
       Hold[$CellContext`diskNormalZ$$], 7.95}, -10, 10}, {{
       Hold[$CellContext`diskRadius$$], 0.473}, 0.1, 0.6}}, Typeset`size$$ = {
    324., {173., 179.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`diskCenterX$4261$$ = 
    0, $CellContext`diskCenterY$4262$$ = 0, $CellContext`diskCenterZ$4263$$ = 
    0, $CellContext`diskNormalX$4264$$ = 0, $CellContext`diskNormalY$4265$$ = 
    0, $CellContext`diskNormalZ$4266$$ = 0, $CellContext`diskRadius$4267$$ = 
    0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`diskCenterX$$ = 
        1, $CellContext`diskCenterY$$ = -0.3, $CellContext`diskCenterZ$$ = 
        1, $CellContext`diskNormalX$$ = -4.2, $CellContext`diskNormalY$$ = \
-8., $CellContext`diskNormalZ$$ = 7.95, $CellContext`diskRadius$$ = 0.473}, 
      "ControllerVariables" :> {
        Hold[$CellContext`diskCenterX$$, $CellContext`diskCenterX$4261$$, 0], 
        Hold[$CellContext`diskCenterY$$, $CellContext`diskCenterY$4262$$, 0], 
        Hold[$CellContext`diskCenterZ$$, $CellContext`diskCenterZ$4263$$, 0], 
        Hold[$CellContext`diskNormalX$$, $CellContext`diskNormalX$4264$$, 0], 
        Hold[$CellContext`diskNormalY$$, $CellContext`diskNormalY$4265$$, 0], 
        Hold[$CellContext`diskNormalZ$$, $CellContext`diskNormalZ$4266$$, 0], 
        Hold[$CellContext`diskRadius$$, $CellContext`diskRadius$4267$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`diskCenter = 
        Normalize[{$CellContext`diskCenterX$$, $CellContext`diskCenterY$$, \
$CellContext`diskCenterZ$$}]; 
       Show[$CellContext`diskNormal = 
          Normalize[{$CellContext`diskNormalX$$, $CellContext`diskNormalY$$, \
$CellContext`diskNormalZ$$}]; {
           (gPlots3DEx`pltSphere3D[
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "plotPts" -> 100, "opacity" -> 
             0.3, "lighting" -> Automatic, "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z, \
$CellContext`\[Theta], $CellContext`\[Phi]}, LightBlue]]]& )[
            Association[]], 
           (gPlots3DEx`pltDisk3D[
            Association[
            "center" -> $CellContext`diskCenter, 
             "normal" -> $CellContext`diskNormal, "radius" -> Slot["radius"], 
             "opacity" -> 0.3, "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
               Green]]]& )[
            Association["radius" -> $CellContext`diskRadius$$]], 
           (gPlots3DEx`pltDiskProjArea3D[
            Association[
            "diskCenter" -> $CellContext`diskCenter, 
             "diskNormal" -> $CellContext`diskNormal, "diskRadius" -> 
             Slot["diskRadius"], "opacity" -> 0.3, "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z}, Red], 
             "zbias" -> 1]]& )[
            Association["diskRadius" -> $CellContext`diskRadius$$]]}, {
         Axes -> False, AxesLabel -> {"X", "Y", "Z"}, Boxed -> False, 
          
          PlotRange -> {{-$CellContext`axisSize, $CellContext`axisSize}, \
{-$CellContext`axisSize, $CellContext`axisSize}, {-$CellContext`axisSize, \
$CellContext`axisSize}}, ImageSize -> Medium}]), 
      "Specifications" :> {{{$CellContext`diskCenterX$$, 1}, -10, 
         10}, {{$CellContext`diskCenterY$$, -0.3}, -10, 
         10}, {{$CellContext`diskCenterZ$$, 1}, -10, 
         10}, {{$CellContext`diskNormalX$$, -4.2}, -10, 
         10}, {{$CellContext`diskNormalY$$, -8.}, -10, 
         10}, {{$CellContext`diskNormalZ$$, 7.95}, -10, 
         10}, {{$CellContext`diskRadius$$, 0.473}, 0.1, 0.6}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{371., {291., 297.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.838713933421653*^9, {3.8387139687932673`*^9, 3.838714012091153*^9}, 
   3.8387141842589903`*^9, 3.8387142526979027`*^9, {3.838714290178372*^9, 
   3.8387142987482414`*^9}, 3.838797093675791*^9, 3.8392995235752525`*^9, 
   3.8393932468480425`*^9, {3.8394806518881702`*^9, 3.8394806611396084`*^9}, 
   3.8395674553093805`*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"9783d85a-72b6-4be0-803c-13610beee193"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "diskCenter", ",", "diskNormal", ",", "axisSize", ",", "recvPt", ",", 
    "reflViewDir", ",", "lightDir", ",", "asgColorHueFunc", ",", 
    "\[IndentingNewLine]", "\t", "asgLightOld", ",", "asgLightNew", ",", 
    "asgLobe"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"asgColorHueFunc", "[", 
     RowBox[{"x_", ",", "y_", ",", "z_", ",", "asgLight_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", "asgLobe"}], "}"}], ",", "\[IndentingNewLine]", "\t",
       "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"asgLobe", "=", 
        RowBox[{"asgLight", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"r", "=", 
        RowBox[{
         RowBox[{"asgVector", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "asgLight"}], 
          "]"}], "/", 
         RowBox[{"asgVector", "[", 
          RowBox[{"asgLobe", ",", "asgLight"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Hue", "@", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{".7", "-", "r"}], ",", "0"}], "]"}], ",", 
             RowBox[{"r", ">", ".1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{".7", ",", 
             RowBox[{"r", "<", ".1"}]}], "}"}]}], "}"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"Hue", "@", 
       RowBox[{"asgVector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "asgLight"}], 
        "]"}]}], " ", "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axisSize", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diskCenter", "=", 
   RowBox[{"Normalize", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"recvPt", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"reflViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"recvPt", "-", "diskCenter"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"lightDir", "=", 
     RowBox[{"gReflectVector", "[", 
      RowBox[{"reflViewDir", ",", "diskNormal"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"diskNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"diskNormalX", ",", "diskNormalY", ",", "diskNormalZ"}], 
       "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"asgLightOld", "=", 
     RowBox[{"asgReflectLight", "[", 
      RowBox[{
      "recvPt", ",", "lightDir", ",", "lightIntensity", ",", "0.1", ",", 
       RowBox[{"{", 
        RowBox[{"diskCenter", ",", "diskNormal", ",", "diskRadius"}], "}"}]}],
       "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"asgLightNew", "=", "asgLightOld"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"asgLightNew", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "=", "asgLambda"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"asgLightNew", "[", 
      RowBox[{"[", "5", "]"}], "]"}], "=", "asgMu"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"asgLightNew", "[", 
      RowBox[{"[", "6", "]"}], "]"}], "=", "asgC"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "arrow"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pltArrow3D", "[", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<origin\>\"", "\[Rule]", 
               RowBox[{"diskCenter", "+", 
                RowBox[{"lightDir", "*", "0.5"}]}]}], ",", 
              RowBox[{"\"\<dir\>\"", "\[Rule]", 
               RowBox[{"-", "lightDir"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}], ",", 
              RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.6"}]}], "|>"}], 
            "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
          RowBox[{"<|", "|>"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pltSphere3D", "[", " ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "recvPt"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<plotPts\>\"", "\[Rule]", "100"}], ",", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"\"\<mesh\>\"", "\[Rule]", "10"}], ","}], "*)"}], 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
              RowBox[{"\"\<lighting\>\"", "\[Rule]", "Automatic"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "x", ",", "y", ",", "z", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "}"}], ",", "LightBlue"}], "]"}]}]}], "|>"}], 
            "\[IndentingNewLine]", "]"}], "&"}], "[", 
          RowBox[{"<|", "|>"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pltSphere3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "200"}], ",", 
             RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                RowBox[{"asgColorHueFunc", "[", 
                 RowBox[{"x", ",", "y", ",", "z", ",", "asgLightNew"}], 
                 "]"}]}], 
               RowBox[{"(*", 
                RowBox[{"Hue", "@", 
                 RowBox[{"asgVector", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                   "asgLight"}], "]"}]}], "*)"}], " ", "]"}]}]}], "|>"}], 
           "\[IndentingNewLine]", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"pltDisk3D", "[", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "diskCenter"}], ",", 
              RowBox[{"\"\<normal\>\"", "\[Rule]", "diskNormal"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#radius"}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Green"}], 
                "]"}]}]}], "|>"}], "\[IndentingNewLine]", "\t", "]"}], "&"}], 
          "[", 
          RowBox[{"<|", 
           RowBox[{"\"\<radius\>\"", "\[Rule]", "diskRadius"}], "|>"}], "]"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltDiskProjBoundary", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<diskCenter\>\"", "\[Rule]", "diskCenter"}], ",", 
             RowBox[{"\"\<diskNormal\>\"", "\[Rule]", "diskNormal"}], ",", 
             RowBox[{"\"\<diskRadius\>\"", "\[Rule]", "#diskRadius"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Red"}], 
               "]"}]}], ",", 
             RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}]}], "|>"}], 
           "\[IndentingNewLine]", "\t", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<diskRadius\>\"", "\[Rule]", "diskRadius"}], "|>"}], 
         "]"}]}], "\[IndentingNewLine]", " ", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{"Axes", "\[Rule]", "False"}], ",", "\n", "\t\t", 
        RowBox[{"AxesLabel", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
        ",", "\n", "\t\t", 
        RowBox[{"Boxed", "->", "False"}], ",", "\n", "\t\t", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}]}], "}"}]}], 
        ",", "\n", "\t\t", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "\n", "\t", "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalX", ",", 
       RowBox[{"-", "4.2"}]}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalY", ",", 
       RowBox[{"-", "8."}]}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalZ", ",", "7.95"}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskRadius", ",", "0.473"}], "}"}], ",", "0.1", ",", "0.6"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "0.05", ",", "5"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"asgLambda", ",", "10"}], "}"}], ",", "10", ",", "20"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"asgMu", ",", "24.6"}], "}"}], ",", "20", ",", "30"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"asgC", ",", "1"}], "}"}], ",", "0.05", ",", "5"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.838714484609054*^9, 3.8387145170271535`*^9}, {
   3.838714578351654*^9, 3.8387146308673487`*^9}, {3.838714816915636*^9, 
   3.8387150895630417`*^9}, {3.838715131189658*^9, 3.838715209317031*^9}, {
   3.8387152759178796`*^9, 3.838715284859612*^9}, {3.838715315874111*^9, 
   3.838715346620067*^9}, 3.838797215716299*^9, {3.838797263616211*^9, 
   3.8387972641131787`*^9}, {3.838797357962243*^9, 3.838797408523572*^9}, {
   3.839299621946027*^9, 3.8392996221125813`*^9}, {3.8394914374959607`*^9, 
   3.8394914469506598`*^9}, {3.83949163575498*^9, 3.839491657035446*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"0100b804-fc93-4ef6-8c90-070b592b8b7c"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`asgC$$ = 1, $CellContext`asgLambda$$ = 
    10, $CellContext`asgMu$$ = 
    24.6, $CellContext`diskNormalX$$ = -4.2, $CellContext`diskNormalY$$ = \
-8., $CellContext`diskNormalZ$$ = 7.95, $CellContext`diskRadius$$ = 
    0.473, $CellContext`lightIntensity$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`diskNormalX$$], -4.2}, -10, 10}, {{
       Hold[$CellContext`diskNormalY$$], -8.}, -10, 10}, {{
       Hold[$CellContext`diskNormalZ$$], 7.95}, -10, 10}, {{
       Hold[$CellContext`diskRadius$$], 0.473}, 0.1, 0.6}, {{
       Hold[$CellContext`lightIntensity$$], 1}, 0.05, 5}, {{
       Hold[$CellContext`asgLambda$$], 10}, 10, 20}, {{
       Hold[$CellContext`asgMu$$], 24.6}, 20, 30}, {{
       Hold[$CellContext`asgC$$], 1}, 0.05, 5}}, Typeset`size$$ = {
    324., {173., 179.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`diskNormalX$14610$$ = 
    0, $CellContext`diskNormalY$14611$$ = 
    0, $CellContext`diskNormalZ$14612$$ = 0, $CellContext`diskRadius$14613$$ =
     0, $CellContext`lightIntensity$14614$$ = 
    0, $CellContext`asgLambda$14615$$ = 0, $CellContext`asgMu$14616$$ = 
    0, $CellContext`asgC$14617$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`asgC$$ = 1, $CellContext`asgLambda$$ = 
        10, $CellContext`asgMu$$ = 
        24.6, $CellContext`diskNormalX$$ = -4.2, $CellContext`diskNormalY$$ = \
-8., $CellContext`diskNormalZ$$ = 7.95, $CellContext`diskRadius$$ = 
        0.473, $CellContext`lightIntensity$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`diskNormalX$$, $CellContext`diskNormalX$14610$$, 0], 
        Hold[$CellContext`diskNormalY$$, $CellContext`diskNormalY$14611$$, 0], 
        Hold[$CellContext`diskNormalZ$$, $CellContext`diskNormalZ$14612$$, 0], 
        Hold[$CellContext`diskRadius$$, $CellContext`diskRadius$14613$$, 0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$14614$$, 0], 
        Hold[$CellContext`asgLambda$$, $CellContext`asgLambda$14615$$, 0], 
        Hold[$CellContext`asgMu$$, $CellContext`asgMu$14616$$, 0], 
        Hold[$CellContext`asgC$$, $CellContext`asgC$14617$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`reflViewDir = 
        Normalize[$CellContext`recvPt - $CellContext`diskCenter]; \
$CellContext`lightDir = 
        gUtils`gReflectVector[$CellContext`reflViewDir, \
$CellContext`diskNormal]; $CellContext`diskNormal = 
        Normalize[{$CellContext`diskNormalX$$, $CellContext`diskNormalY$$, \
$CellContext`diskNormalZ$$}]; $CellContext`asgLightOld = 
        sgCommon`asgReflectLight[$CellContext`recvPt, $CellContext`lightDir, \
$CellContext`lightIntensity$$, 
          0.1, {$CellContext`diskCenter, $CellContext`diskNormal, \
$CellContext`diskRadius$$}]; $CellContext`asgLightNew = \
$CellContext`asgLightOld; 
       Part[$CellContext`asgLightNew, 4] = $CellContext`asgLambda$$; 
       Part[$CellContext`asgLightNew, 5] = $CellContext`asgMu$$; 
       Part[$CellContext`asgLightNew, 6] = $CellContext`asgC$$; Show[{
          (gPlots3DEx`pltSphere3D[
           Association[
           "center" -> {0, 0, 0}, "radius" -> 1, "plotPts" -> 200, "mesh" -> 
            None, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              $CellContext`asgColorHueFunc[$CellContext`x, $CellContext`y, \
$CellContext`z, $CellContext`asgLightNew]]]]& )[
           Association[]], 
          (gPlots3DEx`pltDiskProjBoundary[
           Association[
           "diskCenter" -> $CellContext`diskCenter, 
            "diskNormal" -> $CellContext`diskNormal, "diskRadius" -> 
            Slot["diskRadius"], "opacity" -> 0.3, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, Red], 
            "zbias" -> 1]]& )[
           Association["diskRadius" -> $CellContext`diskRadius$$]]}, {
         Axes -> False, AxesLabel -> {"X", "Y", "Z"}, Boxed -> False, 
          PlotRange -> {{-$CellContext`axisSize, $CellContext`axisSize}, \
{-$CellContext`axisSize, $CellContext`axisSize}, {-$CellContext`axisSize, \
$CellContext`axisSize}}, ImageSize -> Medium}]), 
      "Specifications" :> {{{$CellContext`diskNormalX$$, -4.2}, -10, 
         10}, {{$CellContext`diskNormalY$$, -8.}, -10, 
         10}, {{$CellContext`diskNormalZ$$, 7.95}, -10, 
         10}, {{$CellContext`diskRadius$$, 0.473}, 0.1, 
         0.6}, {{$CellContext`lightIntensity$$, 1}, 0.05, 
         5}, {{$CellContext`asgLambda$$, 10}, 10, 
         20}, {{$CellContext`asgMu$$, 24.6}, 20, 
         30}, {{$CellContext`asgC$$, 1}, 0.05, 5}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{627., {202., 208.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.839299525119155*^9, {3.8392996138784747`*^9, 3.839299623441001*^9}, 
   3.8393932483188343`*^9, 3.8394915481849165`*^9, 3.839491644582508*^9, 
   3.839567456762497*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"f0b8ae4b-dbff-479e-b1c5-d56d8538657e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gParamPlotContent", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\"\<lines\>\"", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "5"}], ",", "0"}], "}"}]}], ",", 
                RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], ",", 
                RowBox[{"\"\<length\>\"", "\[Rule]", "10"}], ",", 
                RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], ",", 
                RowBox[{"\"\<length\>\"", "\[Rule]", "3"}], ",", 
                RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}]}], 
             "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
          RowBox[{"<|", 
           RowBox[{"\"\<lightDir\>\"", "\[Rule]", "lightDir"}], "|>"}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<varyDirectionDisbs\>\"", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<lightDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", "lightDir", ")"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ")"}], 
                   "&"}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<normalDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<disbFunc\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"gDGGX", "[", 
                    RowBox[{"#roughness", ",", "#noh"}], "]"}], ")"}]}], 
                    ")"}], "&"}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
                RowBox[{
                "\"\<label\>\"", "\[Rule]", "\"\<GGX Normal Lobe\>\""}]}], 
               "|>"}], ",", "\[IndentingNewLine]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<lightDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", "lightDir", ")"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ")"}], 
                   "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<normalDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<disbFunc\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"sgVector", "[", 
                    RowBox[{"#halfDir", ",", " ", 
                    RowBox[{"sgRawNDF", "[", 
                    RowBox[{"#roughness", ",", "#normalDir"}], "]"}]}], "]"}],
                     "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#\[Theta]", ">", "\[Pi]"}], ",", "0", ",", "1"}],
                     "]"}]}], ")"}]}], ")"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
                RowBox[{
                "\"\<label\>\"", "\[Rule]", "\"\<SG GGX Normal Lobe\>\""}]}], 
               "|>"}], ",", "\[IndentingNewLine]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<lightDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", "lightDir", ")"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ")"}], 
                   "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<normalDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<disbFunc\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"sgVector", "[", 
                    RowBox[{"#lightDir", ",", 
                    RowBox[{"sgNDF", "[", 
                    RowBox[{
                    "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                    "#normalDir"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
                    "\t", "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#lightDir", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<", "0"}], ",", "0", ",",
                     "1"}], "]"}]}], ")"}]}], ")"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
                RowBox[{
                "\"\<label\>\"", "\[Rule]", "\"\<SG GGX Warped Lobe\>\""}]}], 
               "|>"}], ",", "\[IndentingNewLine]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<lightDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", "lightDir", ")"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ")"}], 
                   "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<normalDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<disbFunc\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"sgVector", "[", 
                    RowBox[{"#viewDir", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", "30", ",", "3.9"}], 
                    "}"}]}], "]"}]}], ")"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<color\>\"", "\[Rule]", "Orange"}], ",", 
                RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<Light Lobe\>\""}]}], 
               "|>"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"\"\<lightDir\>\"", "\[Rule]", "lightDir"}]}], "|>"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "3.8"}]}], 
        "\[IndentingNewLine]", "|>"}], ",", "Medium"}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.5"}], ",", "5.5"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "\[IndentingNewLine]", 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"normalDir", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"viewDir", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ","}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.3"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.838797592331209*^9, 3.838797593933448*^9}, {
   3.838797682041217*^9, 3.838797682447472*^9}, {3.8387977193889575`*^9, 
   3.838797775415122*^9}, {3.8387978635545616`*^9, 3.838797870528533*^9}, {
   3.8387981413496857`*^9, 3.8387983166323805`*^9}, {3.838798349906737*^9, 
   3.838798365170604*^9}, {3.8387984196478386`*^9, 3.8387984666349087`*^9}, {
   3.838798497274062*^9, 3.8387985344195256`*^9}, {3.8387985681784697`*^9, 
   3.838798572578483*^9}, {3.838798818840515*^9, 3.838798896337879*^9}, {
   3.838799293022706*^9, 3.838799304083005*^9}, 3.8387996040291834`*^9, {
   3.83879972817241*^9, 3.838799863509283*^9}, {3.8387999438043613`*^9, 
   3.838799996270355*^9}, 3.8388000883890777`*^9, {3.8388001793668323`*^9, 
   3.838800246944092*^9}, {3.838800304947627*^9, 3.8388003315160303`*^9}, {
   3.83880039599175*^9, 3.8388004634281836`*^9}, {3.839493276936694*^9, 
   3.839493297889179*^9}, {3.8394933335411015`*^9, 3.8394933366914406`*^9}, {
   3.83949337588515*^9, 3.8394933972217307`*^9}, {3.839493504822689*^9, 
   3.8394935069346857`*^9}, {3.839493591597776*^9, 3.8394935933800097`*^9}, {
   3.839566426824025*^9, 3.839566427283796*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"edc6d70f-c706-4c48-91d8-4ee05edf38ac"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lightDir$$ = {1, 
    1}, $CellContext`normalDir$$ = {0, 1}, $CellContext`roughness$$ = 0.3, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`normalDir$$], {0, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`lightDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`roughness$$], 0.3}, 0.05, 1}}, Typeset`size$$ = {
    488., {159., 165.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`normalDir$145050$$ = {0, 
    0}, $CellContext`lightDir$145051$$ = {0, 
    0}, $CellContext`roughness$145052$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`lightDir$$ = {1, 
         1}, $CellContext`normalDir$$ = {0, 1}, $CellContext`roughness$$ = 
        0.3}, "ControllerVariables" :> {
        Hold[$CellContext`normalDir$$, $CellContext`normalDir$145050$$, {0, 
         0}], 
        Hold[$CellContext`lightDir$$, $CellContext`lightDir$145051$$, {0, 0}], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$145052$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[
        gPlots`gParamPlotContent[
         Association[
          ("lines" -> {
            Association[
            "startPos" -> {-5, 0}, "dirVec" -> {1, 0}, "length" -> 10, 
             "color" -> Black], 
            Association[
            "startPos" -> {0, 0}, "dirVec" -> {0, 1}, "length" -> 3, "color" -> 
             Black]}& )[
           Association["lightDir" -> $CellContext`lightDir$$]], 
          ("varyDirectionDisbs" -> {
            Association[
            "lightDir" -> ($CellContext`lightDir$$& ), "viewDir" -> ({
               Cos[
                Slot["\[Theta]"]], 
               Sin[
                Slot["\[Theta]"]]}& ), "normalDir" -> ({0, 1}& ), "roughness" -> 
             Slot["roughness"], "disbFunc" -> ({
                Cos[
                 Slot["\[Theta]"]], 
                Sin[
                 Slot["\[Theta]"]]} gBRDF`gDGGX[
                Slot["roughness"], 
                Slot["noh"]]& ), "color" -> Red, "label" -> 
             "GGX Normal Lobe"], 
            Association[
            "roughness" -> $CellContext`roughness$$, 
             "lightDir" -> ($CellContext`lightDir$$& ), "viewDir" -> ({
               Cos[
                Slot["\[Theta]"]], 
               Sin[
                Slot["\[Theta]"]]}& ), "normalDir" -> ({0, 1}& ), 
             "disbFunc" -> ({
                Cos[
                 Slot["\[Theta]"]], 
                Sin[
                 Slot["\[Theta]"]]} (sgCommon`sgVector[
                 Slot["halfDir"], 
                 sgCommon`sgRawNDF[
                  Slot["roughness"], 
                  Slot["normalDir"]]] If[Slot["\[Theta]"] > Pi, 0, 1])& ), 
             "color" -> Green, "label" -> "SG GGX Normal Lobe"], 
            Association[
            "roughness" -> $CellContext`roughness$$, 
             "lightDir" -> ($CellContext`lightDir$$& ), "viewDir" -> ({
               Cos[
                Slot["\[Theta]"]], 
               Sin[
                Slot["\[Theta]"]]}& ), "normalDir" -> ({0, 1}& ), 
             "disbFunc" -> ({
                Cos[
                 Slot["\[Theta]"]], 
                Sin[
                 Slot["\[Theta]"]]} (sgCommon`sgVector[
                 Slot["lightDir"], 
                 sgCommon`sgNDF[
                  Slot["roughness"], 
                  Slot["lightDir"], 
                  Slot["viewDir"], 
                  Slot["normalDir"]]] If[Part[
                   Slot["lightDir"], 2] < 0, 0, 1])& ), "color" -> Blue, 
             "label" -> "SG GGX Warped Lobe"], 
            Association[
            "roughness" -> $CellContext`roughness$$, 
             "lightDir" -> ($CellContext`lightDir$$& ), "viewDir" -> ({
               Cos[
                Slot["\[Theta]"]], 
               Sin[
                Slot["\[Theta]"]]}& ), "normalDir" -> ({0, 1}& ), 
             "disbFunc" -> ({
                Cos[
                 Slot["\[Theta]"]], 
                Sin[
                 Slot["\[Theta]"]]} sgCommon`sgVector[
                Slot["viewDir"], {{1, 1}, 30, 3.9}]& ), "color" -> Orange, 
             "label" -> "Light Lobe"]}& )[
           Association[
           "roughness" -> $CellContext`roughness$$, 
            "lightDir" -> $CellContext`lightDir$$]], "axisExtent" -> 3.8], 
         Medium], PlotRange -> {{-3, 3}, {-0.5, 5.5}}, Axes -> False, 
        ImageSize -> Medium], 
      "Specifications" :> {{{$CellContext`normalDir$$, {0, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`lightDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`roughness$$, 0.3}, 0.05, 1}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{535., {278., 284.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.838800438379466*^9, 3.838800463909574*^9}, 
   3.8388005030647135`*^9, 3.8392995269212875`*^9, 3.8393932575602617`*^9, {
   3.839493278942523*^9, 3.839493299016004*^9}, 3.839493339932657*^9, 
   3.83949337834044*^9, 3.8394935073873014`*^9, 3.839493594405241*^9, 
   3.8395664286830997`*^9, 3.839567461868104*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"7b1275f5-0384-4532-a5c6-1714a11e8353"]
}, Open  ]]
},
WindowSize->{980, 683},
WindowMargins->{{-6, Automatic}, {-5, Automatic}},
Magnification:>0.9 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2521, 53, 207, "Input",ExpressionUUID->"869dad65-2627-40c4-a516-a065be9f81e5"],
Cell[CellGroupData[{
Cell[3104, 77, 27602, 634, 1971, "Input",ExpressionUUID->"32509c09-4e03-4cf7-b0a4-9a78146cb38e"],
Cell[30709, 713, 15230, 292, 528, "Output",ExpressionUUID->"97c3f28e-43a7-4411-a943-1b3bf88afe25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45976, 1010, 31945, 757, 2475, "Input",ExpressionUUID->"61d6c217-67ca-459c-81f4-23382bf91bc5"],
Cell[77924, 1769, 16138, 319, 656, "Output",ExpressionUUID->"42a799a0-352b-4985-b9f2-3c8f77be361c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94099, 2093, 5364, 120, 513, "Input",ExpressionUUID->"c7857d34-d240-432f-ba2e-2264d397a06b"],
Cell[99466, 2215, 490, 14, 47, "Output",ExpressionUUID->"e7b4415a-9d53-4f82-98ce-a15c6f08c2fa"],
Cell[99959, 2231, 2456, 46, 534, "Output",ExpressionUUID->"ad1ee88f-60f3-4c3a-9278-f3fd74132d57"],
Cell[102418, 2279, 831, 14, 20, "Message",ExpressionUUID->"b7a4b3b4-50f2-4de8-b785-28f02cfb6e11"],
Cell[103252, 2295, 831, 14, 20, "Message",ExpressionUUID->"f165039c-2aa4-4925-ae51-e06402a22a29"],
Cell[104086, 2311, 831, 14, 20, "Message",ExpressionUUID->"b9fdfccd-aeeb-41d3-a7b4-ed8daed72423"],
Cell[104920, 2327, 412, 8, 20, "Message",ExpressionUUID->"6d46df6c-f98f-4282-a825-4d38e7f9c215"],
Cell[105335, 2337, 834, 14, 20, "Message",ExpressionUUID->"14fedc17-d644-47f0-b3fe-f7890d200eea"],
Cell[106172, 2353, 832, 14, 20, "Message",ExpressionUUID->"6fb5de70-51b6-4b0d-8023-6eb0dfb30b21"],
Cell[107007, 2369, 834, 14, 20, "Message",ExpressionUUID->"e53d5b66-a642-4789-bd0f-e5ac9b023f03"],
Cell[107844, 2385, 414, 8, 20, "Message",ExpressionUUID->"49277940-bcb4-4c7e-9bd6-387831d1d726"],
Cell[108261, 2395, 834, 14, 20, "Message",ExpressionUUID->"28c2418d-05bb-49c7-95bc-260221312472"],
Cell[109098, 2411, 834, 14, 20, "Message",ExpressionUUID->"ed8f41c2-1510-4be9-bc69-8a0ae5e92007"],
Cell[109935, 2427, 834, 14, 20, "Message",ExpressionUUID->"e6bfe2f7-26ad-4d83-9b24-2a7b23a9e1e1"],
Cell[110772, 2443, 414, 8, 20, "Message",ExpressionUUID->"779e5bb1-b1a0-4e58-8072-42852bce0295"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111223, 2456, 4816, 127, 493, "Input",ExpressionUUID->"9a27f70b-80df-408a-a262-6271b112fa2e"],
Cell[116042, 2585, 3314, 64, 360, "Output",ExpressionUUID->"18136361-c37f-42a5-bdf5-e79c24f8489e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119393, 2654, 6760, 161, 621, "Input",ExpressionUUID->"ee6a1a37-aed0-4f7a-b85e-72fb42133cae"],
Cell[126156, 2817, 5647, 101, 606, "Output",ExpressionUUID->"9783d85a-72b6-4be0-803c-13610beee193"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131840, 2923, 12245, 296, 1107, "Input",ExpressionUUID->"0100b804-fc93-4ef6-8c90-070b592b8b7c"],
Cell[144088, 3221, 5894, 106, 428, "Output",ExpressionUUID->"f0b8ae4b-dbff-479e-b1c5-d56d8538657e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150019, 3332, 14298, 319, 945, "Input",ExpressionUUID->"edc6d70f-c706-4c48-91d8-4ee05edf38ac"],
Cell[164320, 3653, 6074, 131, 580, "Output",ExpressionUUID->"7b1275f5-0384-4532-a5c6-1714a11e8353"]
}, Open  ]]
}
]
*)

