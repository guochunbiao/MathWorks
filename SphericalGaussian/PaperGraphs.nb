(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     57142,       1236]
NotebookOptionsPosition[     55768,       1207]
NotebookOutlinePosition[     56113,       1222]
CellTagsIndexPosition[     56070,       1219]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
      "\"\<Shared\>\""}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3DEx`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gTexStyles`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBlochSphere`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResetDirectory", "[", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8381045114551363`*^9, 3.838104621306058*^9}, {
   3.8381047318712387`*^9, 3.8381047322481966`*^9}, {3.838104794488738*^9, 
   3.838105018474309*^9}, {3.8381051299062104`*^9, 3.838105146536306*^9}, {
   3.838105374402709*^9, 3.838105377296275*^9}, {3.838105554141843*^9, 
   3.838105659984576*^9}, {3.8381060886546383`*^9, 3.8381060930153093`*^9}, {
   3.8381062316590977`*^9, 3.8381062893154573`*^9}, {3.838106350865511*^9, 
   3.838106359414567*^9}, 3.8381064092334566`*^9, {3.83810687288235*^9, 
   3.8381069367815385`*^9}, {3.838106984663814*^9, 3.8381069951275673`*^9}, {
   3.8381071398045254`*^9, 3.8381072658717337`*^9}, {3.8381073503072834`*^9, 
   3.8381075332543845`*^9}, {3.8381077236884565`*^9, 
   3.8381077468396764`*^9}, {3.838107865615464*^9, 3.8381082317647915`*^9}, {
   3.838108263607842*^9, 3.8381083210600543`*^9}, {3.838108363584729*^9, 
   3.838108423001891*^9}, {3.838108490317093*^9, 3.838108512995843*^9}, {
   3.838590300439362*^9, 3.83859030125344*^9}, 3.838591772389261*^9, {
   3.8385921678668203`*^9, 3.838592181930876*^9}, {3.838595366170927*^9, 
   3.838595391521434*^9}, {3.8385955016339736`*^9, 3.838595530726467*^9}, {
   3.8387130559878073`*^9, 3.8387130564817243`*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->"In[11]:=",ExpressionUUID->"869dad65-2627-40c4-a516-a065be9f81e5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "reflCenter", ",", "reflNormal", ",", "lightDir", ",", "pltLighting", ",", 
    "reflPeakPt", ",", "recvPt", ",", "\[IndentingNewLine]", "\t", 
    "bounceDir", ",", "outDir"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"reflCenter", "=", 
     RowBox[{"{", 
      RowBox[{"reflCenterX", ",", "reflCenterY", ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"reflNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "reflNormalY", ",", "reflNormalZ"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"lightDirX", ",", "lightDirY", ",", "lightDirZ"}], "}"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"pltLighting", "=", 
       RowBox[{"{", 
        RowBox[{"\"\<Directional\>\"", ",", "White", ",", 
         RowBox[{"{", 
          RowBox[{"testLightDir", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"recvPt", "=", 
     RowBox[{"{", 
      RowBox[{"recvPtX", ",", "recvPtY", ",", "0"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"reflPeakPt", "=", 
     RowBox[{"gCalcPeakPoint", "[", 
      RowBox[{"reflNormal", ",", "reflCenter", ",", 
       RowBox[{"-", "lightDir"}], ",", "recvPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"bounceDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"outDir", "=", 
     RowBox[{"gReflectVector", "[", 
      RowBox[{
       RowBox[{"-", "bounceDir"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"pltLighting", "=", "Automatic"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", "receiver", "*)"}], "\[IndentingNewLine]", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pltRectLine3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "reflector", "*)"}], "\[IndentingNewLine]", "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRectLine3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "#centerPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<centerPt\>\"", "\[Rule]", "reflCenter"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "arrow"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"reflPeakPt", "+", 
               RowBox[{"lightDir", "*", "1.5"}]}]}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "lightDir"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "1.5"}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.5"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"one", " ", "bounce", " ", "arrow"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"Normalize", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", 
              RowBox[{"Norm", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.5"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"out", " ", "dir", " ", "arrow"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "recvPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", "outDir"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "2"}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.6"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"recv", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "recvPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"refl", " ", "peak", " ", "point"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"sampling", " ", "disk"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltCircle3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "#radius"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", 
              RowBox[{"gPlotColors", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "|>"}], 
           "\[IndentingNewLine]", "\t", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], "|>"}], 
         "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"imgMinX", ",", 
           RowBox[{"imgMinX", "+", "imgSize"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"imgMinY", ",", 
           RowBox[{"imgMinY", "+", "imgSize"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"imgMinZ", ",", 
           RowBox[{"imgMinZ", "+", "imgSizeZ"}]}], "}"}]}], "}"}]}], ",", 
      "\n", "\t\t", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "2"}], ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
      "\t    ", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
      ",", "\[IndentingNewLine]", "\t    ", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflCenterX", ",", "0.814"}], "}"}], ",", "0", ",", "1.3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflCenterY", ",", "0.3"}], "}"}], ",", "0", ",", "1"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflNormalY", ",", "1."}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflNormalZ", ",", "0.145"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"recvPtX", ",", "0.39"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"recvPtY", ",", 
       RowBox[{"-", "0.208"}]}], "}"}], ",", 
     RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirX", ",", 
       RowBox[{"-", "4.4"}]}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirY", ",", 
       RowBox[{"-", "2.38"}]}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirZ", ",", "3.54"}], "}"}], ",", "1", ",", "10"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinX", ",", 
       RowBox[{"-", "1.06"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinY", ",", 
       RowBox[{"-", "1.5"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinZ", ",", 
       RowBox[{"-", "0.15"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgSize", ",", "2.865"}], "}"}], ",", "2", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgSizeZ", ",", "2.005"}], "}"}], ",", "2", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"samplingRadius", ",", "0.45"}], "}"}], ",", "0.2", ",", 
     "1.5"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.838591199702325*^9, 3.838591337293561*^9}, 
   3.8385917159706817`*^9, 3.838595490013892*^9, {3.838595755631129*^9, 
   3.838595792330063*^9}, 3.838705098834033*^9, {3.838705198068845*^9, 
   3.8387052547296543`*^9}, {3.838710356243922*^9, 3.8387104205158715`*^9}, {
   3.838710457834075*^9, 3.8387104772503433`*^9}, {3.8387105602265053`*^9, 
   3.8387106453182497`*^9}, {3.838710691110968*^9, 3.8387107026595526`*^9}, {
   3.838710760950264*^9, 3.8387107741555157`*^9}, {3.83871081058805*^9, 
   3.8387108842281995`*^9}, {3.8387109557796297`*^9, 3.838710962771296*^9}, {
   3.8387110579159527`*^9, 3.8387110659404736`*^9}, 3.83871115302098*^9, {
   3.8387112018303523`*^9, 3.838711225944543*^9}, {3.838711357957591*^9, 
   3.8387114052290945`*^9}, {3.838711463876541*^9, 3.8387114851587057`*^9}, {
   3.838711527140164*^9, 3.8387115592453966`*^9}, {3.8387116107116127`*^9, 
   3.8387116152321033`*^9}, {3.838711698541105*^9, 3.838711826163373*^9}, {
   3.8387119425001335`*^9, 3.8387120479172487`*^9}, {3.838712198285242*^9, 
   3.8387122420538263`*^9}, {3.8387123341239777`*^9, 3.838712428933677*^9}, {
   3.8387125745236473`*^9, 3.838712790668149*^9}, {3.83871282780429*^9, 
   3.8387129440765405`*^9}, {3.8387134662939687`*^9, 3.838713596672432*^9}, {
   3.8387137060366974`*^9, 3.838713721979744*^9}, {3.838713777120103*^9, 
   3.83871380899654*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"c7857d34-d240-432f-ba2e-2264d397a06b"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`imgMinX$$ = -1.06, $CellContext`imgMinY$$ = \
-1.5, $CellContext`imgMinZ$$ = -0.15, $CellContext`imgSize$$ = 
    2.865, $CellContext`imgSizeZ$$ = 
    2.005, $CellContext`lightDirX$$ = -4.4, $CellContext`lightDirY$$ = -2.38, \
$CellContext`lightDirZ$$ = 3.54, $CellContext`recvPtX$$ = 
    0.39, $CellContext`recvPtY$$ = -0.208, $CellContext`reflCenterX$$ = 
    0.814, $CellContext`reflCenterY$$ = 0.3, $CellContext`reflNormalY$$ = 
    1., $CellContext`reflNormalZ$$ = 0.145, $CellContext`samplingRadius$$ = 
    0.45, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reflCenterX$$], 0.814}, 0, 1.3}, {{
       Hold[$CellContext`reflCenterY$$], 0.3}, 0, 1}, {{
       Hold[$CellContext`reflNormalY$$], 1.}, -1, 1}, {{
       Hold[$CellContext`reflNormalZ$$], 0.145}, -1, 1}, {{
       Hold[$CellContext`recvPtX$$], 0.39}, -1, 1}, {{
       Hold[$CellContext`recvPtY$$], -0.208}, -0.5, 0.5}, {{
       Hold[$CellContext`lightDirX$$], -4.4}, -5, 5}, {{
       Hold[$CellContext`lightDirY$$], -2.38}, -5, 5}, {{
       Hold[$CellContext`lightDirZ$$], 3.54}, 1, 10}, {{
       Hold[$CellContext`imgMinX$$], -1.06}, -2, 2}, {{
       Hold[$CellContext`imgMinY$$], -1.5}, -2, 2}, {{
       Hold[$CellContext`imgMinZ$$], -0.15}, -2, 2}, {{
       Hold[$CellContext`imgSize$$], 2.865}, 2, 5}, {{
       Hold[$CellContext`imgSizeZ$$], 2.005}, 2, 5}, {{
       Hold[$CellContext`samplingRadius$$], 0.45}, 0.2, 1.5}}, 
    Typeset`size$$ = {576., {227., 232.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`reflCenterX$2723$$ = 
    0, $CellContext`reflCenterY$2724$$ = 0, $CellContext`reflNormalY$2725$$ = 
    0, $CellContext`reflNormalZ$2726$$ = 0, $CellContext`recvPtX$2727$$ = 
    0, $CellContext`recvPtY$2728$$ = 0, $CellContext`lightDirX$2729$$ = 
    0, $CellContext`lightDirY$2730$$ = 0, $CellContext`lightDirZ$2731$$ = 
    0, $CellContext`imgMinX$2732$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`imgMinX$$ = -1.06, $CellContext`imgMinY$$ = \
-1.5, $CellContext`imgMinZ$$ = -0.15, $CellContext`imgSize$$ = 
        2.865, $CellContext`imgSizeZ$$ = 
        2.005, $CellContext`lightDirX$$ = -4.4, $CellContext`lightDirY$$ = \
-2.38, $CellContext`lightDirZ$$ = 3.54, $CellContext`recvPtX$$ = 
        0.39, $CellContext`recvPtY$$ = -0.208, $CellContext`reflCenterX$$ = 
        0.814, $CellContext`reflCenterY$$ = 0.3, $CellContext`reflNormalY$$ = 
        1., $CellContext`reflNormalZ$$ = 0.145, $CellContext`samplingRadius$$ = 
        0.45}, "ControllerVariables" :> {
        Hold[$CellContext`reflCenterX$$, $CellContext`reflCenterX$2723$$, 0], 
        Hold[$CellContext`reflCenterY$$, $CellContext`reflCenterY$2724$$, 0], 
        Hold[$CellContext`reflNormalY$$, $CellContext`reflNormalY$2725$$, 0], 
        Hold[$CellContext`reflNormalZ$$, $CellContext`reflNormalZ$2726$$, 0], 
        Hold[$CellContext`recvPtX$$, $CellContext`recvPtX$2727$$, 0], 
        Hold[$CellContext`recvPtY$$, $CellContext`recvPtY$2728$$, 0], 
        Hold[$CellContext`lightDirX$$, $CellContext`lightDirX$2729$$, 0], 
        Hold[$CellContext`lightDirY$$, $CellContext`lightDirY$2730$$, 0], 
        Hold[$CellContext`lightDirZ$$, $CellContext`lightDirZ$2731$$, 0], 
        Hold[$CellContext`imgMinX$$, $CellContext`imgMinX$2732$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`reflCenter = {$CellContext`reflCenterX$$, \
$CellContext`reflCenterY$$, 1}; $CellContext`reflNormal = 
        Normalize[{
          1, $CellContext`reflNormalY$$, $CellContext`reflNormalZ$$}]; \
$CellContext`lightDir = 
        Normalize[{$CellContext`lightDirX$$, $CellContext`lightDirY$$, \
$CellContext`lightDirZ$$}]; $CellContext`recvPt = {$CellContext`recvPtX$$, \
$CellContext`recvPtY$$, 0}; $CellContext`reflPeakPt = 
        gBRDF`gCalcPeakPoint[$CellContext`reflNormal, \
$CellContext`reflCenter, -$CellContext`lightDir, $CellContext`recvPt]; \
$CellContext`bounceDir = 
        Normalize[$CellContext`recvPt - $CellContext`reflPeakPt]; \
$CellContext`outDir = 
        gUtils`gReflectVector[-$CellContext`bounceDir, {0, 0, 
          1}]; $CellContext`pltLighting = Automatic; Show[{
          (gPlots3DEx`pltRectLine3D[
           Association[
           "center" -> {0, 0, 0}, "normal" -> {0, 0, 1}, 
            "majorAxis" -> {1, 0, 0}, "majorRadius" -> 1, "minorRadius" -> 
            0.5, "color" -> Black]]& )[
           Association[]], 
          (gPlots3DEx`pltRectLine3D[
           Association[
           "center" -> Slot["centerPt"], "normal" -> $CellContext`reflNormal, 
            "majorAxis" -> {0, 1, 0}, "majorRadius" -> 1, "minorRadius" -> 
            0.5, "color" -> Black]]& )[
           Association["centerPt" -> $CellContext`reflCenter]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt + $CellContext`lightDir 1.5, 
            "dir" -> -$CellContext`lightDir, "length" -> 1.5, "arrowPos" -> 
            0.5]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, "dir" -> 
            Normalize[$CellContext`recvPt - $CellContext`reflPeakPt], 
            "length" -> Norm[$CellContext`recvPt - $CellContext`reflPeakPt], 
            "arrowPos" -> 0.5]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`recvPt, "dir" -> $CellContext`outDir, 
            "length" -> 2, "arrowPos" -> 0.6]]& )[
           Association[]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`recvPt, "size" -> 0.01, "color" -> Black]]& )[
           Association[]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`reflPeakPt, "size" -> 0.01, "color" -> 
            Black]]& )[
           Association[]], 
          (gPlots3DEx`pltCircle3D[
           Association[
           "center" -> $CellContext`reflPeakPt, 
            "normal" -> $CellContext`reflNormal, "radius" -> Slot["radius"], 
            "thickness" -> 1, "color" -> Part[gUtils`gPlotColors, 1]]]& )[
           Association["radius" -> $CellContext`samplingRadius$$]]}, 
         PlotRange -> {{$CellContext`imgMinX$$, $CellContext`imgMinX$$ + \
$CellContext`imgSize$$}, {$CellContext`imgMinY$$, $CellContext`imgMinY$$ + \
$CellContext`imgSize$$}, {$CellContext`imgMinZ$$, $CellContext`imgMinZ$$ + \
$CellContext`imgSizeZ$$}}, Axes -> False, Boxed -> False, 
         ViewPoint -> {0, -2, 1}, AxesLabel -> {"X", "Y", "Z"}, ImageSize -> 
         Large]), 
      "Specifications" :> {{{$CellContext`reflCenterX$$, 0.814}, 0, 
         1.3}, {{$CellContext`reflCenterY$$, 0.3}, 0, 
         1}, {{$CellContext`reflNormalY$$, 1.}, -1, 
         1}, {{$CellContext`reflNormalZ$$, 0.145}, -1, 
         1}, {{$CellContext`recvPtX$$, 0.39}, -1, 
         1}, {{$CellContext`recvPtY$$, -0.208}, -0.5, 
         0.5}, {{$CellContext`lightDirX$$, -4.4}, -5, 
         5}, {{$CellContext`lightDirY$$, -2.38}, -5, 
         5}, {{$CellContext`lightDirZ$$, 3.54}, 1, 
         10}, {{$CellContext`imgMinX$$, -1.06}, -2, 
         2}, {{$CellContext`imgMinY$$, -1.5}, -2, 
         2}, {{$CellContext`imgMinZ$$, -0.15}, -2, 
         2}, {{$CellContext`imgSize$$, 2.865}, 2, 
         5}, {{$CellContext`imgSizeZ$$, 2.005}, 2, 
         5}, {{$CellContext`samplingRadius$$, 0.45}, 0.2, 1.5}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{931., {258., 264.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8385912192685413`*^9, 3.8385912443321114`*^9}, 
   3.8385912873416634`*^9, {3.838591321708517*^9, 3.8385913341329083`*^9}, 
   3.8385917165278206`*^9, 3.8385954906231775`*^9, 3.8385957622801776`*^9, 
   3.8385957930643406`*^9, 3.838705099423764*^9, 3.83870525540784*^9, 
   3.838710647930924*^9, {3.838710770135853*^9, 3.8387107746015787`*^9}, {
   3.838710822608133*^9, 3.838710885180488*^9}, 3.8387109633521376`*^9, 
   3.838711067628955*^9, 3.838711157489561*^9, {3.8387111963500576`*^9, 
   3.8387112386374693`*^9}, {3.83871135024479*^9, 3.8387114059945326`*^9}, {
   3.8387114481089916`*^9, 3.8387114858374777`*^9}, {3.8387115185100627`*^9, 
   3.8387115621931157`*^9}, 3.8387116190781536`*^9, {3.838711694606098*^9, 
   3.838711702271719*^9}, {3.838711739800219*^9, 3.83871182702871*^9}, 
   3.838711994323635*^9, {3.838712043018404*^9, 3.83871204882206*^9}, {
   3.8387121553511653`*^9, 3.838712165638774*^9}, 3.838712202079609*^9, 
   3.8387122674581757`*^9, {3.838712420568671*^9, 3.838712429592088*^9}, {
   3.8387127378110576`*^9, 3.8387128687549376`*^9}, {3.8387129104375825`*^9, 
   3.8387129444926524`*^9}, {3.8387135633627076`*^9, 3.838713626623205*^9}, 
   3.8387137237137003`*^9, {3.8387137694866285`*^9, 3.8387138098366656`*^9}, 
   3.8387152511948204`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"fdc9f780-8d5e-4fbd-b7ae-bcd440515921"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"diskCenter", ",", "diskNormal", ",", "axisSize"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axisSize", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diskCenter", "=", 
   RowBox[{"Normalize", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"diskNormal", "=", 
       RowBox[{"Normalize", "@", 
        RowBox[{"{", 
         RowBox[{"diskNormalX", ",", "diskNormalY", ",", "diskNormalZ"}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pltSphere3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "100"}], ",", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"\"\<mesh\>\"", "\[Rule]", "10"}], ","}], "*)"}], 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
             RowBox[{"\"\<lighting\>\"", "\[Rule]", "Automatic"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "x", ",", "y", ",", "z", ",", "\[Theta]", ",", "\[Phi]"}], 
                 "}"}], ",", "LightBlue"}], "]"}]}]}], "|>"}], 
           "\[IndentingNewLine]", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltDisk3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "diskCenter"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "diskNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "#radius"}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Green"}], 
               "]"}]}]}], "|>"}], "\[IndentingNewLine]", "\t", "]"}], "&"}], 
         "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<radius\>\"", "\[Rule]", "diskRadius"}], "|>"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltDiskProjArea3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<diskCenter\>\"", "\[Rule]", "diskCenter"}], ",", 
             RowBox[{"\"\<diskNormal\>\"", "\[Rule]", "diskNormal"}], ",", 
             RowBox[{"\"\<diskRadius\>\"", "\[Rule]", "#diskRadius"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Red"}], 
               "]"}]}], ",", 
             RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}]}], "|>"}], 
           "\[IndentingNewLine]", "\t", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<diskRadius\>\"", "\[Rule]", "diskRadius"}], "|>"}], 
         "]"}]}], "\[IndentingNewLine]", " ", "}"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"Axes", "\[Rule]", "False"}], ",", "\n", "\t\t", 
       RowBox[{"AxesLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
       ",", "\n", "\t\t", 
       RowBox[{"Boxed", "->", "False"}], ",", "\n", "\t\t", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}]}], "}"}]}], 
       ",", "\n", "\t\t", 
       RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "\n", "\t", "}"}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalX", ",", 
       RowBox[{"-", "4.2"}]}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalY", ",", 
       RowBox[{"-", "8."}]}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalZ", ",", "7.95"}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskRadius", ",", "0.473"}], "}"}], ",", "0.1", ",", "0.6"}], 
    "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8387140062764063`*^9, 3.8387140103327026`*^9}, {
  3.838714082557334*^9, 3.8387141153961573`*^9}, {3.8387141474867234`*^9, 
  3.83871417594713*^9}, {3.8387142377486773`*^9, 3.8387142980108094`*^9}, {
  3.8387144294289217`*^9, 3.8387144364714947`*^9}},
 CellLabel->
  "In[2205]:=",ExpressionUUID->"ee6a1a37-aed0-4f7a-b85e-72fb42133cae"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`diskNormalX$$ = -4.2, \
$CellContext`diskNormalY$$ = -8., $CellContext`diskNormalZ$$ = 
    7.95, $CellContext`diskRadius$$ = 0.473, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`diskNormalX$$], -4.2}, -10, 10}, {{
       Hold[$CellContext`diskNormalY$$], -8.}, -10, 10}, {{
       Hold[$CellContext`diskNormalZ$$], 7.95}, -10, 10}, {{
       Hold[$CellContext`diskRadius$$], 0.473}, 0.1, 0.6}}, Typeset`size$$ = {
    360., {193., 198.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`diskNormalX$1354504$$ = 
    0, $CellContext`diskNormalY$1354505$$ = 
    0, $CellContext`diskNormalZ$1354506$$ = 
    0, $CellContext`diskRadius$1354507$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`diskNormalX$$ = -4.2, \
$CellContext`diskNormalY$$ = -8., $CellContext`diskNormalZ$$ = 
        7.95, $CellContext`diskRadius$$ = 0.473}, "ControllerVariables" :> {
        Hold[$CellContext`diskNormalX$$, $CellContext`diskNormalX$1354504$$, 
         0], 
        Hold[$CellContext`diskNormalY$$, $CellContext`diskNormalY$1354505$$, 
         0], 
        Hold[$CellContext`diskNormalZ$$, $CellContext`diskNormalZ$1354506$$, 
         0], 
        Hold[$CellContext`diskRadius$$, $CellContext`diskRadius$1354507$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Show[$CellContext`diskNormal = 
         Normalize[{$CellContext`diskNormalX$$, $CellContext`diskNormalY$$, \
$CellContext`diskNormalZ$$}]; {
          (gPlots3DEx`pltSphere3D[
           Association[
           "center" -> {0, 0, 0}, "radius" -> 1, "plotPts" -> 100, "opacity" -> 
            0.3, "lighting" -> Automatic, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z, \
$CellContext`\[Theta], $CellContext`\[Phi]}, LightBlue]]]& )[
           Association[]], 
          (gPlots3DEx`pltDisk3D[
           Association[
           "center" -> $CellContext`diskCenter, 
            "normal" -> $CellContext`diskNormal, "radius" -> Slot["radius"], 
            "opacity" -> 0.3, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              Green]]]& )[
           Association["radius" -> $CellContext`diskRadius$$]], 
          (gPlots3DEx`pltDiskProjArea3D[
           Association[
           "diskCenter" -> $CellContext`diskCenter, 
            "diskNormal" -> $CellContext`diskNormal, "diskRadius" -> 
            Slot["diskRadius"], "opacity" -> 0.3, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, Red], 
            "zbias" -> 1]]& )[
           Association["diskRadius" -> $CellContext`diskRadius$$]]}, {
        Axes -> False, AxesLabel -> {"X", "Y", "Z"}, Boxed -> False, 
         PlotRange -> {{-$CellContext`axisSize, $CellContext`axisSize}, \
{-$CellContext`axisSize, $CellContext`axisSize}, {-$CellContext`axisSize, \
$CellContext`axisSize}}, ImageSize -> Medium}], 
      "Specifications" :> {{{$CellContext`diskNormalX$$, -4.2}, -10, 
         10}, {{$CellContext`diskNormalY$$, -8.}, -10, 
         10}, {{$CellContext`diskNormalZ$$, 7.95}, -10, 
         10}, {{$CellContext`diskRadius$$, 0.473}, 0.1, 0.6}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{411., {282., 288.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.838713933421653*^9, {3.8387139687932673`*^9, 3.838714012091153*^9}, 
   3.8387141842589903`*^9, 3.8387142526979027`*^9, {3.838714290178372*^9, 
   3.8387142987482414`*^9}},
 CellLabel->
  "Out[2208]=",ExpressionUUID->"37920008-fc0e-4052-996f-1398804e996e"],

Cell[BoxData[
 TemplateBox[{
  "Show","gcomb",
   "\"Could not combine the graphics objects in \\!\\(\\*RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]\\).\"",2,1,1,
   30204054292605315703,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8387152317050457`*^9},
 CellLabel->"",ExpressionUUID->"2c46503b-9b47-45c3-8497-10d3a93440b0"],

Cell[BoxData[
 TemplateBox[{
  "Show","gcomb",
   "\"Could not combine the graphics objects in \
\\!\\(\\*RowBox[{\\\"Show\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"gPlots3DEx`pltSphere3D\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftAssociation]\\\", RowBox[{RowBox[{\\\"\\\\\\\"center\\\\\\\"\\\", \\\"\
\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"\\\\\\\"radius\\\\\\\"\\\", \\\"\[Rule]\\\", \\\"1\\\"}], \\\",\\\
\", RowBox[{\\\"\\\\\\\"plotPts\\\\\\\"\\\", \\\"\[Rule]\\\", \\\"100\\\"}], \
\\\",\\\", RowBox[{\\\"\\\\\\\"opacity\\\\\\\"\\\", \\\"\[Rule]\\\", \\\"0.3`\
\\\"}], \\\",\\\", RowBox[{\\\"\\\\\\\"lighting\\\\\\\"\\\", \\\"\[Rule]\\\", \
\\\"Automatic\\\"}], \\\",\\\", RowBox[{\\\"\\\\\\\"colorFunc\\\\\\\"\\\", \\\
\"\[Rule]\\\", RowBox[{\\\"Function\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"x\\\", \\\",\\\", \\\"y\\\", \
\\\",\\\", \\\"z\\\", \\\",\\\", \\\"\[Theta]\\\", \\\",\\\", \
\\\"\[Phi]\\\"}], \\\"}\\\"}], \\\",\\\", \\\"LightBlue\\\"}], \
\\\"]\\\"}]}]}], \\\"\[RightAssociation]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"gPlots3DEx`pltDisk3D\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftAssociation]\\\", RowBox[{RowBox[{\\\"\\\\\\\"center\\\\\\\"\\\", \\\"\
\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{FractionBox[\\\"1\\\", \
SqrtBox[\\\"3\\\"]], \\\",\\\", RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", \
SqrtBox[\\\"3\\\"]]}], \\\",\\\", FractionBox[\\\"1\\\", \
SqrtBox[\\\"3\\\"]]}], \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\",\
\\\", RowBox[{\\\"\\\\\\\"colorFunc\\\\\\\"\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"Function\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"x\
\\\", \\\",\\\", \\\"y\\\", \\\",\\\", \\\"z\\\"}], \\\"}\\\"}], \\\",\\\", \
\\\"Green\\\"}], \\\"]\\\"}]}]}], \\\"\[RightAssociation]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"gPlots3DEx`pltDiskProjArea3D\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{RowBox[{\\\"\\\\\\\"diskCenter\\\\\\\"\\\", \\\"\[Rule]\\\", RowBox[{\
\\\"{\\\", RowBox[{FractionBox[\\\"1\\\", SqrtBox[\\\"3\\\"]], \\\",\\\", \
RowBox[{\\\"-\\\", FractionBox[\\\"1\\\", SqrtBox[\\\"3\\\"]]}], \\\",\\\", \
FractionBox[\\\"1\\\", SqrtBox[\\\"3\\\"]]}], \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"\\\\\\\"diskNormal\\\\\\\"\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"0.3489805994485165`\\\"}], \
\\\",\\\", RowBox[{\\\"-\\\", \\\"0.6647249513305076`\\\"}], \\\",\\\", \
\\\"0.6605704203846919`\\\"}], \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"\\\\\\\"diskRadius\\\\\\\"\\\", \\\"\[Rule]\\\", \
\\\"0.473`\\\"}], \\\",\\\", RowBox[{\\\"\\\\\\\"opacity\\\\\\\"\\\", \\\"\
\[Rule]\\\", \\\"0.3`\\\"}], \\\",\\\", RowBox[{\\\"\\\\\\\"colorFunc\\\\\\\"\
\\\", \\\"\[Rule]\\\", RowBox[{\\\"Function\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"x\\\", \\\",\\\", \\\"y\\\", \
\\\",\\\", \\\"z\\\"}], \\\"}\\\"}], \\\",\\\", \\\"Red\\\"}], \\\"]\\\"}]}], \
\\\",\\\", RowBox[{\\\"\\\\\\\"zbias\\\\\\\"\\\", \\\"\[Rule]\\\", \
\\\"1\\\"}]}], \\\"\[RightAssociation]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"Axes\\\", \\\"\[Rule]\\\", \
\\\"False\\\"}], \\\",\\\", RowBox[{\\\"AxesLabel\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\
\"}], \\\",\\\", RowBox[{RowBox[{\\\"\[LeftSkeleton]\\\", \\\"9\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\
\",\\\", RowBox[{\\\"ImageSize\\\", \\\"\[Rule]\\\", \\\"Medium\\\"}]}], \
\\\"}\\\"}]}], \\\"]\\\"}]\\).\"",2,11,6,30204054292605315703,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8387152413696995`*^9},
 CellLabel->"",ExpressionUUID->"d78eaa69-a105-4e08-a77e-5b2ebcf1de4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "diskCenter", ",", "diskNormal", ",", "axisSize", ",", "recvPt", ",", 
    "reflViewDir", ",", "lightDir"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axisSize", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diskCenter", "=", 
   RowBox[{"Normalize", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"recvPt", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"reflViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"recvPt", "-", "diskCenter"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"lightDir", "=", 
     RowBox[{"gReflectVector", "[", 
      RowBox[{"reflViewDir", ",", "diskNormal"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"diskNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"diskNormalX", ",", "diskNormalY", ",", "diskNormalZ"}], 
       "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"asgLight", "=", 
     RowBox[{"asgReflectLight", "[", 
      RowBox[{
      "recvPt", ",", "lightDir", ",", "lightIntensity", ",", "0.1", ",", 
       RowBox[{"{", 
        RowBox[{"diskCenter", ",", "diskNormal", ",", "diskRadius"}], "}"}]}],
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "arrow"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pltArrow3D", "[", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<origin\>\"", "\[Rule]", 
               RowBox[{"diskCenter", "+", 
                RowBox[{"lightDir", "*", "0.5"}]}]}], ",", 
              RowBox[{"\"\<dir\>\"", "\[Rule]", 
               RowBox[{"-", "lightDir"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}], ",", 
              RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.6"}]}], "|>"}], 
            "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
          RowBox[{"<|", "|>"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pltSphere3D", "[", " ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "recvPt"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<plotPts\>\"", "\[Rule]", "100"}], ",", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"\"\<mesh\>\"", "\[Rule]", "10"}], ","}], "*)"}], 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
              RowBox[{"\"\<lighting\>\"", "\[Rule]", "Automatic"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "x", ",", "y", ",", "z", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "}"}], ",", "LightBlue"}], "]"}]}]}], "|>"}], 
            "\[IndentingNewLine]", "]"}], "&"}], "[", 
          RowBox[{"<|", "|>"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"pltSphere3D", "[", " ", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<center\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
            RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
            RowBox[{"\"\<plotPts\>\"", "\[Rule]", "200"}], ",", 
            RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
               RowBox[{"Hue", "@", 
                RowBox[{"asgVector", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                  "asgLight"}], "]"}]}]}], "]"}]}]}], "|>"}], 
          "\[IndentingNewLine]", "]"}], "&"}], "[", 
        RowBox[{"<|", "|>"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"pltDisk3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "diskCenter"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "diskNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "#radius"}], ",", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Green"}], 
               "]"}]}]}], "|>"}], "\[IndentingNewLine]", "\t", "]"}], "&"}], 
         "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<radius\>\"", "\[Rule]", "diskRadius"}], "|>"}], "]"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"pltDiskProjArea3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<diskCenter\>\"", "\[Rule]", "diskCenter"}], ",", 
             RowBox[{"\"\<diskNormal\>\"", "\[Rule]", "diskNormal"}], ",", 
             RowBox[{"\"\<diskRadius\>\"", "\[Rule]", "#diskRadius"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Red"}], 
               "]"}]}], ",", 
             RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}]}], "|>"}], 
           "\[IndentingNewLine]", "\t", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<diskRadius\>\"", "\[Rule]", "diskRadius"}], "|>"}], 
         "]"}], "*)"}], "\[IndentingNewLine]", " ", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{"Axes", "\[Rule]", "False"}], ",", "\n", "\t\t", 
        RowBox[{"AxesLabel", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
        ",", "\n", "\t\t", 
        RowBox[{"Boxed", "->", "False"}], ",", "\n", "\t\t", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}]}], "}"}]}], 
        ",", "\n", "\t\t", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "\n", "\t", "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalX", ",", 
       RowBox[{"-", "4.2"}]}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalY", ",", 
       RowBox[{"-", "8."}]}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalZ", ",", "7.95"}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskRadius", ",", "0.473"}], "}"}], ",", "0.1", ",", "0.6"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "0.1"}], "}"}], ",", "0.05", ",", 
     "0.3"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.838714484609054*^9, 3.8387145170271535`*^9}, {
  3.838714578351654*^9, 3.8387146308673487`*^9}, {3.838714816915636*^9, 
  3.8387150895630417`*^9}, {3.838715131189658*^9, 3.838715209317031*^9}, {
  3.8387152759178796`*^9, 3.838715284859612*^9}, {3.838715315874111*^9, 
  3.838715346620067*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"0100b804-fc93-4ef6-8c90-070b592b8b7c"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`diskNormalX$$ = -4.2, \
$CellContext`diskNormalY$$ = -8., $CellContext`diskNormalZ$$ = 
    7.95, $CellContext`diskRadius$$ = 0.473, $CellContext`lightIntensity$$ = 
    0.1, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`diskNormalX$$], -4.2}, -10, 10}, {{
       Hold[$CellContext`diskNormalY$$], -8.}, -10, 10}, {{
       Hold[$CellContext`diskNormalZ$$], 7.95}, -10, 10}, {{
       Hold[$CellContext`diskRadius$$], 0.473}, 0.1, 0.6}, {{
       Hold[$CellContext`lightIntensity$$], 0.1}, 0.05, 0.3}}, 
    Typeset`size$$ = {360., {193., 198.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`diskNormalX$416198$$ = 
    0, $CellContext`diskNormalY$416199$$ = 
    0, $CellContext`diskNormalZ$416200$$ = 
    0, $CellContext`diskRadius$416201$$ = 
    0, $CellContext`lightIntensity$416202$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`diskNormalX$$ = -4.2, \
$CellContext`diskNormalY$$ = -8., $CellContext`diskNormalZ$$ = 
        7.95, $CellContext`diskRadius$$ = 
        0.473, $CellContext`lightIntensity$$ = 0.1}, "ControllerVariables" :> {
        Hold[$CellContext`diskNormalX$$, $CellContext`diskNormalX$416198$$, 
         0], 
        Hold[$CellContext`diskNormalY$$, $CellContext`diskNormalY$416199$$, 
         0], 
        Hold[$CellContext`diskNormalZ$$, $CellContext`diskNormalZ$416200$$, 
         0], 
        Hold[$CellContext`diskRadius$$, $CellContext`diskRadius$416201$$, 0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$416202$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`reflViewDir = 
        Normalize[$CellContext`recvPt - $CellContext`diskCenter]; \
$CellContext`lightDir = 
        gUtils`gReflectVector[$CellContext`reflViewDir, \
$CellContext`diskNormal]; $CellContext`diskNormal = 
        Normalize[{$CellContext`diskNormalX$$, $CellContext`diskNormalY$$, \
$CellContext`diskNormalZ$$}]; $CellContext`asgLight = 
        sgCommon`asgReflectLight[$CellContext`recvPt, $CellContext`lightDir, \
$CellContext`lightIntensity$$, 
          0.1, {$CellContext`diskCenter, $CellContext`diskNormal, \
$CellContext`diskRadius$$}]; Show[{
          (gPlots3DEx`pltSphere3D[
           Association[
           "center" -> {0, 0, 0}, "radius" -> 1, "plotPts" -> 200, "mesh" -> 
            None, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              Hue[
               
               sgCommon`asgVector[{$CellContext`x, $CellContext`y, \
$CellContext`z}, $CellContext`asgLight]]]]]& )[
           Association[]]}, {
         Axes -> False, AxesLabel -> {"X", "Y", "Z"}, Boxed -> False, 
          PlotRange -> {{-$CellContext`axisSize, $CellContext`axisSize}, \
{-$CellContext`axisSize, $CellContext`axisSize}, {-$CellContext`axisSize, \
$CellContext`axisSize}}, ImageSize -> Medium}]), 
      "Specifications" :> {{{$CellContext`diskNormalX$$, -4.2}, -10, 
         10}, {{$CellContext`diskNormalY$$, -8.}, -10, 
         10}, {{$CellContext`diskNormalZ$$, 7.95}, -10, 
         10}, {{$CellContext`diskRadius$$, 0.473}, 0.1, 
         0.6}, {{$CellContext`lightIntensity$$, 0.1}, 0.05, 0.3}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{411., {296., 302.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8387153668800755`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"0b9ff3f0-3f01-43de-bfe2-c83bf59fc76d"],

Cell[BoxData[
 TemplateBox[{
  "Assert","asrtfl",
   "\"Assertion \\!\\(\\*RowBox[{\\\"sgCommon`Private`minorSize$456290\\\", \
\\\">\\\", \\\"0\\\"}]\\) at line \\!\\(\\*RowBox[{\\\"427\\\"}]\\) in \\!\\(\
\\*RowBox[{\\\"\\\\\\\"sgCommon`\\\\\\\"\\\"}]\\) failed.\"",2,48,49,
   30204054292605315703,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.838715376003642*^9},
 CellLabel->"",ExpressionUUID->"228eb24f-e8dd-480d-a8a4-6b551253eae3"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.8387153839576087`*^9},ExpressionUUID->"4393e55f-b04c-45c7-8a74-\
edce5527b4db"]
},
WindowSize->{1078, 687},
WindowMargins->{{Automatic, 436}, {-15, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2558, 54, 257, "Input",ExpressionUUID->"869dad65-2627-40c4-a516-a065be9f81e5"],
Cell[CellGroupData[{
Cell[3141, 78, 13876, 322, 1359, "Input",ExpressionUUID->"c7857d34-d240-432f-ba2e-2264d397a06b"],
Cell[17020, 402, 9817, 174, 541, "Output",ExpressionUUID->"fdc9f780-8d5e-4fbd-b7ae-bcd440515921"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26874, 581, 6007, 144, 599, "Input",ExpressionUUID->"ee6a1a37-aed0-4f7a-b85e-72fb42133cae"],
Cell[32884, 727, 4463, 86, 589, "Output",ExpressionUUID->"37920008-fc0e-4052-996f-1398804e996e"],
Cell[37350, 815, 380, 8, 21, "Message",ExpressionUUID->"2c46503b-9b47-45c3-8497-10d3a93440b0"],
Cell[37733, 825, 4048, 59, 148, "Message",ExpressionUUID->"d78eaa69-a105-4e08-a77e-5b2ebcf1de4d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41818, 889, 8990, 213, 846, "Input",ExpressionUUID->"0100b804-fc93-4ef6-8c90-070b592b8b7c"],
Cell[50811, 1104, 4322, 84, 617, "Output",ExpressionUUID->"0b9ff3f0-3f01-43de-bfe2-c83bf59fc76d"],
Cell[55136, 1190, 464, 9, 21, "Message",ExpressionUUID->"228eb24f-e8dd-480d-a8a4-6b551253eae3"]
}, Open  ]],
Cell[55615, 1202, 149, 3, 48, "Input",ExpressionUUID->"4393e55f-b04c-45c7-8a74-edce5527b4db"]
}
]
*)

