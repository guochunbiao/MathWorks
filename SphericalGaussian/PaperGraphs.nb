(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    255015,       5596]
NotebookOptionsPosition[    252060,       5539]
NotebookOutlinePosition[    252434,       5555]
CellTagsIndexPosition[    252391,       5552]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
      "\"\<Shared\>\""}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3DEx`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gTexStyles`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBlochSphere`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResetDirectory", "[", "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8381045114551363`*^9, 3.838104621306058*^9}, {
   3.8381047318712387`*^9, 3.8381047322481966`*^9}, {3.838104794488738*^9, 
   3.838105018474309*^9}, {3.8381051299062104`*^9, 3.838105146536306*^9}, {
   3.838105374402709*^9, 3.838105377296275*^9}, {3.838105554141843*^9, 
   3.838105659984576*^9}, {3.8381060886546383`*^9, 3.8381060930153093`*^9}, {
   3.8381062316590977`*^9, 3.8381062893154573`*^9}, {3.838106350865511*^9, 
   3.838106359414567*^9}, 3.8381064092334566`*^9, {3.83810687288235*^9, 
   3.8381069367815385`*^9}, {3.838106984663814*^9, 3.8381069951275673`*^9}, {
   3.8381071398045254`*^9, 3.8381072658717337`*^9}, {3.8381073503072834`*^9, 
   3.8381075332543845`*^9}, {3.8381077236884565`*^9, 
   3.8381077468396764`*^9}, {3.838107865615464*^9, 3.8381082317647915`*^9}, {
   3.838108263607842*^9, 3.8381083210600543`*^9}, {3.838108363584729*^9, 
   3.838108423001891*^9}, {3.838108490317093*^9, 3.838108512995843*^9}, {
   3.838590300439362*^9, 3.83859030125344*^9}, 3.838591772389261*^9, {
   3.8385921678668203`*^9, 3.838592181930876*^9}, {3.838595366170927*^9, 
   3.838595391521434*^9}, {3.8385955016339736`*^9, 3.838595530726467*^9}, {
   3.8387130559878073`*^9, 3.8387130564817243`*^9}, 3.8390587601131177`*^9},
 CellLabel->"In[59]:=",ExpressionUUID->"869dad65-2627-40c4-a516-a065be9f81e5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "reflCenter", ",", "reflNormal", ",", "lightDir", ",", "pltLighting", ",", 
    "reflPeakPt", ",", "recvPt", ",", "\[IndentingNewLine]", "\t", 
    "bounceDir", ",", "outDir", ",", "minorAxis", ",", "majorAxis", ",", 
    "intsMin", ",", "intsMax", ",", "intsCenter"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"reflCenter", "=", 
     RowBox[{"{", 
      RowBox[{"reflCenterX", ",", "reflCenterY", ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"reflNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "reflNormalY", ",", "reflNormalZ"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"lightDirX", ",", "lightDirY", ",", "lightDirZ"}], "}"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"pltLighting", "=", 
       RowBox[{"{", 
        RowBox[{"\"\<Directional\>\"", ",", "White", ",", 
         RowBox[{"{", 
          RowBox[{"testLightDir", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"recvPt", "=", 
     RowBox[{"{", 
      RowBox[{"recvPtX", ",", "recvPtY", ",", "0"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"reflPeakPt", "=", 
     RowBox[{"gCalcPeakPoint", "[", 
      RowBox[{"reflNormal", ",", "reflCenter", ",", 
       RowBox[{"-", "lightDir"}], ",", "recvPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"bounceDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"outDir", "=", 
     RowBox[{"gReflectVector", "[", 
      RowBox[{
       RowBox[{"-", "bounceDir"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"approximate", " ", "intersection", " ", "area"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"minorAxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"reflNormal", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}]}], ";", "\n", 
    "   ", 
    RowBox[{"majorAxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"minorAxis", ",", "reflNormal"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsMin", "=", 
     RowBox[{"reflPeakPt", "+", 
      RowBox[{"majorAxis", "*", 
       RowBox[{"(", 
        RowBox[{"samplingRadius", "+", "intsCenterXOffset"}], ")"}]}], "-", 
      RowBox[{"minorAxis", "*", 
       RowBox[{"(", 
        RowBox[{"0.3", "+", "intsCenterYOffset"}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsMax", "=", 
     RowBox[{"reflPeakPt", "-", 
      RowBox[{"majorAxis", "*", "samplingRadius"}], "+", 
      RowBox[{"minorAxis", "*", "samplingRadius"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsCenter", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"intsMin", "+", "intsMax"}], ")"}], "/", "2"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"pltLighting", "=", "Automatic"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", "receiver", "*)"}], "\[IndentingNewLine]", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pltRectLine3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"ints", " ", "area"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pltPoint3D", "[", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<pos\>\"", "\[Rule]", "intsMax"}], ",", 
               RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
             "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
           RowBox[{"<|", "|>"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", "  ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pltRectLine3D", "[", " ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "intsCenter"}], ",", 
               RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
               RowBox[{"\"\<style\>\"", "\[Rule]", "Dashed"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<majorRadius\>\"", "\[Rule]", 
                RowBox[{"samplingRadius", "*", "intsCenterWidthMultiply"}]}], 
               ",", "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "#intsMinorRadius"}],
                ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Orange"}]}], "|>"}], 
             "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
           RowBox[{"<|", 
            RowBox[{"\"\<intsMinorRadius\>\"", "\[Rule]", "intsMinorRadius"}],
             "|>"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", "reflector", "*)"}], "\[IndentingNewLine]", "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRectLine3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "#centerPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<centerPt\>\"", "\[Rule]", "reflCenter"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "arrow"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"reflPeakPt", "+", 
               RowBox[{"lightDir", "*", "1.5"}]}]}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "lightDir"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "1.5"}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.3"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"one", " ", "bounce", " ", "arrow"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"Normalize", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", 
              RowBox[{"Norm", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.5"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"out", " ", "dir", " ", "arrow"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "recvPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", "outDir"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "2"}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.8"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"recv", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "recvPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"reflector", " ", "normal"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "reflNormal"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.6"}], ",", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"recv", " ", "normal"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "recvPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.6"}], ",", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"refl", " ", "peak", " ", "point"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"sampling", " ", "disk"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltCircle3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}]}], "|>"}], 
           "\[IndentingNewLine]", "\t", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "text", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<R'\>\"", ",", 
                RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Orange", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
              ",", 
              RowBox[{"reflPeakPt", "+", 
               RowBox[{"{", 
                RowBox[{"0.3", ",", "0", ",", "0.46"}], "}"}]}]}], "]"}], 
            "}"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Light\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"lightDir", "*", "1.65"}]}]}], "]"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<-i\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"lightDir", "*", "1.2"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.05"}], ",", "0", ",", 
               RowBox[{"-", "0.1"}]}], "}"}]}]}], "]"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<y\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{"0.07", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<r\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{
              RowBox[{"Normalize", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}], "*", "0.5"}], 
             "+", 
             RowBox[{"{", 
              RowBox[{"0.1", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<o\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{"outDir", "*", "1.6"}], "+", 
             RowBox[{"{", 
              RowBox[{"0.1", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<x\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{"{", 
              RowBox[{"0.08", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\!\(\*SubscriptBox[\(n\), \(r\)]\)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", "Red", 
              ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "-", 
             RowBox[{"reflNormal", "*", "0.65"}]}]}], "]"}], "}"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\!\(\*SubscriptBox[\(n\), \(x\)]\)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", "Red", 
              ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}], "*", "0.7"}]}]}], 
           "]"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Rectangle R\\n(reflector)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{"0.8", ",", "0", ",", "0.7"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<receiver\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "0.3"}]}], "}"}]}]}], "]"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<D\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", "Blue",
               ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0.55"}], "}"}]}]}], "]"}], "}"}], 
         "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"imgMinX", ",", 
           RowBox[{"imgMinX", "+", "imgSize"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"imgMinY", ",", 
           RowBox[{"imgMinY", "+", "imgSize"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"imgMinZ", ",", 
           RowBox[{"imgMinZ", "+", "imgSizeZ"}]}], "}"}]}], "}"}]}], ",", 
      "\n", "\t\t", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "2"}], ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
      "\t    ", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
      ",", "\[IndentingNewLine]", "\t    ", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflCenterX", ",", "0.814"}], "}"}], ",", "0", ",", "1.3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflCenterY", ",", "0.3"}], "}"}], ",", "0", ",", "1"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflNormalY", ",", "1."}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflNormalZ", ",", "0.145"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"recvPtX", ",", "0.39"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"recvPtY", ",", 
       RowBox[{"-", "0.208"}]}], "}"}], ",", 
     RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirX", ",", 
       RowBox[{"-", "4.4"}]}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirY", ",", 
       RowBox[{"-", "2.38"}]}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirZ", ",", "3.54"}], "}"}], ",", "1", ",", "10"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinX", ",", 
       RowBox[{"-", "1.06"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinY", ",", 
       RowBox[{"-", "1.5"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinZ", ",", 
       RowBox[{"-", "0.15"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgSize", ",", "2.865"}], "}"}], ",", "2", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgSizeZ", ",", "2.005"}], "}"}], ",", "2", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"samplingRadius", ",", "0.45"}], "}"}], ",", "0.2", ",", 
     "1.5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsCenterWidthMultiply", ",", "1.0295"}], "}"}], ",", "0.9", 
     ",", "1.1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsCenterXOffset", ",", 
       RowBox[{"-", "0.018"}]}], "}"}], ",", 
     RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsCenterYOffset", ",", 
       RowBox[{"-", "0.062"}]}], "}"}], ",", 
     RowBox[{"-", "0.2"}], ",", "0.2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsMinorRadius", ",", "0.4"}], "}"}], ",", "0.3", ",", 
     "0.5"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8381045114551363`*^9, 3.838104621306058*^9}, {
   3.8381047318712387`*^9, 3.8381047322481966`*^9}, {3.838104794488738*^9, 
   3.838105018474309*^9}, {3.8381051299062104`*^9, 3.838105146536306*^9}, {
   3.838105374402709*^9, 3.838105377296275*^9}, {3.838105554141843*^9, 
   3.838105659984576*^9}, {3.8381060886546383`*^9, 3.8381060930153093`*^9}, {
   3.8381062316590977`*^9, 3.8381062893154573`*^9}, {3.838106350865511*^9, 
   3.838106359414567*^9}, 3.8381064092334566`*^9, {3.83810687288235*^9, 
   3.8381069367815385`*^9}, {3.838106984663814*^9, 3.8381069951275673`*^9}, {
   3.8381071398045254`*^9, 3.8381072658717337`*^9}, {3.8381073503072834`*^9, 
   3.8381075332543845`*^9}, {3.8381077236884565`*^9, 
   3.8381077468396764`*^9}, {3.838107865615464*^9, 3.8381082317647915`*^9}, {
   3.838108263607842*^9, 3.8381083210600543`*^9}, {3.838108363584729*^9, 
   3.838108423001891*^9}, {3.838108490317093*^9, 3.838108512995843*^9}, {
   3.838590300439362*^9, 3.83859030125344*^9}, 3.838591772389261*^9, {
   3.8385921678668203`*^9, 3.838592181930876*^9}, {3.838595366170927*^9, 
   3.838595391521434*^9}, {3.8385955016339736`*^9, 3.838595530726467*^9}, {
   3.8387130559878073`*^9, 3.8387130564817243`*^9}, {3.8390587601131177`*^9, 
   3.8390587741025543`*^9}, {3.8390595766422176`*^9, 
   3.8390596155031347`*^9}, {3.8390596605241776`*^9, 3.83905975650671*^9}, {
   3.8390598162399225`*^9, 3.839060224983287*^9}, {3.839060565658577*^9, 
   3.8390606329551983`*^9}, {3.839060777791469*^9, 3.839060934879589*^9}, {
   3.8390609933000793`*^9, 3.8390611449516*^9}, {3.8390611764490485`*^9, 
   3.839061239199666*^9}, {3.8390612708643975`*^9, 3.839061406852685*^9}, {
   3.8392995311563835`*^9, 3.8392995319148836`*^9}, {3.8393006656541204`*^9, 
   3.8393007041070304`*^9}, {3.839300977291467*^9, 3.839300999572774*^9}, {
   3.8393010507126527`*^9, 3.8393010839473534`*^9}, {3.839301805794608*^9, 
   3.8393018185856514`*^9}, {3.8393077869435596`*^9, 
   3.8393078149637184`*^9}, {3.839307852285992*^9, 3.8393079044528666`*^9}, {
   3.8393166232329187`*^9, 3.8393166613672514`*^9}, {3.8393167388870745`*^9, 
   3.839316746625222*^9}, {3.839316819007837*^9, 3.8393168458627396`*^9}, {
   3.8393168848790874`*^9, 3.839316926802112*^9}, {3.839316982152668*^9, 
   3.83931706192227*^9}, {3.8393171104902377`*^9, 3.8393171976314726`*^9}, {
   3.839317230951835*^9, 3.8393175033154755`*^9}, {3.839317547802697*^9, 
   3.839317554450119*^9}, {3.8393175996978827`*^9, 3.839317632113021*^9}, {
   3.8393176792887383`*^9, 3.839317758072201*^9}, {3.8393177883614473`*^9, 
   3.8393178946640844`*^9}, {3.8393179446652236`*^9, 
   3.8393181553521194`*^9}, {3.839318221610052*^9, 3.8393182272965755`*^9}, {
   3.8393691531543207`*^9, 3.839369192577217*^9}, {3.8395546620420523`*^9, 
   3.8395546629175167`*^9}, {3.8396540082300034`*^9, 3.839654019595943*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"32509c09-4e03-4cf7-b0a4-9a78146cb38e"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`imgMinX$$ = -1.06, $CellContext`imgMinY$$ = \
-1.5, $CellContext`imgMinZ$$ = -0.15, $CellContext`imgSize$$ = 
    2.865, $CellContext`imgSizeZ$$ = 
    2.005, $CellContext`intsCenterWidthMultiply$$ = 
    1.0295, $CellContext`intsCenterXOffset$$ = -0.018, \
$CellContext`intsCenterYOffset$$ = -0.062, $CellContext`intsMinorRadius$$ = 
    0.4, $CellContext`lightDirX$$ = -4.4, $CellContext`lightDirY$$ = -2.38, \
$CellContext`lightDirZ$$ = 3.54, $CellContext`recvPtX$$ = 
    0.39, $CellContext`recvPtY$$ = -0.208, $CellContext`reflCenterX$$ = 
    0.814, $CellContext`reflCenterY$$ = 0.3, $CellContext`reflNormalY$$ = 
    1., $CellContext`reflNormalZ$$ = 0.145, $CellContext`samplingRadius$$ = 
    0.45, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reflCenterX$$], 0.814}, 0, 1.3}, {{
       Hold[$CellContext`reflCenterY$$], 0.3}, 0, 1}, {{
       Hold[$CellContext`reflNormalY$$], 1.}, -1, 1}, {{
       Hold[$CellContext`reflNormalZ$$], 0.145}, -1, 1}, {{
       Hold[$CellContext`recvPtX$$], 0.39}, -1, 1}, {{
       Hold[$CellContext`recvPtY$$], -0.208}, -0.5, 0.5}, {{
       Hold[$CellContext`lightDirX$$], -4.4}, -5, 5}, {{
       Hold[$CellContext`lightDirY$$], -2.38}, -5, 5}, {{
       Hold[$CellContext`lightDirZ$$], 3.54}, 1, 10}, {{
       Hold[$CellContext`imgMinX$$], -1.06}, -2, 2}, {{
       Hold[$CellContext`imgMinY$$], -1.5}, -2, 2}, {{
       Hold[$CellContext`imgMinZ$$], -0.15}, -2, 2}, {{
       Hold[$CellContext`imgSize$$], 2.865}, 2, 5}, {{
       Hold[$CellContext`imgSizeZ$$], 2.005}, 2, 5}, {{
       Hold[$CellContext`samplingRadius$$], 0.45}, 0.2, 1.5}, {{
       Hold[$CellContext`intsCenterWidthMultiply$$], 1.0295}, 0.9, 1.1}, {{
       Hold[$CellContext`intsCenterXOffset$$], -0.018}, -0.1, 0.1}, {{
       Hold[$CellContext`intsCenterYOffset$$], -0.062}, -0.2, 0.2}, {{
       Hold[$CellContext`intsMinorRadius$$], 0.4}, 0.3, 0.5}}, 
    Typeset`size$$ = {518., {204., 209.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`reflCenterX$2456339$$ = 
    0, $CellContext`reflCenterY$2456340$$ = 
    0, $CellContext`reflNormalY$2456341$$ = 
    0, $CellContext`reflNormalZ$2456342$$ = 
    0, $CellContext`recvPtX$2456343$$ = 0, $CellContext`recvPtY$2456344$$ = 
    0, $CellContext`lightDirX$2456345$$ = 
    0, $CellContext`lightDirY$2456346$$ = 
    0, $CellContext`lightDirZ$2456347$$ = 0, $CellContext`imgMinX$2456348$$ = 
    0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`imgMinX$$ = -1.06, $CellContext`imgMinY$$ = \
-1.5, $CellContext`imgMinZ$$ = -0.15, $CellContext`imgSize$$ = 
        2.865, $CellContext`imgSizeZ$$ = 
        2.005, $CellContext`intsCenterWidthMultiply$$ = 
        1.0295, $CellContext`intsCenterXOffset$$ = -0.018, \
$CellContext`intsCenterYOffset$$ = -0.062, $CellContext`intsMinorRadius$$ = 
        0.4, $CellContext`lightDirX$$ = -4.4, $CellContext`lightDirY$$ = \
-2.38, $CellContext`lightDirZ$$ = 3.54, $CellContext`recvPtX$$ = 
        0.39, $CellContext`recvPtY$$ = -0.208, $CellContext`reflCenterX$$ = 
        0.814, $CellContext`reflCenterY$$ = 0.3, $CellContext`reflNormalY$$ = 
        1., $CellContext`reflNormalZ$$ = 0.145, $CellContext`samplingRadius$$ = 
        0.45}, "ControllerVariables" :> {
        Hold[$CellContext`reflCenterX$$, $CellContext`reflCenterX$2456339$$, 
         0], 
        Hold[$CellContext`reflCenterY$$, $CellContext`reflCenterY$2456340$$, 
         0], 
        Hold[$CellContext`reflNormalY$$, $CellContext`reflNormalY$2456341$$, 
         0], 
        Hold[$CellContext`reflNormalZ$$, $CellContext`reflNormalZ$2456342$$, 
         0], 
        Hold[$CellContext`recvPtX$$, $CellContext`recvPtX$2456343$$, 0], 
        Hold[$CellContext`recvPtY$$, $CellContext`recvPtY$2456344$$, 0], 
        Hold[$CellContext`lightDirX$$, $CellContext`lightDirX$2456345$$, 0], 
        Hold[$CellContext`lightDirY$$, $CellContext`lightDirY$2456346$$, 0], 
        Hold[$CellContext`lightDirZ$$, $CellContext`lightDirZ$2456347$$, 0], 
        Hold[$CellContext`imgMinX$$, $CellContext`imgMinX$2456348$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`reflCenter = {$CellContext`reflCenterX$$, \
$CellContext`reflCenterY$$, 1}; $CellContext`reflNormal = 
        Normalize[{
          1, $CellContext`reflNormalY$$, $CellContext`reflNormalZ$$}]; \
$CellContext`lightDir = 
        Normalize[{$CellContext`lightDirX$$, $CellContext`lightDirY$$, \
$CellContext`lightDirZ$$}]; $CellContext`recvPt = {$CellContext`recvPtX$$, \
$CellContext`recvPtY$$, 0}; $CellContext`reflPeakPt = 
        gBRDF`gCalcPeakPoint[$CellContext`reflNormal, \
$CellContext`reflCenter, -$CellContext`lightDir, $CellContext`recvPt]; \
$CellContext`bounceDir = 
        Normalize[$CellContext`recvPt - $CellContext`reflPeakPt]; \
$CellContext`outDir = 
        gUtils`gReflectVector[-$CellContext`bounceDir, {0, 0, 
          1}]; $CellContext`minorAxis = Normalize[
          Cross[$CellContext`reflNormal, {0, 1, 0}]]; $CellContext`majorAxis = 
        Normalize[
          
          Cross[$CellContext`minorAxis, $CellContext`reflNormal]]; \
$CellContext`intsMin = $CellContext`reflPeakPt + $CellContext`majorAxis \
($CellContext`samplingRadius$$ + $CellContext`intsCenterXOffset$$) - \
$CellContext`minorAxis (
          0.3 + $CellContext`intsCenterYOffset$$); $CellContext`intsMax = \
$CellContext`reflPeakPt - $CellContext`majorAxis \
$CellContext`samplingRadius$$ + $CellContext`minorAxis \
$CellContext`samplingRadius$$; $CellContext`intsCenter = \
($CellContext`intsMin + $CellContext`intsMax)/2; $CellContext`pltLighting = 
        Automatic; Show[{
          (gPlots3DEx`pltRectLine3D[
           Association[
           "center" -> {0, 0, 0}, "normal" -> {0, 0, 1}, 
            "majorAxis" -> {1, 0, 0}, "majorRadius" -> 1, "minorRadius" -> 
            0.5, "color" -> Black]]& )[
           Association[]], 
          (gPlots3DEx`pltRectLine3D[
           Association[
           "center" -> Slot["centerPt"], "normal" -> $CellContext`reflNormal, 
            "majorAxis" -> {0, 1, 0}, "majorRadius" -> 1, "minorRadius" -> 
            0.5, "color" -> Black]]& )[
           Association["centerPt" -> $CellContext`reflCenter]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt + $CellContext`lightDir 1.5, 
            "dir" -> -$CellContext`lightDir, "length" -> 1.5, "arrowPos" -> 
            0.3]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, "dir" -> 
            Normalize[$CellContext`recvPt - $CellContext`reflPeakPt], 
            "length" -> Norm[$CellContext`recvPt - $CellContext`reflPeakPt], 
            "arrowPos" -> 0.5]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`recvPt, "dir" -> $CellContext`outDir, 
            "length" -> 2, "arrowPos" -> 0.8]]& )[
           Association[]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`recvPt, "size" -> 0.01, "color" -> Black]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, 
            "dir" -> -$CellContext`reflNormal, "length" -> 0.6, "thickness" -> 
            0.5, "color" -> Red]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`recvPt, "dir" -> {0, 0, 1}, "length" -> 
            0.6, "thickness" -> 0.5, "color" -> Red]]& )[
           Association[]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`reflPeakPt, "size" -> 0.01, "color" -> 
            Black]]& )[
           Association[]], 
          (gPlots3DEx`pltCircle3D[
           Association[
           "center" -> $CellContext`reflPeakPt, 
            "normal" -> $CellContext`reflNormal, "radius" -> 0.5, "thickness" -> 
            1, "color" -> Blue]]& )[
           Association["radius" -> $CellContext`samplingRadius$$]], 
          Graphics3D[{
            Text[
             Style[
             "Light", FontSize -> 16, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + $CellContext`lightDir 
              1.65]}], 
          Graphics3D[{
            Text[
             Style[
             "-i", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + $CellContext`lightDir 
              1.2 + {-0.05, 0, -0.1}]}], 
          Graphics3D[{
            Text[
             Style[
             "y", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {0.07, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "r", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + 
             Normalize[$CellContext`recvPt - $CellContext`reflPeakPt] 0.5 + {
              0.1, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "o", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`recvPt + $CellContext`outDir 1.6 + {
              0.1, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "x", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`recvPt + {0.08, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "\!\(\*SubscriptBox[\(n\), \(r\)]\)", FontSize -> 16, Bold, Red, 
              FontFamily -> 
              "Times"], $CellContext`reflPeakPt - $CellContext`reflNormal 
             0.65]}], 
          Graphics3D[{
            Text[
             Style[
             "\!\(\*SubscriptBox[\(n\), \(x\)]\)", FontSize -> 16, Bold, Red, 
              FontFamily -> "Times"], $CellContext`recvPt + {0, 0, 1} 0.7]}], 
          Graphics3D[{
            Text[
             Style[
             "Rectangle R\n(reflector)", FontSize -> 16, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {0.8, 0, 0.7}]}], 
          Graphics3D[{
            Text[
             Style[
             "receiver", FontSize -> 16, FontFamily -> 
              "Times"], $CellContext`recvPt + {0, 0, -0.3}]}], 
          Graphics3D[{
            Text[
             Style[
             "D", FontSize -> 16, Bold, Blue, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {0, 0, 0.55}]}]}, 
         PlotRange -> {{$CellContext`imgMinX$$, $CellContext`imgMinX$$ + \
$CellContext`imgSize$$}, {$CellContext`imgMinY$$, $CellContext`imgMinY$$ + \
$CellContext`imgSize$$}, {$CellContext`imgMinZ$$, $CellContext`imgMinZ$$ + \
$CellContext`imgSizeZ$$}}, Axes -> False, Boxed -> False, 
         ViewPoint -> {0, -2, 1}, AxesLabel -> {"X", "Y", "Z"}, ImageSize -> 
         Large]), 
      "Specifications" :> {{{$CellContext`reflCenterX$$, 0.814}, 0, 
         1.3}, {{$CellContext`reflCenterY$$, 0.3}, 0, 
         1}, {{$CellContext`reflNormalY$$, 1.}, -1, 
         1}, {{$CellContext`reflNormalZ$$, 0.145}, -1, 
         1}, {{$CellContext`recvPtX$$, 0.39}, -1, 
         1}, {{$CellContext`recvPtY$$, -0.208}, -0.5, 
         0.5}, {{$CellContext`lightDirX$$, -4.4}, -5, 
         5}, {{$CellContext`lightDirY$$, -2.38}, -5, 
         5}, {{$CellContext`lightDirZ$$, 3.54}, 1, 
         10}, {{$CellContext`imgMinX$$, -1.06}, -2, 
         2}, {{$CellContext`imgMinY$$, -1.5}, -2, 
         2}, {{$CellContext`imgMinZ$$, -0.15}, -2, 
         2}, {{$CellContext`imgSize$$, 2.865}, 2, 
         5}, {{$CellContext`imgSizeZ$$, 2.005}, 2, 
         5}, {{$CellContext`samplingRadius$$, 0.45}, 0.2, 
         1.5}, {{$CellContext`intsCenterWidthMultiply$$, 1.0295}, 0.9, 
         1.1}, {{$CellContext`intsCenterXOffset$$, -0.018}, -0.1, 
         0.1}, {{$CellContext`intsCenterYOffset$$, -0.062}, -0.2, 
         0.2}, {{$CellContext`intsMinorRadius$$, 0.4}, 0.3, 0.5}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{869., {252., 258.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.839058762957086*^9, 3.839058775644432*^9}, {
   3.8390596044271526`*^9, 3.839059615995593*^9}, {3.839059713102023*^9, 
   3.83905975699415*^9}, {3.839059820404539*^9, 3.8390599217598886`*^9}, {
   3.839060001675419*^9, 3.8390601126900644`*^9}, {3.839060148192834*^9, 
   3.839060187645644*^9}, {3.8390602200720105`*^9, 3.8390602253423567`*^9}, {
   3.839060779371044*^9, 3.839060862763859*^9}, {3.839060924852326*^9, 
   3.8390609353523235`*^9}, 3.839061007219391*^9, {3.8390610410364275`*^9, 
   3.8390610806082196`*^9}, {3.839061215089179*^9, 3.8390612396770897`*^9}, {
   3.8390612716804094`*^9, 3.8390613016122427`*^9}, {3.8390613567579145`*^9, 
   3.8390614073182683`*^9}, {3.8392995230566034`*^9, 3.839299533041233*^9}, 
   3.839300673806241*^9, 3.8393009789999847`*^9, 3.839301054406039*^9, 
   3.83930108581306*^9, {3.8393018093524055`*^9, 3.8393018196259375`*^9}, {
   3.8393077987133646`*^9, 3.839307905148016*^9}, 3.8393079710088544`*^9, {
   3.8393170145255795`*^9, 3.8393171358239803`*^9}, {3.8393173491749716`*^9, 
   3.839317355481311*^9}, 3.839317407690111*^9, 3.8393175841068597`*^9, 
   3.839317632680503*^9, {3.8393176799213953`*^9, 3.839317714218418*^9}, 
   3.8393177588508005`*^9, {3.8393178170550957`*^9, 3.8393178638602805`*^9}, 
   3.8393179267151318`*^9, {3.8393179713319335`*^9, 3.8393180527644672`*^9}, {
   3.8393180966528845`*^9, 3.839318155803913*^9}, {3.839318222336144*^9, 
   3.839318227702458*^9}, 3.8393683316454372`*^9, {3.839369154135232*^9, 
   3.8393691929711633`*^9}, 3.8393932458282347`*^9, {3.8395546575073123`*^9, 
   3.839554664987511*^9}, 3.839567454166438*^9, 3.8396540206232266`*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"6a6fc7ed-34c6-40b7-a2b0-9f86efe71b7f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "reflCenter", ",", "reflNormal", ",", "lightDir", ",", "pltLighting", ",", 
    "reflPeakPt", ",", "recvPt", ",", "\[IndentingNewLine]", "\t", 
    "bounceDir", ",", "outDir", ",", "minorAxis", ",", "majorAxis", ",", 
    "intsMin", ",", "intsMax", ",", "intsCenter", ",", "\[IndentingNewLine]", 
    "\t", "uaxis", ",", "vaxis", ",", "coneApertureNormal"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"reflCenter", "=", 
     RowBox[{"{", 
      RowBox[{"reflCenterX", ",", "reflCenterY", ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"reflNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "reflNormalY", ",", "reflNormalZ"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"lightDirX", ",", "lightDirY", ",", "lightDirZ"}], "}"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"pltLighting", "=", 
       RowBox[{"{", 
        RowBox[{"\"\<Directional\>\"", ",", "White", ",", 
         RowBox[{"{", 
          RowBox[{"testLightDir", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"recvPt", "=", 
     RowBox[{"{", 
      RowBox[{"recvPtX", ",", "recvPtY", ",", "0"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"reflPeakPt", "=", 
     RowBox[{"gCalcPeakPoint", "[", 
      RowBox[{"reflNormal", ",", "reflCenter", ",", 
       RowBox[{"-", "lightDir"}], ",", "recvPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"bounceDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"outDir", "=", 
     RowBox[{"gReflectVector", "[", 
      RowBox[{
       RowBox[{"-", "bounceDir"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"uv", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"vaxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"recvPt", "-", "reflPeakPt"}], ",", "reflNormal"}], "]"}]}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"uaxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"reflNormal", ",", "vaxis"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"approximate", " ", "intersection", " ", "area"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"minorAxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"reflNormal", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}]}], ";", "\n", 
    "   ", 
    RowBox[{"majorAxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"minorAxis", ",", "reflNormal"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsMin", "=", 
     RowBox[{"reflPeakPt", "+", 
      RowBox[{"majorAxis", "*", 
       RowBox[{"(", 
        RowBox[{"samplingRadius", "+", "intsCenterXOffset"}], ")"}]}], "-", 
      RowBox[{"minorAxis", "*", 
       RowBox[{"(", 
        RowBox[{"0.3", "+", "intsCenterYOffset"}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsMax", "=", 
     RowBox[{"reflPeakPt", "-", 
      RowBox[{"majorAxis", "*", "samplingRadius"}], "+", 
      RowBox[{"minorAxis", "*", "samplingRadius"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsCenter", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"intsMin", "+", "intsMax"}], ")"}], "/", "2"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"cone", " ", "aperture"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"coneApertureNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"recvPt", "-", "reflPeakPt"}], ",", "vaxis"}], "]"}]}]}], ";",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"pltLighting", "=", "Automatic"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", "cone", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", "0.3", "]"}], ",", "Cyan", ",", 
             RowBox[{"Cone", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"reflPeakPt", ",", "recvPt"}], "}"}], ",", 
               "#coneRadius"}], "]"}]}], "}"}], "\[IndentingNewLine]", "]"}], 
          "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<coneRadius\>\"", "\[Rule]", "coneRadius"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"sampling", " ", "disk"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pltCircle3D", "[", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "reflPeakPt"}], ",", 
               RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "0.5"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}]}], "|>"}], 
             "\[IndentingNewLine]", "\t", "]"}], "&"}], "[", 
           RowBox[{"<|", 
            RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], "|>"}], 
           "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArc3DDirect", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<\[Phi]1\>\"", "\[Rule]", "#\[Phi]1"}], ",", 
             RowBox[{"\"\<\[Phi]2\>\"", "\[Rule]", "#\[Phi]2"}], ",", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}]}], "|>"}], 
           "\[IndentingNewLine]", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], ",", 
           RowBox[{"\"\<\[Phi]1\>\"", "->", "diskPhi1"}], ",", 
           RowBox[{"\"\<\[Phi]2\>\"", "->", "diskPhi2"}]}], "|>"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArc3DDirect", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<\[Phi]1\>\"", "\[Rule]", "#\[Phi]2"}], ",", 
             RowBox[{"\"\<\[Phi]2\>\"", "\[Rule]", "#\[Phi]1"}], ",", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
             RowBox[{"\"\<style\>\"", "\[Rule]", "Dashed"}]}], "|>"}], 
           "\[IndentingNewLine]", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], ",", 
           RowBox[{"\"\<\[Phi]1\>\"", "->", "diskPhi1"}], ",", 
           RowBox[{"\"\<\[Phi]2\>\"", "->", "diskPhi2"}]}], "|>"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"u", "-", 
          RowBox[{"v", " ", "axis"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "uaxis"}]}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "1"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", "vaxis"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "1"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"cone", " ", "aperture"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArc3DDirect", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "recvPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "coneApertureNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.3"}], ",", 
             RowBox[{"\"\<style\>\"", "\[Rule]", "Dashed"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<\[Phi]1\>\"", "\[Rule]", "#\[Phi]1"}], ",", 
             RowBox[{"\"\<\[Phi]2\>\"", "\[Rule]", "#\[Phi]2"}], ",", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], ",", 
           RowBox[{"\"\<\[Phi]1\>\"", "\[Rule]", "apertPhi1"}], ",", 
           RowBox[{"\"\<\[Phi]2\>\"", "->", "apertPhi2"}]}], "|>"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "receiver", "*)"}], "\[IndentingNewLine]", "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRectLine3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "reflector", "*)"}], "\[IndentingNewLine]", "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRectLine3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "#centerPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<centerPt\>\"", "\[Rule]", "reflCenter"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "arrow"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"reflPeakPt", "+", 
               RowBox[{"lightDir", "*", "1.5"}]}]}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "lightDir"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "1.5"}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.3"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"one", " ", "bounce", " ", "arrow"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"Normalize", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", 
              RowBox[{"Norm", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.5"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"out", " ", "dir", " ", "arrow"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pltArrow3D", "[", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<origin\>\"", "\[Rule]", "recvPt"}], ",", 
               RowBox[{"\"\<dir\>\"", "\[Rule]", "outDir"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "2"}], ",", 
               RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.8"}]}], "|>"}], 
             "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
           RowBox[{"<|", "|>"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"recv", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "recvPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"reflector", " ", "normal"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "reflNormal"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.6"}], ",", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Orange"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"recv", " ", "normal"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pltArrow3D", "[", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<origin\>\"", "\[Rule]", "recvPt"}], ",", 
               RowBox[{"\"\<dir\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "0.6"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.5"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
             "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
           RowBox[{"<|", "|>"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"refl", " ", "peak", " ", "point"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "text", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Light\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"lightDir", "*", "1.65"}]}]}], "]"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<-i\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"lightDir", "*", "1.2"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.05"}], ",", "0", ",", 
               RowBox[{"-", "0.1"}]}], "}"}]}]}], "]"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<y\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{"0.07", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<r\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{
              RowBox[{"Normalize", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}], "*", "0.5"}], 
             "+", 
             RowBox[{"{", 
              RowBox[{"0.1", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<o\>\"", ",", 
                RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
              ",", 
              RowBox[{"recvPt", "+", 
               RowBox[{"outDir", "*", "1.6"}], "+", 
               RowBox[{"{", 
                RowBox[{"0.1", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
           "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<x\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{"{", 
              RowBox[{"0.08", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\!\(\*SubscriptBox[\(n\), \(r\)]\)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              "Orange", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "-", 
             RowBox[{"reflNormal", "*", "0.65"}]}]}], "]"}], "}"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<\!\(\*SubscriptBox[\(n\), \(x\)]\)\>\"", ",", 
                RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
                "Red", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
              ",", 
              RowBox[{"recvPt", "+", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}], "*", "0.7"}]}]}], 
             "]"}], "}"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Rectangle R\\n(reflector)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.3"}], ",", "0", ",", "0.9"}], "}"}]}]}], "]"}],
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<receiver\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "0.3"}]}], "}"}]}]}], "]"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<D\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", "Blue",
               ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0.55"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"OverBar", "[", "\"\<u\>\"", "]"}], ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "-", 
             RowBox[{"uaxis", "*", "0.5"}], "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0.05"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"OverBar", "[", "\"\<v\>\"", "]"}], ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"vaxis", "*", "0.5"}], "+", 
             RowBox[{"{", 
              RowBox[{"0.05", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\[Alpha]\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{"{", 
              RowBox[{"0.12", ",", "0", ",", "0.28"}], "}"}]}]}], "]"}], 
          "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"imgMinX", ",", 
           RowBox[{"imgMinX", "+", "imgSize"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"imgMinY", ",", 
           RowBox[{"imgMinY", "+", "imgSize"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"imgMinZ", ",", 
           RowBox[{"imgMinZ", "+", "imgSizeZ"}]}], "}"}]}], "}"}]}], ",", 
      "\n", "\t\t", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "2"}], ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
      "\t    ", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
      ",", "\[IndentingNewLine]", "\t    ", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"apertPhi1", ",", "0.351858"}], "}"}], ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"apertPhi2", ",", "0.942478"}], "}"}], ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskPhi1", ",", "2.50071"}], "}"}], ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskPhi2", ",", "5.51664"}], "}"}], ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"coneRadius", ",", "0.442"}], "}"}], ",", "0.1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflCenterX", ",", "0.814"}], "}"}], ",", "0", ",", "1.3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflCenterY", ",", "0.3"}], "}"}], ",", "0", ",", "1"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflNormalY", ",", "1."}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflNormalZ", ",", "0.145"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"recvPtX", ",", "0.39"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"recvPtY", ",", 
       RowBox[{"-", "0.208"}]}], "}"}], ",", 
     RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirX", ",", 
       RowBox[{"-", "4.4"}]}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirY", ",", 
       RowBox[{"-", "2.38"}]}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirZ", ",", "3.54"}], "}"}], ",", "1", ",", "10"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinX", ",", 
       RowBox[{"-", "0.36"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinY", ",", 
       RowBox[{"-", "0.62"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinZ", ",", 
       RowBox[{"-", "0.19"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgSize", ",", "1.6"}], "}"}], ",", "1", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgSizeZ", ",", "2.005"}], "}"}], ",", "2", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"samplingRadius", ",", "0.45"}], "}"}], ",", "0.2", ",", 
     "1.5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsCenterWidthMultiply", ",", "1.0295"}], "}"}], ",", "0.9", 
     ",", "1.1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsCenterXOffset", ",", 
       RowBox[{"-", "0.018"}]}], "}"}], ",", 
     RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsCenterYOffset", ",", 
       RowBox[{"-", "0.062"}]}], "}"}], ",", 
     RowBox[{"-", "0.2"}], ",", "0.2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsMinorRadius", ",", "0.4"}], "}"}], ",", "0.3", ",", 
     "0.5"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.839404094746642*^9, 3.839404101527314*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"61d6c217-67ca-459c-81f4-23382bf91bc5"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`apertPhi1$$ = 
    0.351858, $CellContext`apertPhi2$$ = 0.942478, $CellContext`coneRadius$$ =
     0.442, $CellContext`diskPhi1$$ = 2.50071, $CellContext`diskPhi2$$ = 
    5.51664, $CellContext`imgMinX$$ = -0.36, $CellContext`imgMinY$$ = -0.62, \
$CellContext`imgMinZ$$ = -0.19, $CellContext`imgSize$$ = 
    1.6, $CellContext`imgSizeZ$$ = 
    2.005, $CellContext`intsCenterWidthMultiply$$ = 
    1.0295, $CellContext`intsCenterXOffset$$ = -0.018, \
$CellContext`intsCenterYOffset$$ = -0.062, $CellContext`intsMinorRadius$$ = 
    0.4, $CellContext`lightDirX$$ = -4.4, $CellContext`lightDirY$$ = -2.38, \
$CellContext`lightDirZ$$ = 3.54, $CellContext`recvPtX$$ = 
    0.39, $CellContext`recvPtY$$ = -0.208, $CellContext`reflCenterX$$ = 
    0.814, $CellContext`reflCenterY$$ = 0.3, $CellContext`reflNormalY$$ = 
    1., $CellContext`reflNormalZ$$ = 0.145, $CellContext`samplingRadius$$ = 
    0.45, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`apertPhi1$$], 0.351858}, 0, 2 Pi}, {{
       Hold[$CellContext`apertPhi2$$], 0.942478}, 0, 2 Pi}, {{
       Hold[$CellContext`diskPhi1$$], 2.50071}, 0, 2 Pi}, {{
       Hold[$CellContext`diskPhi2$$], 5.51664}, 0, 2 Pi}, {{
       Hold[$CellContext`coneRadius$$], 0.442}, 0.1, 1}, {{
       Hold[$CellContext`reflCenterX$$], 0.814}, 0, 1.3}, {{
       Hold[$CellContext`reflCenterY$$], 0.3}, 0, 1}, {{
       Hold[$CellContext`reflNormalY$$], 1.}, -1, 1}, {{
       Hold[$CellContext`reflNormalZ$$], 0.145}, -1, 1}, {{
       Hold[$CellContext`recvPtX$$], 0.39}, -1, 1}, {{
       Hold[$CellContext`recvPtY$$], -0.208}, -0.5, 0.5}, {{
       Hold[$CellContext`lightDirX$$], -4.4}, -5, 5}, {{
       Hold[$CellContext`lightDirY$$], -2.38}, -5, 5}, {{
       Hold[$CellContext`lightDirZ$$], 3.54}, 1, 10}, {{
       Hold[$CellContext`imgMinX$$], -0.36}, -2, 2}, {{
       Hold[$CellContext`imgMinY$$], -0.62}, -2, 2}, {{
       Hold[$CellContext`imgMinZ$$], -0.19}, -2, 2}, {{
       Hold[$CellContext`imgSize$$], 1.6}, 1, 5}, {{
       Hold[$CellContext`imgSizeZ$$], 2.005}, 2, 5}, {{
       Hold[$CellContext`samplingRadius$$], 0.45}, 0.2, 1.5}, {{
       Hold[$CellContext`intsCenterWidthMultiply$$], 1.0295}, 0.9, 1.1}, {{
       Hold[$CellContext`intsCenterXOffset$$], -0.018}, -0.1, 0.1}, {{
       Hold[$CellContext`intsCenterYOffset$$], -0.062}, -0.2, 0.2}, {{
       Hold[$CellContext`intsMinorRadius$$], 0.4}, 0.3, 0.5}}, 
    Typeset`size$$ = {518., {287., 293.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`apertPhi1$3453$$ = 0, $CellContext`apertPhi2$3454$$ = 
    0, $CellContext`diskPhi1$3455$$ = 0, $CellContext`diskPhi2$3456$$ = 
    0, $CellContext`coneRadius$3457$$ = 0, $CellContext`reflCenterX$3458$$ = 
    0, $CellContext`reflCenterY$3459$$ = 0, $CellContext`reflNormalY$3460$$ = 
    0, $CellContext`reflNormalZ$3461$$ = 0, $CellContext`recvPtX$3462$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`apertPhi1$$ = 
        0.351858, $CellContext`apertPhi2$$ = 
        0.942478, $CellContext`coneRadius$$ = 0.442, $CellContext`diskPhi1$$ = 
        2.50071, $CellContext`diskPhi2$$ = 
        5.51664, $CellContext`imgMinX$$ = -0.36, $CellContext`imgMinY$$ = \
-0.62, $CellContext`imgMinZ$$ = -0.19, $CellContext`imgSize$$ = 
        1.6, $CellContext`imgSizeZ$$ = 
        2.005, $CellContext`intsCenterWidthMultiply$$ = 
        1.0295, $CellContext`intsCenterXOffset$$ = -0.018, \
$CellContext`intsCenterYOffset$$ = -0.062, $CellContext`intsMinorRadius$$ = 
        0.4, $CellContext`lightDirX$$ = -4.4, $CellContext`lightDirY$$ = \
-2.38, $CellContext`lightDirZ$$ = 3.54, $CellContext`recvPtX$$ = 
        0.39, $CellContext`recvPtY$$ = -0.208, $CellContext`reflCenterX$$ = 
        0.814, $CellContext`reflCenterY$$ = 0.3, $CellContext`reflNormalY$$ = 
        1., $CellContext`reflNormalZ$$ = 0.145, $CellContext`samplingRadius$$ = 
        0.45}, "ControllerVariables" :> {
        Hold[$CellContext`apertPhi1$$, $CellContext`apertPhi1$3453$$, 0], 
        Hold[$CellContext`apertPhi2$$, $CellContext`apertPhi2$3454$$, 0], 
        Hold[$CellContext`diskPhi1$$, $CellContext`diskPhi1$3455$$, 0], 
        Hold[$CellContext`diskPhi2$$, $CellContext`diskPhi2$3456$$, 0], 
        Hold[$CellContext`coneRadius$$, $CellContext`coneRadius$3457$$, 0], 
        Hold[$CellContext`reflCenterX$$, $CellContext`reflCenterX$3458$$, 0], 
        Hold[$CellContext`reflCenterY$$, $CellContext`reflCenterY$3459$$, 0], 
        Hold[$CellContext`reflNormalY$$, $CellContext`reflNormalY$3460$$, 0], 
        Hold[$CellContext`reflNormalZ$$, $CellContext`reflNormalZ$3461$$, 0], 
        Hold[$CellContext`recvPtX$$, $CellContext`recvPtX$3462$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`reflCenter = {$CellContext`reflCenterX$$, \
$CellContext`reflCenterY$$, 1}; $CellContext`reflNormal = 
        Normalize[{
          1, $CellContext`reflNormalY$$, $CellContext`reflNormalZ$$}]; \
$CellContext`lightDir = 
        Normalize[{$CellContext`lightDirX$$, $CellContext`lightDirY$$, \
$CellContext`lightDirZ$$}]; $CellContext`recvPt = {$CellContext`recvPtX$$, \
$CellContext`recvPtY$$, 0}; $CellContext`reflPeakPt = 
        gBRDF`gCalcPeakPoint[$CellContext`reflNormal, \
$CellContext`reflCenter, -$CellContext`lightDir, $CellContext`recvPt]; \
$CellContext`bounceDir = 
        Normalize[$CellContext`recvPt - $CellContext`reflPeakPt]; \
$CellContext`outDir = 
        gUtils`gReflectVector[-$CellContext`bounceDir, {0, 0, 
          1}]; $CellContext`vaxis = Normalize[
          
          Cross[$CellContext`recvPt - $CellContext`reflPeakPt, \
$CellContext`reflNormal]]; $CellContext`uaxis = Normalize[
          
          Cross[$CellContext`reflNormal, $CellContext`vaxis]]; \
$CellContext`minorAxis = Normalize[
          Cross[$CellContext`reflNormal, {0, 1, 0}]]; $CellContext`majorAxis = 
        Normalize[
          
          Cross[$CellContext`minorAxis, $CellContext`reflNormal]]; \
$CellContext`intsMin = $CellContext`reflPeakPt + $CellContext`majorAxis \
($CellContext`samplingRadius$$ + $CellContext`intsCenterXOffset$$) - \
$CellContext`minorAxis (
          0.3 + $CellContext`intsCenterYOffset$$); $CellContext`intsMax = \
$CellContext`reflPeakPt - $CellContext`majorAxis \
$CellContext`samplingRadius$$ + $CellContext`minorAxis \
$CellContext`samplingRadius$$; $CellContext`intsCenter = \
($CellContext`intsMin + $CellContext`intsMax)/
         2; $CellContext`coneApertureNormal = Normalize[
          
          Cross[$CellContext`recvPt - $CellContext`reflPeakPt, \
$CellContext`vaxis]]; $CellContext`pltLighting = Automatic; Show[{
          (Graphics3D[{
            Opacity[0.3], Cyan, 
            Cone[{$CellContext`reflPeakPt, $CellContext`recvPt}, 
             Slot["coneRadius"]]}]& )[
           Association["coneRadius" -> $CellContext`coneRadius$$]], 
          (gPlots3DEx`pltArc3DDirect[
           Association[
           "center" -> $CellContext`reflPeakPt, 
            "normal" -> $CellContext`reflNormal, "radius" -> 0.5, "\[Phi]1" -> 
            Slot["\[Phi]1"], "\[Phi]2" -> Slot["\[Phi]2"], "thickness" -> 1, 
            "color" -> Blue]]& )[
           Association[
           "radius" -> $CellContext`samplingRadius$$, 
            "\[Phi]1" -> $CellContext`diskPhi1$$, 
            "\[Phi]2" -> $CellContext`diskPhi2$$]], 
          (gPlots3DEx`pltArc3DDirect[
           Association[
           "center" -> $CellContext`reflPeakPt, 
            "normal" -> $CellContext`reflNormal, "radius" -> 0.5, "\[Phi]1" -> 
            Slot["\[Phi]2"], "\[Phi]2" -> Slot["\[Phi]1"], "thickness" -> 1, 
            "color" -> Blue, "style" -> Dashed]]& )[
           Association[
           "radius" -> $CellContext`samplingRadius$$, 
            "\[Phi]1" -> $CellContext`diskPhi1$$, 
            "\[Phi]2" -> $CellContext`diskPhi2$$]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, "dir" -> -$CellContext`uaxis, 
            "color" -> Red, "length" -> 0.5, "arrowPos" -> 1]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, "dir" -> $CellContext`vaxis, 
            "color" -> Red, "length" -> 0.5, "arrowPos" -> 1]]& )[
           Association[]], 
          (gPlots3DEx`pltArc3DDirect[
           Association[
           "center" -> $CellContext`recvPt, 
            "normal" -> $CellContext`coneApertureNormal, "radius" -> 0.3, 
            "style" -> Dashed, "\[Phi]1" -> Slot["\[Phi]1"], "\[Phi]2" -> 
            Slot["\[Phi]2"], "thickness" -> 1, "color" -> Black]]& )[
           Association[
           "radius" -> $CellContext`samplingRadius$$, 
            "\[Phi]1" -> $CellContext`apertPhi1$$, 
            "\[Phi]2" -> $CellContext`apertPhi2$$]], 
          (gPlots3DEx`pltRectLine3D[
           Association[
           "center" -> {0, 0, 0}, "normal" -> {0, 0, 1}, 
            "majorAxis" -> {1, 0, 0}, "majorRadius" -> 1, "minorRadius" -> 
            0.5, "color" -> Black]]& )[
           Association[]], 
          (gPlots3DEx`pltRectLine3D[
           Association[
           "center" -> Slot["centerPt"], "normal" -> $CellContext`reflNormal, 
            "majorAxis" -> {0, 1, 0}, "majorRadius" -> 1, "minorRadius" -> 
            0.5, "color" -> Black]]& )[
           Association["centerPt" -> $CellContext`reflCenter]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt + $CellContext`lightDir 1.5, 
            "dir" -> -$CellContext`lightDir, "length" -> 1.5, "arrowPos" -> 
            0.3]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, "dir" -> 
            Normalize[$CellContext`recvPt - $CellContext`reflPeakPt], 
            "length" -> Norm[$CellContext`recvPt - $CellContext`reflPeakPt], 
            "arrowPos" -> 0.5]]& )[
           Association[]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`recvPt, "size" -> 0.01, "color" -> Black]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, 
            "dir" -> -$CellContext`reflNormal, "length" -> 0.6, "thickness" -> 
            0.5, "color" -> Orange]]& )[
           Association[]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`reflPeakPt, "size" -> 0.01, "color" -> 
            Black]]& )[
           Association[]], 
          Graphics3D[{
            Text[
             Style[
             "Light", FontSize -> 16, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + $CellContext`lightDir 
              1.65]}], 
          Graphics3D[{
            Text[
             Style[
             "-i", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + $CellContext`lightDir 
              1.2 + {-0.05, 0, -0.1}]}], 
          Graphics3D[{
            Text[
             Style[
             "y", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {0.07, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "r", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + 
             Normalize[$CellContext`recvPt - $CellContext`reflPeakPt] 0.5 + {
              0.1, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "x", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`recvPt + {0.08, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "\!\(\*SubscriptBox[\(n\), \(r\)]\)", FontSize -> 16, Bold, 
              Orange, FontFamily -> 
              "Times"], $CellContext`reflPeakPt - $CellContext`reflNormal 
             0.65]}], 
          Graphics3D[{
            Text[
             Style[
             "Rectangle R\n(reflector)", FontSize -> 16, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {-0.3, 0, 0.9}]}], 
          Graphics3D[{
            Text[
             Style[
             "receiver", FontSize -> 16, FontFamily -> 
              "Times"], $CellContext`recvPt + {0, 0, -0.3}]}], 
          Graphics3D[{
            Text[
             Style[
             "D", FontSize -> 16, Bold, Blue, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {0, 0, 0.55}]}], 
          Graphics3D[{
            Text[
             Style[
              OverBar["u"], FontSize -> 16, Red, FontFamily -> 
              "Times"], $CellContext`reflPeakPt - $CellContext`uaxis 
             0.5 + {0, 0, 0.05}]}], 
          Graphics3D[{
            Text[
             Style[
              OverBar["v"], FontSize -> 16, Red, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + $CellContext`vaxis 0.5 + {
              0.05, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "\[Alpha]", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`recvPt + {0.12, 0, 0.28}]}]}, 
         PlotRange -> {{$CellContext`imgMinX$$, $CellContext`imgMinX$$ + \
$CellContext`imgSize$$}, {$CellContext`imgMinY$$, $CellContext`imgMinY$$ + \
$CellContext`imgSize$$}, {$CellContext`imgMinZ$$, $CellContext`imgMinZ$$ + \
$CellContext`imgSizeZ$$}}, Axes -> False, Boxed -> False, 
         ViewPoint -> {0, -2, 1}, AxesLabel -> {"X", "Y", "Z"}, ImageSize -> 
         Large]), 
      "Specifications" :> {{{$CellContext`apertPhi1$$, 0.351858}, 0, 2 
         Pi}, {{$CellContext`apertPhi2$$, 0.942478}, 0, 2 
         Pi}, {{$CellContext`diskPhi1$$, 2.50071}, 0, 2 
         Pi}, {{$CellContext`diskPhi2$$, 5.51664}, 0, 2 
         Pi}, {{$CellContext`coneRadius$$, 0.442}, 0.1, 
         1}, {{$CellContext`reflCenterX$$, 0.814}, 0, 
         1.3}, {{$CellContext`reflCenterY$$, 0.3}, 0, 
         1}, {{$CellContext`reflNormalY$$, 1.}, -1, 
         1}, {{$CellContext`reflNormalZ$$, 0.145}, -1, 
         1}, {{$CellContext`recvPtX$$, 0.39}, -1, 
         1}, {{$CellContext`recvPtY$$, -0.208}, -0.5, 
         0.5}, {{$CellContext`lightDirX$$, -4.4}, -5, 
         5}, {{$CellContext`lightDirY$$, -2.38}, -5, 
         5}, {{$CellContext`lightDirZ$$, 3.54}, 1, 
         10}, {{$CellContext`imgMinX$$, -0.36}, -2, 
         2}, {{$CellContext`imgMinY$$, -0.62}, -2, 
         2}, {{$CellContext`imgMinZ$$, -0.19}, -2, 
         2}, {{$CellContext`imgSize$$, 1.6}, 1, 
         5}, {{$CellContext`imgSizeZ$$, 2.005}, 2, 
         5}, {{$CellContext`samplingRadius$$, 0.45}, 0.2, 
         1.5}, {{$CellContext`intsCenterWidthMultiply$$, 1.0295}, 0.9, 
         1.1}, {{$CellContext`intsCenterXOffset$$, -0.018}, -0.1, 
         0.1}, {{$CellContext`intsCenterYOffset$$, -0.062}, -0.2, 
         0.2}, {{$CellContext`intsMinorRadius$$, 0.4}, 0.3, 0.5}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{869., {316., 322.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8393890074820137`*^9, 3.839393246445585*^9, {3.8395674476375237`*^9, 
   3.839567454494589*^9}},
 CellLabel->"Out[16]=",ExpressionUUID->"42a799a0-352b-4985-b9f2-3c8f77be361c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "diskCenter", ",", "diskNormal", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
    "radius", ",", "dr", ",", "dx", ",", "\[Phi]", ",", "\[Phi]i", ",", 
    "\[Phi]o", ",", "QQ1", ",", "PQ1"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radius", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]1", "=", "\[Phi]i"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QQ1", "=", 
   RowBox[{"radius", "*", 
    RowBox[{"Cos", "[", "\[Alpha]1", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PQ1", "=", 
   RowBox[{"radius", "*", 
    RowBox[{"Sin", "[", "\[Alpha]1", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]2", "=", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"dr", "+", "PQ1"}], ")"}], "/", "QQ1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]o", "=", "\[Alpha]2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dr", "=", 
   RowBox[{"dx", "*", "radius"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Phi]i", "+", "\[Phi]o"}], ")"}], "/", "2"}], "-", 
     "\[Phi]i"}], "//", "Simplify"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diskCenter", "=", 
   RowBox[{"Normalize", "@", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diskNormal", "=", 
   RowBox[{"Normalize", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", 
      RowBox[{"-", "1.5"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"blPaperIntsDisk10", "[", 
       RowBox[{
       "diskCenter", ",", "diskNormal", ",", "diskRadius", ",", 
        "calcPointPercent"}], "]"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", " ", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], ",", "\n", "\t\t", 
     RowBox[{"Axes", "\[Rule]", "True"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"AspectRatio", "->", "1"}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", "Front"}], ",", "\[IndentingNewLine]", 
     "\t    ", 
     RowBox[{"ViewProjection", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
     ",", "\[IndentingNewLine]", "\t    ", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
    "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"calcPointPercent", ",", "0.57"}], "}"}], ",", "0.1", ",", 
     "0.99"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskRadius", ",", "0.6"}], "}"}], ",", "0.1", ",", "0.6"}], 
    "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.838591199702325*^9, 3.838591337293561*^9}, 
   3.8385917159706817`*^9, 3.838595490013892*^9, {3.838595755631129*^9, 
   3.838595792330063*^9}, 3.838705098834033*^9, {3.838705198068845*^9, 
   3.8387052547296543`*^9}, {3.838710356243922*^9, 3.8387104205158715`*^9}, {
   3.838710457834075*^9, 3.8387104772503433`*^9}, {3.8387105602265053`*^9, 
   3.8387106453182497`*^9}, {3.838710691110968*^9, 3.8387107026595526`*^9}, {
   3.838710760950264*^9, 3.8387107741555157`*^9}, {3.83871081058805*^9, 
   3.8387108842281995`*^9}, {3.8387109557796297`*^9, 3.838710962771296*^9}, {
   3.8387110579159527`*^9, 3.8387110659404736`*^9}, 3.83871115302098*^9, {
   3.8387112018303523`*^9, 3.838711225944543*^9}, {3.838711357957591*^9, 
   3.8387114052290945`*^9}, {3.838711463876541*^9, 3.8387114851587057`*^9}, {
   3.838711527140164*^9, 3.8387115592453966`*^9}, {3.8387116107116127`*^9, 
   3.8387116152321033`*^9}, {3.838711698541105*^9, 3.838711826163373*^9}, {
   3.8387119425001335`*^9, 3.8387120479172487`*^9}, {3.838712198285242*^9, 
   3.8387122420538263`*^9}, {3.8387123341239777`*^9, 3.838712428933677*^9}, {
   3.8387125745236473`*^9, 3.838712790668149*^9}, {3.83871282780429*^9, 
   3.8387129440765405`*^9}, {3.8387134662939687`*^9, 3.838713596672432*^9}, {
   3.8387137060366974`*^9, 3.838713721979744*^9}, {3.838713777120103*^9, 
   3.83871380899654*^9}, {3.839309805061955*^9, 3.8393099924920273`*^9}, {
   3.839310024752675*^9, 3.839310046330528*^9}, {3.839314746283371*^9, 
   3.839314780323186*^9}, {3.839315001441532*^9, 3.839315271795656*^9}, {
   3.839315322227222*^9, 3.8393156164676065`*^9}, {3.8393156522051506`*^9, 
   3.8393157084066873`*^9}, {3.8393157791724143`*^9, 3.8393158712205234`*^9}, 
   3.8393933058810225`*^9, 3.839455041436775*^9, 3.839660569188075*^9},
 CellLabel->
  "In[895]:=",ExpressionUUID->"c7857d34-d240-432f-ba2e-2264d397a06b"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "\[Phi]i"}], "+", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"Sec", "[", "\[Phi]i", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"dx", "+", 
        RowBox[{"Sin", "[", "\[Phi]i", "]"}]}], ")"}]}], "]"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.8394550423775*^9, 3.8395674547788296`*^9, 
  3.839659942724324*^9, 3.8396605709142466`*^9},
 CellLabel->
  "Out[903]=",ExpressionUUID->"04879840-9a06-4c0b-904a-a873c8ccdcae"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`calcPointPercent$$ = 
    0.57, $CellContext`diskRadius$$ = 0.6, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`calcPointPercent$$], 0.57}, 0.1, 0.99}, {{
       Hold[$CellContext`diskRadius$$], 0.6}, 0.1, 0.6}}, Typeset`size$$ = {
    518., {259., 264.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`calcPointPercent$2468559$$ = 
    0, $CellContext`diskRadius$2468560$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`calcPointPercent$$ = 
        0.57, $CellContext`diskRadius$$ = 0.6}, "ControllerVariables" :> {
        Hold[$CellContext`calcPointPercent$$, \
$CellContext`calcPointPercent$2468559$$, 0], 
        Hold[$CellContext`diskRadius$$, $CellContext`diskRadius$2468560$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[{
         gBlochSphere`blPaperIntsDisk10[$CellContext`diskCenter, \
$CellContext`diskNormal, $CellContext`diskRadius$$, \
$CellContext`calcPointPercent$$]}, PlotRange -> {{-1, 1}, {-1, 1}, {0, 2}}, 
        Axes -> True, Boxed -> False, AspectRatio -> 1, ViewPoint -> Front, 
        ViewProjection -> "Orthographic", AxesLabel -> {"X", "Y", "Z"}, 
        ImageSize -> Large], 
      "Specifications" :> {{{$CellContext`calcPointPercent$$, 0.57}, 0.1, 
         0.99}, {{$CellContext`diskRadius$$, 0.6}, 0.1, 0.6}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{565., {314., 320.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8394550423775*^9, 3.8395674547788296`*^9, 
  3.839659942724324*^9, 3.8396605709601226`*^9},
 CellLabel->
  "Out[906]=",ExpressionUUID->"017ba4ff-d0b7-49fc-9cba-0d74708b5dbd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"m", ",", "\[Theta]", ",", "\[Theta]L", ",", "\[Lambda]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]", "=", 
     RowBox[{
      FractionBox[
       RowBox[{"0.288", 
        RowBox[{"Cos", "[", "\[Theta]L", "]"}]}], 
       RowBox[{"m", "^", "2"}]], "-", "0.673"}]}], ";", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", 
          SuperscriptBox["m", "4"], " "}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["m", "2"], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["m", "2"]}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]L", "-", 
               RowBox[{"ArcTan", "[", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"Sec", "[", "\[Theta]L", "]"}], "2"], " ", 
                  RowBox[{"Tan", "[", "\[Theta]", "]"}]}], "+", 
                 RowBox[{"Tan", "[", "\[Theta]L", "]"}]}], "]"}]}], "]"}]}]}],
            ")"}], "2"]], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", 
          RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"ColorFunction", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ",", "Blue"}], "]"}]}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[Lambda]"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]], " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", 
          RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"ColorFunction", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ",", "Orange"}], "]"}]}]}], "]"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "legends", " ", "in", " ", "the", " ", "Epilog", " ", 
        "are", " ", "starting", " ", "here"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Epilog", "\[Rule]", 
       RowBox[{"Inset", "[", 
        RowBox[{
         RowBox[{"LineLegend", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Blue", ",", "Orange"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Origin\>\"", ",", "\"\<Fitted\>\""}], "}"}]}], "]"}],
          ",", 
         RowBox[{"Scaled", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
         RowBox[{"Scaled", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}]}]}], "\n", 
     RowBox[{"(*", 
      RowBox[{"End", " ", "of", " ", "the", " ", "Legends"}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "0.7"}], "}"}], ",", "0.01", ",", "0.9"}], "}"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]L", ",", 
       RowBox[{"\[Pi]", "/", "6"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"Lambda", ",", "\[Lambda]"}], "}"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.839568007208395*^9, 3.8395680112483444`*^9}, {
  3.8395680542991667`*^9, 3.839568098730796*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"9a27f70b-80df-408a-a262-6271b112fa2e"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`Lambda$$ = -0.16398915042873807`, \
$CellContext`m$$ = 0.7, $CellContext`\[Theta]L$$ = Rational[1, 6] Pi, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`m$$], 0.7}, 0.01, 0.9}, {{
       Hold[$CellContext`\[Theta]L$$], Rational[1, 6] Pi}, 0, Rational[1, 2] 
      Pi}, {{
       Hold[$CellContext`Lambda$$], -0.16398915042873807`}}}, 
    Typeset`size$$ = {324., {103., 108.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`m$300483$$ = 0, $CellContext`\[Theta]L$300484$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`Lambda$$ = $CellContext`\[Lambda], \
$CellContext`m$$ = 0.7, $CellContext`\[Theta]L$$ = Rational[1, 6] Pi}, 
      "ControllerVariables" :> {
        Hold[$CellContext`m$$, $CellContext`m$300483$$, 0], 
        Hold[$CellContext`\[Theta]L$$, $CellContext`\[Theta]L$300484$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`\[Lambda] = 
        0.288 (Cos[$CellContext`\[Theta]L$$]/$CellContext`m$$^2) - 0.673; Show[
         Plot[
         4 ($CellContext`m$$^4/(
            1 + $CellContext`m$$^2 + (-1 + $CellContext`m$$^2) 
             Cos[$CellContext`\[Theta]L$$ - ArcTan[
               Sec[$CellContext`\[Theta]L$$]^2 Tan[$CellContext`\[Theta]] + 
                Tan[$CellContext`\[Theta]L$$]]])^2), {$CellContext`\[Theta], 
           0, Pi/2}, PlotRange -> {{0, Pi/2}, {0, 1}}, ColorFunction -> 
          Function[{$CellContext`x, $CellContext`y}, Blue]], 
         Plot[
         E^((-$CellContext`\[Lambda]) Sin[$CellContext`\[Theta]]^2) 
          Cos[$CellContext`\[Theta]], {$CellContext`\[Theta], 0, Pi/2}, 
          PlotRange -> {{0, Pi/2}, {0, 1}}, ColorFunction -> 
          Function[{$CellContext`x, $CellContext`y}, Orange]], Epilog -> Inset[
           LineLegend[{Blue, Orange}, {"Origin", "Fitted"}], 
           Scaled[{1, 1}], 
           Scaled[{1, 1}]]]), 
      "Specifications" :> {{{$CellContext`m$$, 0.7}, 0.01, 
         0.9}, {{$CellContext`\[Theta]L$$, Rational[1, 6] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`Lambda$$, $CellContext`\[Lambda]}}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{371., {168., 174.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.839468341557228*^9, 3.839567455104927*^9, {3.839568030928995*^9, 
   3.839568099221574*^9}},
 CellLabel->"Out[54]=",ExpressionUUID->"18136361-c37f-42a5-bdf5-e79c24f8489e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "diskCenter", ",", "diskNormal", ",", "axisSize", ",", "camViewPt"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axisSize", "=", "1.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"diskCenter", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"diskCenterX", ",", "diskCenterY", ",", "diskCenterZ"}], 
       "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"diskNormal", "=", 
        RowBox[{"Normalize", "@", 
         RowBox[{"{", 
          RowBox[{"diskNormalX", ",", "diskNormalY", ",", "diskNormalZ"}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pltSphere3D", "[", " ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<plotPts\>\"", "\[Rule]", "100"}], ",", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"\"\<mesh\>\"", "\[Rule]", "10"}], ","}], "*)"}], 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
              RowBox[{"\"\<lighting\>\"", "\[Rule]", "Automatic"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "x", ",", "y", ",", "z", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "}"}], ",", "LightBlue"}], "]"}]}]}], "|>"}], 
            "\[IndentingNewLine]", "]"}], "&"}], "[", 
          RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"pltDisk3D", "[", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "diskCenter"}], ",", 
              RowBox[{"\"\<normal\>\"", "\[Rule]", "diskNormal"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#radius"}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Green"}], 
                "]"}]}]}], "|>"}], "\[IndentingNewLine]", "\t", "]"}], "&"}], 
          "[", 
          RowBox[{"<|", 
           RowBox[{"\"\<radius\>\"", "\[Rule]", "diskRadius"}], "|>"}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"pltDiskProjArea3D", "[", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<diskCenter\>\"", "\[Rule]", "diskCenter"}], ",", 
              RowBox[{"\"\<diskNormal\>\"", "\[Rule]", "diskNormal"}], ",", 
              RowBox[{"\"\<diskRadius\>\"", "\[Rule]", "#diskRadius"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Red"}], 
                "]"}]}], ",", 
              RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}]}], "|>"}], 
            "\[IndentingNewLine]", "\t", "]"}], "&"}], "[", 
          RowBox[{"<|", 
           RowBox[{"\"\<diskRadius\>\"", "\[Rule]", "diskRadius"}], "|>"}], 
          "]"}]}], "\[IndentingNewLine]", " ", "}"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{"Axes", "\[Rule]", "False"}], ",", "\n", "\t\t", 
        RowBox[{"AxesLabel", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
        ",", "\n", "\t\t", 
        RowBox[{"Boxed", "->", "False"}], ",", "\n", "\t\t", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}]}], "}"}]}], 
        ",", "\n", "\t\t", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "\n", "\t", "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskCenterX", ",", "1"}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskCenterY", ",", 
       RowBox[{"-", "0.3"}]}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskCenterZ", ",", "1"}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalX", ",", 
       RowBox[{"-", "4.2"}]}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalY", ",", 
       RowBox[{"-", "8."}]}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalZ", ",", "7.95"}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskRadius", ",", "0.473"}], "}"}], ",", "0.1", ",", "0.6"}], 
    "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8387140062764063`*^9, 3.8387140103327026`*^9}, {
   3.838714082557334*^9, 3.8387141153961573`*^9}, {3.8387141474867234`*^9, 
   3.83871417594713*^9}, {3.8387142377486773`*^9, 3.8387142980108094`*^9}, {
   3.8387144294289217`*^9, 3.8387144364714947`*^9}, 3.839480660046486*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"ee6a1a37-aed0-4f7a-b85e-72fb42133cae"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`diskCenterX$$ = 
    1, $CellContext`diskCenterY$$ = -0.3, $CellContext`diskCenterZ$$ = 
    1, $CellContext`diskNormalX$$ = -4.2, $CellContext`diskNormalY$$ = -8., \
$CellContext`diskNormalZ$$ = 7.95, $CellContext`diskRadius$$ = 0.473, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`diskCenterX$$], 1}, -10, 10}, {{
       Hold[$CellContext`diskCenterY$$], -0.3}, -10, 10}, {{
       Hold[$CellContext`diskCenterZ$$], 1}, -10, 10}, {{
       Hold[$CellContext`diskNormalX$$], -4.2}, -10, 10}, {{
       Hold[$CellContext`diskNormalY$$], -8.}, -10, 10}, {{
       Hold[$CellContext`diskNormalZ$$], 7.95}, -10, 10}, {{
       Hold[$CellContext`diskRadius$$], 0.473}, 0.1, 0.6}}, Typeset`size$$ = {
    324., {173., 179.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`diskCenterX$4261$$ = 
    0, $CellContext`diskCenterY$4262$$ = 0, $CellContext`diskCenterZ$4263$$ = 
    0, $CellContext`diskNormalX$4264$$ = 0, $CellContext`diskNormalY$4265$$ = 
    0, $CellContext`diskNormalZ$4266$$ = 0, $CellContext`diskRadius$4267$$ = 
    0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`diskCenterX$$ = 
        1, $CellContext`diskCenterY$$ = -0.3, $CellContext`diskCenterZ$$ = 
        1, $CellContext`diskNormalX$$ = -4.2, $CellContext`diskNormalY$$ = \
-8., $CellContext`diskNormalZ$$ = 7.95, $CellContext`diskRadius$$ = 0.473}, 
      "ControllerVariables" :> {
        Hold[$CellContext`diskCenterX$$, $CellContext`diskCenterX$4261$$, 0], 
        Hold[$CellContext`diskCenterY$$, $CellContext`diskCenterY$4262$$, 0], 
        Hold[$CellContext`diskCenterZ$$, $CellContext`diskCenterZ$4263$$, 0], 
        Hold[$CellContext`diskNormalX$$, $CellContext`diskNormalX$4264$$, 0], 
        Hold[$CellContext`diskNormalY$$, $CellContext`diskNormalY$4265$$, 0], 
        Hold[$CellContext`diskNormalZ$$, $CellContext`diskNormalZ$4266$$, 0], 
        Hold[$CellContext`diskRadius$$, $CellContext`diskRadius$4267$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`diskCenter = 
        Normalize[{$CellContext`diskCenterX$$, $CellContext`diskCenterY$$, \
$CellContext`diskCenterZ$$}]; 
       Show[$CellContext`diskNormal = 
          Normalize[{$CellContext`diskNormalX$$, $CellContext`diskNormalY$$, \
$CellContext`diskNormalZ$$}]; {
           (gPlots3DEx`pltSphere3D[
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "plotPts" -> 100, "opacity" -> 
             0.3, "lighting" -> Automatic, "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z, \
$CellContext`\[Theta], $CellContext`\[Phi]}, LightBlue]]]& )[
            Association[]], 
           (gPlots3DEx`pltDisk3D[
            Association[
            "center" -> $CellContext`diskCenter, 
             "normal" -> $CellContext`diskNormal, "radius" -> Slot["radius"], 
             "opacity" -> 0.3, "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
               Green]]]& )[
            Association["radius" -> $CellContext`diskRadius$$]], 
           (gPlots3DEx`pltDiskProjArea3D[
            Association[
            "diskCenter" -> $CellContext`diskCenter, 
             "diskNormal" -> $CellContext`diskNormal, "diskRadius" -> 
             Slot["diskRadius"], "opacity" -> 0.3, "colorFunc" -> 
             Function[{$CellContext`x, $CellContext`y, $CellContext`z}, Red], 
             "zbias" -> 1]]& )[
            Association["diskRadius" -> $CellContext`diskRadius$$]]}, {
         Axes -> False, AxesLabel -> {"X", "Y", "Z"}, Boxed -> False, 
          
          PlotRange -> {{-$CellContext`axisSize, $CellContext`axisSize}, \
{-$CellContext`axisSize, $CellContext`axisSize}, {-$CellContext`axisSize, \
$CellContext`axisSize}}, ImageSize -> Medium}]), 
      "Specifications" :> {{{$CellContext`diskCenterX$$, 1}, -10, 
         10}, {{$CellContext`diskCenterY$$, -0.3}, -10, 
         10}, {{$CellContext`diskCenterZ$$, 1}, -10, 
         10}, {{$CellContext`diskNormalX$$, -4.2}, -10, 
         10}, {{$CellContext`diskNormalY$$, -8.}, -10, 
         10}, {{$CellContext`diskNormalZ$$, 7.95}, -10, 
         10}, {{$CellContext`diskRadius$$, 0.473}, 0.1, 0.6}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{371., {291., 297.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.838713933421653*^9, {3.8387139687932673`*^9, 3.838714012091153*^9}, 
   3.8387141842589903`*^9, 3.8387142526979027`*^9, {3.838714290178372*^9, 
   3.8387142987482414`*^9}, 3.838797093675791*^9, 3.8392995235752525`*^9, 
   3.8393932468480425`*^9, {3.8394806518881702`*^9, 3.8394806611396084`*^9}, 
   3.8395674553093805`*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"9783d85a-72b6-4be0-803c-13610beee193"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "diskCenter", ",", "diskNormal", ",", "axisSize", ",", "recvPt", ",", 
    "reflViewDir", ",", "lightDir", ",", "asgColorHueFunc", ",", 
    "\[IndentingNewLine]", "\t", "asgLightOld", ",", "asgLightNew", ",", 
    "asgLobe"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"asgColorHueFunc", "[", 
     RowBox[{"x_", ",", "y_", ",", "z_", ",", "asgLight_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", "asgLobe"}], "}"}], ",", "\[IndentingNewLine]", "\t",
       "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"asgLobe", "=", 
        RowBox[{"asgLight", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"r", "=", 
        RowBox[{
         RowBox[{"asgVector", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "asgLight"}], 
          "]"}], "/", 
         RowBox[{"asgVector", "[", 
          RowBox[{"asgLobe", ",", "asgLight"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Hue", "@", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{".7", "-", "r"}], ",", "0"}], "]"}], ",", 
             RowBox[{"r", ">", ".1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{".7", ",", 
             RowBox[{"r", "<", ".1"}]}], "}"}]}], "}"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"Hue", "@", 
       RowBox[{"asgVector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "asgLight"}], 
        "]"}]}], " ", "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axisSize", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diskCenter", "=", 
   RowBox[{"Normalize", "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"recvPt", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"reflViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"recvPt", "-", "diskCenter"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"lightDir", "=", 
     RowBox[{"gReflectVector", "[", 
      RowBox[{"reflViewDir", ",", "diskNormal"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"diskNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"diskNormalX", ",", "diskNormalY", ",", "diskNormalZ"}], 
       "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"asgLightOld", "=", 
     RowBox[{"asgReflectLight", "[", 
      RowBox[{
      "recvPt", ",", "lightDir", ",", "lightIntensity", ",", "0.1", ",", 
       RowBox[{"{", 
        RowBox[{"diskCenter", ",", "diskNormal", ",", "diskRadius"}], "}"}]}],
       "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"asgLightNew", "=", "asgLightOld"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"asgLightNew", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "=", "asgLambda"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"asgLightNew", "[", 
      RowBox[{"[", "5", "]"}], "]"}], "=", "asgMu"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"asgLightNew", "[", 
      RowBox[{"[", "6", "]"}], "]"}], "=", "asgC"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "arrow"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pltArrow3D", "[", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<origin\>\"", "\[Rule]", 
               RowBox[{"diskCenter", "+", 
                RowBox[{"lightDir", "*", "0.5"}]}]}], ",", 
              RowBox[{"\"\<dir\>\"", "\[Rule]", 
               RowBox[{"-", "lightDir"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}], ",", 
              RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.6"}]}], "|>"}], 
            "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
          RowBox[{"<|", "|>"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pltSphere3D", "[", " ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "recvPt"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<plotPts\>\"", "\[Rule]", "100"}], ",", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"\"\<mesh\>\"", "\[Rule]", "10"}], ","}], "*)"}], 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
              RowBox[{"\"\<lighting\>\"", "\[Rule]", "Automatic"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "x", ",", "y", ",", "z", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "}"}], ",", "LightBlue"}], "]"}]}]}], "|>"}], 
            "\[IndentingNewLine]", "]"}], "&"}], "[", 
          RowBox[{"<|", "|>"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pltSphere3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "200"}], ",", 
             RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                RowBox[{"asgColorHueFunc", "[", 
                 RowBox[{"x", ",", "y", ",", "z", ",", "asgLightNew"}], 
                 "]"}]}], 
               RowBox[{"(*", 
                RowBox[{"Hue", "@", 
                 RowBox[{"asgVector", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                   "asgLight"}], "]"}]}], "*)"}], " ", "]"}]}]}], "|>"}], 
           "\[IndentingNewLine]", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"pltDisk3D", "[", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "diskCenter"}], ",", 
              RowBox[{"\"\<normal\>\"", "\[Rule]", "diskNormal"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#radius"}], ",", 
              RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Green"}], 
                "]"}]}]}], "|>"}], "\[IndentingNewLine]", "\t", "]"}], "&"}], 
          "[", 
          RowBox[{"<|", 
           RowBox[{"\"\<radius\>\"", "\[Rule]", "diskRadius"}], "|>"}], "]"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltDiskProjBoundary", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<diskCenter\>\"", "\[Rule]", "diskCenter"}], ",", 
             RowBox[{"\"\<diskNormal\>\"", "\[Rule]", "diskNormal"}], ",", 
             RowBox[{"\"\<diskRadius\>\"", "\[Rule]", "#diskRadius"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<opacity\>\"", "\[Rule]", "0.3"}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Red"}], 
               "]"}]}], ",", 
             RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}]}], "|>"}], 
           "\[IndentingNewLine]", "\t", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<diskRadius\>\"", "\[Rule]", "diskRadius"}], "|>"}], 
         "]"}]}], "\[IndentingNewLine]", " ", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{"Axes", "\[Rule]", "False"}], ",", "\n", "\t\t", 
        RowBox[{"AxesLabel", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
        ",", "\n", "\t\t", 
        RowBox[{"Boxed", "->", "False"}], ",", "\n", "\t\t", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "axisSize"}], ",", "axisSize"}], "}"}]}], "}"}]}], 
        ",", "\n", "\t\t", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "\n", "\t", "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalX", ",", 
       RowBox[{"-", "4.2"}]}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalY", ",", 
       RowBox[{"-", "8."}]}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskNormalZ", ",", "7.95"}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskRadius", ",", "0.473"}], "}"}], ",", "0.1", ",", "0.6"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "0.05", ",", "5"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"asgLambda", ",", "10"}], "}"}], ",", "10", ",", "20"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"asgMu", ",", "24.6"}], "}"}], ",", "20", ",", "30"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"asgC", ",", "1"}], "}"}], ",", "0.05", ",", "5"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.838714484609054*^9, 3.8387145170271535`*^9}, {
   3.838714578351654*^9, 3.8387146308673487`*^9}, {3.838714816915636*^9, 
   3.8387150895630417`*^9}, {3.838715131189658*^9, 3.838715209317031*^9}, {
   3.8387152759178796`*^9, 3.838715284859612*^9}, {3.838715315874111*^9, 
   3.838715346620067*^9}, 3.838797215716299*^9, {3.838797263616211*^9, 
   3.8387972641131787`*^9}, {3.838797357962243*^9, 3.838797408523572*^9}, {
   3.839299621946027*^9, 3.8392996221125813`*^9}, {3.8394914374959607`*^9, 
   3.8394914469506598`*^9}, {3.83949163575498*^9, 3.839491657035446*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"0100b804-fc93-4ef6-8c90-070b592b8b7c"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`asgC$$ = 1, $CellContext`asgLambda$$ = 
    10, $CellContext`asgMu$$ = 
    24.6, $CellContext`diskNormalX$$ = -4.2, $CellContext`diskNormalY$$ = \
-8., $CellContext`diskNormalZ$$ = 7.95, $CellContext`diskRadius$$ = 
    0.473, $CellContext`lightIntensity$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`diskNormalX$$], -4.2}, -10, 10}, {{
       Hold[$CellContext`diskNormalY$$], -8.}, -10, 10}, {{
       Hold[$CellContext`diskNormalZ$$], 7.95}, -10, 10}, {{
       Hold[$CellContext`diskRadius$$], 0.473}, 0.1, 0.6}, {{
       Hold[$CellContext`lightIntensity$$], 1}, 0.05, 5}, {{
       Hold[$CellContext`asgLambda$$], 10}, 10, 20}, {{
       Hold[$CellContext`asgMu$$], 24.6}, 20, 30}, {{
       Hold[$CellContext`asgC$$], 1}, 0.05, 5}}, Typeset`size$$ = {
    324., {173., 179.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`diskNormalX$14610$$ = 
    0, $CellContext`diskNormalY$14611$$ = 
    0, $CellContext`diskNormalZ$14612$$ = 0, $CellContext`diskRadius$14613$$ =
     0, $CellContext`lightIntensity$14614$$ = 
    0, $CellContext`asgLambda$14615$$ = 0, $CellContext`asgMu$14616$$ = 
    0, $CellContext`asgC$14617$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`asgC$$ = 1, $CellContext`asgLambda$$ = 
        10, $CellContext`asgMu$$ = 
        24.6, $CellContext`diskNormalX$$ = -4.2, $CellContext`diskNormalY$$ = \
-8., $CellContext`diskNormalZ$$ = 7.95, $CellContext`diskRadius$$ = 
        0.473, $CellContext`lightIntensity$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`diskNormalX$$, $CellContext`diskNormalX$14610$$, 0], 
        Hold[$CellContext`diskNormalY$$, $CellContext`diskNormalY$14611$$, 0], 
        Hold[$CellContext`diskNormalZ$$, $CellContext`diskNormalZ$14612$$, 0], 
        Hold[$CellContext`diskRadius$$, $CellContext`diskRadius$14613$$, 0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$14614$$, 0], 
        Hold[$CellContext`asgLambda$$, $CellContext`asgLambda$14615$$, 0], 
        Hold[$CellContext`asgMu$$, $CellContext`asgMu$14616$$, 0], 
        Hold[$CellContext`asgC$$, $CellContext`asgC$14617$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`reflViewDir = 
        Normalize[$CellContext`recvPt - $CellContext`diskCenter]; \
$CellContext`lightDir = 
        gUtils`gReflectVector[$CellContext`reflViewDir, \
$CellContext`diskNormal]; $CellContext`diskNormal = 
        Normalize[{$CellContext`diskNormalX$$, $CellContext`diskNormalY$$, \
$CellContext`diskNormalZ$$}]; $CellContext`asgLightOld = 
        sgCommon`asgReflectLight[$CellContext`recvPt, $CellContext`lightDir, \
$CellContext`lightIntensity$$, 
          0.1, {$CellContext`diskCenter, $CellContext`diskNormal, \
$CellContext`diskRadius$$}]; $CellContext`asgLightNew = \
$CellContext`asgLightOld; 
       Part[$CellContext`asgLightNew, 4] = $CellContext`asgLambda$$; 
       Part[$CellContext`asgLightNew, 5] = $CellContext`asgMu$$; 
       Part[$CellContext`asgLightNew, 6] = $CellContext`asgC$$; Show[{
          (gPlots3DEx`pltSphere3D[
           Association[
           "center" -> {0, 0, 0}, "radius" -> 1, "plotPts" -> 200, "mesh" -> 
            None, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              $CellContext`asgColorHueFunc[$CellContext`x, $CellContext`y, \
$CellContext`z, $CellContext`asgLightNew]]]]& )[
           Association[]], 
          (gPlots3DEx`pltDiskProjBoundary[
           Association[
           "diskCenter" -> $CellContext`diskCenter, 
            "diskNormal" -> $CellContext`diskNormal, "diskRadius" -> 
            Slot["diskRadius"], "opacity" -> 0.3, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, Red], 
            "zbias" -> 1]]& )[
           Association["diskRadius" -> $CellContext`diskRadius$$]]}, {
         Axes -> False, AxesLabel -> {"X", "Y", "Z"}, Boxed -> False, 
          PlotRange -> {{-$CellContext`axisSize, $CellContext`axisSize}, \
{-$CellContext`axisSize, $CellContext`axisSize}, {-$CellContext`axisSize, \
$CellContext`axisSize}}, ImageSize -> Medium}]), 
      "Specifications" :> {{{$CellContext`diskNormalX$$, -4.2}, -10, 
         10}, {{$CellContext`diskNormalY$$, -8.}, -10, 
         10}, {{$CellContext`diskNormalZ$$, 7.95}, -10, 
         10}, {{$CellContext`diskRadius$$, 0.473}, 0.1, 
         0.6}, {{$CellContext`lightIntensity$$, 1}, 0.05, 
         5}, {{$CellContext`asgLambda$$, 10}, 10, 
         20}, {{$CellContext`asgMu$$, 24.6}, 20, 
         30}, {{$CellContext`asgC$$, 1}, 0.05, 5}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{627., {202., 208.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.839299525119155*^9, {3.8392996138784747`*^9, 3.839299623441001*^9}, 
   3.8393932483188343`*^9, 3.8394915481849165`*^9, 3.839491644582508*^9, 
   3.839567456762497*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"f0b8ae4b-dbff-479e-b1c5-d56d8538657e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gParamPlotContent", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\"\<lines\>\"", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "5"}], ",", "0"}], "}"}]}], ",", 
                RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], ",", 
                RowBox[{"\"\<length\>\"", "\[Rule]", "10"}], ",", 
                RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], ",", 
                RowBox[{"\"\<length\>\"", "\[Rule]", "3"}], ",", 
                RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}]}], 
             "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
          RowBox[{"<|", 
           RowBox[{"\"\<lightDir\>\"", "\[Rule]", "lightDir"}], "|>"}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<varyDirectionDisbs\>\"", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<lightDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", "lightDir", ")"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ")"}], 
                   "&"}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<normalDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<disbFunc\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"gDGGX", "[", 
                    RowBox[{"#roughness", ",", "#noh"}], "]"}], ")"}]}], 
                    ")"}], "&"}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
                RowBox[{
                "\"\<label\>\"", "\[Rule]", "\"\<GGX Normal Lobe\>\""}]}], 
               "|>"}], ",", "\[IndentingNewLine]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<lightDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", "lightDir", ")"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ")"}], 
                   "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<normalDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<disbFunc\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"sgVector", "[", 
                    RowBox[{"#halfDir", ",", " ", 
                    RowBox[{"sgRawNDF", "[", 
                    RowBox[{"#roughness", ",", "#normalDir"}], "]"}]}], "]"}],
                     "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#\[Theta]", ">", "\[Pi]"}], ",", "0", ",", "1"}],
                     "]"}]}], ")"}]}], ")"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
                RowBox[{
                "\"\<label\>\"", "\[Rule]", "\"\<SG GGX Normal Lobe\>\""}]}], 
               "|>"}], ",", "\[IndentingNewLine]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<lightDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", "lightDir", ")"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ")"}], 
                   "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<normalDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<disbFunc\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"sgVector", "[", 
                    RowBox[{"#lightDir", ",", 
                    RowBox[{"sgNDF", "[", 
                    RowBox[{
                    "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                    "#normalDir"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
                    "\t", "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#lightDir", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<", "0"}], ",", "0", ",",
                     "1"}], "]"}]}], ")"}]}], ")"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
                RowBox[{
                "\"\<label\>\"", "\[Rule]", "\"\<SG GGX Warped Lobe\>\""}]}], 
               "|>"}], ",", "\[IndentingNewLine]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<lightDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", "lightDir", ")"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ")"}], 
                   "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<normalDir\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<disbFunc\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"sgVector", "[", 
                    RowBox[{"#viewDir", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", "30", ",", "3.9"}], 
                    "}"}]}], "]"}]}], ")"}], "&"}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<color\>\"", "\[Rule]", "Orange"}], ",", 
                RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<Light Lobe\>\""}]}], 
               "|>"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"\"\<lightDir\>\"", "\[Rule]", "lightDir"}]}], "|>"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "3.8"}]}], 
        "\[IndentingNewLine]", "|>"}], ",", "Medium"}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.5"}], ",", "5.5"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "\[IndentingNewLine]", 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"normalDir", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"viewDir", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ","}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.3"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.838797592331209*^9, 3.838797593933448*^9}, {
   3.838797682041217*^9, 3.838797682447472*^9}, {3.8387977193889575`*^9, 
   3.838797775415122*^9}, {3.8387978635545616`*^9, 3.838797870528533*^9}, {
   3.8387981413496857`*^9, 3.8387983166323805`*^9}, {3.838798349906737*^9, 
   3.838798365170604*^9}, {3.8387984196478386`*^9, 3.8387984666349087`*^9}, {
   3.838798497274062*^9, 3.8387985344195256`*^9}, {3.8387985681784697`*^9, 
   3.838798572578483*^9}, {3.838798818840515*^9, 3.838798896337879*^9}, {
   3.838799293022706*^9, 3.838799304083005*^9}, 3.8387996040291834`*^9, {
   3.83879972817241*^9, 3.838799863509283*^9}, {3.8387999438043613`*^9, 
   3.838799996270355*^9}, 3.8388000883890777`*^9, {3.8388001793668323`*^9, 
   3.838800246944092*^9}, {3.838800304947627*^9, 3.8388003315160303`*^9}, {
   3.83880039599175*^9, 3.8388004634281836`*^9}, {3.839493276936694*^9, 
   3.839493297889179*^9}, {3.8394933335411015`*^9, 3.8394933366914406`*^9}, {
   3.83949337588515*^9, 3.8394933972217307`*^9}, {3.839493504822689*^9, 
   3.8394935069346857`*^9}, {3.839493591597776*^9, 3.8394935933800097`*^9}, {
   3.839566426824025*^9, 3.839566427283796*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"edc6d70f-c706-4c48-91d8-4ee05edf38ac"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lightDir$$ = {1, 
    1}, $CellContext`normalDir$$ = {0, 1}, $CellContext`roughness$$ = 0.3, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`normalDir$$], {0, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`lightDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`roughness$$], 0.3}, 0.05, 1}}, Typeset`size$$ = {
    488., {159., 165.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`normalDir$145050$$ = {0, 
    0}, $CellContext`lightDir$145051$$ = {0, 
    0}, $CellContext`roughness$145052$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`lightDir$$ = {1, 
         1}, $CellContext`normalDir$$ = {0, 1}, $CellContext`roughness$$ = 
        0.3}, "ControllerVariables" :> {
        Hold[$CellContext`normalDir$$, $CellContext`normalDir$145050$$, {0, 
         0}], 
        Hold[$CellContext`lightDir$$, $CellContext`lightDir$145051$$, {0, 0}], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$145052$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[
        gPlots`gParamPlotContent[
         Association[
          ("lines" -> {
            Association[
            "startPos" -> {-5, 0}, "dirVec" -> {1, 0}, "length" -> 10, 
             "color" -> Black], 
            Association[
            "startPos" -> {0, 0}, "dirVec" -> {0, 1}, "length" -> 3, "color" -> 
             Black]}& )[
           Association["lightDir" -> $CellContext`lightDir$$]], 
          ("varyDirectionDisbs" -> {
            Association[
            "lightDir" -> ($CellContext`lightDir$$& ), "viewDir" -> ({
               Cos[
                Slot["\[Theta]"]], 
               Sin[
                Slot["\[Theta]"]]}& ), "normalDir" -> ({0, 1}& ), "roughness" -> 
             Slot["roughness"], "disbFunc" -> ({
                Cos[
                 Slot["\[Theta]"]], 
                Sin[
                 Slot["\[Theta]"]]} gBRDF`gDGGX[
                Slot["roughness"], 
                Slot["noh"]]& ), "color" -> Red, "label" -> 
             "GGX Normal Lobe"], 
            Association[
            "roughness" -> $CellContext`roughness$$, 
             "lightDir" -> ($CellContext`lightDir$$& ), "viewDir" -> ({
               Cos[
                Slot["\[Theta]"]], 
               Sin[
                Slot["\[Theta]"]]}& ), "normalDir" -> ({0, 1}& ), 
             "disbFunc" -> ({
                Cos[
                 Slot["\[Theta]"]], 
                Sin[
                 Slot["\[Theta]"]]} (sgCommon`sgVector[
                 Slot["halfDir"], 
                 sgCommon`sgRawNDF[
                  Slot["roughness"], 
                  Slot["normalDir"]]] If[Slot["\[Theta]"] > Pi, 0, 1])& ), 
             "color" -> Green, "label" -> "SG GGX Normal Lobe"], 
            Association[
            "roughness" -> $CellContext`roughness$$, 
             "lightDir" -> ($CellContext`lightDir$$& ), "viewDir" -> ({
               Cos[
                Slot["\[Theta]"]], 
               Sin[
                Slot["\[Theta]"]]}& ), "normalDir" -> ({0, 1}& ), 
             "disbFunc" -> ({
                Cos[
                 Slot["\[Theta]"]], 
                Sin[
                 Slot["\[Theta]"]]} (sgCommon`sgVector[
                 Slot["lightDir"], 
                 sgCommon`sgNDF[
                  Slot["roughness"], 
                  Slot["lightDir"], 
                  Slot["viewDir"], 
                  Slot["normalDir"]]] If[Part[
                   Slot["lightDir"], 2] < 0, 0, 1])& ), "color" -> Blue, 
             "label" -> "SG GGX Warped Lobe"], 
            Association[
            "roughness" -> $CellContext`roughness$$, 
             "lightDir" -> ($CellContext`lightDir$$& ), "viewDir" -> ({
               Cos[
                Slot["\[Theta]"]], 
               Sin[
                Slot["\[Theta]"]]}& ), "normalDir" -> ({0, 1}& ), 
             "disbFunc" -> ({
                Cos[
                 Slot["\[Theta]"]], 
                Sin[
                 Slot["\[Theta]"]]} sgCommon`sgVector[
                Slot["viewDir"], {{1, 1}, 30, 3.9}]& ), "color" -> Orange, 
             "label" -> "Light Lobe"]}& )[
           Association[
           "roughness" -> $CellContext`roughness$$, 
            "lightDir" -> $CellContext`lightDir$$]], "axisExtent" -> 3.8], 
         Medium], PlotRange -> {{-3, 3}, {-0.5, 5.5}}, Axes -> False, 
        ImageSize -> Medium], 
      "Specifications" :> {{{$CellContext`normalDir$$, {0, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`lightDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`roughness$$, 0.3}, 0.05, 1}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{535., {278., 284.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.838800438379466*^9, 3.838800463909574*^9}, 
   3.8388005030647135`*^9, 3.8392995269212875`*^9, 3.8393932575602617`*^9, {
   3.839493278942523*^9, 3.839493299016004*^9}, 3.839493339932657*^9, 
   3.83949337834044*^9, 3.8394935073873014`*^9, 3.839493594405241*^9, 
   3.8395664286830997`*^9, 3.839567461868104*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"7b1275f5-0384-4532-a5c6-1714a11e8353"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<ASG Conv SG Error(Large)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "sg1", ",", "sg2", ",", "asg1", ",", "\[Lambda]", ",", "\[Mu]1", ",", 
    "\[Mu]2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Mu]1", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Mu]2", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"sg1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"2", "\[Lambda]"}], ",", "\[Mu]1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"sg2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Normalize", "@", "sg2Axis"}], ",", 
       RowBox[{"2", "\[Lambda]"}], ",", "\[Mu]2"}], "}"}]}], ";", "\n", "  ", 
    RowBox[{"asg1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", "\[Lambda]", ",", 
       "\[Lambda]", ",", "\[Mu]1"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"Abs", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sgDot", "[", 
          RowBox[{"sg1", ",", "sg2"}], "]"}], "-", "\[IndentingNewLine]", 
         RowBox[{"asgDotSg", "[", 
          RowBox[{"asg1", ",", "sg2"}], "]"}]}], "]"}], "\[IndentingNewLine]",
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Lambda]", ",", "5", ",", "50.1"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<\[Lambda]\>\"", ",", 
            RowBox[{"FontSize", "->", "16"}], ",", 
            RowBox[{"FontFamily", "->", "\"\<Times\>\""}]}], "]"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<error\>\"", ",", 
            RowBox[{"FontSize", "->", "16"}], ",", 
            RowBox[{"FontFamily", "->", "\"\<Times\>\""}]}], "]"}], "]"}]}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sg2Axis", ",", 
       RowBox[{"{", 
        RowBox[{"0.5", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8396281772931695`*^9, 3.839628179329753*^9}, 
   3.8396283686908536`*^9},
 CellLabel->"In[84]:=",ExpressionUUID->"b7f868ad-b527-418e-a966-151ae4a8f0fc"],

Cell[BoxData[
 StyleBox["\<\" ASG Conv SG Error(Large)\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8396275456475105`*^9, 3.8396281798942766`*^9, 
  3.839628374550106*^9},
 CellLabel->
  "During evaluation of \
In[84]:=",ExpressionUUID->"c4f91631-9e5c-419c-988a-0f79c0c5850a"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`sg2Axis$$ = {0.5, 0, 1}, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`sg2Axis$$], {0.5, 0, 1}}, {0, 0, 0}, {1, 1, 1}}}, 
    Typeset`size$$ = {324., {105., 110.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`sg2Axis$731481$$ = {0, 0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`sg2Axis$$ = {0.5, 0, 1}}, 
      "ControllerVariables" :> {
        Hold[$CellContext`sg2Axis$$, $CellContext`sg2Axis$731481$$, {0, 0, 
         0}]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`\[Mu]1 = 1; $CellContext`\[Mu]2 = 
        1; $CellContext`sg1 = {{0, 0, 1}, 
          2 $CellContext`\[Lambda], $CellContext`\[Mu]1}; $CellContext`sg2 = {
          Normalize[$CellContext`sg2Axis$$], 
          2 $CellContext`\[Lambda], $CellContext`\[Mu]2}; $CellContext`asg1 = \
{{0, 0, 1}, {1, 0, 0}, {0, 1, 
          0}, $CellContext`\[Lambda], $CellContext`\[Lambda], $CellContext`\
\[Mu]1}; Plot[{
          Abs[
          sgCommon`sgDot[$CellContext`sg1, $CellContext`sg2] - 
           sgCommon`asgDotSg[$CellContext`asg1, $CellContext`sg2]]}, \
{$CellContext`\[Lambda], 5, 50.1}, AxesLabel -> {
           Text[
            Style["\[Lambda]", FontSize -> 16, FontFamily -> "Times"]], 
           Text[
            Style["error", FontSize -> 16, FontFamily -> "Times"]]}]), 
      "Specifications" :> {{{$CellContext`sg2Axis$$, {0.5, 0, 1}}, {0, 0, 
         0}, {1, 1, 1}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{371., {144., 150.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.839627545676467*^9, 3.8396281799082384`*^9, 
  3.839628374566059*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"2d6de5d2-767b-40e9-a97e-4a30060fdfb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"approxRect", ",", "plotFunc"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"approxRect", "[", 
     RowBox[{"inRect_", ",", "inDisk_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "rMin", ",", "rMax", ",", "rLeft", ",", "rRight", ",", "rTop", ",", 
        "rBottom", ",", "\[IndentingNewLine]", "\t", "dCenter", ",", 
        "dRadius", ",", "dLeft", ",", "dRight", ",", "dTop", ",", "dBottom", 
        ",", "\[IndentingNewLine]", "\t", "oLeft", ",", "oRight", ",", "oTop",
         ",", "oBottom"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rMin", "=", 
        RowBox[{"inRect", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rMax", "=", 
        RowBox[{"inRect", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dCenter", "=", 
        RowBox[{"inDisk", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dRadius", "=", 
        RowBox[{"inDisk", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"rLeft", "=", 
        RowBox[{"rMin", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rRight", "=", 
        RowBox[{"rMax", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rTop", "=", 
        RowBox[{"rMax", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rBottom", "=", 
        RowBox[{"rMin", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dLeft", "=", 
        RowBox[{
         RowBox[{"dCenter", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "dRadius"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dRight", "=", 
        RowBox[{
         RowBox[{"dCenter", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "dRadius"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dBottom", "=", 
        RowBox[{
         RowBox[{"dCenter", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", "dRadius"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dTop", "=", 
        RowBox[{
         RowBox[{"dCenter", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "dRadius"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"oLeft", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"rLeft", ",", "dLeft"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"oRight", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"rRight", ",", "dRight"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"oTop", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"rTop", ",", "dTop"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"oBottom", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"rBottom", ",", "dBottom"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"oLeft", ",", "oBottom"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"oRight", ",", "oTop"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"plotFunc", "[", "diskCenter_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rect", ",", "disk", ",", "intsR", ",", "reg"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rect", "=", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "0.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0.5"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"disk", "=", 
        RowBox[{"Disk", "[", 
         RowBox[{"diskCenter", ",", "0.6"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"intsR", "=", 
        RowBox[{"RegionIntersection", "[", 
         RowBox[{"rect", ",", "disk"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"reg", "=", 
        RowBox[{"Region", "[", "intsR", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"EdgeForm", "[", 
             RowBox[{"{", "Black", "}"}], "]"}], ",", 
            RowBox[{"FaceForm", "[", "]"}], ",", "rect", ",", "disk"}], "}"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"EdgeForm", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Thickness", "[", "0.02", "]"}], ",", "Blue"}], "}"}], 
             "]"}], ",", 
            RowBox[{"FaceForm", "[", "]"}], ",", 
            RowBox[{"approxRect", "[", 
             RowBox[{"rect", ",", "disk"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RegionPlot", "[", 
             RowBox[{"reg", ",", 
              RowBox[{"PlotStyle", "\[Rule]", "LightGreen"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"GraphicsGrid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{"Rectangle", "[", "]"}], "]"}], ",", " ", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Disk", "[", "]"}], "]"}]}], "}"}], ",", " ", "\n", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{"Disk", "[", "]"}], "]"}], ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Rectangle", "[", "]"}], "]"}]}], "}"}]}], "}"}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsGrid", "[", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"plotFunc", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", 
     RowBox[{"plotFunc", "[", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "0.3"}], "}"}], "]"}]}], "}"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{"plotFunc", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], "]"}], "\[IndentingNewLine]", "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8396470906876936`*^9, 3.8396471028956656`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"3722861b-cbfc-4ac3-a641-235a4f3c5cd3"],

Cell[BoxData[
 GraphicsBox[{{}, {InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[0]], FaceForm[None], 
        RectangleBox[{-1, -0.5}, {1, 0.5}], DiskBox[{0, 0}, 0.6]}, 
       {EdgeForm[{RGBColor[0, 0, 1], Thickness[0.02]}], FaceForm[None], 
        RectangleBox[{-0.6, -0.5}, {0.6, 0.5}]}, {
        GraphicsComplexBox[CompressedData["
1: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
6AmbMTRz/foRA0y8LaUySRDTgv8HIS9JJg==
         "], {{
           {RGBColor[0.88, 1, 0.88], AbsoluteThickness[1.6], Opacity[1], 
            EdgeForm[None], GraphicsGroupBox[PolygonBox[CompressedData["
1:eJxFmgnY11MWx+/fMvZk37KE7Fu2rClKlrKEskWypEGR0GRqimSLSlIoS8qa
LGlBqewkZMYwZuwMxjpmxj7M9zP30+N53vOce8499/7vcu753nt+b/MefTr3
XqKUstGSpeSvvBvaq1HK1uGfhQ5IedfwD0L7pLxd+N9D+6a8Q/i40LEp7x3+
Sah9yjuFXx/qmnLr8C9DB6e8e/i/Qodr/03oyJTbhP8U6pby/uG/hLqnfGD4
A6HzUu4SvnT4aaFDU14mvFfo8JTXCh8SOinlJcJPDnVMefnwM0NHprxCeJ/Q
USlPCfW37a2hC/3dW0J9U24f/lXokJT3CJ8QOivlfcNXDx8UOiHl6aHnUj42
/JHQ6JRPDL8/dIW/tVH4VaHfprxN+OTQ+SlvHD6S8dFHaGLKvcMfDV2Xcvfw
kaHxKe8Sflfo5pQPCR8bujPlvcJ3CL8nNCDlq0PzXP9FrJ2/NS30UMpHh68X
fmnoVH4zNDXlDuGvhGamfEH4n5hPyr8LnxR6wr24KvR0yjuGtwqfw7qnvE74
UNY95c3Drw+dk/Ls0Avuy4+h413bD0NtU94+/P1Q65S31e9a63ufhjo492Gh
Nur/Edo/5Z31x7b65Mehdo4N32ynf+KPHVyTz0MHptwq/OvQYa4hPn6Qfn5p
qGPK2+inR+irX5Rqs1v4qFAn7fHrTvo2/nKYPvPvUGf9/5+hQ1PeM/yj0H4p
twx/L7S3v/WfUn9rn/C5oZdSPsUzdIz9cFa6eF6+Cx2tT3JuTtSHvy/Vfr/w
n0vVHxD+Q+g41qXU83q88/pv6AR9oLBXrAXF8B6hg0s9c6d77pZkXMw55aXw
I33ymlLHxtp2ty0+c7I2nMffhPdkjVJeljMR6pzycuFnsNYpX17qb7Gn34aO
Yo/D9wxfFLqk1HN/hud3eOhl13N06Fz36PbQ2Y5/RfyxUWNIU/zaM9tHPeeU
GHOBNiuF9wt1TbkJZ8izs7I2x6S8CmcudFypsWSA45kcusg1XC18YKhbqTFm
oHu0bvgw93fV8N+zHymvEf6HRo0ha4YPbtQ4sHb4xaxpqXHuYs/UIG2IRX0d
M+eLmNe7UePemNAl+uSW4TeFzk15w/DhoV4prx9+OXtTamygTHzYNPyaRo1L
G4RfiR+kvEn4qNBZpca54a7h/NCIlE8rNeZRJu6NtB9i3bOha227RfiNob6l
xs4xzn2z8LGhs1NuFn6ZfbbQpk/Kj4fGOWbi5TjX6nr7JP48HZqAr4Q/FLrB
vRvq+hOv7ih1rfDP8a4PMYfYNrdR4xuxeZLrQAy+VZ+fFbrN/SUe392o8WRr
7c+jz1L1+PC24bc3aowFB+5o1Pi8ffhdjRpvW4ZPCV2Y8sLQva4PsXya9teF
7mvUeLJj+P34UMq7hs/CJ0rFBNqCC1O14YzvFP4gvpjyLuHT8bmU/xiakXL/
8J39rUEpb+c40W/l3PuViiczPBdTQ7c06vl9PfSY/T8celT/nBOarQ/fGXqy
UWMIODPbuYNdjzdqrN7N9b8o5d3D5+P3Kb9Zqg36B0NPNeo5BaMoE3NGsHaN
ihH34HONGnPALspgBFj3sHtxY+iZRo2rT4ae91zsEb4gNDTlN0IvulZgGuWT
SsV/bIgnr5baJ2vePPxqfY9YTuzivDOPec4F7ALXwEFwDywAB+HI4CHYtb8+
iS2YBw6ia+8c0be1Dtzbzznup7yvfXSwDRgI5hGrwatD9Vv0B1kHBoJtYBM4
BjYdbj12xNhO2oGD8E62oT/6BQ872w78OlTdno6NcRG3uVsRs8CyI2wDDoIP
xHniPVgHroGHYAJYc6T6rrYFx8C7btpSBw6iow4cBAPBv3aWj1c+wXacETAQ
DCOGg2PI4AjYBTaBh2DgyfrwqcrEhC6Or5X99LAv6k+1TU/7OMw5Mj9wkLki
c45O1w4cPMq5ti11vIy7vXGLteto3MXfiJPgXh/HDL4hd1F/jnVgILiF34KZ
fd1Tyv0av+IJMucL3AMHiZ9wZDATvwbP8O0B9gsmgmlgHrgG7iF3Uz/QOrAO
DCPmD1YmhsMHWweWDnEvLlYmhsAvtg58I6bv4dgY19H6VW99a5h2jBM8udS1
AtPAL3AM/eXWXakOvAPrwK+R2lJHfEBHHbjA2oN5Z1geoTzKduAduDfaMjiG
DJaBS2AW2AXugWdg3zhlMO5yx9fTfsbYF/XjbHODfbBH4N54xwOmIYP7N2oH
plziurB2xBzizTa2vcn2xHtiOzEf7AK3iJng3kT3FKxDBu/ALrDnQm0maQe+
gYPgJHhCX2DKXeqI/3dr17ZU7JriOOH32i94BfYQh8E0cBDsgyODdcRgcHCA
enTEHHAPHAWbwDfkQeLedMcDn+FvUD/NNrc77smuB+tys78Dlgwu9SxwF+WO
CnaBgxeJe+BgD/EQGdwDr8DBrmLmHMeGDjzrpH6udeDefPucrzzPPp6yDTgG
zrURrxa6VuiftQ58A7d6OR7GcoI4iR1xaYF2Q8XDBbahP/p9wbmCbS3FW3Tg
0Sz3YKZrxToR07BfZJuRYhjvucvEPN5DvL/ww3fVo1u/VBl8+0Bb6rZVRx2Y
yDuR92Qzy2Do+7al3cahK6xrJm4ig7+8I8Ajchu8QXijrlcqriITh68s9Z25
rv3Qfpj22H1oP/SxTqnvZd57m5WKd8iL36fYtXSMwxw/82b+29iWNh+5Ju86
ftaNNduy1HsOOZetSsV1ZNaft9hn2o+wDjvyA9wBPnXt6WsX9eiaWI/MHYx7
AH21sk/kz9yTL90X7gK8u8CO0cqfu1bcPT5Wj27DUt/OvKU3KPUugbz4Hf2e
c39P+UvtsfvC/uh3B+d3qXPs6Lh2Vd/RdeSeTB5nk1LvHcjEAe4p15b6Zr9W
eZT22NGGHAv3Fd7uvKG+dh/Ro9vcemTuTtx3sNtDe2TakAcj59W81HsQcmv1
yNTdUGq+gDwcdx/kfdQjU0eejRxBxP/fkZD3Vo9MHW+Nbxwn9wXktuqRv3Ef
vnUvjnKv2F/uLdyD25TKu7j3n2v3rfprXPMJzoF53VRqPoL8IXcuZO5d3Muw
21f7rs7/Ju2+c97fO/djnGtr9cjU3ew8mTt3NeR26o91LW4pNceBX3E/Qm6v
HvkH9+FHx3y8a7+3emTquDOQQ+ROBT/LOZAr435InvK2Uu+L5E5uLTXPsqZ6
dGtZj8ydk/sndrz9uQuSI+A+M1n5F/vB7mf1v7hH5DGYeItS75PIB6tHpo4c
HfmaTUu9byLzDpqkTN2dzoe5n6wMvtypTB05xiXt5xRl7rR3KVPHe5m8z1Ku
CevBWUDP/ZY63lzkaomTxF3yPvhMT+M3sfQ07cCae5SXth472txd6j2Y+Hpv
qTnf35SqR7ee9cjkprhHY9dZe2Ta8D4l37R0qfdrZPBoqjJ15ISXc+5nKJPP
maK8nP5KThk/P1MZ3/5OeXnXcYI+hr+wRh1cG9YIv7rP9WINHyv1DsYduo97
dbD7iUzeGvvetm+oY5wP6Af4Bjln8lwblXrHRyYnw50fuy7an60P3a/disZW
zglnp68y8fwLZep4a4/WJ3kTIHdVj0wd52clfayf56m9emTqpjkOxnyeMnf1
acrUkash77ZFqfd55GPUIzdx3LxByMlNd582dQ1Wdh0u0I6599eO9w5vlBml
vlNmKDe1vr97jx7dMvrdKvreAH3qcPUDrJtZ6hkmDlyozNtnpjJ15IvI961R
6jsIuZt65FWNL+QNOVMDlYkbPylTx7eG1bUhP8Z7g3xDb32FvB/fEcgnrlpq
HoZ8IncG3lXI3Pd4Z2HXXXvkNazHbk3jC28svrGQw5msDxR17OMQ7YhpF2nH
XXeOMm34FrC2Y+DdhnySemTqwF2+JYDXQ5XB06+UqSM3Dr6CcZco86abq0wd
Z4rztHapZwuZXN8g14735vxSv4U0LfW9h8x7kDcWuUXeWY8rN7Meu/Wsb+Zc
5pWaP10l/IlSzxW+x9sRmfcjbzfsTtUeeX3rr/Cskncix7psqe9L5F7qkTfw
3G/o2R+uzBmHD7eOnCffnFYu9f2JzBvwaeWNnE9zx3+1MnN/xDXCt7gXcSci
JjzlejW1PML14LvVJvoheV2+aa1W6nsX+Szr6XexDXXYPVPq+5kcM29k+uId
jR7d6tYjkzfmrUtfi/scbb8L9F38nHfx86W+qZ9X5jfHut491aNbzfPRwjMy
Rt/HN3hL0+/Z9n9d49fzNMY2jHeUY+LdCe530Bc20x9494AbYA3vcuIScWyc
Z6t7qXycPsXb/IVSc9fY8i0NX0JHrnw59ddbxzueHDFvZDjyQ9rT1xbuM/d8
9po3Pfd87vzox1v3ov6xsuN5XPvxtsd/yAlgd672E/StT+13S+fKXWFT9eia
uCZjXRfGyRiJ7djfbBvuyrz/uatyh+B9Tb75pVLfkFPVowM3Xy41v0DsxJa6
Q9RRRy5iNfdpc8sTlamn3Rr62tb62yT9ET8kH86bn5w930b5drtCqe9/5MXf
ScfaP+0m2dcr2tGGfuiD+fJNlnw67zVyCcjn+zvYkX9gjIy1m/Nm/v1sS5vt
1LEeS7turBnxkDs63xKIz+RRkNvqOy31n2+tw+7PpeZU+IbM2tMXbxn06Ja3
Hpl8zhR9qq99TrHf10p9OxG3ydOQByf38qryQteKPM9Y9Qv1Ad5SE11D8jTI
vNHus19yO68pX6c9dhPtj37JHXH++BaylmXOJDKxipjFd6i/lPr9Y8VSczvI
5H/I7/DdgtzL68qLtMduJ/eSXBDfRvgWwH2lhX6xs74xTTv29CHtyL28oTzN
/d9FH5jufvZXP926JvoD6zNDmTsSfIZ1fy3Vz/hd8izIg9XP1AfZw13dx1nu
8wD1s6zb1v3itx5WxrfJCYED3BPgj7jW1D9sm9XVsXfgN/eGLfVBsB8/nK2v
sUfkmrDrof2jtqF+tm1Y61bu0RzXfqD6Oda96T6xho8pkxN7U5m6v5X6DWml
UvNnyEPUI1P3Vqm5DmLUPGW+y7ylfLW/s8jfos3u9kl5vjLvIt5axL1PHAf2
5OeQyaXwnnvQNfnEOuy4E5O/4x32hH11Uo+uean1yNy3yfPR14H2iUy/5Fl4
R/HmIsfHW79NqRyZfBL5O+4IvdSjI27w1uJtzxuN/B8y7zLygfS7o/0j36P9
M7ZhvE84f/qe7jpQfk55vuvNHpFH5F7NPZy84tul5hjfVua+Qz3f3paxvECZ
szHCtSUHNlt/I++IvLN6ZOoW2oYzyB2fu3p/dQvti5zkO6XmbLnPvui5Je82
1/VhbIyLuxn12J1Uah4Tu5baI9PmHfslx8c9lP9dWFs9unX8LX6nhTaLtPsf
QTZ00g==
              "]]]}, {}, {}, {}, {}}, 
          {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
           LineBox[CompressedData["
1:eJwt0UsoZXEAx/F7B+P9fhsjj4aQPNKIWViwsJuSnVmZlCSXjBWJUGJrZcHC
TsmOndQkhYwViZia2FpZsJDPP7P49O3XObfzP+dWDMR6R6ORSGSOJT7zSDur
lPFCNxuEe5/oZI0PPNPFOnGkuKlPd4inzv6lf0ggye7VbT6SbffrLol02At6
F+4NZ7CH9Dfl1NjjekoyzfaUXoRn89We1WtSabVn9Io02qLv73tDenhXe15v
yaDWntAzMsMz7WE9JItP9qAehLNTbY/pCTl8sWN6TC6V9ogekUe9Pann5Iff
2D90jwJe6WGTQlpcn9ZLqii2f+o+RXyzF/VvuMYDTaxQEr656991K5ydexpZ
ppR/NPz//98AinMzog==
            "]]}}], {}}},
      DisplayFunction->Identity,
      ImagePadding->{{2.842170943040401*^-14, 1.}, {1., 
       4.263256414560601*^-14}}], {192., -119.7}, 
     ImageScaled[{0.5, 0.5}], {360., 228.00000000000003}], InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[0]], FaceForm[None], 
        RectangleBox[{-1, -0.5}, {1, 0.5}], DiskBox[{0.5, 0.3}, 0.6]}, 
       {EdgeForm[{RGBColor[0, 0, 1], Thickness[0.02]}], FaceForm[None], 
        RectangleBox[{-0.09999999999999998, -0.3}, {1, 0.5}]}, {
        GraphicsComplexBox[CompressedData["
1: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

         "], {{
           {RGBColor[0.88, 1, 0.88], AbsoluteThickness[1.6], Opacity[1], 
            EdgeForm[None], GraphicsGroupBox[PolygonBox[CompressedData["
1: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
pU+6/uAnmAtuUz6n8SN2zXae9DfPMbClDRgNZoKp4CbYCLYNtXy+dWDp846L
/II69dhx9l/QrnupuLrQtQIn6RfcBFepu1xf4t7bUftFtnna7xjgfF5xTuAV
OApmgZ9gLjgLRwdXwUOwcIjllBHPwVjuOsPEUvQjxdg3XXM4+lLrl9iGcRc7
9nLHuE5sBF/7iodg7mniHljYT3xe7pwW29dxtn3P9jP0iccto264/XxoX/TN
GB+5ZuBoK3Gesl7iM23A6Bn2B+5jv8I2o8TXf+mfvIWIybw1wEbyKOQieAPv
VGo9b6Gmpb5D8efPLaf9F7ajPXESXOatRcyH8zbeRPyl3z0di3F+7ljUMR7v
cfCOtzJYzVsXzL1Rnbc1OM17qZXllDUrtYx80M7K2KHzrvlaG/qn7+Z+y+fO
gTGpa+2c+QbmDf7SvqX9oNPXraW+7dcr9b6Bzl2FnBX4T/6JXBD3kG+0x442
rD9rv67237rOXbVt4/6MUqYP+uI+M8b26yqfoN0drgXfyFuJe8h31mPX1vl8
41jUY7eP+8la7Gbb71zDk/QF1p/7DGO0d6yT3Zsvtfte+XvXkzwVuYktS70H
obezHJ063lzcfcjJ3VVq/mKjUu8+40qN89RjB0ZwX8Juf+3RacO7mHsUuY1x
jrGl5ZRtaHkP54EtdeAvvkuOA98mf0VeYwfLuYcVv22E39VTvZ3f2tO14x5D
zo67GXd17hvkKrjn0O9B9o++kra0Idd4mmeI9b+71HzKFqXej9A7WI5OHfev
e0u9g8HRV3FNyYnw7Weqt3cf0Kmb4P7hJ2ep876eoE7dxFLzrawb90L0wxxr
Fec20TrsuEOS3+E+Sa6SnA4+xr0SndwC9eSDNlCmzequA2uwo21pQ3vum+RK
wAU4Onlf1pZ13dk1Rj9SG+rXKhXHeVuCmzPVySM+UOpdkDwfd1byJtzl4Ohr
e+bJ+W5iOWXr+03r+F3nOUe+l/vv5FLzTpPV79f+PNucb7+7a0M960AZdYxH
Ppa7Kjlj7r28dcFT+AXG6IdLzW1tWuq9GJ18FG1pt7Hfx3eSNyO2kc/Cb/sb
s3d1HNocbf/03VR77GgztdQ4yDoMUCd/Rb6X3Pdmpd7H0Y+xHH1D15oc2bal
3sfRuZM/pk7dI6XmyH5a6r0dnRzdI+rUkSffxLM51Xkwp0HWcf/nLUwO7mfK
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
              "]]]}, {}, {}, {}, {}}, 
          {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
           LineBox[CompressedData["
1:eJwt0s0r5HEAx/GxWM/rYT0/LJNSIm2bw5aE0CBJThIlByUakpsUod2VP8Bt
T5KS5CRRTkokyU2KKHbzB+xtvb7l8Jr3fGam+U3f30THpgfiCZFIZJUNsin1
wpAekkOm3as75JJix3SLPP7Twm8+U+f9ST0nP3yH3a97FPDJ7tNdCmmzl/SB
KI32nN5QTa09oWcUhWvaA7pPcWAP6gGVdNu/9A9f6LBX9IkKyu1hPQrPabDj
ekkZyXanboazoNle0DtKaLLn9ZZwdq0eFvWeD1TZo3pCIr32ur6SxFd7Rq/C
taixx/WUj9TbU3oRzjr8ZntEj0nlmz2r16TRbi/rI+n02Gv6l4zwGbtbt8O9
pMv+qS9kEbN/6HO4N/zj+/v/4Q080DOF
            "]]}}], {}}},
      DisplayFunction->Identity,
      ImagePadding->{{2.842170943040401*^-14, 1.}, {1., 
       4.263256414560601*^-14}}], {576., -119.7}, 
     ImageScaled[{0.5, 0.5}], {360., 228.00000000000003}]}, {}},
  ContentSelectable->True,
  ImageSize->{
    UpTo[600], 
    UpTo[360]},
  PlotRangePadding->{6, 5}]], "Output",
 CellChangeTimes->{
  3.8396463659181805`*^9, {3.8396470948602495`*^9, 3.8396471035534477`*^9}},
 CellLabel->
  "Out[106]=",ExpressionUUID->"b5246670-18fc-48d6-808f-0dddcb9f780d"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.8396495509523454`*^9},ExpressionUUID->"9c3b158b-d379-4210-84e2-\
61cda25f3953"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "reflCenter", ",", "reflNormal", ",", "lightDir", ",", "pltLighting", ",",
      "reflPeakPt", ",", "recvPt", ",", "\[IndentingNewLine]", "\t", 
     "bounceDir", ",", "outDir", ",", "minorAxis", ",", "majorAxis", ",", 
     "intsMin", ",", "intsMax", ",", "intsCenter", ",", "\[IndentingNewLine]",
      "\t", "uaxis", ",", "vaxis", ",", "coneApertureNormal", ",", 
     "reflColorFunc"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"reflColorFunc", "[", 
     RowBox[{
     "shadingPt_", ",", "lightDir_", ",", "eyePt_", ",", "normalDir_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"viewDir", ",", "halfDir", ",", "noh", ",", "m"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", "=", "0.1"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"viewDir", "=", 
        RowBox[{"Normalize", "[", 
         RowBox[{"eyePt", "-", "shadingPt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"halfDir", "=", 
        RowBox[{"Normalize", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"viewDir", "+", "lightDir"}], ")"}], "/", "2"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"noh", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{"normalDir", ",", "halfDir"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gDGGX", "[", 
         RowBox[{"0.1", ",", "noh"}], "]"}], "/", "30"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"reflCenter", "=", 
     RowBox[{"{", 
      RowBox[{"reflCenterX", ",", "reflCenterY", ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"reflNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "reflNormalY", ",", "reflNormalZ"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"lightDir", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"{", 
       RowBox[{"lightDirX", ",", "lightDirY", ",", "lightDirZ"}], "}"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"pltLighting", "=", 
       RowBox[{"{", 
        RowBox[{"\"\<Directional\>\"", ",", "White", ",", 
         RowBox[{"{", 
          RowBox[{"testLightDir", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"recvPt", "=", 
     RowBox[{"{", 
      RowBox[{"recvPtX", ",", "recvPtY", ",", "0"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"reflPeakPt", "=", 
     RowBox[{"gCalcPeakPoint", "[", 
      RowBox[{"reflNormal", ",", "reflCenter", ",", 
       RowBox[{"-", "lightDir"}], ",", "recvPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"bounceDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"outDir", "=", 
     RowBox[{"gReflectVector", "[", 
      RowBox[{
       RowBox[{"-", "bounceDir"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"uv", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"vaxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"recvPt", "-", "reflPeakPt"}], ",", "reflNormal"}], "]"}]}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"uaxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"reflNormal", ",", "vaxis"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"approximate", " ", "intersection", " ", "area"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"minorAxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"reflNormal", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}]}], ";", "\n", 
    "   ", 
    RowBox[{"majorAxis", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{"minorAxis", ",", "reflNormal"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsMin", "=", 
     RowBox[{"reflPeakPt", "+", 
      RowBox[{"majorAxis", "*", 
       RowBox[{"(", 
        RowBox[{"samplingRadius", "+", "intsCenterXOffset"}], ")"}]}], "-", 
      RowBox[{"minorAxis", "*", 
       RowBox[{"(", 
        RowBox[{"0.3", "+", "intsCenterYOffset"}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsMax", "=", 
     RowBox[{"reflPeakPt", "-", 
      RowBox[{"majorAxis", "*", "samplingRadius"}], "+", 
      RowBox[{"minorAxis", "*", "samplingRadius"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"intsCenter", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"intsMin", "+", "intsMax"}], ")"}], "/", "2"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"cone", " ", "aperture"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"coneApertureNormal", "=", 
     RowBox[{"Normalize", "@", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"recvPt", "-", "reflPeakPt"}], ",", "vaxis"}], "]"}]}]}], ";",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"pltLighting", "=", "Automatic"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"sampling", " ", "disk"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pltCircle3D", "[", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "reflPeakPt"}], ",", 
              RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.5"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}]}], "|>"}], 
            "\[IndentingNewLine]", "\t", "]"}], "&"}], "[", 
          RowBox[{"<|", 
           RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], "|>"}], 
          "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pltCircle3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"reflPeakPt", "-", 
               RowBox[{"reflNormal", "*", "0.05"}]}]}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "2"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}]}], "|>"}], 
           "\[IndentingNewLine]", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], ",", 
           RowBox[{"\"\<\[Phi]1\>\"", "->", "diskPhi1"}], ",", 
           RowBox[{"\"\<\[Phi]2\>\"", "->", "diskPhi2"}]}], "|>"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"u", "-", 
          RowBox[{"v", " ", "axis"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "uaxis"}]}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "1"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", "vaxis"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "1"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"cone", " ", "aperture"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pltArc3DDirect", "[", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", "recvPt"}], ",", 
               RowBox[{"\"\<normal\>\"", "\[Rule]", "coneApertureNormal"}], 
               ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "0.3"}], ",", 
               RowBox[{"\"\<style\>\"", "\[Rule]", "Dashed"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<\[Phi]1\>\"", "\[Rule]", "#\[Phi]1"}], ",", 
               RowBox[{"\"\<\[Phi]2\>\"", "\[Rule]", "#\[Phi]2"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
             "\[IndentingNewLine]", "]"}], "&"}], "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<radius\>\"", "\[Rule]", "samplingRadius"}], ",", 
             RowBox[{"\"\<\[Phi]1\>\"", "\[Rule]", "apertPhi1"}], ",", 
             RowBox[{"\"\<\[Phi]2\>\"", "->", "apertPhi2"}]}], "|>"}], "]"}], 
          ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", "receiver", "*)"}], "\[IndentingNewLine]", "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRectLine3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "reflector", "*)"}], "\[IndentingNewLine]", "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"pltRect3D", "[", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "#centerPt"}], ",", 
             RowBox[{"\"\<normal\>\"", "\[Rule]", "reflNormal"}], ",", 
             RowBox[{"\"\<plotPts\>\"", "\[Rule]", "100"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<majorAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<majorRadius\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"\"\<minorRadius\>\"", "\[Rule]", "0.5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                RowBox[{"reflColorFunc", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "lightDir", 
                  ",", "recvPt", ",", "reflNormal"}], "]"}]}], "]"}]}]}], 
            "|>"}], "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<centerPt\>\"", "\[Rule]", "reflCenter"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"light", " ", "arrow"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"reflPeakPt", "+", 
               RowBox[{"lightDir", "*", "1.5"}]}]}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "lightDir"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "1.5"}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.3"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"one", " ", "bounce", " ", "arrow"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"Normalize", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<length\>\"", "\[Rule]", 
              RowBox[{"Norm", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}]}], ",", 
             RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"out", " ", "dir", " ", "arrow"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pltArrow3D", "[", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<origin\>\"", "\[Rule]", "recvPt"}], ",", 
               RowBox[{"\"\<dir\>\"", "\[Rule]", "outDir"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "2"}], ",", 
               RowBox[{"\"\<arrowPos\>\"", "\[Rule]", "0.8"}]}], "|>"}], 
             "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
           RowBox[{"<|", "|>"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"recv", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "recvPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"reflector", " ", "normal"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltArrow3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<dir\>\"", "\[Rule]", 
              RowBox[{"-", "reflNormal"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "0.6"}], ",", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.5"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Orange"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"recv", " ", "normal"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pltArrow3D", "[", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<origin\>\"", "\[Rule]", "recvPt"}], ",", 
               RowBox[{"\"\<dir\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "0.6"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.5"}], ",", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
             "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
           RowBox[{"<|", "|>"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"refl", " ", "peak", " ", "point"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pltPoint3D", "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<pos\>\"", "\[Rule]", "reflPeakPt"}], ",", 
             RowBox[{"\"\<size\>\"", "\[Rule]", "0.01"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Black"}]}], "|>"}], 
           "\[IndentingNewLine]", "  ", "]"}], "&"}], "[", 
         RowBox[{"<|", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "text", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Light\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"lightDir", "*", "1.65"}]}]}], "]"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<-i\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", "Red", 
              ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"lightDir", "*", "1.2"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.05"}], ",", "0", ",", 
               RowBox[{"-", "0.1"}]}], "}"}]}]}], "]"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<y\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              "White", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{"0.07", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<r\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", "Red", 
              ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{
              RowBox[{"Normalize", "[", 
               RowBox[{"recvPt", "-", "reflPeakPt"}], "]"}], "*", "0.5"}], 
             "+", 
             RowBox[{"{", 
              RowBox[{"0.1", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<o\>\"", ",", 
                RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
              ",", 
              RowBox[{"recvPt", "+", 
               RowBox[{"outDir", "*", "1.6"}], "+", 
               RowBox[{"{", 
                RowBox[{"0.1", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
           "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<x\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{"{", 
              RowBox[{"0.08", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\!\(\*SubscriptBox[\(n\), \(r\)]\)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
              "Orange", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "-", 
             RowBox[{"reflNormal", "*", "0.65"}]}]}], "]"}], "}"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{"{", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<\!\(\*SubscriptBox[\(n\), \(x\)]\)\>\"", ",", 
                RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", 
                "Red", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
              ",", 
              RowBox[{"recvPt", "+", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}], "*", "0.7"}]}]}], 
             "]"}], "}"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Rectangle R\\n(reflector)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.3"}], ",", "0", ",", "0.9"}], "}"}]}]}], "]"}],
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<receiver\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"recvPt", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "0.3"}]}], "}"}]}]}], "]"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<D\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Bold", ",", "Blue",
               ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0.55"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"OverBar", "[", "\"\<u\>\"", "]"}], ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Green", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "-", 
             RowBox[{"uaxis", "*", "0.5"}], "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0.05"}], "}"}]}]}], "]"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"OverBar", "[", "\"\<v\>\"", "]"}], ",", 
              RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Green", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], 
            ",", 
            RowBox[{"reflPeakPt", "+", 
             RowBox[{"vaxis", "*", "0.5"}], "+", 
             RowBox[{"{", 
              RowBox[{"0.05", ",", "0", ",", "0"}], "}"}]}]}], "]"}], "}"}], 
         "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"imgMinX", ",", 
           RowBox[{"imgMinX", "+", "imgSize"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"imgMinY", ",", 
           RowBox[{"imgMinY", "+", "imgSize"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"imgMinZ", ",", 
           RowBox[{"imgMinZ", "+", "imgSizeZ"}]}], "}"}]}], "}"}]}], ",", 
      "\n", "\t\t", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "2"}], ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
      "\t    ", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
      ",", "\[IndentingNewLine]", "\t    ", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"apertPhi1", ",", "0.351858"}], "}"}], ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"apertPhi2", ",", "0.942478"}], "}"}], ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskPhi1", ",", "2.50071"}], "}"}], ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diskPhi2", ",", "5.51664"}], "}"}], ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"coneRadius", ",", "0.442"}], "}"}], ",", "0.1", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflCenterX", ",", "0.814"}], "}"}], ",", "0", ",", "1.3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflCenterY", ",", "0.3"}], "}"}], ",", "0", ",", "1"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflNormalY", ",", "1."}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reflNormalZ", ",", "0.145"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"recvPtX", ",", "0.39"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"recvPtY", ",", 
       RowBox[{"-", "0.208"}]}], "}"}], ",", 
     RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirX", ",", 
       RowBox[{"-", "4.4"}]}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirY", ",", 
       RowBox[{"-", "2.38"}]}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightDirZ", ",", "3.54"}], "}"}], ",", "1", ",", "10"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinX", ",", 
       RowBox[{"-", "0.36"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinY", ",", 
       RowBox[{"-", "0.62"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgMinZ", ",", 
       RowBox[{"-", "0.19"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgSize", ",", "1.6"}], "}"}], ",", "1", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"imgSizeZ", ",", "2.005"}], "}"}], ",", "2", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"samplingRadius", ",", "0.45"}], "}"}], ",", "0.2", ",", 
     "1.5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsCenterWidthMultiply", ",", "1.0295"}], "}"}], ",", "0.9", 
     ",", "1.1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsCenterXOffset", ",", 
       RowBox[{"-", "0.018"}]}], "}"}], ",", 
     RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsCenterYOffset", ",", 
       RowBox[{"-", "0.062"}]}], "}"}], ",", 
     RowBox[{"-", "0.2"}], ",", "0.2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intsMinorRadius", ",", "0.4"}], "}"}], ",", "0.3", ",", 
     "0.5"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellLabel->
  "In[110]:=",ExpressionUUID->"2c80bb01-5f53-4344-85fd-b9fb883b1940"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`apertPhi1$$ = 
    0.351858, $CellContext`apertPhi2$$ = 0.942478, $CellContext`coneRadius$$ =
     0.442, $CellContext`diskPhi1$$ = 2.50071, $CellContext`diskPhi2$$ = 
    5.51664, $CellContext`imgMinX$$ = -0.36, $CellContext`imgMinY$$ = -0.62, \
$CellContext`imgMinZ$$ = -0.19, $CellContext`imgSize$$ = 
    1.6, $CellContext`imgSizeZ$$ = 
    2.005, $CellContext`intsCenterWidthMultiply$$ = 
    1.0295, $CellContext`intsCenterXOffset$$ = -0.018, \
$CellContext`intsCenterYOffset$$ = -0.062, $CellContext`intsMinorRadius$$ = 
    0.4, $CellContext`lightDirX$$ = -4.4, $CellContext`lightDirY$$ = -2.38, \
$CellContext`lightDirZ$$ = 3.54, $CellContext`recvPtX$$ = 
    0.39, $CellContext`recvPtY$$ = -0.208, $CellContext`reflCenterX$$ = 
    0.814, $CellContext`reflCenterY$$ = 0.3, $CellContext`reflNormalY$$ = 
    1., $CellContext`reflNormalZ$$ = 0.145, $CellContext`samplingRadius$$ = 
    0.45, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`apertPhi1$$], 0.351858}, 0, 2 Pi}, {{
       Hold[$CellContext`apertPhi2$$], 0.942478}, 0, 2 Pi}, {{
       Hold[$CellContext`diskPhi1$$], 2.50071}, 0, 2 Pi}, {{
       Hold[$CellContext`diskPhi2$$], 5.51664}, 0, 2 Pi}, {{
       Hold[$CellContext`coneRadius$$], 0.442}, 0.1, 1}, {{
       Hold[$CellContext`reflCenterX$$], 0.814}, 0, 1.3}, {{
       Hold[$CellContext`reflCenterY$$], 0.3}, 0, 1}, {{
       Hold[$CellContext`reflNormalY$$], 1.}, -1, 1}, {{
       Hold[$CellContext`reflNormalZ$$], 0.145}, -1, 1}, {{
       Hold[$CellContext`recvPtX$$], 0.39}, -1, 1}, {{
       Hold[$CellContext`recvPtY$$], -0.208}, -0.5, 0.5}, {{
       Hold[$CellContext`lightDirX$$], -4.4}, -5, 5}, {{
       Hold[$CellContext`lightDirY$$], -2.38}, -5, 5}, {{
       Hold[$CellContext`lightDirZ$$], 3.54}, 1, 10}, {{
       Hold[$CellContext`imgMinX$$], -0.36}, -2, 2}, {{
       Hold[$CellContext`imgMinY$$], -0.62}, -2, 2}, {{
       Hold[$CellContext`imgMinZ$$], -0.19}, -2, 2}, {{
       Hold[$CellContext`imgSize$$], 1.6}, 1, 5}, {{
       Hold[$CellContext`imgSizeZ$$], 2.005}, 2, 5}, {{
       Hold[$CellContext`samplingRadius$$], 0.45}, 0.2, 1.5}, {{
       Hold[$CellContext`intsCenterWidthMultiply$$], 1.0295}, 0.9, 1.1}, {{
       Hold[$CellContext`intsCenterXOffset$$], -0.018}, -0.1, 0.1}, {{
       Hold[$CellContext`intsCenterYOffset$$], -0.062}, -0.2, 0.2}, {{
       Hold[$CellContext`intsMinorRadius$$], 0.4}, 0.3, 0.5}}, 
    Typeset`size$$ = {518., {287., 293.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`apertPhi1$2273274$$ = 
    0, $CellContext`apertPhi2$2273275$$ = 0, $CellContext`diskPhi1$2273276$$ =
     0, $CellContext`diskPhi2$2273277$$ = 
    0, $CellContext`coneRadius$2273278$$ = 
    0, $CellContext`reflCenterX$2273279$$ = 
    0, $CellContext`reflCenterY$2273280$$ = 
    0, $CellContext`reflNormalY$2273281$$ = 
    0, $CellContext`reflNormalZ$2273282$$ = 
    0, $CellContext`recvPtX$2273283$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`apertPhi1$$ = 
        0.351858, $CellContext`apertPhi2$$ = 
        0.942478, $CellContext`coneRadius$$ = 0.442, $CellContext`diskPhi1$$ = 
        2.50071, $CellContext`diskPhi2$$ = 
        5.51664, $CellContext`imgMinX$$ = -0.36, $CellContext`imgMinY$$ = \
-0.62, $CellContext`imgMinZ$$ = -0.19, $CellContext`imgSize$$ = 
        1.6, $CellContext`imgSizeZ$$ = 
        2.005, $CellContext`intsCenterWidthMultiply$$ = 
        1.0295, $CellContext`intsCenterXOffset$$ = -0.018, \
$CellContext`intsCenterYOffset$$ = -0.062, $CellContext`intsMinorRadius$$ = 
        0.4, $CellContext`lightDirX$$ = -4.4, $CellContext`lightDirY$$ = \
-2.38, $CellContext`lightDirZ$$ = 3.54, $CellContext`recvPtX$$ = 
        0.39, $CellContext`recvPtY$$ = -0.208, $CellContext`reflCenterX$$ = 
        0.814, $CellContext`reflCenterY$$ = 0.3, $CellContext`reflNormalY$$ = 
        1., $CellContext`reflNormalZ$$ = 0.145, $CellContext`samplingRadius$$ = 
        0.45}, "ControllerVariables" :> {
        Hold[$CellContext`apertPhi1$$, $CellContext`apertPhi1$2273274$$, 0], 
        Hold[$CellContext`apertPhi2$$, $CellContext`apertPhi2$2273275$$, 0], 
        Hold[$CellContext`diskPhi1$$, $CellContext`diskPhi1$2273276$$, 0], 
        Hold[$CellContext`diskPhi2$$, $CellContext`diskPhi2$2273277$$, 0], 
        Hold[$CellContext`coneRadius$$, $CellContext`coneRadius$2273278$$, 0], 
        Hold[$CellContext`reflCenterX$$, $CellContext`reflCenterX$2273279$$, 
         0], 
        Hold[$CellContext`reflCenterY$$, $CellContext`reflCenterY$2273280$$, 
         0], 
        Hold[$CellContext`reflNormalY$$, $CellContext`reflNormalY$2273281$$, 
         0], 
        Hold[$CellContext`reflNormalZ$$, $CellContext`reflNormalZ$2273282$$, 
         0], 
        Hold[$CellContext`recvPtX$$, $CellContext`recvPtX$2273283$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`reflCenter = {$CellContext`reflCenterX$$, \
$CellContext`reflCenterY$$, 1}; $CellContext`reflNormal = 
        Normalize[{
          1, $CellContext`reflNormalY$$, $CellContext`reflNormalZ$$}]; \
$CellContext`lightDir = 
        Normalize[{$CellContext`lightDirX$$, $CellContext`lightDirY$$, \
$CellContext`lightDirZ$$}]; $CellContext`recvPt = {$CellContext`recvPtX$$, \
$CellContext`recvPtY$$, 0}; $CellContext`reflPeakPt = 
        gBRDF`gCalcPeakPoint[$CellContext`reflNormal, \
$CellContext`reflCenter, -$CellContext`lightDir, $CellContext`recvPt]; \
$CellContext`bounceDir = 
        Normalize[$CellContext`recvPt - $CellContext`reflPeakPt]; \
$CellContext`outDir = 
        gUtils`gReflectVector[-$CellContext`bounceDir, {0, 0, 
          1}]; $CellContext`vaxis = Normalize[
          
          Cross[$CellContext`recvPt - $CellContext`reflPeakPt, \
$CellContext`reflNormal]]; $CellContext`uaxis = Normalize[
          
          Cross[$CellContext`reflNormal, $CellContext`vaxis]]; \
$CellContext`minorAxis = Normalize[
          Cross[$CellContext`reflNormal, {0, 1, 0}]]; $CellContext`majorAxis = 
        Normalize[
          
          Cross[$CellContext`minorAxis, $CellContext`reflNormal]]; \
$CellContext`intsMin = $CellContext`reflPeakPt + $CellContext`majorAxis \
($CellContext`samplingRadius$$ + $CellContext`intsCenterXOffset$$) - \
$CellContext`minorAxis (
          0.3 + $CellContext`intsCenterYOffset$$); $CellContext`intsMax = \
$CellContext`reflPeakPt - $CellContext`majorAxis \
$CellContext`samplingRadius$$ + $CellContext`minorAxis \
$CellContext`samplingRadius$$; $CellContext`intsCenter = \
($CellContext`intsMin + $CellContext`intsMax)/
         2; $CellContext`coneApertureNormal = Normalize[
          
          Cross[$CellContext`recvPt - $CellContext`reflPeakPt, \
$CellContext`vaxis]]; $CellContext`pltLighting = Automatic; Show[{
          (gPlots3DEx`pltCircle3D[
           Association[
           "center" -> $CellContext`reflPeakPt - $CellContext`reflNormal 0.05,
             "normal" -> $CellContext`reflNormal, "radius" -> 0.5, 
            "thickness" -> 2, "color" -> Blue]]& )[
           Association[
           "radius" -> $CellContext`samplingRadius$$, 
            "\[Phi]1" -> $CellContext`diskPhi1$$, 
            "\[Phi]2" -> $CellContext`diskPhi2$$]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, "dir" -> -$CellContext`uaxis, 
            "color" -> Green, "length" -> 0.5, "arrowPos" -> 1]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, "dir" -> $CellContext`vaxis, 
            "color" -> Green, "length" -> 0.5, "arrowPos" -> 1]]& )[
           Association[]], 
          (gPlots3DEx`pltRectLine3D[
           Association[
           "center" -> {0, 0, 0}, "normal" -> {0, 0, 1}, 
            "majorAxis" -> {1, 0, 0}, "majorRadius" -> 1, "minorRadius" -> 
            0.5, "color" -> Black]]& )[
           Association[]], 
          (gPlots3DEx`pltRect3D[
           Association[
           "center" -> Slot["centerPt"], "normal" -> $CellContext`reflNormal, 
            "plotPts" -> 100, "majorAxis" -> {0, 1, 0}, "majorRadius" -> 1, 
            "minorRadius" -> 0.5, "colorFunc" -> 
            Function[{$CellContext`x, $CellContext`y, $CellContext`z}, 
              $CellContext`reflColorFunc[{$CellContext`x, $CellContext`y, \
$CellContext`z}, $CellContext`lightDir, $CellContext`recvPt, \
$CellContext`reflNormal]]]]& )[
           Association["centerPt" -> $CellContext`reflCenter]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt + $CellContext`lightDir 1.5, 
            "dir" -> -$CellContext`lightDir, "length" -> 1.5, "arrowPos" -> 
            0.3, "color" -> Red]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, "dir" -> 
            Normalize[$CellContext`recvPt - $CellContext`reflPeakPt], 
            "length" -> Norm[$CellContext`recvPt - $CellContext`reflPeakPt], 
            "arrowPos" -> 0.5, "color" -> Red]]& )[
           Association[]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`recvPt, "size" -> 0.01, "color" -> Black]]& )[
           Association[]], 
          (gPlots3DEx`pltArrow3D[
           Association[
           "origin" -> $CellContext`reflPeakPt, 
            "dir" -> -$CellContext`reflNormal, "length" -> 0.6, "thickness" -> 
            0.5, "color" -> Orange]]& )[
           Association[]], 
          (gPlots3DEx`pltPoint3D[
           Association[
           "pos" -> $CellContext`reflPeakPt, "size" -> 0.01, "color" -> 
            Black]]& )[
           Association[]], 
          Graphics3D[{
            Text[
             Style[
             "Light", FontSize -> 16, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + $CellContext`lightDir 
              1.65]}], 
          Graphics3D[{
            Text[
             Style[
             "-i", FontSize -> 16, Bold, Red, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + $CellContext`lightDir 
              1.2 + {-0.05, 0, -0.1}]}], 
          Graphics3D[{
            Text[
             Style[
             "y", FontSize -> 16, Bold, White, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {0.07, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "r", FontSize -> 16, Bold, Red, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + 
             Normalize[$CellContext`recvPt - $CellContext`reflPeakPt] 0.5 + {
              0.1, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "x", FontSize -> 16, Bold, FontFamily -> 
              "Times"], $CellContext`recvPt + {0.08, 0, 0}]}], 
          Graphics3D[{
            Text[
             Style[
             "\!\(\*SubscriptBox[\(n\), \(r\)]\)", FontSize -> 16, Bold, 
              Orange, FontFamily -> 
              "Times"], $CellContext`reflPeakPt - $CellContext`reflNormal 
             0.65]}], 
          Graphics3D[{
            Text[
             Style[
             "Rectangle R\n(reflector)", FontSize -> 16, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {-0.3, 0, 0.9}]}], 
          Graphics3D[{
            Text[
             Style[
             "receiver", FontSize -> 16, FontFamily -> 
              "Times"], $CellContext`recvPt + {0, 0, -0.3}]}], 
          Graphics3D[{
            Text[
             Style[
             "D", FontSize -> 16, Bold, Blue, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + {0, 0, 0.55}]}], 
          Graphics3D[{
            Text[
             Style[
              OverBar["u"], FontSize -> 16, Green, FontFamily -> 
              "Times"], $CellContext`reflPeakPt - $CellContext`uaxis 
             0.5 + {0, 0, 0.05}]}], 
          Graphics3D[{
            Text[
             Style[
              OverBar["v"], FontSize -> 16, Green, FontFamily -> 
              "Times"], $CellContext`reflPeakPt + $CellContext`vaxis 0.5 + {
              0.05, 0, 0}]}]}, 
         PlotRange -> {{$CellContext`imgMinX$$, $CellContext`imgMinX$$ + \
$CellContext`imgSize$$}, {$CellContext`imgMinY$$, $CellContext`imgMinY$$ + \
$CellContext`imgSize$$}, {$CellContext`imgMinZ$$, $CellContext`imgMinZ$$ + \
$CellContext`imgSizeZ$$}}, Axes -> False, Boxed -> False, 
         ViewPoint -> {0, -2, 1}, AxesLabel -> {"X", "Y", "Z"}, ImageSize -> 
         Large]), 
      "Specifications" :> {{{$CellContext`apertPhi1$$, 0.351858}, 0, 2 
         Pi}, {{$CellContext`apertPhi2$$, 0.942478}, 0, 2 
         Pi}, {{$CellContext`diskPhi1$$, 2.50071}, 0, 2 
         Pi}, {{$CellContext`diskPhi2$$, 5.51664}, 0, 2 
         Pi}, {{$CellContext`coneRadius$$, 0.442}, 0.1, 
         1}, {{$CellContext`reflCenterX$$, 0.814}, 0, 
         1.3}, {{$CellContext`reflCenterY$$, 0.3}, 0, 
         1}, {{$CellContext`reflNormalY$$, 1.}, -1, 
         1}, {{$CellContext`reflNormalZ$$, 0.145}, -1, 
         1}, {{$CellContext`recvPtX$$, 0.39}, -1, 
         1}, {{$CellContext`recvPtY$$, -0.208}, -0.5, 
         0.5}, {{$CellContext`lightDirX$$, -4.4}, -5, 
         5}, {{$CellContext`lightDirY$$, -2.38}, -5, 
         5}, {{$CellContext`lightDirZ$$, 3.54}, 1, 
         10}, {{$CellContext`imgMinX$$, -0.36}, -2, 
         2}, {{$CellContext`imgMinY$$, -0.62}, -2, 
         2}, {{$CellContext`imgMinZ$$, -0.19}, -2, 
         2}, {{$CellContext`imgSize$$, 1.6}, 1, 
         5}, {{$CellContext`imgSizeZ$$, 2.005}, 2, 
         5}, {{$CellContext`samplingRadius$$, 0.45}, 0.2, 
         1.5}, {{$CellContext`intsCenterWidthMultiply$$, 1.0295}, 0.9, 
         1.1}, {{$CellContext`intsCenterXOffset$$, -0.018}, -0.1, 
         0.1}, {{$CellContext`intsCenterYOffset$$, -0.062}, -0.2, 
         0.2}, {{$CellContext`intsMinorRadius$$, 0.4}, 0.3, 0.5}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{869., {316., 322.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8396496155400486`*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"c8d41538-6aa1-4f54-a5b4-b74e5b62f142"]
}, Open  ]]
},
WindowSize->{980, 683},
WindowMargins->{{138, Automatic}, {-98, Automatic}},
Magnification:>0.9 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2492, 52, 207, "Input",ExpressionUUID->"869dad65-2627-40c4-a516-a065be9f81e5"],
Cell[CellGroupData[{
Cell[3075, 76, 27818, 638, 1971, "Input",ExpressionUUID->"32509c09-4e03-4cf7-b0a4-9a78146cb38e"],
Cell[30896, 716, 14707, 286, 528, "Output",ExpressionUUID->"6a6fc7ed-34c6-40b7-a2b0-9f86efe71b7f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45640, 1007, 31945, 757, 2475, "Input",ExpressionUUID->"61d6c217-67ca-459c-81f4-23382bf91bc5"],
Cell[77588, 1766, 16138, 319, 656, "Output",ExpressionUUID->"42a799a0-352b-4985-b9f2-3c8f77be361c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93763, 2090, 5391, 121, 513, "Input",ExpressionUUID->"c7857d34-d240-432f-ba2e-2264d397a06b"],
Cell[99157, 2213, 543, 16, 47, "Output",ExpressionUUID->"04879840-9a06-4c0b-904a-a873c8ccdcae"],
Cell[99703, 2231, 2530, 48, 652, "Output",ExpressionUUID->"017ba4ff-d0b7-49fc-9cba-0d74708b5dbd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102270, 2284, 4816, 127, 493, "Input",ExpressionUUID->"9a27f70b-80df-408a-a262-6271b112fa2e"],
Cell[107089, 2413, 3322, 64, 360, "Output",ExpressionUUID->"18136361-c37f-42a5-bdf5-e79c24f8489e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110448, 2482, 6760, 161, 621, "Input",ExpressionUUID->"ee6a1a37-aed0-4f7a-b85e-72fb42133cae"],
Cell[117211, 2645, 5647, 101, 606, "Output",ExpressionUUID->"9783d85a-72b6-4be0-803c-13610beee193"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122895, 2751, 12245, 296, 1107, "Input",ExpressionUUID->"0100b804-fc93-4ef6-8c90-070b592b8b7c"],
Cell[135143, 3049, 5894, 106, 428, "Output",ExpressionUUID->"f0b8ae4b-dbff-479e-b1c5-d56d8538657e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141074, 3160, 14298, 319, 945, "Input",ExpressionUUID->"edc6d70f-c706-4c48-91d8-4ee05edf38ac"],
Cell[155375, 3481, 6074, 131, 580, "Output",ExpressionUUID->"7b1275f5-0384-4532-a5c6-1714a11e8353"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161486, 3617, 3076, 78, 369, "Input",ExpressionUUID->"b7f868ad-b527-418e-a966-151ae4a8f0fc"],
Cell[164565, 3697, 347, 9, 27, "Print",ExpressionUUID->"c4f91631-9e5c-419c-988a-0f79c0c5850a"],
Cell[164915, 3708, 2613, 51, 312, "Output",ExpressionUUID->"2d6de5d2-767b-40e9-a97e-4a30060fdfb1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167565, 3764, 7033, 183, 855, "Input",ExpressionUUID->"3722861b-cbfc-4ac3-a641-235a4f3c5cd3"],
Cell[174601, 3949, 30589, 515, 198, "Output",ExpressionUUID->"b5246670-18fc-48d6-808f-0dddcb9f780d"]
}, Open  ]],
Cell[205205, 4467, 130, 3, 26, "Input",ExpressionUUID->"9c3b158b-d379-4210-84e2-61cda25f3953"],
Cell[CellGroupData[{
Cell[205360, 4474, 31672, 761, 2601, "Input",ExpressionUUID->"2c80bb01-5f53-4344-85fd-b9fb883b1940"],
Cell[237035, 5237, 15009, 299, 656, "Output",ExpressionUUID->"c8d41538-6aa1-4f54-a5b4-b74e5b62f142"]
}, Open  ]]
}
]
*)

