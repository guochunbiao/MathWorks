(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42010,       1051]
NotebookOptionsPosition[     41262,       1030]
NotebookOutlinePosition[     41603,       1045]
CellTagsIndexPosition[     41560,       1042]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
      "\"\<Shared\>\""}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3DEx`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlotsEx`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "scene", ",", "camera", ",", "eyePt", ",", "lookPt", ",", "upDir", ",", 
     "fov", ",", "lights", ",", "prims", ",", "\[IndentingNewLine]", 
     "camBoundMin", ",", "camBoundMax", ",", "rasterToCam", ",", 
     "xformRasterToCamera", ",", "\[IndentingNewLine]", "gGetCameraSample", 
     ",", "\[IndentingNewLine]", "rayMaxDist", ",", "camRayo", ",", "camRayd",
      ",", "calcTriNormal", ",", "triIntersect", ",", "sceneIntersect", ",", 
     "\[IndentingNewLine]", "isect", ",", "getUVs", ",", "bsdf", ",", 
     "\[IndentingNewLine]", "imgSettings", ",", "resx", ",", "resy", ",", 
     "graphList", ",", "createPolyGraphs", ",", "imgTable", ",", 
     "\[IndentingNewLine]", "resultFlag", ",", "testRender"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"get", " ", "sampling", " ", "data", " ", "by", " ", "x"}], ",", 
    RowBox[{"y", " ", "and", " ", "dimension"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gGetCameraSample", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dim", ",", "startIdx", ",", "sampValue", ",", "data"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dim", "=", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sampValue", "=", "0.5"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "0"}], ",", 
           RowBox[{"i", "<", "dim"}], ",", 
           RowBox[{"i", "++"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"data", ",", 
             RowBox[{"dataArray", "[", 
              RowBox[{"[", 
               RowBox[{"startIdx", "+", "i"}], "]"}], "]"}]}], "]"}]}], "]"}],
          ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "+", "sampValue"}], ",", 
          RowBox[{"y", "+", "sampValue"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "data"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"load", " ", "scene", " ", "data"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scene", "=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"Import", "[", "\"\<cornell-tiny.scene\>\"", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"camera", "=", 
   RowBox[{
    RowBox[{"scene", "[", "\"\<camera\>\"", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eyePt", "=", 
   RowBox[{"camera", "[", "\"\<eyePt\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lookPt", "=", 
   RowBox[{"camera", "[", "\"\<lookPt\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"upDir", "=", 
   RowBox[{"camera", "[", "\"\<upDir\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fov", "=", 
   RowBox[{"camera", "[", "\"\<fov\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fov", "=", 
   RowBox[{
    FractionBox["fov", "180"], "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"camBoundMin", "=", 
   RowBox[{"camera", "[", "\"\<boundMin\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"camBoundMax", "=", 
   RowBox[{"camera", "[", "\"\<boundMax\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rasterToCam", "=", 
   RowBox[{"camera", "[", "\"\<rasterToCam\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lights", "=", 
   RowBox[{"scene", "[", "\"\<lights\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prims", "=", 
   RowBox[{"scene", "[", "\"\<prims\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imgSettings", "=", 
   RowBox[{
    RowBox[{"scene", "[", "\"\<image\>\"", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resx", "=", 
   RowBox[{"imgSettings", "[", "\"\<resx\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resy", "=", 
   RowBox[{"imgSettings", "[", "\"\<resy\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Assert", "[", 
    RowBox[{
     RowBox[{"resx", ">", "0"}], "&&", 
     RowBox[{"resy", ">", "0"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "transform", " ", "raster", " ", "point", " ", "to", " ", "world", " ", 
    "point"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"xformRasterToCamera", "[", "rasterPt_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "worldPt", ",", "m", ",", "x", ",", "y", ",", "z", ",", "xp", ",", 
        "yp", ",", "zp", ",", "wp", ",", "dirRHS"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", "=", "rasterToCam"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{"rasterPt", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"y", "=", 
        RowBox[{"rasterPt", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"z", "=", "0"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "  ", 
       RowBox[{"xp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", "x"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", "y"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "*", "z"}], "+", 
         RowBox[{
          RowBox[{"m", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"yp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", "x"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", "y"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "*", "z"}], "+", 
         RowBox[{
          RowBox[{"m", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"zp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", "x"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", "y"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "*", "z"}], "+", 
         RowBox[{
          RowBox[{"m", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"wp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", "x"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", "y"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "*", "z"}], "+", 
         RowBox[{
          RowBox[{"m", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dirRHS", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xp", ",", "zp", ",", "yp"}], "}"}], "/", "wp"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Normalize", "@", "dirRHS"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"generate", " ", "ray"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generateRayDifferential", "[", "pixel_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"px", ",", "py", ",", "sampRasterPt", ",", "sampDir"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"px", "=", 
        RowBox[{"pixel", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"py", "=", 
        RowBox[{"pixel", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"sampRasterPt", "=", 
        RowBox[{"gGetCameraSample", "[", 
         RowBox[{"px", ",", "py"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sampDir", "=", 
        RowBox[{"xformRasterToCamera", "[", "sampRasterPt", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Normalize", "@", "sampDir"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getUVs", "[", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Triangle", "::", "Intersect"}], " ", "cross", " ", "op", " ", 
    "is", " ", "changed", " ", "to", " ", "RHS"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calcTriNormal", "[", "tri_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dp02", ",", "dp12", ",", "n", ",", "uv", ",", "duv02", ",", "duv12", 
        ",", "determinant", ",", "degenerateUV", ",", "invdet", ",", 
        "\[IndentingNewLine]", "\t", "dpdu", ",", "dpdv"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dp02", "=", 
        RowBox[{
         RowBox[{"tri", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", 
         RowBox[{"tri", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dp12", "=", 
        RowBox[{
         RowBox[{"tri", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", 
         RowBox[{"tri", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Normalize", "@", 
         RowBox[{"Cross", "[", 
          RowBox[{"dp12", ",", "dp02"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"calculate", " ", "dpdu"}], ",", " ", "dpdv"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"uv", "=", 
        RowBox[{"getUVs", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"duv02", "=", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", 
         RowBox[{"uv", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"duv12", "=", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", 
         RowBox[{"uv", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"determinant", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"duv02", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"duv12", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"duv02", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", 
          RowBox[{"duv12", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"degenerateUV", "=", 
        RowBox[{"determinant", "<", "0.000001"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Assert", 
        RowBox[{"(", 
         RowBox[{"!", "degenerateUV"}], ")"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"invdet", "=", 
        RowBox[{"1", "/", "determinant"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dpdu", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"duv12", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", "dp02"}], "-", 
           RowBox[{
            RowBox[{"duv02", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", "dp12"}]}], ")"}], "*", 
         "invdet"}]}], ";", "\n", "\t", 
       RowBox[{"dpdv", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"duv12", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "*", "dp02"}], "+", 
           RowBox[{
            RowBox[{"duv02", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", "dp12"}]}], ")"}], "*", 
         "invdet"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"n", ",", "dpdu", ",", "dpdv"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rayMaxDist", "=", "10000"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Triangle", "::", "Intersect"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"triIntersect", "[", 
     RowBox[{"ray_", ",", "tri_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "rayo", ",", "rayd", ",", "R", ",", "L", ",", "d", ",", "curve", ",", 
        "t", ",", "pt"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rayo", "=", 
        RowBox[{"ray", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rayd", "=", 
        RowBox[{"ray", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"R", "=", 
        RowBox[{"Triangle", "[", "tri", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"L", "=", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{"rayo", ",", 
           RowBox[{"rayo", "+", 
            RowBox[{"rayd", "*", "rayMaxDist"}]}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"RegionDistance", "[", "R", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"curve", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "t"}], ")"}], " ", 
          RowBox[{"L", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", 
         RowBox[{"t", " ", 
          RowBox[{"L", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pt", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"Check", "[", 
          RowBox[{
           RowBox[{"curve", "/.", 
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"d", "[", "curve", "]"}], "\[Equal]", "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
              RowBox[{"Method", "\[Rule]", "\"\<Secant\>\""}]}], "]"}]}], ",",
            "\[IndentingNewLine]", "\"\<NaN\>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FindRoot", "::", "lstol"}], ",", 
             RowBox[{"FindRoot", "::", "jsing"}], ",", 
             RowBox[{"FindRoot", "::", "cvmit"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "pt"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Scene", "::", "Intersect"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sceneIntersect", "[", "ray_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "rayo", ",", "rayd", ",", "prim", ",", "tri", ",", "dist", ",", 
        "triInts", ",", "minDist", ",", "minIntsPt", ",", 
        "\[IndentingNewLine]", "minPrim", ",", "minTri", ",", 
        "\[IndentingNewLine]", "minNormal", ",", "dpdu", ",", "dpdv", ",", 
        "material"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rayo", "=", 
        RowBox[{"ray", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rayd", "=", 
        RowBox[{"ray", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"minDist", "=", "rayMaxDist"}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"minPrim", "=", "\"\<NaN\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"minTri", "=", "\"\<NaN\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"minIntsPt", "=", "\"\<NaN\>\""}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "prims", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"prim", "=", 
           RowBox[{"prims", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tri", "=", 
           RowBox[{"gAssocData", "[", 
            RowBox[{"prim", ",", "\"\<tri\>\""}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"triInts", "=", 
           RowBox[{"triIntersect", "[", 
            RowBox[{"ray", ",", "tri"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"triInts", "\[Equal]", "\"\<NaN\>\""}], ",", 
            RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Assert", "[", 
           RowBox[{
            RowBox[{"Length", "[", "triInts", "]"}], "\[Equal]", "3"}], "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"dist", "=", 
           RowBox[{"Norm", "[", 
            RowBox[{"triInts", "-", "rayo"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"dist", "\[GreaterEqual]", "minDist"}], ",", 
            RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"minPrim", "=", "prim"}], ";", "\[IndentingNewLine]", 
          RowBox[{"minDist", "=", "dist"}], ";", "\[IndentingNewLine]", 
          RowBox[{"minTri", "=", "tri"}], ";", "\[IndentingNewLine]", 
          RowBox[{"minIntsPt", "=", "triInts"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"minNormal", ",", "dpdu", ",", "dpdv"}], "}"}], "=", 
        RowBox[{"calcTriNormal", "[", "minTri", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"material", "=", 
        RowBox[{"gAssocData", "[", 
         RowBox[{"minPrim", ",", "\"\<material\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "result", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<p\>\"", "\[Rule]", "minIntsPt"}], ",", 
         RowBox[{"\"\<n\>\"", "\[Rule]", "minNormal"}], ",", 
         RowBox[{"\"\<wo\>\"", "\[Rule]", 
          RowBox[{"-", "rayd"}]}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"\"\<dpdu\>\"", "\[Rule]", "dpdu"}], ",", 
         RowBox[{"\"\<dpdv\>\"", "\[Rule]", "dpdv"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"\"\<tri\>\"", "\[Rule]", "minTri"}], ",", 
         RowBox[{"\"\<material\>\"", "\[Rule]", "material"}]}], "|>"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"BSDF", "::", "BSDF"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"constructBSDF", "[", 
     RowBox[{"si_", ",", "eta_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ns", ",", "ss", ",", "ts"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ns", "=", 
        RowBox[{"si", "[", "\"\<n\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ss", "=", 
        RowBox[{"Normalize", "@", 
         RowBox[{"si", "[", "\"\<dpdu\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ts", "=", 
        RowBox[{"Cross", "[", 
         RowBox[{"ss", ",", "ns"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<eta\>\"", "\[Rule]", "eta"}], ",", 
         RowBox[{"\"\<ns\>\"", "\[Rule]", "ns"}], ",", 
         RowBox[{"\"\<ng\>\"", "\[Rule]", 
          RowBox[{"si", "[", "\"\<n\>\"", "]"}]}], ",", 
         RowBox[{"\"\<ss\>\"", "\[Rule]", "ss"}], ",", 
         RowBox[{"\"\<ts\>\"", "\[Rule]", "ts"}]}], "|>"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"geometry", " ", "plot", " ", "graph"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"graphList", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"createPolyGraphs", "[", "elems_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "elem", ",", "tri", ",", "mat", ",", "Kd", ",", "sigma"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "elems", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"elem", "=", 
           RowBox[{"elems", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tri", "=", 
           RowBox[{"gAssocData", "[", 
            RowBox[{"elem", ",", "\"\<tri\>\""}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"mat", "=", 
           RowBox[{"gAssocData", "[", 
            RowBox[{"elem", ",", "\"\<material\>\""}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Kd", "=", 
           RowBox[{"gAssocData", "[", 
            RowBox[{"mat", ",", "\"\<Kd\>\""}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sigma", "=", 
           RowBox[{"gAssocData", "[", 
            RowBox[{"mat", ",", "\"\<sigma\>\""}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"graphList", ",", 
            RowBox[{"RGBColor", "[", "Kd", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"graphList", ",", 
            RowBox[{"Polygon", "[", "tri", "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"createPolyGraphs", "[", "lights", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"createPolyGraphs", "[", "prims", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"creating", " ", "image", " ", "table"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imgTable", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"1", ",", "resx", ",", "resy"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "resx"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "resy"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"imgTable", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{"RGBColor", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "+", "j"}], ")"}], "*", "0.01"}], ",", "0", ",", 
           "0"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testRender", ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "resx"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "resy"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"imgTable", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}], "=", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "+", "j"}], ")"}], "*", "0.01"}], ",", "0"}], 
              "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"resultFlag", "=", "False"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Show", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"resultFlag", ",", 
          RowBox[{"ArrayPlot", "[", "imgTable", "]"}], ",", 
          RowBox[{"Graphics3D", "[", "graphList", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Lighting", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Boxed", "\[Rule]", "False"}], ",", " ", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"ViewVector", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"eyePt", ",", "lookPt"}], "}"}]}], ",", 
        RowBox[{"ViewVertical", "\[Rule]", "upDir"}], ",", 
        RowBox[{"ViewAngle", "\[Rule]", "fov"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Result\>\"", ",", 
        RowBox[{"resultFlag", "=", 
         RowBox[{"!", "resultFlag"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Start\>\"", ",", 
        RowBox[{"testRender", "[", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"MatteMaterial", "::", "ComputeScatteringFunctions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"computeMaterial", "[", "si_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bsdf", ",", "material", ",", "r", ",", "sig"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bsdf", "=", 
        RowBox[{"constructBSDF", "[", 
         RowBox[{"si", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"material", "=", 
        RowBox[{"si", "[", "\"\<material\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"material", "[", "\"\<Kd\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sig", "=", 
        RowBox[{"material", "[", "\"\<sigma\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sig", "=", 
        RowBox[{"Clip", "[", 
         RowBox[{"sig", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "90"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"not", " ", "black"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Assert", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], "||", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", "0"}], "||", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", "0"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Assert", "[", 
        RowBox[{"sig", "\[Equal]", "0"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bsdf", "[", "\"\<bxdfs0\>\"", "]"}], "=", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<LambertianReflection\>\""}],
           ",", 
          RowBox[{"\"\<R\>\"", "\[Rule]", "r"}]}], "|>"}]}], ";", 
       "\[IndentingNewLine]", "bsdf"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"camRayo", "=", "eyePt"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"camRayd", "=", 
   RowBox[{"generateRayDifferential", "[", 
    RowBox[{"{", 
     RowBox[{"80", ",", "61"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"isect", "=", 
  RowBox[{"sceneIntersect", "[", 
   RowBox[{"{", 
    RowBox[{"camRayo", ",", "camRayd"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"computeMaterial", "[", "isect", "]"}]}], "Input",
 CellChangeTimes->{{3.837654122022234*^9, 3.8376541560065136`*^9}, {
   3.8376541863354316`*^9, 3.83765418654235*^9}, {3.8376590183229375`*^9, 
   3.837659109872554*^9}, {3.83765937564216*^9, 3.8376593794884515`*^9}, {
   3.8376595373163424`*^9, 3.83765964152796*^9}, {3.83765967686572*^9, 
   3.837659690036155*^9}, {3.837659721289977*^9, 3.837659723736927*^9}, {
   3.8376597651952887`*^9, 3.837659844473301*^9}, {3.837659893449835*^9, 
   3.837660027961242*^9}, {3.8376601136188393`*^9, 3.8376601809844074`*^9}, {
   3.8376644806597033`*^9, 3.837664521170023*^9}, {3.8376801884179153`*^9, 
   3.8376802184893236`*^9}, {3.8377411596379232`*^9, 
   3.8377411606134424`*^9}, {3.8377411911816783`*^9, 3.837741294776919*^9}, {
   3.837741357945646*^9, 3.8377413770301204`*^9}, {3.8377414276525593`*^9, 
   3.837741542348942*^9}, {3.837741675197055*^9, 3.837741790654489*^9}, {
   3.8377418337966876`*^9, 3.83774198147711*^9}, {3.837742011940463*^9, 
   3.8377420488205166`*^9}, {3.837742105698755*^9, 3.8377421439968605`*^9}, {
   3.8377428149393377`*^9, 3.837742820026168*^9}, 3.8377428551311474`*^9, {
   3.8377431779490232`*^9, 3.8377431915878477`*^9}, {3.837743366552213*^9, 
   3.8377434459064655`*^9}, {3.837745412773281*^9, 3.837745437225678*^9}, 
   3.8377457441144023`*^9, {3.837746243728445*^9, 3.837746250311763*^9}, {
   3.8377463513715196`*^9, 3.837746392231592*^9}, {3.837746429135024*^9, 
   3.8377464660089693`*^9}, {3.837746703062667*^9, 3.8377469641453753`*^9}, {
   3.8377470004234433`*^9, 3.837747073105345*^9}, {3.83774729804999*^9, 
   3.837747338150365*^9}, {3.837747506385109*^9, 3.8377476477994967`*^9}, {
   3.837747744222701*^9, 3.8377477633895445`*^9}, {3.8377478567018805`*^9, 
   3.837747856772798*^9}, {3.8377478983527155`*^9, 3.837747935317585*^9}, {
   3.837751929874689*^9, 3.837751937615461*^9}, {3.8377525810007973`*^9, 
   3.8377526303751087`*^9}, {3.8377531196552615`*^9, 3.837753154416168*^9}, {
   3.8377533787178555`*^9, 3.8377535092870703`*^9}, {3.8377535719986815`*^9, 
   3.8377537241677876`*^9}, {3.837753778801285*^9, 3.8377538178323*^9}, {
   3.837753859304861*^9, 3.8377540783924513`*^9}, {3.8377541150245886`*^9, 
   3.8377541168545218`*^9}, {3.8377542952216883`*^9, 3.837754317407643*^9}, {
   3.837754600247965*^9, 3.8377546415329914`*^9}, {3.837754746750693*^9, 
   3.8377547791917524`*^9}, {3.837759759772126*^9, 3.837759829817941*^9}, {
   3.8378092198177643`*^9, 3.8378092737704487`*^9}, {3.8378093277955637`*^9, 
   3.837809403432517*^9}, {3.837809434687477*^9, 3.8378094410722427`*^9}, {
   3.8378095107594147`*^9, 3.8378096401463985`*^9}, {3.837809728480542*^9, 
   3.837809764233906*^9}, {3.837809811936705*^9, 3.837809825472486*^9}, {
   3.837809953201628*^9, 3.83780999703165*^9}, {3.8378104264770436`*^9, 
   3.837810527665268*^9}, {3.837810581193096*^9, 3.837810595984208*^9}, {
   3.8378106809708805`*^9, 3.8378106978772535`*^9}, {3.83781075349125*^9, 
   3.8378107822764206`*^9}, {3.8378108184218016`*^9, 
   3.8378109730123663`*^9}, {3.8378110794444466`*^9, 3.837811112996643*^9}, {
   3.837812607179533*^9, 3.837812750050412*^9}, {3.8378131172980022`*^9, 
   3.837813146633501*^9}, {3.837813215945509*^9, 3.837813246291735*^9}, {
   3.8378133867038665`*^9, 3.8378136493436966`*^9}, {3.8378140861243486`*^9, 
   3.8378142501456337`*^9}, {3.8378142949194827`*^9, 3.837814412581587*^9}, {
   3.837815086025359*^9, 3.8378150862752924`*^9}, {3.8378151255204754`*^9, 
   3.837815162723563*^9}, {3.8378152526646643`*^9, 3.837815408252823*^9}, {
   3.837815482392646*^9, 3.8378154887947454`*^9}, {3.8378245905935497`*^9, 
   3.8378246125843673`*^9}, {3.837824687604117*^9, 3.837824699543831*^9}, {
   3.837824778504441*^9, 3.837824828904827*^9}, {3.8378250361043954`*^9, 
   3.8378252464312477`*^9}, {3.837826415704646*^9, 3.8378264198881407`*^9}, {
   3.8378266001656094`*^9, 3.837826740376923*^9}, {3.8378340608089957`*^9, 
   3.837834167950903*^9}, 3.8378342935267496`*^9},
 CellLabel->"In[89]:=",ExpressionUUID->"856a8b20-6c6d-4ca2-ada8-1a4ac995cc0c"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"p\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "551.791308614776`", ",", "522.2348516470469`", ",", 
      "169.7672225433138`"}], "}"}]}], ",", 
   RowBox[{"\<\"n\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.999915637885577`"}], ",", 
      RowBox[{"-", "0.005721999233829623`"}], ",", "0.01166086774849389`"}], 
     "}"}]}], ",", 
   RowBox[{"\<\"wo\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.20217573341204628`"}], ",", 
      RowBox[{"-", "0.9763779654920831`"}], ",", "0.0762301864148427`"}], 
     "}"}]}], ",", 
   RowBox[{"\<\"dpdu\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "3.200012000000015`"}], ",", "559.200012`", ",", "0.`"}], 
     "}"}]}], ",", 
   RowBox[{"\<\"dpdv\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"6.40002400000003`", ",", "0.`", ",", "548.799988`"}], "}"}]}], 
   ",", 
   RowBox[{"\<\"tri\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"552.799988`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"549.599976`", ",", "559.200012`", ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"556.`", ",", "559.200012`", ",", "548.799988`"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"\<\"material\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"Kd\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0.571289`", ",", "0.042393`", ",", "0.044485`"}], "}"}]}], 
      ",", 
      RowBox[{"\<\"sigma\"\>", "\[Rule]", "0.`"}]}], 
     "\[RightAssociation]"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.8378341714886703`*^9, 3.8378342940139985`*^9, 
  3.837834671013429*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"001a4677-2502-455d-9b79-9cc655971fa1"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"eta\"\>", "\[Rule]", "1"}], ",", 
   RowBox[{"\<\"ns\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.999915637885577`"}], ",", 
      RowBox[{"-", "0.005721999233829623`"}], ",", "0.01166086774849389`"}], 
     "}"}]}], ",", 
   RowBox[{"\<\"ng\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.999915637885577`"}], ",", 
      RowBox[{"-", "0.005721999233829623`"}], ",", "0.01166086774849389`"}], 
     "}"}]}], ",", 
   RowBox[{"\<\"ss\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.005722388300324364`"}], ",", "0.9999836270020327`", ",",
       "0.`"}], "}"}]}], ",", 
   RowBox[{"\<\"ts\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "0.011660676825129947`", ",", "0.00006672801317561114`", ",", 
      "0.9999320097703407`"}], "}"}]}], ",", 
   RowBox[{"\<\"bxdfs0\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"LambertianReflection\"\>"}], 
      ",", 
      RowBox[{"\<\"R\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0.571289`", ",", "0.042393`", ",", "0.044485`"}], "}"}]}]}], 
     "\[RightAssociation]"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.8378341714886703`*^9, 3.8378342940139985`*^9, 
  3.8378346710174513`*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"c8dcbd98-fe15-45df-bc18-2bf288a86d28"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BitShiftRight", "[", 
  RowBox[{"9861", ",", "7"}], "]"}]], "Input",
 CellChangeTimes->{{3.837831777206209*^9, 3.8378317829631658`*^9}},
 CellLabel->
  "In[1910]:=",ExpressionUUID->"83439a9b-4568-47ce-b590-85bcd4dfed73"],

Cell[BoxData["77"], "Output",
 CellChangeTimes->{3.837831783310452*^9},
 CellLabel->
  "Out[1910]=",ExpressionUUID->"2b1765e9-ae94-417e-be8e-d4cce691eabc"]
}, Open  ]]
},
WindowSize->{759, 795},
WindowMargins->{{Automatic, 78}, {2, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 36871, 897, 4627, "Input",ExpressionUUID->"856a8b20-6c6d-4ca2-ada8-1a4ac995cc0c"],
Cell[37454, 921, 1885, 51, 90, "Output",ExpressionUUID->"001a4677-2502-455d-9b79-9cc655971fa1"],
Cell[39342, 974, 1465, 38, 71, "Output",ExpressionUUID->"c8dcbd98-fe15-45df-bc18-2bf288a86d28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40844, 1017, 244, 5, 28, "Input",ExpressionUUID->"83439a9b-4568-47ce-b590-85bcd4dfed73"],
Cell[41091, 1024, 155, 3, 32, "Output",ExpressionUUID->"2b1765e9-ae94-417e-be8e-d4cce691eabc"]
}, Open  ]]
}
]
*)

