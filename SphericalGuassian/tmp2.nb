(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31917,        724]
NotebookOptionsPosition[     31258,        704]
NotebookOutlinePosition[     31602,        719]
CellTagsIndexPosition[     31559,        716]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "oldLightSg2D", ",", "oldLightSg3D", ",", "newLightSg3D", ",", 
    "newLightSg2D", ",", "bentCone", ",", "coneTheta2D", ",", "coneAperture", 
    ",", "coneCapAxis", ",", "coneCap"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"oldLightSg2D", "=", 
     RowBox[{
      RowBox[{"sgPointLightNew", "[", 
       RowBox[{"lightCenter", ",", "lightRadius", ",", "lightIntensity", ",", 
        RowBox[{"{", 
         RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}], "//", "N"}]}], 
    ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"oldLightSg3D", "=", 
     RowBox[{"sgTo3D", "[", "oldLightSg2D", "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"bentCone", "=", 
     RowBox[{
      RowBox[{"gCreateCone", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"shadingPosX", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}], "//", "N"}]}],
     ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"coneTheta2D", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneAperture", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCapAxis", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "coneTheta2D", "]"}], ",", 
        RowBox[{"Sin", "[", "coneTheta2D", "]"}], ",", "0"}], "}"}], "//", 
      "N"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCap", "=", 
     RowBox[{"{", 
      RowBox[{"coneCapAxis", ",", "coneAperture"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"newLightSg3D", "=", 
     RowBox[{
      RowBox[{"Quiet", "@", 
       RowBox[{"sgCapIntsAsNewSG", "[", 
        RowBox[{"oldLightSg3D", ",", "coneCap"}], "]"}]}], "//", "N"}]}], ";",
     "\[IndentingNewLine]", "\t", 
    RowBox[{"newLightSg2D", "=", 
     RowBox[{"sgTo2D", "[", "newLightSg3D", "]"}]}], ";", "\t", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\"\<circles\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
            "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
           RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}]}], 
          "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<lines\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<startPos\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]",
                "\t", 
               RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], ",", 
               RowBox[{"\"\<length\>\"", "\[Rule]", "#rightWallHeight"}], ",",
                "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
               RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}]}], 
            "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
           ",", 
           RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
           ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<cones\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<origin\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "5"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<cone\>\"", "\[Rule]", "bentCone"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Cyan"}]}], "|>"}], 
            "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], "|>"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<sgPointLights\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", "  ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenterCtrl"}], 
              ",", 
              RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadiusCtrl"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
              ",", 
              RowBox[{"\"\<shadingPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgPointLightNew", "[", 
                  RowBox[{
                  "#lightCenter", ",", "#lightRadius", ",", 
                   "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",", 
                   "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<SG Point Light\>\""}]}], 
             "|>"}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<lightCenterCtrl\>\"", "\[Rule]", "lightCenter"}], ",", 
           RowBox[{"\"\<lightRadiusCtrl\>\"", "\[Rule]", "lightRadius"}], ",",
            "\[IndentingNewLine]", "\t\t", 
           RowBox[{
           "\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}], ",", 
           RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}]}], 
          "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<lobes\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<origin\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], 
               ",", 
               RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadius"}], 
               ",", 
               RowBox[{
               "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensity"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<lobeFunc\>\"", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#shadingPos", "+", 
                    RowBox[{"lightIntensity", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"sgVector", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ",", 
                    "oldLightSg2D"}], "]"}]}]}], ")"}], "&"}], ")"}]}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Orange"}], ",", 
               RowBox[{
               "\"\<label\>\"", "\[Rule]", "\"\<Old Light Lobe\>\""}]}], 
              "|>"}], ",", "\[IndentingNewLine]", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<origin\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], 
               ",", 
               RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadius"}], 
               ",", 
               RowBox[{
               "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensity"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<lobeFunc\>\"", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#shadingPos", "+", 
                    RowBox[{"lightIntensity", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"sgVector", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ",", 
                    "newLightSg2D"}], "]"}]}]}], ")"}], "&"}], ")"}]}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
               RowBox[{
               "\"\<label\>\"", "\[Rule]", "\"\<New Light Lobe\>\""}]}], 
              "|>"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
           RowBox[{"\"\<lightIntensity\>\"", "\[Rule]", "lightIntensity"}], 
           ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
           RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}]}], 
          "|>"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
       "\[IndentingNewLine]", "|>"}], ",", "Medium"}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "5"}], "}"}], ",", "1", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "8"}], "}"}], ",", "5", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rightWallHeight", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8328889412895775`*^9, 3.832888943829444*^9}, 
   3.8329105814363804`*^9},
 CellLabel->
  "In[2293]:=",ExpressionUUID->"de46ef57-a359-4ec4-a7d3-aea9f5198032"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`leftWallHeight$$ = 
    1, $CellContext`lightCenter$$ = {-1.7999999999999998`, 
    1.25}, $CellContext`lightIntensity$$ = 8, $CellContext`lightRadius$$ = 
    5, $CellContext`rightWallHeight$$ = 
    1, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 1}, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-3, 2}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightRadius$$], 5}, 1, 5}, {{
       Hold[$CellContext`lightIntensity$$], 8}, 5, 10}, {{
       Hold[$CellContext`leftWallHeight$$], 1}, 0, 2}, {{
       Hold[$CellContext`rightWallHeight$$], 1}, 0, 2}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`shadingPosX$$], -1}, -2, 2}}, Typeset`size$$ = {
    56., {2., 9.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$380006$$ = {0, 
    0}, $CellContext`lightRadius$380007$$ = 
    0, $CellContext`lightIntensity$380008$$ = 
    0, $CellContext`leftWallHeight$380009$$ = 
    0, $CellContext`rightWallHeight$380010$$ = 
    0, $CellContext`viewDir$380011$$ = {0, 
    0}, $CellContext`shadingPosX$380012$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`leftWallHeight$$ = 
        1, $CellContext`lightCenter$$ = {-3, 
         2}, $CellContext`lightIntensity$$ = 8, $CellContext`lightRadius$$ = 
        5, $CellContext`rightWallHeight$$ = 
        1, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 1}}, 
      "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$380006$$, {
         0, 0}], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$380007$$, 
         0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$380008$$, 0], 
        Hold[$CellContext`leftWallHeight$$, \
$CellContext`leftWallHeight$380009$$, 0], 
        Hold[$CellContext`rightWallHeight$$, \
$CellContext`rightWallHeight$380010$$, 0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$380011$$, {0, 0}], 
        Hold[$CellContext`shadingPosX$$, $CellContext`shadingPosX$380012$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`oldLightSg2D = N[
          
          sgCommon`sgPointLightNew[$CellContext`lightCenter$$, \
$CellContext`lightRadius$$, $CellContext`lightIntensity$$, \
{$CellContext`shadingPosX$$, 0}]]; $CellContext`oldLightSg3D = 
        sgCommon`sgTo3D[$CellContext`oldLightSg2D]; $CellContext`bentCone = N[
          
          gUtils`gCreateCone[{$CellContext`shadingPosX$$, 
            0}, {-2, $CellContext`leftWallHeight$$}, {
           2, $CellContext`rightWallHeight$$}]]; $CellContext`coneTheta2D = N[
          Part[$CellContext`bentCone, 1]]; $CellContext`coneAperture = N[
          Part[$CellContext`bentCone, 2]]; $CellContext`coneCapAxis = N[{
           Cos[$CellContext`coneTheta2D], 
           Sin[$CellContext`coneTheta2D], 
           0}]; $CellContext`coneCap = {$CellContext`coneCapAxis, \
$CellContext`coneAperture}; $CellContext`newLightSg3D = N[
          Quiet[
           
           sgCommon`sgCapIntsAsNewSG[$CellContext`oldLightSg3D, \
$CellContext`coneCap]]]; $CellContext`newLightSg2D = 
        sgCommon`sgTo2D[$CellContext`newLightSg3D]; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association["center" -> {
               Slot["shadingPosX"], 0}, "radius" -> 0.1, "color" -> Red]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightRadius" -> $CellContext`lightRadius$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["rightWallHeight"], "color" -> Green, "thickness" -> 
             0.015]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("cones" -> {
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "radius" -> 5, 
             "cone" -> $CellContext`bentCone, "color" -> Cyan]}& )[
           Association["shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("sgPointLights" -> {
            Association[
            "lightCenter" -> Slot["lightCenterCtrl"], "lightRadius" -> 
             Slot["lightRadiusCtrl"], "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "shadingPos" -> {
               Slot["shadingPosX"], 0}, "sgFunc" -> (sgCommon`sgPointLightNew[
               Slot["lightCenter"], 
               Slot["lightRadius"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "color" -> Blue, "label" -> 
             "SG Point Light"]}& )[
           Association[
           "lightCenterCtrl" -> $CellContext`lightCenter$$, 
            "lightRadiusCtrl" -> $CellContext`lightRadius$$, 
            "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("lobes" -> {
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "lightCenter" -> Slot["lightCenter"], 
             "lightRadius" -> Slot["lightRadius"], "lightIntensity" -> 
             Slot["lightIntensity"], 
             "lobeFunc" -> (
              Slot["shadingPos"] + $CellContext`lightIntensity$$ {
                 Cos[
                  Slot["\[Theta]"]], 
                 Sin[
                  Slot["\[Theta]"]]} sgCommon`sgVector[{
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}, $CellContext`oldLightSg2D]& ), "color" -> 
             Orange, "label" -> "Old Light Lobe"], 
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "lightCenter" -> Slot["lightCenter"], 
             "lightRadius" -> Slot["lightRadius"], "lightIntensity" -> 
             Slot["lightIntensity"], 
             "lobeFunc" -> (
              Slot["shadingPos"] + $CellContext`lightIntensity$$ {
                 Cos[
                  Slot["\[Theta]"]], 
                 Sin[
                  Slot["\[Theta]"]]} sgCommon`sgVector[{
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}, $CellContext`newLightSg2D]& ), "color" -> 
             Red, "label" -> "New Light Lobe"]}& )[
           Association[
           "shadingPosX" -> $CellContext`shadingPosX$$, 
            "lightIntensity" -> $CellContext`lightIntensity$$, 
            "lightCenter" -> $CellContext`lightCenter$$, 
            "lightRadius" -> $CellContext`lightRadius$$]], "axisExtent" -> 5],
          Medium]), 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-3, 2}}, {-4, -4}, {
         4, 4}}, {{$CellContext`lightRadius$$, 5}, 1, 
         5}, {{$CellContext`lightIntensity$$, 8}, 5, 
         10}, {{$CellContext`leftWallHeight$$, 1}, 0, 
         2}, {{$CellContext`rightWallHeight$$, 1}, 0, 
         2}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`shadingPosX$$, -1}, -2, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{334., {192., 198.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.832888944642335*^9, 3.832910556902343*^9, 
  3.8329105902386746`*^9, 3.832910728866332*^9, 3.832910820470826*^9, 
  3.832911064232461*^9, 3.832911115612363*^9, 3.832911328389186*^9, 
  3.8329114405160823`*^9, 3.832911504142568*^9},
 CellLabel->
  "Out[2301]=",ExpressionUUID->"77969ded-7d11-43e2-af30-bce07ba50ebd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BesselI", "[", 
      RowBox[{"1", ",", "\[Lambda]"}], "]"}], ",", 
     RowBox[{"BesselI", "[", 
      RowBox[{"0", ",", "\[Lambda]"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", ",", "5", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8329062320069556`*^9, 3.832906251252819*^9}, {
  3.8329063194708557`*^9, 3.832906328121459*^9}},
 CellLabel->
  "In[669]:=",ExpressionUUID->"6395743c-83e6-436b-bdd1-15e13daec17e"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVkHk41HkAh0eJdDhnGPf8fHVpS0ma1NRH68ouStu6UmYeTJqiA0NIocgq
yVUZ2vihsjqwemhFqMjQUsrRYRGbKNXuOhrN1h/v8z7vvy8lCHbzn8FgMJy/
8s2b5nUpMRhMxOsrNY9s50K1LmTWWQUmFlnue1Kxk4susbqi6Uwm9goZrHgh
F/v7HRQclZgQvNqLxRFcXKyq+Jwyj4kx83p+loQL2e70MWNdJkq1FXs0Brio
uOfavdGCCVWRwPRo6FosjblfEuPHhI6quTghzxpHnJ8HHGpjIs6wTxzny8O4
Vk7T8jUsuBRW5crYgHuuhcvbCyxIrXYsuyqxARU/NqCvrA1fS6pVR/Q9NASe
C5h7tZFSrC0YsrODKHtYfLRLG8ljvgMhUQ4oObdlZNRWB1rv1l+70bcZrNP8
OeSKDnZlT9rVe/yIoZcXrKUsNu4q2OwpdnTFq0UxTF4kGz3qPlcfLtyKO5Zc
9esv2bBKrOled98Nyjm6RhlOuhj8PblMreInhE0XdGy6rguNUwHv1pX9jC2V
Xhf9DPRwK3p5q6GWJzTWDiQlJOghmKc4tr3QGxM32JyDb/VwbDw4ReK0E5vj
Qx/86a6PJxFmUcqVvqh1jWaP/6GPmoWCGjUPAS6FlUSmmhlAT+W1ZY2DH/bw
SxnLMg0QmMQ1u8MPgKetwPzMlAFuc95v5CXtRmms9X6h0BB31CZbiZEIKyur
vZRaDDFY3XTE+t4+ZJWxhIUrjFCW84D92XU/hCqZx6skRpAqem/wVzwIH/e7
zpkKxnA3mwhXvncI1QzW4sEgY6TI54yrvgjFrCCe6ZpuY9z0iCwfNglHVeDs
14uMOcgU93kHhR/GQiclm6DtHCx178jz2RSNgsKuA+xEDp5X8xpi1Y+C7Z+1
qr6SA5E4rK05+xiwNfBL0XsOHpeqFRmExCGyUj13jKJwbe7i/ySexyFyldof
8qBQWHYiqS8nAUF8nwbPXyio2cp10j+dhF9HZzuqKcg56y7zxMlQE+8e5n+i
oBHu8uxUeApa0lueDi4wwcn4MxfmO6YCvfbSgh0msO181Mql0lB06qqb/1kT
nLcv4NiQDFC3+ksSG0xgcPtXTuqqLGxRXak5OGWC+7Xz082Lz+PsX9t+KFpG
UNruPfvaagkatfmswF0Es4RaM1Z8zEVZROzffhkELnENwg79S18/RZxpeEAQ
Vv7EQfIwD1Z3lxwpaCRw54fHR7fnoWpJt+hEE0HW5KCmoDsPDVPWDo7NBKcb
68xWD+fhqUQ23dxK0Ow4tG/mnHzIemNEjzsIeguDYmyc8uEYeMK+r5/gS/n5
HueWfLS0WVnWDxB0moawJB35cLMeoujXBD6d5o9GX+TDe67jtP8QgSZnTWP2
u3wElaiUvxkmYDEMpyh1GukfkqkPHwi+C9X5rXMbDV0vnlr7RwJ7B3nmrh00
cutGZaWfCN7o1+kO+9EoSnPpDPmXwChjdEQljEbVavWUiQkCS1HqPyHnaGzI
rY3qmiQYCZ3RxL5Eo17pwJ6qKQKLwUSb2is0pM/a7KJkBJePyU31btPYithV
PtMEh5lKadJ6Gk8vW1AbvhAkPXcpjpXS8NLoVzWWE6y/GRC8voPGq4g0mfxr
+2v29E6+oPE/55sfgA==
       "]]},
     Annotation[#, "Charting`Private`Tag$78006#1"]& ], 
    TagBox[
     {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVi3s01HkAR8eKapXI0IzXzPiSrY6S2hKNPuwYahnjsY3Hti2RZ+NVrINE
ExMpCbWUCj/KOY7IKrMpxfbw2JK0WCeFRlgbIY9Gtv3jnnvuH5fjF+4W8BWN
RnP+wv+2W9GtSqPR8XlRPTCIaw31B4dVspXoWDd3oWOGb43uWI0lxsp0uBuu
rkkXWiNiwEHJUZWOnom+TtkBa1yW1X46s4IOL62DDbx0ayiCcsZZTDq0rpwU
0LqsUfuHS88uCzrafRLdWTE7sSHpYUWSPx0iheFtfj0XR517D0a307FoW6R5
1weY0br0ZON2bajlZyim+m0hKrQQjOZrozlWd2Es9TtwJOODekt1kByiVy6M
t4emn5cJPUwHz4KlFWkJDggtGIk91q2DJrm8aOfr3ai4IPxnjLcGk+Et0qoY
J2if9v2aXF+DO7LzqlIDFwy9yrdq1WYgSsSPCiSu6DNNonPjGXDP6kr694Eb
7m611Kh8xUA9c3Rma7IHll5iGubuYcLS1ibAI3cvYhaoTrtKJpjvhH68W54Q
1nlf9tfXhaRTYzjSzgeaOwbT09J0cedGrceM8k+YvcFgR43qgvdizupM6M/Y
LTny6JlID6ZMvXtyXT80uCQyZu7ooVkg6p3qPICrMRXxZ9frQ/Tek10hD0CI
bzXNLE8fNb/1nlhpHAQvnt+mrHl9bG5Mbz8UEYLqFKuIwEADpEW08Uo3HsLm
unpv1TYDTNht6NxPi8D5m9qBpeaGsOR7mVyURCJwed4J2UVDBLkeMlf2iMY+
0X3nPCUWdp21XFA3P4J6mvY3cjELOaEULzooFipirvH2HhbmdaLoyu1xkAUv
e2vKYuPw30Fa93cnYO0eVVvxD2x4FRR6O3GTQJV2RzKkbJwc7HI2JslgBJzf
0ljHxoHwVKXpphTANfhz2Xs2BObl3m9vSRBfp1E4zuGgJiUgK+Z2KkJdWvnR
nhw0OyX2yfRPQuy7r8krg4MQzVmuyrkM+Hd2PUc9B4m/M26G7TiNVbFBI76T
X/6nx32Gq7LQltP2Um5iBPG8oVm+Wzbwmt9K/WiEArNrwcd5OSjLLHcLyDbC
i3CBE/HNA+fWQIW0yQg2m6ZNk09dgFB982r5vBHYwik1Y+MCZL9x/77MjMDg
bNEyh6eX8FjHVzt4P0H8fDzHWXQFN+NS3vnnEgyHTp0uVS9ClWdcVtMjgr1X
94aFPS/GtvvrjlKPCYROk5LKnmLI1vWEpj4hGM9JpH/sL0bTvJWDYwvB+rUW
hZmTxXh5UbHQ8idBwxTrhJxeAsXrpNCOToJN5dxReJbAMTiV3z9AIF05mV70
pgRt7du2Ng4ScGscfEUjJXCzGuKUvCWw/uXIq1WTJfBRc1wIGCKwz5V0ZCyh
IK5YXjM8QvDEpbKj0pRCzsQpzsQEwXSmQHpdTIHpzV31/ANBqppD6q+xFAof
jCmqJwlOVanwMo9RKDsn6Do8TbB2wFTlWDYF2bcaZ2ZnCcKdDjZn11KwKWxI
6J4jYL2Y+HDlHoVG1cgQ2TxBT8vcUPVjCq1/tdsnKAj0Psm5/T0UXJGyZd8C
wc5epaLFAQovr1lwbD4TqCYv6WaPUfDWHFBnLRKYRGYM2n+k0Bd3TrH4pVv7
tzwUL1L4D7NIKQE=
       "]]},
     Annotation[#, "Charting`Private`Tag$78006#2"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{5., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{5, 10}, {0., 2815.7163559164383`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.832906239866613*^9, 3.8329062516491327`*^9}, 
   3.8329063286514206`*^9},
 CellLabel->
  "Out[669]=",ExpressionUUID->"4a24bec4-c370-445d-855e-8fb5f4baef3e"]
}, Open  ]]
},
WindowSize->{1083, 640},
WindowMargins->{{Automatic, 177}, {74, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 15709, 367, 1416, "Input",ExpressionUUID->"de46ef57-a359-4ec4-a7d3-aea9f5198032"],
Cell[16292, 391, 8948, 177, 409, "Output",ExpressionUUID->"77969ded-7d11-43e2-af30-bce07ba50ebd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25277, 573, 543, 14, 28, "Input",ExpressionUUID->"6395743c-83e6-436b-bdd1-15e13daec17e"],
Cell[25823, 589, 5419, 112, 233, "Output",ExpressionUUID->"4a24bec4-c370-445d-855e-8fb5f4baef3e"]
}, Open  ]]
}
]
*)

