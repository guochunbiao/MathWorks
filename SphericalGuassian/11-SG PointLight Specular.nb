(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     34895,        741]
NotebookOptionsPosition[     34050,        719]
NotebookOutlinePosition[     34392,        734]
CellTagsIndexPosition[     34349,        731]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<>NoL*FallOff*BRDF(Ground Lighting):\>\"", "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<startPos\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
              RowBox[{"FromPolarCoordinates", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "#lineAngle"}], "}"}], "]"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "2"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{"\"\<lineAngle\>\"", "\[Rule]", "viewAngle"}], "|>"}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}]}], "|>"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<groundShadings\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "    ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
             RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadiusCtrl"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
             RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
              RowBox[{"FromPolarCoordinates", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "#viewAngle"}], "}"}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<shadingFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#nol", "*", 
                 RowBox[{"gPointLightFallOff", "[", 
                  RowBox[{"#lightRadius", ",", "#shadingDist"}], "]"}], "*", 
                 "\[IndentingNewLine]", "\t\t\t\t ", 
                 RowBox[{"gBrdfFunc", "[", 
                  RowBox[{
                  "#roughness", ",", "#normalDir", ",", "#lightDir", ",", 
                   "#viewDir"}], "]"}]}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "          ", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Purple"}], ",", 
             RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<BRDF\>\""}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadiusCtrl\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}], ",", 
          RowBox[{"\"\<viewAngle\>\"", "\[Rule]", "viewAngle"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "3"}]}], 
      "\[IndentingNewLine]", "|>"}], ",", "Medium"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "2"}], "}"}], ",", "1", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.2"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewAngle", ",", 
       RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", "\[Pi]"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.831159052131798*^9, 3.831159053077799*^9}, {
   3.831159106069352*^9, 3.831159130205224*^9}, {3.831159672764243*^9, 
   3.831159706356526*^9}, {3.8311597386357193`*^9, 3.831159766951304*^9}, {
   3.831160000165146*^9, 3.8311600468444233`*^9}, {3.8311602055552473`*^9, 
   3.8311602790608387`*^9}, {3.8311604106929083`*^9, 3.831160416125536*^9}, {
   3.831160561357197*^9, 3.8311606238928757`*^9}, {3.831179466705072*^9, 
   3.8311794668013735`*^9}, {3.8311800642572618`*^9, 
   3.8311800806969595`*^9}, {3.831181767119994*^9, 3.8311817673922815`*^9}, {
   3.8315323038321524`*^9, 3.8315323439200163`*^9}, {3.83153241245373*^9, 
   3.831532432657011*^9}, {3.831532465594139*^9, 3.8315325008478374`*^9}, {
   3.831532548439743*^9, 3.8315325880506916`*^9}, {3.831532666323696*^9, 
   3.8315326721957617`*^9}, 3.8315328270135136`*^9, {3.831532868730433*^9, 
   3.831532923021521*^9}, {3.8315329672312984`*^9, 3.831533022973257*^9}, 
   3.831533079531767*^9, {3.8315331213207455`*^9, 3.831533157591982*^9}, {
   3.8315332148827057`*^9, 3.8315332389589305`*^9}, {3.8315333591477413`*^9, 
   3.8315333858136735`*^9}, {3.8315334760207443`*^9, 
   3.8315334948399286`*^9}, {3.831533530110876*^9, 3.831533556610481*^9}, {
   3.8315335916324434`*^9, 3.8315336280913687`*^9}, {3.8315392893753285`*^9, 
   3.8315392903076067`*^9}, {3.831539336028604*^9, 3.8315394058985043`*^9}, {
   3.8315394698710256`*^9, 3.8315394832492867`*^9}, {3.831540484103381*^9, 
   3.8315405415896163`*^9}, {3.8315408150717373`*^9, 
   3.8315408428817854`*^9}, {3.831541010408637*^9, 3.8315410829619646`*^9}, {
   3.831541122268527*^9, 3.8315411273523073`*^9}, {3.8315932814717407`*^9, 
   3.8315933078123198`*^9}, {3.8315933919187536`*^9, 3.831593407923608*^9}, {
   3.831593438894783*^9, 3.8315934395317607`*^9}, 
   3.8317918718905582`*^9},ExpressionUUID->"a553c2d9-ec9e-417a-9b05-\
f7e73d693e26"],

Cell[BoxData[
 StyleBox["\<\" >NoL*FallOff*BRDF(Ground Lighting):\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8315934085464563`*^9},
 CellLabel->
  "During evaluation of \
In[137]:=",ExpressionUUID->"aa797d38-d501-49eb-8f84-d4771cfc1323"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lightCenter$$ = {-1, 
    1}, $CellContext`lightRadius$$ = 2, $CellContext`roughness$$ = 
    0.2, $CellContext`viewAngle$$ = Rational[1, 4] Pi, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-1, 1}}, {-2, -2}, {2, 2}}, {{
       Hold[$CellContext`lightRadius$$], 2}, 1, 5}, {{
       Hold[$CellContext`roughness$$], 0.2}, 0.05, 1}, {{
       Hold[$CellContext`viewAngle$$], Rational[1, 4] Pi}, 0, Pi}}, 
    Typeset`size$$ = {406., {179., 185.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`lightCenter$18513$$ = {0, 
    0}, $CellContext`lightRadius$18514$$ = 0, $CellContext`roughness$18515$$ =
     0, $CellContext`viewAngle$18516$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`lightCenter$$ = {-1, 
         1}, $CellContext`lightRadius$$ = 2, $CellContext`roughness$$ = 
        0.2, $CellContext`viewAngle$$ = Rational[1, 4] Pi}, 
      "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$18513$$, {0,
          0}], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$18514$$, 0], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$18515$$, 0], 
        Hold[$CellContext`viewAngle$$, $CellContext`viewAngle$18516$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> gPlots`gParamPlot[
        Association[
         ("lines" -> {
           Association[
           "startPos" -> {0, 0}, "dirVec" -> FromPolarCoordinates[{1, 
               Slot["lineAngle"]}], "length" -> 2]}& )[
          Association["lineAngle" -> $CellContext`viewAngle$$]], 
         ("circles" -> {
           Association[
           "center" -> Slot["lightCenter"], "radius" -> 
            Slot["lightRadius"]]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadius" -> $CellContext`lightRadius$$]], 
         ("groundShadings" -> {
           Association[
           "lightCenter" -> Slot["lightCenter"], "lightRadius" -> 
            Slot["lightRadiusCtrl"], "roughness" -> Slot["roughness"], 
            "viewDir" -> FromPolarCoordinates[{1, 
               Slot["viewAngle"]}], 
            "shadingFunc" -> (Slot["nol"] gBRDF`gPointLightFallOff[
               Slot["lightRadius"], 
               Slot["shadingDist"]] gBRDF`gBrdfFunc[
               Slot["roughness"], 
               Slot["normalDir"], 
               Slot["lightDir"], 
               Slot["viewDir"]]& ), "color" -> Purple, "lable" -> "BRDF"]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadiusCtrl" -> $CellContext`lightRadius$$, 
           "roughness" -> $CellContext`roughness$$, 
           "viewAngle" -> $CellContext`viewAngle$$]], "axisExtent" -> 3], 
        Medium], 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-1, 1}}, {-2, -2}, {
         2, 2}}, {{$CellContext`lightRadius$$, 2}, 1, 
         5}, {{$CellContext`roughness$$, 0.2}, 0.05, 
         1}, {{$CellContext`viewAngle$$, Rational[1, 4] Pi}, 0, Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{457., {296., 302.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.831159131399238*^9, 3.831159327764292*^9, 3.8311595949599714`*^9, {
   3.8311597443645015`*^9, 3.8311597678080034`*^9}, 3.8311599510899987`*^9, 
   3.8311602798397307`*^9, {3.83116031710339*^9, 3.8311603241650968`*^9}, {
   3.8311604115733147`*^9, 3.8311604168824177`*^9}, {3.83116057822622*^9, 
   3.831160624710725*^9}, 3.83116241611049*^9, 3.831179270853613*^9, {
   3.831179459708642*^9, 3.8311794677406874`*^9}, 3.8311800816641655`*^9, 
   3.8311801220597467`*^9, {3.831181761499483*^9, 3.8311817680377393`*^9}, 
   3.8311826970159817`*^9, 3.8311842597160144`*^9, 3.831186525176833*^9, 
   3.8315317143380156`*^9, {3.831532407866885*^9, 3.8315324334725294`*^9}, {
   3.831532466167988*^9, 3.8315324788568425`*^9}, 3.8315325093220015`*^9, {
   3.831532565543601*^9, 3.8315325894337225`*^9}, {3.8315326446578074`*^9, 
   3.8315326727561827`*^9}, {3.831532719462315*^9, 3.831532827745146*^9}, {
   3.831532887009447*^9, 3.8315328969079103`*^9}, 3.8315329404160576`*^9, 
   3.8315329803267975`*^9, {3.8315330252098827`*^9, 3.8315330493493347`*^9}, {
   3.8315331083245506`*^9, 3.831533239843913*^9}, 3.8315335204089727`*^9, {
   3.8315335573322372`*^9, 3.8315336305361443`*^9}, 3.8315393107823195`*^9, 
   3.831540241792514*^9, 3.8315403238316236`*^9, {3.8315404854117913`*^9, 
   3.8315404967559557`*^9}, {3.831540529651494*^9, 3.8315405421651344`*^9}, {
   3.831540613791026*^9, 3.8315406474014187`*^9}, 3.8315408239021845`*^9, {
   3.831541046670722*^9, 3.83154108384131*^9}, 3.8315411280025835`*^9, {
   3.8315901844632626`*^9, 3.831590226188836*^9}, {3.8315913044209204`*^9, 
   3.831591326069976*^9}, 3.8315922509575777`*^9, 3.8315926412801466`*^9, 
   3.831592761476427*^9, {3.8315928119450684`*^9, 3.831592841760223*^9}, 
   3.8315929296750736`*^9, {3.831593266495424*^9, 3.83159330895168*^9}, {
   3.831593399310337*^9, 3.831593408583429*^9}},
 CellLabel->
  "Out[143]=",ExpressionUUID->"ab794a3b-bd70-4be8-b618-7390bab903ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<>SG Ground Lighting:\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<startPos\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
              RowBox[{"FromPolarCoordinates", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "#lineAngle"}], "}"}], "]"}]}], ",", 
             RowBox[{"\"\<length\>\"", "\[Rule]", "2"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{"\"\<lineAngle\>\"", "\[Rule]", "viewAngle"}], "|>"}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}]}], "|>"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgGroundShading\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "    ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadiusCtrl"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
              ",", 
              RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
               RowBox[{"FromPolarCoordinates", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "#viewAngle"}], "}"}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgPointLightOld", "[", 
                  RowBox[{
                  "#lightCenter", ",", "#lightRadius", ",", 
                   "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",", 
                   "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDF", "[", 
                  RowBox[{
                  "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                   "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDFConvLight", "[", 
                  RowBox[{
                  "#lightRadius", ",", "\[IndentingNewLine]", 
                   "\t\t\t\t\t\t\t", "#shadingDist", ",", "#sgLight", ",", 
                   "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<Old SG Light\>\""}]}], 
             "|>"}], ",", "\[IndentingNewLine]", "  ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadiusCtrl"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
              ",", 
              RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
               RowBox[{"FromPolarCoordinates", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "#viewAngle"}], "}"}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgPointLightNew", "[", 
                  RowBox[{
                  "#lightCenter", ",", "#lightRadius", ",", 
                   "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",", 
                   "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDF", "[", 
                  RowBox[{
                  "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                   "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDFConvLight", "[", 
                  RowBox[{
                  "#lightRadius", ",", "\[IndentingNewLine]", 
                   "\t\t\t\t\t\t\t", "#shadingDist", ",", "#sgLight", ",", 
                   "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<New SG Light\>\""}]}], 
             "|>"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadiusCtrl\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}],
           ",", 
          RowBox[{"\"\<viewAngle\>\"", "\[Rule]", "viewAngle"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<groundShadings\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "    ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
             RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadiusCtrl"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
             RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
              RowBox[{"FromPolarCoordinates", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "#viewAngle"}], "}"}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<shadingFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#nol", "*", 
                 RowBox[{"gPointLightFallOff", "[", 
                  RowBox[{"#lightRadius", ",", "#shadingDist"}], "]"}], "*", 
                 "\[IndentingNewLine]", "\t\t\t\t ", 
                 RowBox[{"gBrdfFunc", "[", 
                  RowBox[{
                  "#roughness", ",", "#normalDir", ",", "#lightDir", ",", 
                   "#viewDir"}], "]"}]}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "          ", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Purple"}], ",", 
             RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<BRDF\>\""}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadiusCtrl\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}], ",", 
          RowBox[{"\"\<viewAngle\>\"", "\[Rule]", "viewAngle"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "3"}]}], 
      "\[IndentingNewLine]", "|>"}], ",", "Medium"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "2"}], "}"}], ",", "1", ",", "5", ",", 
     "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewAngle", ",", 
       RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", "\[Pi]"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.1"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8311610894027767`*^9, 3.8311611544036455`*^9}, {
   3.8311612217631893`*^9, 3.831161246802561*^9}, {3.831161301003403*^9, 
   3.8311615006533375`*^9}, {3.831161570700322*^9, 3.831161594802808*^9}, {
   3.8311616953812346`*^9, 3.8311617190848975`*^9}, {3.83116181753197*^9, 
   3.8311618682429333`*^9}, {3.831162127234378*^9, 3.8311622816689987`*^9}, {
   3.831162317020039*^9, 3.831162335956648*^9}, {3.8311623672515287`*^9, 
   3.831162400581092*^9}, {3.8311624426353817`*^9, 3.8311626148132424`*^9}, {
   3.8311793149780755`*^9, 3.831179340552803*^9}, 3.831179476291432*^9, {
   3.8311795477062073`*^9, 3.8311795679777617`*^9}, {3.8311809229792013`*^9, 
   3.8311809229871793`*^9}, {3.831181624161186*^9, 3.8311816336028376`*^9}, {
   3.831541161950098*^9, 3.831541166008524*^9}, {3.831541301735651*^9, 
   3.831541314051265*^9}, 3.8315417353437915`*^9, {3.8315915263212233`*^9, 
   3.831591599707803*^9}, {3.831592089970795*^9, 3.8315921158382297`*^9}, {
   3.8315922229737573`*^9, 3.831592277227013*^9}, {3.831592310966921*^9, 
   3.831592356595959*^9}, {3.8315930237433085`*^9, 3.8315931853989983`*^9}, 
   3.8315932497383313`*^9, {3.831593314043335*^9, 3.83159331973883*^9}, {
   3.831593365438961*^9, 3.831593383510313*^9}, {3.8315934273277225`*^9, 
   3.8315934446989455`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"830e4848-af02-4d1c-8e35-982b07bfd5a1"],

Cell[BoxData[
 StyleBox["\<\" >SG Ground Lighting:\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.8315934138569202`*^9, 3.831593445579024*^9}},
 CellLabel->
  "During evaluation of \
In[148]:=",ExpressionUUID->"021b2f86-573c-454d-bd2b-d7edf8cffe4f"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lightCenter$$ = {-1, 
    1}, $CellContext`lightIntensity$$ = 1, $CellContext`lightRadius$$ = 
    2, $CellContext`roughness$$ = 0.1, $CellContext`viewAngle$$ = 
    Rational[1, 4] Pi, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-1, 1}}, {-2, -2}, {2, 2}}, {{
       Hold[$CellContext`lightRadius$$], 2}, 1, 5, 1}, {{
       Hold[$CellContext`lightIntensity$$], 1}, 1, 10}, {{
       Hold[$CellContext`viewAngle$$], Rational[1, 4] Pi}, 0, Pi}, {{
       Hold[$CellContext`roughness$$], 0.1}, 0.05, 1}}, Typeset`size$$ = {
    486., {179., 185.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$19464$$ = {0, 
    0}, $CellContext`lightRadius$19465$$ = 
    0, $CellContext`lightIntensity$19466$$ = 
    0, $CellContext`viewAngle$19467$$ = 0, $CellContext`roughness$19468$$ = 
    0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`lightCenter$$ = {-1, 
         1}, $CellContext`lightIntensity$$ = 1, $CellContext`lightRadius$$ = 
        2, $CellContext`roughness$$ = 0.1, $CellContext`viewAngle$$ = 
        Rational[1, 4] Pi}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$19464$$, {0,
          0}], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$19465$$, 0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$19466$$, 0], 
        Hold[$CellContext`viewAngle$$, $CellContext`viewAngle$19467$$, 0], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$19468$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> gPlots`gParamPlot[
        Association[
         ("lines" -> {
           Association[
           "startPos" -> {0, 0}, "dirVec" -> FromPolarCoordinates[{1, 
               Slot["lineAngle"]}], "length" -> 2]}& )[
          Association["lineAngle" -> $CellContext`viewAngle$$]], 
         ("circles" -> {
           Association[
           "center" -> Slot["lightCenter"], "radius" -> 
            Slot["lightRadius"]]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadius" -> $CellContext`lightRadius$$]], 
         ("sgGroundShading" -> {
           Association[
           "lightCenter" -> Slot["lightCenter"], "lightRadius" -> 
            Slot["lightRadiusCtrl"], "lightIntensity" -> 
            Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
            "viewDir" -> FromPolarCoordinates[{1, 
               Slot["viewAngle"]}], "sgLightFunc" -> (sgCommon`sgPointLightOld[
              Slot["lightCenter"], 
              Slot["lightRadius"], 
              Slot["lightIntensity"], 
              Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
              Slot["roughness"], 
              Slot["lightDir"], 
              Slot["viewDir"], 
              Slot["normalDir"]]& ), 
            "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
              Slot["lightRadius"], 
              Slot["shadingDist"], 
              Slot["sgLight"], 
              Slot["sgNDF"]]& ), "color" -> Green, "label" -> "Old SG Light"], 
           Association[
           "lightCenter" -> Slot["lightCenter"], "lightRadius" -> 
            Slot["lightRadiusCtrl"], "lightIntensity" -> 
            Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
            "viewDir" -> FromPolarCoordinates[{1, 
               Slot["viewAngle"]}], "sgLightFunc" -> (sgCommon`sgPointLightNew[
              Slot["lightCenter"], 
              Slot["lightRadius"], 
              Slot["lightIntensity"], 
              Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
              Slot["roughness"], 
              Slot["lightDir"], 
              Slot["viewDir"], 
              Slot["normalDir"]]& ), 
            "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
              Slot["lightRadius"], 
              Slot["shadingDist"], 
              Slot["sgLight"], 
              Slot["sgNDF"]]& ), "color" -> Blue, "label" -> 
            "New SG Light"]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadiusCtrl" -> $CellContext`lightRadius$$, 
           "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
           "viewAngle" -> $CellContext`viewAngle$$, 
           "roughness" -> $CellContext`roughness$$]], 
         ("groundShadings" -> {
           Association[
           "lightCenter" -> Slot["lightCenter"], "lightRadius" -> 
            Slot["lightRadiusCtrl"], "roughness" -> Slot["roughness"], 
            "viewDir" -> FromPolarCoordinates[{1, 
               Slot["viewAngle"]}], 
            "shadingFunc" -> (Slot["nol"] gBRDF`gPointLightFallOff[
               Slot["lightRadius"], 
               Slot["shadingDist"]] gBRDF`gBrdfFunc[
               Slot["roughness"], 
               Slot["normalDir"], 
               Slot["lightDir"], 
               Slot["viewDir"]]& ), "color" -> Purple, "label" -> "BRDF"]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadiusCtrl" -> $CellContext`lightRadius$$, 
           "roughness" -> $CellContext`roughness$$, 
           "viewAngle" -> $CellContext`viewAngle$$]], "axisExtent" -> 3], 
        Medium], 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-1, 1}}, {-2, -2}, {
         2, 2}}, {{$CellContext`lightRadius$$, 2}, 1, 5, 
         1}, {{$CellContext`lightIntensity$$, 1}, 1, 
         10}, {{$CellContext`viewAngle$$, Rational[1, 4] Pi}, 0, 
         Pi}, {{$CellContext`roughness$$, 0.1}, 0.05, 1}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{537., {310., 316.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8311623548290195`*^9, {3.831162396487378*^9, 3.8311624189317355`*^9}, {
   3.8311625995310993`*^9, 3.8311626160979023`*^9}, 3.831179271388398*^9, 
   3.8311793172073774`*^9, {3.8311794602481995`*^9, 3.831179477249035*^9}, 
   3.831179568877923*^9, 3.831180122548956*^9, {3.831181621435579*^9, 
   3.8311816341394515`*^9}, 3.8311817994364643`*^9, 3.831182697532007*^9, 
   3.8311848591048307`*^9, 3.8311865304210587`*^9, 3.831531714554264*^9, 
   3.831532644940522*^9, {3.831532767837756*^9, 3.8315327799179983`*^9}, {
   3.8315411468406982`*^9, 3.8315411673030715`*^9}, 3.831541314924038*^9, {
   3.8315915388876047`*^9, 3.8315915478649235`*^9}, 3.8315921742573385`*^9, {
   3.831592216359386*^9, 3.8315922779184127`*^9}, {3.8315923309108486`*^9, 
   3.8315923572326107`*^9}, 3.831592480745599*^9, 3.8315925874573135`*^9, {
   3.8315926319490128`*^9, 3.831592641667082*^9}, {3.831592752863795*^9, 
   3.8315928425005445`*^9}, 3.8315929337133846`*^9, {3.831593049040976*^9, 
   3.831593054935363*^9}, 3.8315931866981087`*^9, 3.831593320740076*^9, {
   3.8315933575469255`*^9, 3.831593445617519*^9}},
 CellLabel->
  "Out[149]=",ExpressionUUID->"b7c11c09-3b20-4bff-9a82-3e9ca88fcd0f"]
}, Open  ]]
},
WindowSize->{967, 763},
WindowMargins->{{Automatic, 93}, {26, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 7237, 157, 599, "Input",ExpressionUUID->"a553c2d9-ec9e-417a-9b05-f7e73d693e26"],
Cell[7820, 181, 310, 8, 30, "Print",ExpressionUUID->"aa797d38-d501-49eb-8f84-d4771cfc1323"],
Cell[8133, 191, 6072, 110, 617, "Output",ExpressionUUID->"ab794a3b-bd70-4be8-b618-7390bab903ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14242, 306, 11633, 247, 979, "Input",ExpressionUUID->"830e4848-af02-4d1c-8e35-982b07bfd5a1"],
Cell[25878, 555, 319, 8, 30, "Print",ExpressionUUID->"021b2f86-573c-454d-bd2b-d7edf8cffe4f"],
Cell[26200, 565, 7834, 151, 645, "Output",ExpressionUUID->"b7c11c09-3b20-4bff-9a82-3e9ca88fcd0f"]
}, Open  ]]
}
]
*)

