(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     68598,       1475]
NotebookOptionsPosition[     67100,       1443]
NotebookOutlinePosition[     67442,       1458]
CellTagsIndexPosition[     67399,       1455]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<>NoL*FallOff*BRDF(Ground Lighting):\>\"", "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\"\<lines\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<startPos\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
             RowBox[{"FromPolarCoordinates", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "#lineAngle"}], "}"}], "]"}]}], ",", 
            RowBox[{"\"\<length\>\"", "\[Rule]", "2"}]}], "|>"}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{"\"\<lineAngle\>\"", "\[Rule]", "viewAngle"}], "|>"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<circles\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
            RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}]}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<groundShadings\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", "    ", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
            RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadiusCtrl"}], 
            ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
            RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
             RowBox[{"FromPolarCoordinates", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "#viewAngle"}], "}"}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<shadingFunc\>\"", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#nol", "*", 
                RowBox[{"gPointLightFallOff", "[", 
                 RowBox[{"#lightRadius", ",", "#shadingDist"}], "]"}], "*", 
                "\[IndentingNewLine]", "\t\t\t\t ", 
                RowBox[{"gBrdfFunc", "[", 
                 RowBox[{
                 "#roughness", ",", "#normalDir", ",", "#lightDir", ",", 
                  "#viewDir"}], "]"}]}], "&"}], ")"}]}], ",", 
            "\[IndentingNewLine]", "          ", 
            RowBox[{"\"\<color\>\"", "\[Rule]", "Purple"}], ",", 
            RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<BRDF\>\""}]}], "|>"}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         RowBox[{"\"\<lightRadiusCtrl\>\"", "\[Rule]", "lightRadius"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}], ",", 
         RowBox[{"\"\<viewAngle\>\"", "\[Rule]", "viewAngle"}]}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "3"}]}], "\[IndentingNewLine]",
      "|>"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "2"}], "}"}], ",", "1", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.2"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewAngle", ",", 
       RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", "\[Pi]"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.831159052131798*^9, 3.831159053077799*^9}, {
   3.831159106069352*^9, 3.831159130205224*^9}, {3.831159672764243*^9, 
   3.831159706356526*^9}, {3.8311597386357193`*^9, 3.831159766951304*^9}, {
   3.831160000165146*^9, 3.8311600468444233`*^9}, {3.8311602055552473`*^9, 
   3.8311602790608387`*^9}, {3.8311604106929083`*^9, 3.831160416125536*^9}, {
   3.831160561357197*^9, 3.8311606238928757`*^9}, {3.831179466705072*^9, 
   3.8311794668013735`*^9}, {3.8311800642572618`*^9, 
   3.8311800806969595`*^9}, {3.831181767119994*^9, 3.8311817673922815`*^9}, {
   3.8315323038321524`*^9, 3.8315323439200163`*^9}, {3.83153241245373*^9, 
   3.831532432657011*^9}, {3.831532465594139*^9, 3.8315325008478374`*^9}, {
   3.831532548439743*^9, 3.8315325880506916`*^9}, {3.831532666323696*^9, 
   3.8315326721957617`*^9}, 3.8315328270135136`*^9, {3.831532868730433*^9, 
   3.831532923021521*^9}, {3.8315329672312984`*^9, 3.831533022973257*^9}, 
   3.831533079531767*^9, {3.8315331213207455`*^9, 3.831533157591982*^9}, {
   3.8315332148827057`*^9, 3.8315332389589305`*^9}, {3.8315333591477413`*^9, 
   3.8315333858136735`*^9}, {3.8315334760207443`*^9, 
   3.8315334948399286`*^9}, {3.831533530110876*^9, 3.831533556610481*^9}, {
   3.8315335916324434`*^9, 3.8315336280913687`*^9}, {3.8315392893753285`*^9, 
   3.8315392903076067`*^9}, {3.831539336028604*^9, 3.8315394058985043`*^9}, {
   3.8315394698710256`*^9, 3.8315394832492867`*^9}, {3.831540484103381*^9, 
   3.8315405415896163`*^9}, {3.8315408150717373`*^9, 
   3.8315408428817854`*^9}, {3.831541010408637*^9, 3.8315410829619646`*^9}, {
   3.831541122268527*^9, 3.8315411273523073`*^9}, {3.8315932814717407`*^9, 
   3.8315933078123198`*^9}, {3.8315933919187536`*^9, 3.831593407923608*^9}, {
   3.831593438894783*^9, 3.8315934395317607`*^9}, 3.8317918718905582`*^9, {
   3.8329128301192894`*^9, 3.8329128307386417`*^9}, {3.832989042585746*^9, 
   3.8329890530543118`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"a553c2d9-ec9e-417a-9b05-f7e73d693e26"],

Cell[BoxData[
 StyleBox["\<\" >NoL*FallOff*BRDF(Ground Lighting):\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8315934085464563`*^9, 3.832913739509099*^9, 
  3.8329890536955833`*^9},
 CellLabel->
  "During evaluation of \
In[95]:=",ExpressionUUID->"e31e2770-bc03-4184-8025-897b7771e553"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lightCenter$$ = {-1, 
    1}, $CellContext`lightRadius$$ = 2, $CellContext`roughness$$ = 
    0.2, $CellContext`viewAngle$$ = Rational[1, 4] Pi, Typeset`show$$ = False,
     Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-1, 1}}, {-2, -2}, {2, 2}}, {{
       Hold[$CellContext`lightRadius$$], 2}, 1, 5}, {{
       Hold[$CellContext`roughness$$], 0.2}, 0.05, 1}, {{
       Hold[$CellContext`viewAngle$$], Rational[1, 4] Pi}, 0, Pi}}, 
    Typeset`size$$ = {177., {47., 53.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`lightCenter$85074$$ = {0, 
    0}, $CellContext`lightRadius$85075$$ = 0, $CellContext`roughness$85076$$ =
     0, $CellContext`viewAngle$85077$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`lightCenter$$ = {-1, 
         1}, $CellContext`lightRadius$$ = 2, $CellContext`roughness$$ = 
        0.2, $CellContext`viewAngle$$ = Rational[1, 4] Pi}, 
      "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$85074$$, {0,
          0}], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$85075$$, 0], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$85076$$, 0], 
        Hold[$CellContext`viewAngle$$, $CellContext`viewAngle$85077$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> gPlots`gParamPlot[
        Association[
         ("lines" -> {
           Association[
           "startPos" -> {0, 0}, "dirVec" -> FromPolarCoordinates[{1, 
               Slot["lineAngle"]}], "length" -> 2]}& )[
          Association["lineAngle" -> $CellContext`viewAngle$$]], 
         ("circles" -> {
           Association[
           "center" -> Slot["lightCenter"], "radius" -> 
            Slot["lightRadius"]]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadius" -> $CellContext`lightRadius$$]], 
         ("groundShadings" -> {
           Association[
           "lightCenter" -> Slot["lightCenter"], "lightRadius" -> 
            Slot["lightRadiusCtrl"], "roughness" -> Slot["roughness"], 
            "viewDir" -> FromPolarCoordinates[{1, 
               Slot["viewAngle"]}], 
            "shadingFunc" -> (Slot["nol"] gBRDF`gPointLightFallOff[
               Slot["lightRadius"], 
               Slot["shadingDist"]] gBRDF`gBrdfFunc[
               Slot["roughness"], 
               Slot["normalDir"], 
               Slot["lightDir"], 
               Slot["viewDir"]]& ), "color" -> Purple, "label" -> "BRDF"]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadiusCtrl" -> $CellContext`lightRadius$$, 
           "roughness" -> $CellContext`roughness$$, 
           "viewAngle" -> $CellContext`viewAngle$$]], "axisExtent" -> 3]], 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-1, 1}}, {-2, -2}, {
         2, 2}}, {{$CellContext`lightRadius$$, 2}, 1, 
         5}, {{$CellContext`roughness$$, 0.2}, 0.05, 
         1}, {{$CellContext`viewAngle$$, Rational[1, 4] Pi}, 0, Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{228., {71., 77.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.831159131399238*^9, 3.831159327764292*^9, 3.8311595949599714`*^9, {
   3.8311597443645015`*^9, 3.8311597678080034`*^9}, 3.8311599510899987`*^9, 
   3.8311602798397307`*^9, {3.83116031710339*^9, 3.8311603241650968`*^9}, {
   3.8311604115733147`*^9, 3.8311604168824177`*^9}, {3.83116057822622*^9, 
   3.831160624710725*^9}, 3.83116241611049*^9, 3.831179270853613*^9, {
   3.831179459708642*^9, 3.8311794677406874`*^9}, 3.8311800816641655`*^9, 
   3.8311801220597467`*^9, {3.831181761499483*^9, 3.8311817680377393`*^9}, 
   3.8311826970159817`*^9, 3.8311842597160144`*^9, 3.831186525176833*^9, 
   3.8315317143380156`*^9, {3.831532407866885*^9, 3.8315324334725294`*^9}, {
   3.831532466167988*^9, 3.8315324788568425`*^9}, 3.8315325093220015`*^9, {
   3.831532565543601*^9, 3.8315325894337225`*^9}, {3.8315326446578074`*^9, 
   3.8315326727561827`*^9}, {3.831532719462315*^9, 3.831532827745146*^9}, {
   3.831532887009447*^9, 3.8315328969079103`*^9}, 3.8315329404160576`*^9, 
   3.8315329803267975`*^9, {3.8315330252098827`*^9, 3.8315330493493347`*^9}, {
   3.8315331083245506`*^9, 3.831533239843913*^9}, 3.8315335204089727`*^9, {
   3.8315335573322372`*^9, 3.8315336305361443`*^9}, 3.8315393107823195`*^9, 
   3.831540241792514*^9, 3.8315403238316236`*^9, {3.8315404854117913`*^9, 
   3.8315404967559557`*^9}, {3.831540529651494*^9, 3.8315405421651344`*^9}, {
   3.831540613791026*^9, 3.8315406474014187`*^9}, 3.8315408239021845`*^9, {
   3.831541046670722*^9, 3.83154108384131*^9}, 3.8315411280025835`*^9, {
   3.8315901844632626`*^9, 3.831590226188836*^9}, {3.8315913044209204`*^9, 
   3.831591326069976*^9}, 3.8315922509575777`*^9, 3.8315926412801466`*^9, 
   3.831592761476427*^9, {3.8315928119450684`*^9, 3.831592841760223*^9}, 
   3.8315929296750736`*^9, {3.831593266495424*^9, 3.83159330895168*^9}, {
   3.831593399310337*^9, 3.831593408583429*^9}, 3.8329137395370255`*^9, 
   3.8329890537199135`*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"bf2c9a81-21ff-4700-be96-6337fa957725"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<>SG Ground Lighting:\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\"\<lines\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<startPos\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
             RowBox[{"FromPolarCoordinates", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "#lineAngle"}], "}"}], "]"}]}], ",", 
            RowBox[{"\"\<length\>\"", "\[Rule]", "2"}]}], "|>"}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{"\"\<lineAngle\>\"", "\[Rule]", "viewAngle"}], "|>"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<circles\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
            RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}]}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<sgGroundShading\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", "    ", 
          RowBox[{
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
             RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadiusCtrl"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
             ",", 
             RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
              RowBox[{"FromPolarCoordinates", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "#viewAngle"}], "}"}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgPointLightOld", "[", 
                 RowBox[{
                 "#lightCenter", ",", "#lightRadius", ",", 
                  "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",", 
                  "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDF", "[", 
                 RowBox[{
                 "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                  "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDFConvLight", "[", 
                 RowBox[{
                 "#lightRadius", ",", "\[IndentingNewLine]", "\t\t\t\t\t\t\t",
                   "#shadingDist", ",", "#sgLight", ",", "#sgNDF"}], "]"}], 
                "&"}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<Old SG Light\>\""}]}], 
            "|>"}], ",", "\[IndentingNewLine]", "  ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
             RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadiusCtrl"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
             ",", 
             RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
              RowBox[{"FromPolarCoordinates", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "#viewAngle"}], "}"}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgPointLightNew", "[", 
                 RowBox[{
                 "#lightCenter", ",", "#lightRadius", ",", 
                  "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",", 
                  "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDF", "[", 
                 RowBox[{
                 "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                  "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDFConvLight", "[", 
                 RowBox[{
                 "#lightRadius", ",", "\[IndentingNewLine]", "\t\t\t\t\t\t\t",
                   "#shadingDist", ",", "#sgLight", ",", "#sgNDF"}], "]"}], 
                "&"}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<New SG Light\>\""}]}], 
            "|>"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         RowBox[{"\"\<lightRadiusCtrl\>\"", "\[Rule]", "lightRadius"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}], 
         ",", 
         RowBox[{"\"\<viewAngle\>\"", "\[Rule]", "viewAngle"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<groundShadings\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", "    ", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
            RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadiusCtrl"}], 
            ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
            RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
             RowBox[{"FromPolarCoordinates", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "#viewAngle"}], "}"}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<shadingFunc\>\"", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#nol", "*", 
                RowBox[{"gPointLightFallOff", "[", 
                 RowBox[{"#lightRadius", ",", "#shadingDist"}], "]"}], "*", 
                "\[IndentingNewLine]", "\t\t\t\t ", 
                RowBox[{"gBrdfFunc", "[", 
                 RowBox[{
                 "#roughness", ",", "#normalDir", ",", "#lightDir", ",", 
                  "#viewDir"}], "]"}]}], "&"}], ")"}]}], ",", 
            "\[IndentingNewLine]", "          ", 
            RowBox[{"\"\<color\>\"", "\[Rule]", "Purple"}], ",", 
            RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<BRDF\>\""}]}], "|>"}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         RowBox[{"\"\<lightRadiusCtrl\>\"", "\[Rule]", "lightRadius"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}], ",", 
         RowBox[{"\"\<viewAngle\>\"", "\[Rule]", "viewAngle"}]}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "3"}]}], "\[IndentingNewLine]",
      "|>"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "2"}], "}"}], ",", "1", ",", "5", ",", 
     "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewAngle", ",", 
       RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", "\[Pi]"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.1"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8311610894027767`*^9, 3.8311611544036455`*^9}, {
   3.8311612217631893`*^9, 3.831161246802561*^9}, {3.831161301003403*^9, 
   3.8311615006533375`*^9}, {3.831161570700322*^9, 3.831161594802808*^9}, {
   3.8311616953812346`*^9, 3.8311617190848975`*^9}, {3.83116181753197*^9, 
   3.8311618682429333`*^9}, {3.831162127234378*^9, 3.8311622816689987`*^9}, {
   3.831162317020039*^9, 3.831162335956648*^9}, {3.8311623672515287`*^9, 
   3.831162400581092*^9}, {3.8311624426353817`*^9, 3.8311626148132424`*^9}, {
   3.8311793149780755`*^9, 3.831179340552803*^9}, 3.831179476291432*^9, {
   3.8311795477062073`*^9, 3.8311795679777617`*^9}, {3.8311809229792013`*^9, 
   3.8311809229871793`*^9}, {3.831181624161186*^9, 3.8311816336028376`*^9}, {
   3.831541161950098*^9, 3.831541166008524*^9}, {3.831541301735651*^9, 
   3.831541314051265*^9}, 3.8315417353437915`*^9, {3.8315915263212233`*^9, 
   3.831591599707803*^9}, {3.831592089970795*^9, 3.8315921158382297`*^9}, {
   3.8315922229737573`*^9, 3.831592277227013*^9}, {3.831592310966921*^9, 
   3.831592356595959*^9}, {3.8315930237433085`*^9, 3.8315931853989983`*^9}, 
   3.8315932497383313`*^9, {3.831593314043335*^9, 3.83159331973883*^9}, {
   3.831593365438961*^9, 3.831593383510313*^9}, {3.8315934273277225`*^9, 
   3.8315934446989455`*^9}, {3.832989077884115*^9, 3.832989079379733*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"830e4848-af02-4d1c-8e35-982b07bfd5a1"],

Cell[BoxData[
 StyleBox["\<\" >SG Ground Lighting:\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.8315934138569202`*^9, 3.831593445579024*^9}, 
   3.8329137399908123`*^9, {3.832989071350895*^9, 3.832989079900614*^9}},
 CellLabel->
  "During evaluation of \
In[103]:=",ExpressionUUID->"41b751e0-75be-4a08-b6a6-a82e5c1ea8aa"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lightCenter$$ = {-1, 
    1}, $CellContext`lightIntensity$$ = 1, $CellContext`lightRadius$$ = 
    2, $CellContext`roughness$$ = 0.1, $CellContext`viewAngle$$ = 
    Rational[1, 4] Pi, Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-1, 1}}, {-2, -2}, {2, 2}}, {{
       Hold[$CellContext`lightRadius$$], 2}, 1, 5, 1}, {{
       Hold[$CellContext`lightIntensity$$], 1}, 1, 10}, {{
       Hold[$CellContext`viewAngle$$], Rational[1, 4] Pi}, 0, Pi}, {{
       Hold[$CellContext`roughness$$], 0.1}, 0.05, 1}}, Typeset`size$$ = {
    222., {55., 61.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$85737$$ = {0, 
    0}, $CellContext`lightRadius$85738$$ = 
    0, $CellContext`lightIntensity$85739$$ = 
    0, $CellContext`viewAngle$85740$$ = 0, $CellContext`roughness$85741$$ = 
    0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`lightCenter$$ = {-1, 
         1}, $CellContext`lightIntensity$$ = 1, $CellContext`lightRadius$$ = 
        2, $CellContext`roughness$$ = 0.1, $CellContext`viewAngle$$ = 
        Rational[1, 4] Pi}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$85737$$, {0,
          0}], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$85738$$, 0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$85739$$, 0], 
        Hold[$CellContext`viewAngle$$, $CellContext`viewAngle$85740$$, 0], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$85741$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> gPlots`gParamPlot[
        Association[
         ("lines" -> {
           Association[
           "startPos" -> {0, 0}, "dirVec" -> FromPolarCoordinates[{1, 
               Slot["lineAngle"]}], "length" -> 2]}& )[
          Association["lineAngle" -> $CellContext`viewAngle$$]], 
         ("circles" -> {
           Association[
           "center" -> Slot["lightCenter"], "radius" -> 
            Slot["lightRadius"]]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadius" -> $CellContext`lightRadius$$]], 
         ("sgGroundShading" -> {
           Association[
           "lightCenter" -> Slot["lightCenter"], "lightRadius" -> 
            Slot["lightRadiusCtrl"], "lightIntensity" -> 
            Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
            "viewDir" -> FromPolarCoordinates[{1, 
               Slot["viewAngle"]}], "sgLightFunc" -> (sgCommon`sgPointLightOld[
              Slot["lightCenter"], 
              Slot["lightRadius"], 
              Slot["lightIntensity"], 
              Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
              Slot["roughness"], 
              Slot["lightDir"], 
              Slot["viewDir"], 
              Slot["normalDir"]]& ), 
            "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
              Slot["lightRadius"], 
              Slot["shadingDist"], 
              Slot["sgLight"], 
              Slot["sgNDF"]]& ), "color" -> Green, "label" -> "Old SG Light"], 
           Association[
           "lightCenter" -> Slot["lightCenter"], "lightRadius" -> 
            Slot["lightRadiusCtrl"], "lightIntensity" -> 
            Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
            "viewDir" -> FromPolarCoordinates[{1, 
               Slot["viewAngle"]}], "sgLightFunc" -> (sgCommon`sgPointLightNew[
              Slot["lightCenter"], 
              Slot["lightRadius"], 
              Slot["lightIntensity"], 
              Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
              Slot["roughness"], 
              Slot["lightDir"], 
              Slot["viewDir"], 
              Slot["normalDir"]]& ), 
            "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
              Slot["lightRadius"], 
              Slot["shadingDist"], 
              Slot["sgLight"], 
              Slot["sgNDF"]]& ), "color" -> Blue, "label" -> 
            "New SG Light"]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadiusCtrl" -> $CellContext`lightRadius$$, 
           "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
           "viewAngle" -> $CellContext`viewAngle$$, 
           "roughness" -> $CellContext`roughness$$]], 
         ("groundShadings" -> {
           Association[
           "lightCenter" -> Slot["lightCenter"], "lightRadius" -> 
            Slot["lightRadiusCtrl"], "roughness" -> Slot["roughness"], 
            "viewDir" -> FromPolarCoordinates[{1, 
               Slot["viewAngle"]}], 
            "shadingFunc" -> (Slot["nol"] gBRDF`gPointLightFallOff[
               Slot["lightRadius"], 
               Slot["shadingDist"]] gBRDF`gBrdfFunc[
               Slot["roughness"], 
               Slot["normalDir"], 
               Slot["lightDir"], 
               Slot["viewDir"]]& ), "color" -> Purple, "label" -> "BRDF"]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadiusCtrl" -> $CellContext`lightRadius$$, 
           "roughness" -> $CellContext`roughness$$, 
           "viewAngle" -> $CellContext`viewAngle$$]], "axisExtent" -> 3]], 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-1, 1}}, {-2, -2}, {
         2, 2}}, {{$CellContext`lightRadius$$, 2}, 1, 5, 
         1}, {{$CellContext`lightIntensity$$, 1}, 1, 
         10}, {{$CellContext`viewAngle$$, Rational[1, 4] Pi}, 0, 
         Pi}, {{$CellContext`roughness$$, 0.1}, 0.05, 1}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{273., {79., 85.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8311623548290195`*^9, {3.831162396487378*^9, 3.8311624189317355`*^9}, {
   3.8311625995310993`*^9, 3.8311626160979023`*^9}, 3.831179271388398*^9, 
   3.8311793172073774`*^9, {3.8311794602481995`*^9, 3.831179477249035*^9}, 
   3.831179568877923*^9, 3.831180122548956*^9, {3.831181621435579*^9, 
   3.8311816341394515`*^9}, 3.8311817994364643`*^9, 3.831182697532007*^9, 
   3.8311848591048307`*^9, 3.8311865304210587`*^9, 3.831531714554264*^9, 
   3.831532644940522*^9, {3.831532767837756*^9, 3.8315327799179983`*^9}, {
   3.8315411468406982`*^9, 3.8315411673030715`*^9}, 3.831541314924038*^9, {
   3.8315915388876047`*^9, 3.8315915478649235`*^9}, 3.8315921742573385`*^9, {
   3.831592216359386*^9, 3.8315922779184127`*^9}, {3.8315923309108486`*^9, 
   3.8315923572326107`*^9}, 3.831592480745599*^9, 3.8315925874573135`*^9, {
   3.8315926319490128`*^9, 3.831592641667082*^9}, {3.831592752863795*^9, 
   3.8315928425005445`*^9}, 3.8315929337133846`*^9, {3.831593049040976*^9, 
   3.831593054935363*^9}, 3.8315931866981087`*^9, 3.831593320740076*^9, {
   3.8315933575469255`*^9, 3.831593445617519*^9}, 3.8329137400157747`*^9, {
   3.8329890713770475`*^9, 3.8329890799245496`*^9}},
 CellLabel->
  "Out[104]=",ExpressionUUID->"efa8f478-26ac-46d1-963c-3472e35d361f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<>Sphere Light Ground Specular:\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\"\<lines\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<startPos\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
             RowBox[{"FromPolarCoordinates", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "#lineAngle"}], "}"}], "]"}]}], ",", 
            RowBox[{"\"\<length\>\"", "\[Rule]", "2"}]}], "|>"}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{"\"\<lineAngle\>\"", "\[Rule]", "viewAngle"}], "|>"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<circles\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "LightGreen"}]}], "|>"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightFadeEnd"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "LightGreen"}]}], "|>"}]}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], ",", 
         RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}]}], 
        "|>"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<sgGroundShading\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", "  ", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], 
            ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], ",",
             "\[IndentingNewLine]", "\t", 
            RowBox[{
            "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], ",", 
            RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
             RowBox[{"FromPolarCoordinates", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "#viewAngle"}], "}"}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sgSphereLight", "[", 
                RowBox[{
                "#lightCenter", ",", "#lightFadeStart", ",", "#lightFadeEnd", 
                 ",", "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",", 
                 "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sgNDF", "[", 
                RowBox[{
                "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                 "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sgNDFConvLight", "[", 
                RowBox[{
                "#lightRadius", ",", "#shadingDist", ",", "#sgLight", ",", 
                 "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<SG Sphere Light\>\""}]}],
            "|>"}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], ",", 
         RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}], 
         ",", 
         RowBox[{"\"\<viewAngle\>\"", "\[Rule]", "viewAngle"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<groundShadings\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", "    ", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
            RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
             RowBox[{"FromPolarCoordinates", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "#viewAngle"}], "}"}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<shadingFunc\>\"", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#nol", "*", " ", 
                RowBox[{"gBrdfFunc", "[", 
                 RowBox[{
                 "#roughness", ",", "#normalDir", ",", "#lightDir", ",", 
                  "#viewDir"}], "]"}]}], "&"}], ")"}]}], ",", 
            "\[IndentingNewLine]", "          ", 
            RowBox[{"\"\<color\>\"", "\[Rule]", "Purple"}], ",", 
            RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<BRDF\>\""}]}], "|>"}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}], ",", 
         RowBox[{"\"\<viewAngle\>\"", "\[Rule]", "viewAngle"}]}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "3"}]}], "\[IndentingNewLine]",
      "|>"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "1"}], "}"}], ",", "1", ",", "3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "5"}], "}"}], ",", "3", ",", "20"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewAngle", ",", 
       RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", "\[Pi]"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.1"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.83299044510005*^9, 3.8329904577469945`*^9}},
 CellLabel->
  "In[731]:=",ExpressionUUID->"4c447f2c-d63a-4ff1-b6a5-31e2bba60abf"],

Cell[BoxData[
 StyleBox["\<\" >Sphere Light Ground Specular:\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8329904596061215`*^9},
 CellLabel->
  "During evaluation of \
In[731]:=",ExpressionUUID->"e0230443-dc63-4699-a406-cdc4e9aaf46f"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lightCenter$$ = {-1, 
    1}, $CellContext`lightFadeEnd$$ = 5, $CellContext`lightFadeStart$$ = 
    1, $CellContext`lightIntensity$$ = 1, $CellContext`roughness$$ = 
    0.1, $CellContext`viewAngle$$ = Rational[1, 4] Pi, Typeset`show$$ = False,
     Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-1, 1}}, {-2, -2}, {2, 2}}, {{
       Hold[$CellContext`lightFadeStart$$], 1}, 1, 3}, {{
       Hold[$CellContext`lightFadeEnd$$], 5}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 1}, 1, 10}, {{
       Hold[$CellContext`viewAngle$$], Rational[1, 4] Pi}, 0, Pi}, {{
       Hold[$CellContext`roughness$$], 0.1}, 0.05, 1}}, Typeset`size$$ = {
    238., {55., 61.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$31942$$ = {0, 
    0}, $CellContext`lightFadeStart$31943$$ = 
    0, $CellContext`lightFadeEnd$31944$$ = 
    0, $CellContext`lightIntensity$31945$$ = 
    0, $CellContext`viewAngle$31946$$ = 0, $CellContext`roughness$31947$$ = 
    0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`lightCenter$$ = {-1, 
         1}, $CellContext`lightFadeEnd$$ = 5, $CellContext`lightFadeStart$$ = 
        1, $CellContext`lightIntensity$$ = 1, $CellContext`roughness$$ = 
        0.1, $CellContext`viewAngle$$ = Rational[1, 4] Pi}, 
      "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$31942$$, {0,
          0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$31943$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$31944$$, 
         0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$31945$$, 0], 
        Hold[$CellContext`viewAngle$$, $CellContext`viewAngle$31946$$, 0], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$31947$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> gPlots`gParamPlot[
        Association[
         ("lines" -> {
           Association[
           "startPos" -> {0, 0}, "dirVec" -> FromPolarCoordinates[{1, 
               Slot["lineAngle"]}], "length" -> 2]}& )[
          Association["lineAngle" -> $CellContext`viewAngle$$]], 
         ("circles" -> {
           Association[
           "center" -> Slot["lightCenter"], "radius" -> 
            Slot["lightFadeStart"], "color" -> LightGreen], 
           Association[
           "center" -> Slot["lightCenter"], "radius" -> Slot["lightFadeEnd"], 
            "color" -> LightGreen]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightFadeStart" -> $CellContext`lightFadeStart$$, 
           "lightFadeEnd" -> $CellContext`lightFadeEnd$$]], 
         ("sgGroundShading" -> {
           Association[
           "lightCenter" -> Slot["lightCenter"], "lightFadeStart" -> 
            Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
            "lightIntensity" -> Slot["lightIntensityCtrl"], "roughness" -> 
            Slot["roughness"], "viewDir" -> FromPolarCoordinates[{1, 
               Slot["viewAngle"]}], "sgLightFunc" -> (sgCommon`sgSphereLight[
              Slot["lightCenter"], 
              Slot["lightFadeStart"], 
              Slot["lightFadeEnd"], 
              Slot["lightIntensity"], 
              Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
              Slot["roughness"], 
              Slot["lightDir"], 
              Slot["viewDir"], 
              Slot["normalDir"]]& ), 
            "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
              Slot["lightRadius"], 
              Slot["shadingDist"], 
              Slot["sgLight"], 
              Slot["sgNDF"]]& ), "color" -> Blue, "label" -> 
            "SG Sphere Light"]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightFadeStart" -> $CellContext`lightFadeStart$$, 
           "lightFadeEnd" -> $CellContext`lightFadeEnd$$, 
           "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
           "viewAngle" -> $CellContext`viewAngle$$, 
           "roughness" -> $CellContext`roughness$$]], 
         ("groundShadings" -> {
           Association[
           "lightCenter" -> Slot["lightCenter"], "roughness" -> 
            Slot["roughness"], "viewDir" -> FromPolarCoordinates[{1, 
               Slot["viewAngle"]}], 
            "shadingFunc" -> (Slot["nol"] gBRDF`gBrdfFunc[
               Slot["roughness"], 
               Slot["normalDir"], 
               Slot["lightDir"], 
               Slot["viewDir"]]& ), "color" -> Purple, "label" -> "BRDF"]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "roughness" -> $CellContext`roughness$$, 
           "viewAngle" -> $CellContext`viewAngle$$]], "axisExtent" -> 3]], 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-1, 1}}, {-2, -2}, {
         2, 2}}, {{$CellContext`lightFadeStart$$, 1}, 1, 
         3}, {{$CellContext`lightFadeEnd$$, 5}, 3, 
         20}, {{$CellContext`lightIntensity$$, 1}, 1, 
         10}, {{$CellContext`viewAngle$$, Rational[1, 4] Pi}, 0, 
         Pi}, {{$CellContext`roughness$$, 0.1}, 0.05, 1}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{289., {79., 85.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8329904596340475`*^9},
 CellLabel->
  "Out[732]=",ExpressionUUID->"4b612fcb-44b0-4796-86db-5041ed9fdbf6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", "\"\<>SG Lighting: Dot vs Product Integral\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\"\<lines\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<startPos\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
             RowBox[{"FromPolarCoordinates", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "#lineAngle"}], "}"}], "]"}]}], ",", 
            RowBox[{"\"\<length\>\"", "\[Rule]", "2"}]}], "|>"}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{"\"\<lineAngle\>\"", "\[Rule]", "viewAngle"}], "|>"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<circles\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
            RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}]}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<sgGroundShading\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", "    ", 
          RowBox[{
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
             RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadiusCtrl"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
             ",", 
             RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
              RowBox[{"FromPolarCoordinates", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "#viewAngle"}], "}"}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgPointLightNew", "[", 
                 RowBox[{
                 "#lightCenter", ",", "#lightRadius", ",", 
                  "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",", 
                  "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDF", "[", 
                 RowBox[{
                 "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                  "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDFProdIntegrateLight", "[", 
                 RowBox[{
                 "#lightRadius", ",", "\[IndentingNewLine]", "\t\t\t\t\t\t\t",
                   "#shadingDist", ",", "#sgLight", ",", "#sgNDF"}], "]"}], 
                "&"}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.03"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<label\>\"", "\[Rule]", "\"\<SG Product Integral\>\""}]}], 
            "|>"}], ",", "\[IndentingNewLine]", "  ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
             RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadiusCtrl"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
             ",", 
             RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
              RowBox[{"FromPolarCoordinates", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "#viewAngle"}], "}"}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgPointLightNew", "[", 
                 RowBox[{
                 "#lightCenter", ",", "#lightRadius", ",", 
                  "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",", 
                  "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDF", "[", 
                 RowBox[{
                 "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                  "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDFConvLight", "[", 
                 RowBox[{
                 "#lightRadius", ",", "\[IndentingNewLine]", "\t\t\t\t\t\t\t",
                   "#shadingDist", ",", "#sgLight", ",", "#sgNDF"}], "]"}], 
                "&"}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<SG Dot\>\""}]}], 
            "|>"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         RowBox[{"\"\<lightRadiusCtrl\>\"", "\[Rule]", "lightRadius"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}], 
         ",", 
         RowBox[{"\"\<viewAngle\>\"", "\[Rule]", "viewAngle"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<groundShadings\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", "    ", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
            RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadiusCtrl"}], 
            ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
            RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
             RowBox[{"FromPolarCoordinates", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "#viewAngle"}], "}"}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<shadingFunc\>\"", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#nol", "*", 
                RowBox[{"gPointLightFallOff", "[", 
                 RowBox[{"#lightRadius", ",", "#shadingDist"}], "]"}], "*", 
                "\[IndentingNewLine]", "\t\t\t\t ", 
                RowBox[{"gBrdfFunc", "[", 
                 RowBox[{
                 "#roughness", ",", "#normalDir", ",", "#lightDir", ",", 
                  "#viewDir"}], "]"}]}], "&"}], ")"}]}], ",", 
            "\[IndentingNewLine]", "          ", 
            RowBox[{"\"\<color\>\"", "\[Rule]", "Purple"}], ",", 
            RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<BRDF\>\""}]}], "|>"}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         RowBox[{"\"\<lightRadiusCtrl\>\"", "\[Rule]", "lightRadius"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}], ",", 
         RowBox[{"\"\<viewAngle\>\"", "\[Rule]", "viewAngle"}]}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "3"}]}], "\[IndentingNewLine]",
      "|>"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "2"}], "}"}], ",", "1", ",", "5", ",", 
     "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewAngle", ",", 
       RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", "\[Pi]"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.1"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8329132797367935`*^9, 3.8329133829155426`*^9}, {
   3.832913825760949*^9, 3.8329138669836597`*^9}, 3.832913925351795*^9, {
   3.832989086262303*^9, 3.8329890879133663`*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"3905c820-41f4-4ebe-97b2-277c61179840"],

Cell[BoxData[
 StyleBox["\<\" >SG Lighting: Dot vs Product Integral\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8329134330952916`*^9, 3.832913557723398*^9, 3.832913740190307*^9, {
   3.832913809111392*^9, 3.832913867766184*^9}, 3.8329139266454144`*^9, 
   3.832989088438038*^9},
 CellLabel->
  "During evaluation of \
In[105]:=",ExpressionUUID->"4d048e64-613a-40ef-b4ab-de42ff7ec4d4"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lightCenter$$ = {-1, 
    1}, $CellContext`lightIntensity$$ = 1, $CellContext`lightRadius$$ = 
    2, $CellContext`roughness$$ = 0.1, $CellContext`viewAngle$$ = 
    Rational[1, 4] Pi, Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-1, 1}}, {-2, -2}, {2, 2}}, {{
       Hold[$CellContext`lightRadius$$], 2}, 1, 5, 1}, {{
       Hold[$CellContext`lightIntensity$$], 1}, 1, 10}, {{
       Hold[$CellContext`viewAngle$$], Rational[1, 4] Pi}, 0, Pi}, {{
       Hold[$CellContext`roughness$$], 0.1}, 0.05, 1}}, Typeset`size$$ = {
    256., {55., 61.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$86570$$ = {0, 
    0}, $CellContext`lightRadius$86571$$ = 
    0, $CellContext`lightIntensity$86572$$ = 
    0, $CellContext`viewAngle$86573$$ = 0, $CellContext`roughness$86574$$ = 
    0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`lightCenter$$ = {-1, 
         1}, $CellContext`lightIntensity$$ = 1, $CellContext`lightRadius$$ = 
        2, $CellContext`roughness$$ = 0.1, $CellContext`viewAngle$$ = 
        Rational[1, 4] Pi}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$86570$$, {0,
          0}], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$86571$$, 0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$86572$$, 0], 
        Hold[$CellContext`viewAngle$$, $CellContext`viewAngle$86573$$, 0], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$86574$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> gPlots`gParamPlot[
        Association[
         ("lines" -> {
           Association[
           "startPos" -> {0, 0}, "dirVec" -> FromPolarCoordinates[{1, 
               Slot["lineAngle"]}], "length" -> 2]}& )[
          Association["lineAngle" -> $CellContext`viewAngle$$]], 
         ("circles" -> {
           Association[
           "center" -> Slot["lightCenter"], "radius" -> 
            Slot["lightRadius"]]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadius" -> $CellContext`lightRadius$$]], 
         ("sgGroundShading" -> {
           Association[
           "lightCenter" -> Slot["lightCenter"], "lightRadius" -> 
            Slot["lightRadiusCtrl"], "lightIntensity" -> 
            Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
            "viewDir" -> FromPolarCoordinates[{1, 
               Slot["viewAngle"]}], "sgLightFunc" -> (sgCommon`sgPointLightNew[
              Slot["lightCenter"], 
              Slot["lightRadius"], 
              Slot["lightIntensity"], 
              Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
              Slot["roughness"], 
              Slot["lightDir"], 
              Slot["viewDir"], 
              Slot["normalDir"]]& ), 
            "sgShadingFunc" -> (sgCommon`sgNDFProdIntegrateLight[
              Slot["lightRadius"], 
              Slot["shadingDist"], 
              Slot["sgLight"], 
              Slot["sgNDF"]]& ), "color" -> Green, "thickness" -> 0.03, 
            "label" -> "SG Product Integral"], 
           Association[
           "lightCenter" -> Slot["lightCenter"], "lightRadius" -> 
            Slot["lightRadiusCtrl"], "lightIntensity" -> 
            Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
            "viewDir" -> FromPolarCoordinates[{1, 
               Slot["viewAngle"]}], "sgLightFunc" -> (sgCommon`sgPointLightNew[
              Slot["lightCenter"], 
              Slot["lightRadius"], 
              Slot["lightIntensity"], 
              Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
              Slot["roughness"], 
              Slot["lightDir"], 
              Slot["viewDir"], 
              Slot["normalDir"]]& ), 
            "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
              Slot["lightRadius"], 
              Slot["shadingDist"], 
              Slot["sgLight"], 
              Slot["sgNDF"]]& ), "color" -> Blue, "label" -> "SG Dot"]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadiusCtrl" -> $CellContext`lightRadius$$, 
           "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
           "viewAngle" -> $CellContext`viewAngle$$, 
           "roughness" -> $CellContext`roughness$$]], 
         ("groundShadings" -> {
           Association[
           "lightCenter" -> Slot["lightCenter"], "lightRadius" -> 
            Slot["lightRadiusCtrl"], "roughness" -> Slot["roughness"], 
            "viewDir" -> FromPolarCoordinates[{1, 
               Slot["viewAngle"]}], 
            "shadingFunc" -> (Slot["nol"] gBRDF`gPointLightFallOff[
               Slot["lightRadius"], 
               Slot["shadingDist"]] gBRDF`gBrdfFunc[
               Slot["roughness"], 
               Slot["normalDir"], 
               Slot["lightDir"], 
               Slot["viewDir"]]& ), "color" -> Purple, "label" -> "BRDF"]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadiusCtrl" -> $CellContext`lightRadius$$, 
           "roughness" -> $CellContext`roughness$$, 
           "viewAngle" -> $CellContext`viewAngle$$]], "axisExtent" -> 3]], 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-1, 1}}, {-2, -2}, {
         2, 2}}, {{$CellContext`lightRadius$$, 2}, 1, 5, 
         1}, {{$CellContext`lightIntensity$$, 1}, 1, 
         10}, {{$CellContext`viewAngle$$, Rational[1, 4] Pi}, 0, 
         Pi}, {{$CellContext`roughness$$, 0.1}, 0.05, 1}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{307., {79., 85.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.832913433121644*^9, 3.8329135577453413`*^9, 3.8329137402112527`*^9, {
   3.8329138091382093`*^9, 3.832913867801625*^9}, 3.8329139266678286`*^9, 
   3.8329890884579554`*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"0f5ad828-e7ec-402c-925c-ef1fd0a8b10b"]
}, Open  ]]
},
WindowSize->{967, 763},
WindowMargins->{{40, Automatic}, {20, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 7253, 156, 599, "Input",ExpressionUUID->"a553c2d9-ec9e-417a-9b05-f7e73d693e26"],
Cell[7836, 180, 358, 9, 30, "Print",ExpressionUUID->"e31e2770-bc03-4184-8025-897b7771e553"],
Cell[8197, 191, 6105, 110, 167, "Output",ExpressionUUID->"bf2c9a81-21ff-4700-be96-6337fa957725"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14339, 306, 11433, 243, 979, "Input",ExpressionUUID->"830e4848-af02-4d1c-8e35-982b07bfd5a1"],
Cell[25775, 551, 393, 9, 30, "Print",ExpressionUUID->"41b751e0-75be-4a08-b6a6-a82e5c1ea8aa"],
Cell[26171, 562, 7893, 151, 183, "Output",ExpressionUUID->"efa8f478-26ac-46d1-963c-3472e35d361f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34101, 718, 8496, 194, 846, "Input",ExpressionUUID->"4c447f2c-d63a-4ff1-b6a5-31e2bba60abf"],
Cell[42600, 914, 305, 8, 30, "Print",ExpressionUUID->"e0230443-dc63-4699-a406-cdc4e9aaf46f"],
Cell[42908, 924, 6323, 126, 183, "Output",ExpressionUUID->"4b612fcb-44b0-4796-86db-5041ed9fdbf6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49268, 1055, 10431, 232, 998, "Input",ExpressionUUID->"3905c820-41f4-4ebe-97b2-277c61179840"],
Cell[59702, 1289, 459, 11, 30, "Print",ExpressionUUID->"4d048e64-613a-40ef-b4ab-de42ff7ec4d4"],
Cell[60164, 1302, 6920, 138, 183, "Output",ExpressionUUID->"0f5ad828-e7ec-402c-925c-ef1fd0a8b10b"]
}, Open  ]]
}
]
*)

