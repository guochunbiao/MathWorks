(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    102565,       2308]
NotebookOptionsPosition[    100737,       2271]
NotebookOutlinePosition[    101081,       2286]
CellTagsIndexPosition[    101038,       2283]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Wall Shading Template\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "rightWallHeight", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"rightWallHeight", "=", "2"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"light", " ", "circle"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "#wallPosY"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<wallPosY\>\"", "\[Rule]", "wallPosY"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"view", " ", "ray"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "viewDir"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "3"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "1"}], "}"}], ",", "1", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"wallPosY", ",", "0"}], "}"}], ",", "0", ",", 
     "rightWallHeight"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "rightWallHeight", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.833268293240923*^9, 3.833268294704982*^9}, {
  3.83326832970101*^9, 3.8332683407930527`*^9}, {3.833268895370757*^9, 
  3.833268901764413*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"85eed16e-5dcb-4532-9710-6fa04a54f8db"],

Cell[BoxData[
 StyleBox["\<\" Wall Shading Template\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8332683483803415`*^9, 3.8332689265156007`*^9},
 CellLabel->
  "During evaluation of \
In[299]:=",ExpressionUUID->"6b2aab7e-9a0c-4cf3-b89e-7c8e205af085"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`leftWallHeight$$ = 
    1, $CellContext`lightCenter$$ = {-3, 2}, $CellContext`lightRadius$$ = 
    1, $CellContext`viewDir$$ = {1, 1}, $CellContext`wallPosY$$ = 0, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-3, 2}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightRadius$$], 1}, 1, 5}, {{
       Hold[$CellContext`leftWallHeight$$], 1}, 0, 2}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`wallPosY$$], 0}, 0, 2}}, Typeset`size$$ = {
    146., {66., 72.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$664653$$ = {0, 
    0}, $CellContext`lightRadius$664654$$ = 
    0, $CellContext`leftWallHeight$664655$$ = 
    0, $CellContext`viewDir$664656$$ = {0, 
    0}, $CellContext`wallPosY$664657$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`leftWallHeight$$ = 
        1, $CellContext`lightCenter$$ = {-3, 2}, $CellContext`lightRadius$$ = 
        1, $CellContext`viewDir$$ = {1, 1}, $CellContext`wallPosY$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$664653$$, {
         0, 0}], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$664654$$, 
         0], 
        Hold[$CellContext`leftWallHeight$$, \
$CellContext`leftWallHeight$664655$$, 0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$664656$$, {0, 0}], 
        Hold[$CellContext`wallPosY$$, $CellContext`wallPosY$664657$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`rightWallHeight = 2; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> Slot["lightRadius"]], 
            Association["center" -> {2, 
               Slot["wallPosY"]}, "radius" -> 0.1, "color" -> Red]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightRadius" -> $CellContext`lightRadius$$, 
            "wallPosY" -> $CellContext`wallPosY$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Green, 
             "thickness" -> 0.015], 
            Association[
            "startPos" -> {0, 0}, "dirVec" -> $CellContext`viewDir$$, 
             "length" -> 3]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], "axisExtent" -> 5]]), 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-3, 2}}, {-4, -4}, {
         4, 4}}, {{$CellContext`lightRadius$$, 1}, 1, 
         5}, {{$CellContext`leftWallHeight$$, 1}, 0, 
         2}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`wallPosY$$, 0}, 
         0, $CellContext`rightWallHeight}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{197., {90., 96.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8332683484122562`*^9, 3.833268926550467*^9},
 CellLabel->
  "Out[308]=",ExpressionUUID->"dd781613-9172-4ab8-9321-7cbf6d74febc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Wall Cone\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "rightWallHeight", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"rightWallHeight", "=", "2"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"light", " ", "circle"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "#wallPosY"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<wallPosY\>\"", "\[Rule]", "wallPosY"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"view", " ", "ray"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "viewDir"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "3"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<cones\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"2", ",", "#wallPosY"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<cone\>\"", "\[Rule]", 
              RowBox[{"gCreateCone", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"2", ",", "#wallPosY"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "#leftWallHeight"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "10"}], "}"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<wallPosY\>\"", "\[Rule]", "wallPosY"}], ",", 
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}]}], 
         "|>"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "1"}], "}"}], ",", "1", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "1"}], "}"}], ",", "0", ",", "3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"wallPosY", ",", "2"}], "}"}], ",", "0", ",", 
     "rightWallHeight"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "rightWallHeight", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8332686204862237`*^9, 3.833268645261631*^9}, {
   3.833268912607446*^9, 3.8332689190371857`*^9}, 3.833322399008932*^9},
 CellLabel->
  "In[780]:=",ExpressionUUID->"134d42c6-9013-4db3-9e91-e4fd300823ba"],

Cell[BoxData[
 StyleBox["\<\" Wall Cone\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.83326862544803*^9, 3.833268646075*^9}, 
   3.8332689236130295`*^9, 3.83331987243906*^9, 3.833322402190652*^9},
 CellLabel->
  "During evaluation of \
In[780]:=",ExpressionUUID->"c0e90d58-6824-4802-8a60-aa9f848948d5"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`leftWallHeight$$ = 
    1, $CellContext`lightCenter$$ = {-3, 2}, $CellContext`lightRadius$$ = 
    1, $CellContext`viewDir$$ = {1, 1}, $CellContext`wallPosY$$ = 2, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-3, 2}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightRadius$$], 1}, 1, 5}, {{
       Hold[$CellContext`leftWallHeight$$], 1}, 0, 3}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`wallPosY$$], 2}, 0, 2}}, Typeset`size$$ = {
    146., {78., 84.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$3493309$$ = {0, 
    0}, $CellContext`lightRadius$3493310$$ = 
    0, $CellContext`leftWallHeight$3493311$$ = 
    0, $CellContext`viewDir$3493312$$ = {0, 
    0}, $CellContext`wallPosY$3493313$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`leftWallHeight$$ = 
        1, $CellContext`lightCenter$$ = {-3, 2}, $CellContext`lightRadius$$ = 
        1, $CellContext`viewDir$$ = {1, 1}, $CellContext`wallPosY$$ = 2}, 
      "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$3493309$$, {
         0, 0}], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$3493310$$, 
         0], 
        Hold[$CellContext`leftWallHeight$$, \
$CellContext`leftWallHeight$3493311$$, 0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$3493312$$, {0, 0}], 
        Hold[$CellContext`wallPosY$$, $CellContext`wallPosY$3493313$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`rightWallHeight = 2; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> Slot["lightRadius"]], 
            Association["center" -> {2, 
               Slot["wallPosY"]}, "radius" -> 0.1, "color" -> Red]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightRadius" -> $CellContext`lightRadius$$, 
            "wallPosY" -> $CellContext`wallPosY$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Green, 
             "thickness" -> 0.015], 
            Association[
            "startPos" -> {0, 0}, "dirVec" -> $CellContext`viewDir$$, 
             "length" -> 3]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("cones" -> {
            Association["origin" -> {2, 
               Slot["wallPosY"]}, "radius" -> 5, "cone" -> 
             gUtils`gCreateCone[{2, 
                Slot["wallPosY"]}, {-2, 
                Slot["leftWallHeight"]}, {2, 10}], "color" -> Red]}& )[
           Association[
           "wallPosY" -> $CellContext`wallPosY$$, 
            "leftWallHeight" -> $CellContext`leftWallHeight$$]], "axisExtent" -> 
          5]]), "Specifications" :> {{{$CellContext`lightCenter$$, {-3, 
          2}}, {-4, -4}, {4, 4}}, {{$CellContext`lightRadius$$, 1}, 1, 
         5}, {{$CellContext`leftWallHeight$$, 1}, 0, 
         3}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`wallPosY$$, 2}, 
         0, $CellContext`rightWallHeight}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{197., {102., 108.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.83326862549257*^9, 3.833268646114921*^9}, 
   3.8332689236483264`*^9, 3.833319872474966*^9, 3.833322402217126*^9},
 CellLabel->
  "Out[782]=",ExpressionUUID->"060ac4e4-fe4a-493d-acc0-fd3440c7a347"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<SG Light Lobe at Wall(Area Percent)\>\"", "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "rightWallHeight", ",", "oldLightSg2D", ",", "oldLightSg3D", ",", 
    "newLightSg3D", ",", "newLightSg2D", ",", "bentCone", ",", 
    "\[IndentingNewLine]", "\t", "coneTheta2D", ",", "coneAperture", ",", 
    "coneCapAxis", ",", "coneCap", ",", "areaPercent"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"rightWallHeight", "=", "2"}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"oldLightSg2D", "=", 
     RowBox[{
      RowBox[{"sgSphereLight", "[", 
       RowBox[{
       "lightCenter", ",", "lightFadeStart", ",", "\[IndentingNewLine]", 
        "\t\t", "lightFadeEnd", ",", "lightIntensity", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "wallPosY"}], "}"}]}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"oldLightSg3D", "=", 
     RowBox[{"sgTo3D", "[", "oldLightSg2D", "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"bentCone", "=", 
     RowBox[{
      RowBox[{"gCreateCone", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "wallPosY"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "10"}], "}"}]}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneTheta2D", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneAperture", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCapAxis", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "coneTheta2D", "]"}], ",", "0", ",", 
        RowBox[{"Sin", "[", "coneTheta2D", "]"}]}], "}"}], "//", "N"}]}], ";",
     "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCap", "=", 
     RowBox[{"{", 
      RowBox[{"coneCapAxis", ",", "coneAperture"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"newLightSg3D", "=", 
       RowBox[{
        RowBox[{"Quiet", "@", 
         RowBox[{"sgCapIntsAsNewSG", "[", 
          RowBox[{"oldLightSg3D", ",", "coneCap"}], "]"}]}], "//", "N"}]}], 
      ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"newLightSg2D", "=", 
       RowBox[{"sgTo2D", "[", "newLightSg3D", "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"areaPercent", "=", 
     RowBox[{"sgCapIntsAreaPercent", "[", 
      RowBox[{"oldLightSg3D", ",", "coneCap"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"newLightSg2D", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"oldLightSg2D", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"oldLightSg2D", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"areaPercent", "*", 
        RowBox[{"oldLightSg2D", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"light", " ", "circle"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "#wallPosY"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<wallPosY\>\"", "\[Rule]", "wallPosY"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"view", " ", "ray"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", "viewDir"}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "3"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<cones\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"2", ",", "#wallPosY"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<cone\>\"", "\[Rule]", "bentCone"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Cyan"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{"\"\<wallPosY\>\"", "\[Rule]", "wallPosY"}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lobes\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<origin\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "#wallPosY"}], "}"}]}], ",", 
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",",
               "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
              RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
              ",", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensity"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<lobeFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#shadingPos", "+", 
                   RowBox[{"lightIntensity", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"sgVector", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ",", 
                    "oldLightSg2D"}], "]"}]}]}], ")"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Orange"}], ",", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<Old Light Lobe\>\""}]}], 
             "|>"}], ",", "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<origin\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "#wallPosY"}], "}"}]}], ",", 
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",",
               "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
              RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
              ",", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensity"}], ",", 
              RowBox[{"\"\<lobeFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#shadingPos", "+", 
                   RowBox[{"lightIntensity", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"sgVector", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ",", 
                    "newLightSg2D"}], "]"}]}]}], ")"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<New Light Lobe\>\""}]}], 
             "|>"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<wallPosY\>\"", "\[Rule]", "wallPosY"}], ",", 
          RowBox[{"\"\<lightIntensity\>\"", "\[Rule]", "lightIntensity"}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}]}], 
         "|>"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "3"}], "}"}], ",", "1", ",", "3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "5"}], "}"}], ",", "3", ",", "20"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "2"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "1"}], "}"}], ",", "1", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", 
       RowBox[{"rightWallHeight", "+", "0.01"}]}], "}"}], ",", 
     RowBox[{"rightWallHeight", "+", "0.01"}], ",", "5"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"wallPosY", ",", "1"}], "}"}], ",", "0", ",", 
     "rightWallHeight"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "rightWallHeight", ",", "oldLightSg2D", ",", "oldLightSg3D", ",", 
    "newLightSg3D", ",", "newLightSg2D", ",", "bentCone", ",", 
    "\[IndentingNewLine]", "\t", "coneTheta2D", ",", "coneAperture", ",", 
    "coneCapAxis", ",", "coneCap", ",", "areaPercent"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.833270287950264*^9, 3.8332703000388045`*^9}, {
   3.8332703701830482`*^9, 3.833270418800189*^9}, 3.8333172544710054`*^9},
 CellLabel->
  "In[128]:=",ExpressionUUID->"f6f2a226-5b97-450e-81bf-4690be0f8cf5"],

Cell[BoxData[
 StyleBox["\<\" SG Light Lobe at Wall(Area Percent)\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.8332703830116067`*^9, 3.8332704198056602`*^9}, 
   3.8333172550713987`*^9},
 CellLabel->
  "During evaluation of \
In[128]:=",ExpressionUUID->"1399ba05-ce63-41aa-81cf-f139f52ca9e8"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`leftWallHeight$$ = 
    2.01, $CellContext`lightCenter$$ = {-3, 2}, $CellContext`lightFadeEnd$$ = 
    5, $CellContext`lightFadeStart$$ = 3, $CellContext`lightIntensity$$ = 
    2, $CellContext`lightRadius$$ = 1, $CellContext`viewDir$$ = {1, 
    1}, $CellContext`wallPosY$$ = 1, Typeset`show$$ = False, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-3, 2}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightFadeStart$$], 3}, 1, 3}, {{
       Hold[$CellContext`lightFadeEnd$$], 5}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 2}, 1, 10}, {{
       Hold[$CellContext`lightRadius$$], 1}, 1, 5}, {{
       Hold[$CellContext`leftWallHeight$$], 2.01}, 2.01, 5}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`wallPosY$$], 1}, 0, 2}}, Typeset`size$$ = {
    235., {101., 107.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$132149$$ = {0, 
    0}, $CellContext`lightFadeStart$132150$$ = 
    0, $CellContext`lightFadeEnd$132151$$ = 
    0, $CellContext`lightIntensity$132152$$ = 
    0, $CellContext`lightRadius$132153$$ = 
    0, $CellContext`leftWallHeight$132154$$ = 
    0, $CellContext`viewDir$132155$$ = {0, 
    0}, $CellContext`wallPosY$132156$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`leftWallHeight$$ = 
        0.01 + $CellContext`rightWallHeight, $CellContext`lightCenter$$ = {-3,
          2}, $CellContext`lightFadeEnd$$ = 5, $CellContext`lightFadeStart$$ = 
        3, $CellContext`lightIntensity$$ = 2, $CellContext`lightRadius$$ = 
        1, $CellContext`viewDir$$ = {1, 1}, $CellContext`wallPosY$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$132149$$, {
         0, 0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$132150$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$132151$$, 
         0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$132152$$, 0], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$132153$$, 
         0], 
        Hold[$CellContext`leftWallHeight$$, \
$CellContext`leftWallHeight$132154$$, 0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$132155$$, {0, 0}], 
        Hold[$CellContext`wallPosY$$, $CellContext`wallPosY$132156$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`rightWallHeight = 2; $CellContext`oldLightSg2D = 
        N[
          
          sgCommon`sgSphereLight[$CellContext`lightCenter$$, \
$CellContext`lightFadeStart$$, $CellContext`lightFadeEnd$$, \
$CellContext`lightIntensity$$, {
           2, $CellContext`wallPosY$$}]]; $CellContext`oldLightSg3D = 
        sgCommon`sgTo3D[$CellContext`oldLightSg2D]; $CellContext`bentCone = N[
          
          gUtils`gCreateCone[{
           2, $CellContext`wallPosY$$}, {-2, $CellContext`leftWallHeight$$}, {
           2, 10}]]; $CellContext`coneTheta2D = N[
          Part[$CellContext`bentCone, 1]]; $CellContext`coneAperture = N[
          Part[$CellContext`bentCone, 2]]; $CellContext`coneCapAxis = N[{
           Cos[$CellContext`coneTheta2D], 0, 
           
           Sin[$CellContext`coneTheta2D]}]; $CellContext`coneCap = \
{$CellContext`coneCapAxis, $CellContext`coneAperture}; \
$CellContext`areaPercent = 
        sgCommon`sgCapIntsAreaPercent[$CellContext`oldLightSg3D, \
$CellContext`coneCap]; $CellContext`newLightSg2D = {
          Part[$CellContext`oldLightSg2D, 1], 
          Part[$CellContext`oldLightSg2D, 2], $CellContext`areaPercent 
          Part[$CellContext`oldLightSg2D, 3]}; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> Slot["lightRadius"]], 
            Association["center" -> {2, 
               Slot["wallPosY"]}, "radius" -> 0.1, "color" -> Red]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightRadius" -> $CellContext`lightRadius$$, 
            "wallPosY" -> $CellContext`wallPosY$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Green, 
             "thickness" -> 0.015], 
            Association[
            "startPos" -> {0, 0}, "dirVec" -> $CellContext`viewDir$$, 
             "length" -> 3]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("cones" -> {
            Association["origin" -> {2, 
               Slot["wallPosY"]}, "radius" -> 5, 
             "cone" -> $CellContext`bentCone, "color" -> Cyan]}& )[
           Association["wallPosY" -> $CellContext`wallPosY$$]], 
          ("lobes" -> {
            Association["origin" -> {2, 
               Slot["wallPosY"]}, "lightCenter" -> Slot["lightCenter"], 
             "lightFadeStart" -> Slot["lightFadeStart"], "lightFadeEnd" -> 
             Slot["lightFadeEnd"], "lightIntensity" -> Slot["lightIntensity"],
              "lobeFunc" -> (
              Slot["shadingPos"] + $CellContext`lightIntensity$$ {
                 Cos[
                  Slot["\[Theta]"]], 
                 Sin[
                  Slot["\[Theta]"]]} sgCommon`sgVector[{
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}, $CellContext`oldLightSg2D]& ), "color" -> 
             Orange, "label" -> "Old Light Lobe"], 
            Association["origin" -> {2, 
               Slot["wallPosY"]}, "lightCenter" -> Slot["lightCenter"], 
             "lightFadeStart" -> Slot["lightFadeStart"], "lightFadeEnd" -> 
             Slot["lightFadeEnd"], "lightIntensity" -> Slot["lightIntensity"],
              "lobeFunc" -> (
              Slot["shadingPos"] + $CellContext`lightIntensity$$ {
                 Cos[
                  Slot["\[Theta]"]], 
                 Sin[
                  Slot["\[Theta]"]]} sgCommon`sgVector[{
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}, $CellContext`newLightSg2D]& ), "color" -> 
             Red, "label" -> "New Light Lobe"]}& )[
           Association[
           "wallPosY" -> $CellContext`wallPosY$$, 
            "lightIntensity" -> $CellContext`lightIntensity$$, 
            "lightCenter" -> $CellContext`lightCenter$$, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "lightFadeEnd" -> $CellContext`lightFadeEnd$$]], "axisExtent" -> 
          5]]), "Specifications" :> {{{$CellContext`lightCenter$$, {-3, 
          2}}, {-4, -4}, {4, 4}}, {{$CellContext`lightFadeStart$$, 3}, 1, 
         3}, {{$CellContext`lightFadeEnd$$, 5}, 3, 
         20}, {{$CellContext`lightIntensity$$, 2}, 1, 
         10}, {{$CellContext`lightRadius$$, 1}, 1, 
         5}, {{$CellContext`leftWallHeight$$, 
          0.01 + $CellContext`rightWallHeight}, 
         0.01 + $CellContext`rightWallHeight, 
         5}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`wallPosY$$, 1}, 
         0, $CellContext`rightWallHeight}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{286., {125., 131.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8332703830490956`*^9, 3.8332704198440557`*^9}, 
   3.83331725511528*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"67fd3cfd-5db5-4d4c-9f14-9912e1cab0ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", "\"\<SG wall lighting for various ground points\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "rightWallHeight", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"rightWallHeight", "=", "3"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"light", " ", "circle"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.03"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}]}], "|>"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgRightWallShading\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "  ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",",
               "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallXRange\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallHeights\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#leftWallHeight", ",", "#rightWallHeight"}], "}"}]}],
               ",", "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
              ",", 
              RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<eyePoint\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgSphereLight", "[", 
                  RowBox[{
                  "#lightCenter", ",", "#lightFadeStart", ",", 
                   "#lightFadeEnd", ",", "\[IndentingNewLine]", "\t\t", 
                   "#lightIntensity", ",", "#shadingPos"}], "]"}], "&"}], 
                ")"}]}], ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDF", "[", 
                  RowBox[{
                  "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                   "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDFConvLight", "[", 
                  RowBox[{
                  "#lightRadius", ",", "#shadingDist", ",", "#sgLight", ",", 
                   "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgPercentStrategy\>\"", "\[Rule]", "1"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<SG wall Lighting\>\""}]}], 
             "|>"}], ",", "\[IndentingNewLine]", "  ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",",
               "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallXRange\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallHeights\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#leftWallHeight", ",", "#rightWallHeight"}], "}"}]}],
               ",", "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
              ",", 
              RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<eyePoint\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgSphereLight", "[", 
                  RowBox[{
                  "#lightCenter", ",", "#lightFadeStart", ",", 
                   "#lightFadeEnd", ",", "\[IndentingNewLine]", "\t\t", 
                   "#lightIntensity", ",", "#shadingPos"}], "]"}], "&"}], 
                ")"}]}], ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDF", "[", 
                  RowBox[{
                  "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                   "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDFConvLight", "[", 
                  RowBox[{
                  "#lightRadius", ",", "#shadingDist", ",", "#sgLight", ",", 
                   "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgPercentStrategy\>\"", "\[Rule]", "3"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<Area Percent Lighting\>\""}]}],
              "|>"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}],
           ",", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
          ",", "\t\t", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "2.5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eyePoint", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "4"}], ",", 
         RowBox[{"-", "4"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ","}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "3"}], "}"}], ",", "1", ",", "3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "5"}], "}"}], ",", "3", ",", "20"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "2"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "6"}], "}"}], ",", "1", ",", "6"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "2"}], "}"}], ",", "0", ",", "5"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.1"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "rightWallHeight", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8333230915821843`*^9, 3.833323174432666*^9}},
 CellLabel->
  "In[890]:=",ExpressionUUID->"f32b2151-b8b3-4372-bfc0-e7be0f7bc7d9"],

Cell[BoxData[
 StyleBox["\<\" SG wall lighting for various ground points\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.8333231263585663`*^9, 3.833323185580241*^9}},
 CellLabel->
  "During evaluation of \
In[890]:=",ExpressionUUID->"19ffd70b-59ea-4813-ba16-d5c8899aeb48"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`leftWallHeight$$ = 
    2, $CellContext`lightCenter$$ = {-3, 2.5}, $CellContext`lightFadeEnd$$ = 
    5, $CellContext`lightFadeStart$$ = 3, $CellContext`lightIntensity$$ = 
    2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
    0.1, $CellContext`shadingPosX$$ = 0, $CellContext`viewDir$$ = {1, 1}, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-3, 2.5}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightFadeStart$$], 3}, 1, 3}, {{
       Hold[$CellContext`lightFadeEnd$$], 5}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 2}, 1, 10}, {{
       Hold[$CellContext`lightRadius$$], 6}, 1, 6}, {{
       Hold[$CellContext`leftWallHeight$$], 2}, 0, 5}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`roughness$$], 0.1}, 0.05, 1}, {{
       Hold[$CellContext`shadingPosX$$], 0}, -2, 2}}, Typeset`size$$ = {
    256., {83., 89.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$6164631$$ = {0, 
    0}, $CellContext`lightFadeStart$6164632$$ = 
    0, $CellContext`lightFadeEnd$6164633$$ = 
    0, $CellContext`lightIntensity$6164634$$ = 
    0, $CellContext`lightRadius$6164635$$ = 
    0, $CellContext`leftWallHeight$6164636$$ = 
    0, $CellContext`viewDir$6164637$$ = {0, 
    0}, $CellContext`roughness$6164638$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`leftWallHeight$$ = 
        2, $CellContext`lightCenter$$ = {-3, 
          2.5}, $CellContext`lightFadeEnd$$ = 
        5, $CellContext`lightFadeStart$$ = 3, $CellContext`lightIntensity$$ = 
        2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
        0.1, $CellContext`shadingPosX$$ = 0, $CellContext`viewDir$$ = {1, 1}},
       "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$6164631$$, {
         0, 0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$6164632$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$6164633$$,
          0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$6164634$$, 0], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$6164635$$, 
         0], 
        Hold[$CellContext`leftWallHeight$$, \
$CellContext`leftWallHeight$6164636$$, 0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$6164637$$, {0, 0}], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$6164638$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`rightWallHeight = 3; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> 0.1, "color" -> Red, 
             "thickness" -> 0.02], 
            Association[
            "center" -> Slot["lightCenter"], "radius" -> Slot["lightRadius"]], 
            Association["center" -> {
               Slot["shadingPosX"], 0}, "radius" -> 0.1, "color" -> Red, 
             "thickness" -> 0.03]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightRadius" -> $CellContext`lightRadius$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Green, 
             "thickness" -> 0.015]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("sgRightWallShading" -> {
            Association[
            "lightCenter" -> Slot["lightCenter"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "wallXRange" -> {-2, 2}, "wallHeights" -> {
               Slot["leftWallHeight"], 
               Slot["rightWallHeight"]}, "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
             "eyePoint" -> {
               Slot["shadingPosX"], 0}, 
             "sgLightFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
               Slot["roughness"], 
               Slot["lightDir"], 
               Slot["viewDir"], 
               Slot["normalDir"]]& ), 
             "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
               Slot["lightRadius"], 
               Slot["shadingDist"], 
               Slot["sgLight"], 
               Slot["sgNDF"]]& ), "sgPercentStrategy" -> 1, "color" -> Red, 
             "label" -> "SG wall Lighting"], 
            Association[
            "lightCenter" -> Slot["lightCenter"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "wallXRange" -> {-2, 2}, "wallHeights" -> {
               Slot["leftWallHeight"], 
               Slot["rightWallHeight"]}, "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
             "eyePoint" -> {
               Slot["shadingPosX"], 0}, 
             "sgLightFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
               Slot["roughness"], 
               Slot["lightDir"], 
               Slot["viewDir"], 
               Slot["normalDir"]]& ), 
             "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
               Slot["lightRadius"], 
               Slot["shadingDist"], 
               Slot["sgLight"], 
               Slot["sgNDF"]]& ), "sgPercentStrategy" -> 3, "color" -> Blue, 
             "label" -> "Area Percent Lighting"]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "lightFadeEnd" -> $CellContext`lightFadeEnd$$, 
            "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight, 
            "roughness" -> $CellContext`roughness$$]], "axisExtent" -> 5]]), 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-3, 
           2.5}}, {-4, -4}, {4, 4}}, {{$CellContext`lightFadeStart$$, 3}, 1, 
         3}, {{$CellContext`lightFadeEnd$$, 5}, 3, 
         20}, {{$CellContext`lightIntensity$$, 2}, 1, 
         10}, {{$CellContext`lightRadius$$, 6}, 1, 
         6}, {{$CellContext`leftWallHeight$$, 2}, 0, 
         5}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`roughness$$, 0.1}, 0.05, 
         1}, {{$CellContext`shadingPosX$$, 0}, -2, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{307., {107., 113.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.833323126397462*^9, 3.833323185604661*^9}},
 CellLabel->
  "Out[892]=",ExpressionUUID->"64a44db1-13db-44d6-b509-976cb5df6ddd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", "\"\<GGX Lobe(at ground) vs Wall Lighting\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "rightWallHeight", ",", "groundViewDir", ",", "groundLightDir", ",", 
    "wallViewDir", ",", "wallLightDir"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"rightWallHeight", "=", "3"}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"groundViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"eyePoint", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"groundLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}], "-", 
       RowBox[{"{", 
        RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", 
       RowBox[{"{", 
        RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"light", " ", "circle"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"eye", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#eyePoint"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Magenta"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "eyePoint"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lobes\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensity"}],
              ",", 
             RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<normalDir\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], ")"}], "&"}], ")"}]}], ",", 
             RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", "groundViewDir", ")"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightDir\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                   RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ")"}], 
                "&"}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lobeFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#shadingPos", "+", 
                  RowBox[{"0.1", "*", "lightIntensity", "*", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                   RowBox[{"gDGGX", "[", 
                    RowBox[{"#roughness", ",", "#noh"}], "]"}]}]}], ")"}], 
                "&"}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
             RowBox[{
             "\"\<label\>\"", "\[Rule]", 
              "\"\<GGX Lobe(view from eye)\>\""}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          RowBox[{"\"\<lightIntensity\>\"", "\[Rule]", "lightIntensity"}], 
          ",", 
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgRightWallShading\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}],
              ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<wallXRange\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<wallHeights\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#leftWallHeight", ",", "#rightWallHeight"}], "}"}]}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
             ",", 
             RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<eyePoint\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgSphereLight", "[", 
                 RowBox[{
                 "#lightCenter", ",", "#lightFadeStart", ",", "#lightFadeEnd",
                   ",", "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",",
                   "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDF", "[", 
                 RowBox[{
                 "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                  "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDFConvLight", "[", 
                 RowBox[{
                 "#lightRadius", ",", "#shadingDist", ",", "#sgLight", ",", 
                  "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgPercentStrategy\>\"", "\[Rule]", "3"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<label\>\"", "\[Rule]", 
              "\"\<Wall Lighting(view from ground)\>\""}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}],
           ",", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
          ",", "\t\t", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "2.5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eyePoint", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "3"}], "}"}], ",", "1", ",", "3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "5"}], "}"}], ",", "3", ",", "20"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "2"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "6"}], "}"}], ",", "1", ",", "6"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "2"}], "}"}], ",", "0", ",", "5"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.1"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "rightWallHeight", ",", "groundViewDir", ",", "groundLightDir", ",", 
    "wallViewDir", ",", "wallLightDir"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8333326490843935`*^9, 3.833332677643402*^9}},
 CellLabel->
  "In[1870]:=",ExpressionUUID->"83f03bfc-ce61-4743-96c4-3a463e700da3"],

Cell[BoxData[
 StyleBox["\<\" GGX Lobe(at ground) vs Wall Lighting\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8333326790137606`*^9},
 CellLabel->
  "During evaluation of \
In[1870]:=",ExpressionUUID->"c84be0b2-c5d2-434b-904d-ad2d554c1403"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eyePoint$$ = {-3, 
    3}, $CellContext`leftWallHeight$$ = 
    0., $CellContext`lightCenter$$ = {-3, 2.5}, $CellContext`lightFadeEnd$$ = 
    5, $CellContext`lightFadeStart$$ = 3, $CellContext`lightIntensity$$ = 
    2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
    0.1, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 1}, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-3, 2.5}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`eyePoint$$], {-3, 3}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightFadeStart$$], 3}, 1, 3}, {{
       Hold[$CellContext`lightFadeEnd$$], 5}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 2}, 1, 10}, {{
       Hold[$CellContext`lightRadius$$], 6}, 1, 6}, {{
       Hold[$CellContext`leftWallHeight$$], 2}, 0, 5}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`roughness$$], 0.1}, 0.05, 1}, {{
       Hold[$CellContext`shadingPosX$$], -1}, -2, 2}}, Typeset`size$$ = {
    328., {98., 104.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$7813137$$ = {0, 
    0}, $CellContext`eyePoint$7813138$$ = {0, 
    0}, $CellContext`lightFadeStart$7813139$$ = 
    0, $CellContext`lightFadeEnd$7813140$$ = 
    0, $CellContext`lightIntensity$7813141$$ = 
    0, $CellContext`lightRadius$7813142$$ = 
    0, $CellContext`viewDir$7813143$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`eyePoint$$ = {-3, 
         3}, $CellContext`leftWallHeight$$ = 
        2, $CellContext`lightCenter$$ = {-3, 
          2.5}, $CellContext`lightFadeEnd$$ = 
        5, $CellContext`lightFadeStart$$ = 3, $CellContext`lightIntensity$$ = 
        2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
        0.1, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 
         1}}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$7813137$$, {
         0, 0}], 
        Hold[$CellContext`eyePoint$$, $CellContext`eyePoint$7813138$$, {0, 
         0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$7813139$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$7813140$$,
          0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$7813141$$, 0], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$7813142$$, 
         0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$7813143$$, {0, 0}]},
       "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`rightWallHeight = 3; $CellContext`groundViewDir = 
        Normalize[$CellContext`eyePoint$$ - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`groundLightDir = 
        Normalize[$CellContext`lightCenter$$ - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`wallViewDir = 
        Normalize[{$CellContext`shadingPosX$$, 0} - {
          2, $CellContext`rightWallHeight}]; $CellContext`wallLightDir = 
        Normalize[$CellContext`lightCenter$$ - {
          2, $CellContext`rightWallHeight}]; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> 0.1, "color" -> Red, 
             "thickness" -> 0.02], 
            Association[
            "center" -> Slot["lightCenter"], "radius" -> Slot["lightRadius"]], 
            Association[
            "center" -> Slot["eyePoint"], "radius" -> 0.1, "color" -> Magenta,
              "thickness" -> 0.02], 
            Association["center" -> {
               Slot["shadingPosX"], 0}, "radius" -> 0.1, "color" -> Red, 
             "thickness" -> 0.02]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightRadius" -> $CellContext`lightRadius$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "eyePoint" -> $CellContext`eyePoint$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Green, 
             "thickness" -> 0.015]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("lobes" -> {
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "lightCenter" -> Slot["lightCenter"], 
             "lightIntensity" -> Slot["lightIntensity"], "roughness" -> 
             Slot["roughness"], "normalDir" -> ({0, 1}& ), 
             "viewDir" -> ($CellContext`groundViewDir& ), "lightDir" -> ({
               Cos[
                Slot["\[Theta]"]], 
               Sin[
                Slot["\[Theta]"]]}& ), 
             "lobeFunc" -> (Slot["shadingPos"] + 
              0.1 $CellContext`lightIntensity$$ {
                 Cos[
                  Slot["\[Theta]"]], 
                 Sin[
                  Slot["\[Theta]"]]} gBRDF`gDGGX[
                 Slot["roughness"], 
                 Slot["noh"]]& ), "color" -> Red, "label" -> 
             "GGX Lobe(view from eye)"]}& )[
           Association[
           "shadingPosX" -> $CellContext`shadingPosX$$, 
            "lightIntensity" -> $CellContext`lightIntensity$$, 
            "lightCenter" -> $CellContext`lightCenter$$, 
            "roughness" -> $CellContext`roughness$$]], 
          ("sgRightWallShading" -> {
            Association[
            "lightCenter" -> Slot["lightCenter"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "wallXRange" -> {-2, 2}, "wallHeights" -> {
               Slot["leftWallHeight"], 
               Slot["rightWallHeight"]}, "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
             "eyePoint" -> {
               Slot["shadingPosX"], 0}, 
             "sgLightFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
               Slot["roughness"], 
               Slot["lightDir"], 
               Slot["viewDir"], 
               Slot["normalDir"]]& ), 
             "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
               Slot["lightRadius"], 
               Slot["shadingDist"], 
               Slot["sgLight"], 
               Slot["sgNDF"]]& ), "sgPercentStrategy" -> 3, "color" -> Blue, 
             "label" -> "Wall Lighting(view from ground)"]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "lightFadeEnd" -> $CellContext`lightFadeEnd$$, 
            "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight, 
            "roughness" -> $CellContext`roughness$$]], "axisExtent" -> 5]]), 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-3, 
           2.5}}, {-4, -4}, {4, 
         4}}, {{$CellContext`eyePoint$$, {-3, 3}}, {-4, -4}, {4, 
         4}}, {{$CellContext`lightFadeStart$$, 3}, 1, 
         3}, {{$CellContext`lightFadeEnd$$, 5}, 3, 
         20}, {{$CellContext`lightIntensity$$, 2}, 1, 
         10}, {{$CellContext`lightRadius$$, 6}, 1, 
         6}, {{$CellContext`leftWallHeight$$, 2}, 0, 
         5}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`roughness$$, 0.1}, 0.05, 
         1}, {{$CellContext`shadingPosX$$, -1}, -2, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{676., {241., 247.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8333326790486484`*^9},
 CellLabel->
  "Out[1872]=",ExpressionUUID->"5ae14918-252f-41d6-a2a4-1aa2110e2f0c"]
}, Open  ]]
},
WindowSize->{1083, 672},
WindowMargins->{{129, Automatic}, {60, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 7646, 186, 903, "Input",ExpressionUUID->"85eed16e-5dcb-4532-9710-6fa04a54f8db"],
Cell[8229, 210, 320, 8, 30, "Print",ExpressionUUID->"6b2aab7e-9a0c-4cf3-b89e-7c8e205af085"],
Cell[8552, 220, 4457, 88, 205, "Output",ExpressionUUID->"dd781613-9172-4ab8-9321-7cbf6d74febc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13046, 313, 8101, 191, 827, "Input",ExpressionUUID->"134d42c6-9013-4db3-9e91-e4fd300823ba"],
Cell[21150, 506, 373, 9, 30, "Print",ExpressionUUID->"c0e90d58-6824-4802-8a60-aa9f848948d5"],
Cell[21526, 517, 4961, 98, 229, "Output",ExpressionUUID->"060ac4e4-fe4a-493d-acc0-fd3440c7a347"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26524, 620, 15482, 364, 1359, "Input",ExpressionUUID->"f6f2a226-5b97-450e-81bf-4690be0f8cf5"],
Cell[42009, 986, 364, 9, 30, "Print",ExpressionUUID->"1399ba05-ce63-41aa-81cf-f139f52ca9e8"],
Cell[42376, 997, 8828, 175, 275, "Output",ExpressionUUID->"67fd3cfd-5db5-4d4c-9f14-9912e1cab0ef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51241, 1177, 14685, 335, 1435, "Input",ExpressionUUID->"f32b2151-b8b3-4372-bfc0-e7be0f7bc7d9"],
Cell[65929, 1514, 341, 8, 30, "Print",ExpressionUUID->"19ffd70b-59ea-4813-ba16-d5c8899aeb48"],
Cell[66273, 1524, 8629, 170, 239, "Output",ExpressionUUID->"64a44db1-13db-44d6-b509-976cb5df6ddd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74939, 1699, 16131, 373, 1397, "Input",ExpressionUUID->"83f03bfc-ce61-4743-96c4-3a463e700da3"],
Cell[91073, 2074, 312, 8, 30, "Print",ExpressionUUID->"c84be0b2-c5d2-434b-904d-ad2d554c1403"],
Cell[91388, 2084, 9333, 184, 507, "Output",ExpressionUUID->"5ae14918-252f-41d6-a2a4-1aa2110e2f0c"]
}, Open  ]]
}
]
*)

