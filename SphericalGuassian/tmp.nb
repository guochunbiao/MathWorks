(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    150582,       3486]
NotebookOptionsPosition[    142327,       3353]
NotebookOutlinePosition[    142670,       3368]
CellTagsIndexPosition[    142627,       3365]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"tmp1", ",", "tmp2", ",", "tmp3", ",", "tmp4", ",", "tmp5"}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"tmp1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"sgAsCap", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "5", ",", "1"}], 
         "}"}], "]"}], "\[IndentingNewLine]", "tmp2"}], "=", 
      RowBox[{
       RowBox[{"gSpherCapIntsArea", "[", 
        RowBox[{"tmp1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sgArea", "[", "\[Lambda]", "]"}], "\[Equal]", "area"}], 
         ",", "\[Lambda]"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sgEnergy", "[", 
           RowBox[{"{", 
            RowBox[{"p", ",", 
             FractionBox["28.9351376", "area"], ",", "\[Mu]"}], "}"}], "]"}], 
          "\[Equal]", "\[Mu]0"}], ",", "\[Mu]"}], "]"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ClearAll", "[", 
        RowBox[{"tmp1", ",", "tmp2", ",", "tmp3", ",", "tmp4", ",", "tmp5"}], 
        "]"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     FractionBox[
      RowBox[{"0.15915494309189535`", " ", "\[Mu]0"}], 
      RowBox[{"area", " ", 
       RowBox[{"(", "0.034560056835534106`", ")"}]}]], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"solveSgCapIntsEnergy", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "5", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"\[Pi]", "/", "4"}]}], "}"}]}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"reg6", "=", 
     RowBox[{"ParametricRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", "0", ",", 
           RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}]}], "}"}]}], 
      "]"}]}], ";", "\n", "\t", 
    RowBox[{"sol6", "=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{"\[Lambda]", "*", 
          RowBox[{"(", 
           RowBox[{"z", "-", "1"}], ")"}]}], "]"}], "*", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "-", 
            RowBox[{"{", 
             RowBox[{"x0", ",", "y0", ",", "z0"}], "}"}]}], "]"}], "<", 
          "0.5"}], "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", "reg6"}], 
       ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Lambda]", ">", "0"}], ",", 
          RowBox[{"\[Mu]", ">", "0"}], ",", 
          RowBox[{"\[Epsilon]", ">", "0"}]}], "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "sol6"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "cap1ApexVis", ",", "cap1Edge1Vis", ",", "cap1Edge2Vis", ",", 
     "cap2Edge1Vis", ",", "cap2Edge2Vis"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "aaa", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"aaa", "[", 
     RowBox[{
     "capAxis1_", ",", "capApert1_", ",", "capAxis2_", ",", "capApert2_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "axis1", ",", "axis2", ",", "edgeAngleL", ",", "edgeAngleR", ",", 
        "axisDot", ",", "\[Psi]1", ",", "\[Psi]1L", ",", "\[Psi]1R", ",", 
        "\[Psi]2", ",", "\[Psi]2L", ",", "\[Psi]2R", ",", "apex1Covered", ",",
         "\[IndentingNewLine]", "\t", "baseHemiApert", ",", 
        "baseQuaterCenter", ",", "baseQuaterApert"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"axis1", "=", 
        RowBox[{"Normalize", "[", "capAxis1", "]"}]}], ";", "\n", "\t", 
       RowBox[{"axis2", "=", 
        RowBox[{"Normalize", "[", "capAxis2", "]"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"axisDot", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{"axis1", ",", "axis2"}], "]"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"\[Psi]1", "=", "0"}], ";", "\n", "\t", 
       RowBox[{"\[Psi]1L", "=", 
        RowBox[{"\[Psi]1", "-", "capApert1"}]}], ";", "\n", "\t", 
       RowBox[{"\[Psi]1R", "=", 
        RowBox[{"\[Psi]1", "+", "capApert1"}]}], ";", "\n", "\t", 
       RowBox[{"\[Psi]2", "=", 
        RowBox[{"0", "+", 
         RowBox[{"ArcCos", "[", "axisDot", "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"\[Psi]2L", "=", 
        RowBox[{"\[Psi]2", "-", "capApert2"}]}], ";", "\n", "\t", 
       RowBox[{"\[Psi]2R", "=", 
        RowBox[{"\[Psi]2", "+", "capApert2"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"edgeAngleL", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"\[Psi]1L", ",", "\[Psi]2L"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"edgeAngleR", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"\[Psi]1R", ",", "\[Psi]2R"}], "]"}]}], ";", "\n", "\t", 
       "\n", "\t", 
       RowBox[{"On", "[", "Assert", "]"}], ";", "\n", "\t", 
       RowBox[{"Assert", "[", 
        RowBox[{"edgeAngleL", "<", "edgeAngleR"}], "]"}], ";", "\n", "\n", 
       "\t", 
       RowBox[{"apex1Covered", "=", 
        RowBox[{
         RowBox[{"\[Psi]2L", "<", "0"}], "&&", 
         RowBox[{"\[Psi]2R", ">", "0"}]}]}], ";", "\n", "\t", 
       RowBox[{"baseHemiApert", "=", 
        RowBox[{"If", "[", 
         RowBox[{"apex1Covered", ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"Abs", "[", "edgeAngleL", "]"}], ",", 
            RowBox[{"Abs", "[", "edgeAngleR", "]"}]}], "]"}], ",", "0"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "  ", 
       RowBox[{"baseQuaterApert", "=", 
        RowBox[{"If", "[", 
         RowBox[{"apex1Covered", ",", "0", ",", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"edgeAngleR", "-", "edgeAngleL"}], "]"}], "/", "2"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "  ", 
       RowBox[{"baseQuaterCenter", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"edgeAngleR", "+", "edgeAngleL"}], ")"}], "/", "2"}]}], ";",
        "\[IndentingNewLine]", " ", 
       RowBox[{"{", 
        RowBox[{
        "baseHemiApert", ",", "baseQuaterCenter", ",", "baseQuaterApert"}], 
        "}"}]}]}], "\n", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"capApex1", ",", "baseApertInfo", ",", "baseQuaterAxis"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"capApex1", ":=", 
     RowBox[{"Normalize", "[", "capDir1", "]"}]}], ";", "\[IndentingNewLine]",
     "\t", 
    RowBox[{"baseApertInfo", ":=", 
     RowBox[{"aaa", "[", 
      RowBox[{
      "capDir1", ",", "capAperture1", ",", "capDir2", ",", "capAperture2"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"baseQuaterAxis", ":=", 
     RowBox[{
      RowBox[{"RotationTransform", "[", 
       RowBox[{
        RowBox[{"baseApertInfo", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "[", "capApex1", 
      "]"}]}], ";", "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"<|", "\[IndentingNewLine]", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\"\<spheres\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "capApex1"}], ",", 
              RowBox[{"\"\<zbias\>\"", "\[Rule]", "5"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}], 
            "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", "]"}], ",", 
        "\[IndentingNewLine]", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<spherCaps\>\"", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", "   ", 
            RowBox[{
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir1"}], ",", 
               RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture1"}], 
               ",", "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], ",", 
             "\[IndentingNewLine]", "   ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir2"}], ",", 
               RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture2"}], 
               ",", "\[IndentingNewLine]", "\t", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Green", "]"}]}], ",", 
               RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], ",", 
             "\[IndentingNewLine]", "   ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<coneDir\>\"", "\[Rule]", "capApex1"}], ",", 
               RowBox[{"\"\<coneAperture\>\"", "\[Rule]", 
                RowBox[{"baseApertInfo", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]",
                "\t", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Brown", "]"}]}], ",", 
               RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<zbias\>\"", "\[Rule]", "2"}], ",", 
               RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], ",", 
             "\[IndentingNewLine]", "   ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<center\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
               RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<coneDir\>\"", "\[Rule]", "baseQuaterAxis"}], ",", 
               RowBox[{"\"\<coneAperture\>\"", "\[Rule]", 
                RowBox[{"baseApertInfo", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]",
                "\t", 
               RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                RowBox[{"Function", "[", "Brown", "]"}]}], ",", 
               RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
               RowBox[{"\"\<zbias\>\"", "\[Rule]", "2"}], ",", 
               RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}]}], 
            "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<capDir1\>\"", "\[Rule]", "capDir1"}], ",", 
           RowBox[{"\"\<capDir2\>\"", "\[Rule]", "capDir2"}], ",", 
           RowBox[{"\"\<capAperture1\>\"", "\[Rule]", "capAperture1"}], ",", 
           RowBox[{"\"\<capAperture2\>\"", "\[Rule]", "capAperture2"}]}], 
          "|>"}], "]"}], ",", "\[IndentingNewLine]", "    ", 
        RowBox[{"\"\<spherCapInts\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", "\t ", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<spherCapPair\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], ",", 
            RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
             RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
            RowBox[{"\"\<opacity\>\"", "\[Rule]", "1"}], ",", 
            RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}], ",", 
            RowBox[{"\"\<mesh\>\"", "\[Rule]", "None"}]}], "|>"}], 
          "\[IndentingNewLine]", "       ", "}"}]}], ",", 
        "\[IndentingNewLine]", "     ", 
        RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.2"}], ",", 
        "\[IndentingNewLine]", "     ", 
        RowBox[{"\"\<viewPoint\>\"", "\[Rule]", "Front"}]}], 
       "\[IndentingNewLine]", "|>"}], ",", "Medium"}], "]"}]}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"capDir1", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capDir2", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}], ",", "0.001"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture1", ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture2", ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "capApex1", ",", "edgeInfo", ",", "apex1Covered", ",", "intsEdgePtL", ",",
      "intsEdgePtR"}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"aaa", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5"}], ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
      RowBox[{"\[Pi]", "/", "3"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
      RowBox[{"\[Pi]", "/", "3"}]}], "]"}], "//", "N"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8323172728534307`*^9, 3.832317358677642*^9}, {
   3.8323173888557367`*^9, 3.8323174838773603`*^9}, {3.83231752919895*^9, 
   3.8323175705806804`*^9}, {3.8323176119268556`*^9, 
   3.8323176871334085`*^9}, {3.8323177470868545`*^9, 
   3.8323178647745934`*^9}, {3.8323179881099916`*^9, 3.83231801852569*^9}, {
   3.83231828309301*^9, 3.832318320172037*^9}, {3.8323198764668446`*^9, 
   3.832319898834792*^9}, {3.832320156972596*^9, 3.8323201630940795`*^9}, {
   3.8323201973625555`*^9, 3.8323202643183765`*^9}, {3.8323203278211308`*^9, 
   3.8323203280103254`*^9}, {3.83232036455333*^9, 3.8323204593251095`*^9}, {
   3.8323204897810764`*^9, 3.8323205143103523`*^9}, {3.832320550530115*^9, 
   3.832320672418547*^9}, {3.832320724298931*^9, 3.8323207880020475`*^9}, {
   3.832320841018152*^9, 3.8323209594377956`*^9}, {3.832321166067587*^9, 
   3.832321167043845*^9}, {3.832321222382145*^9, 3.8323212225778365`*^9}, {
   3.8323212802979913`*^9, 3.8323213338009043`*^9}, {3.8323224422593913`*^9, 
   3.8323224708733244`*^9}, {3.8323225599393396`*^9, 
   3.8323226315807667`*^9}, {3.832322719236287*^9, 3.832322724795369*^9}, {
   3.8323228177827816`*^9, 3.8323228539216866`*^9}, {3.8323229995722036`*^9, 
   3.8323230527430687`*^9}, {3.8323231096635675`*^9, 
   3.8323232467705965`*^9}, {3.832323566113125*^9, 3.832323596915006*^9}, {
   3.8323236451985397`*^9, 3.832323658240017*^9}, {3.832323747422763*^9, 
   3.8323237894831777`*^9}, {3.8323238677673364`*^9, 
   3.8323239465006495`*^9}, {3.8323247211825333`*^9, 3.8323247419093304`*^9}, 
   3.8323250199731216`*^9, {3.8323250987855487`*^9, 3.832325212616511*^9}, {
   3.8323252549253893`*^9, 3.832325259893529*^9}, 3.8323253179255857`*^9, {
   3.8323702499358287`*^9, 3.832370250333763*^9}, 3.8323702943805227`*^9, {
   3.8323794933684435`*^9, 3.832379547492973*^9}, {3.8323795817340174`*^9, 
   3.832379629606268*^9}, 3.8323796874432783`*^9, {3.8323805558798876`*^9, 
   3.8323805642737255`*^9}, {3.8323815468360243`*^9, 
   3.8323815496367044`*^9}, {3.832384033942596*^9, 3.8323840724056063`*^9}, {
   3.8323871745883923`*^9, 3.832387205507222*^9}, {3.8323872690808086`*^9, 
   3.832387275010775*^9}, {3.8323875348046513`*^9, 3.8323877457772512`*^9}, {
   3.8323878374276123`*^9, 3.832387838670131*^9}, 3.8323878845473022`*^9, {
   3.8323890026570573`*^9, 3.8323890653997307`*^9}, {3.8323892759294357`*^9, 
   3.832389278880478*^9}, {3.8323894274403777`*^9, 3.832389442535574*^9}, {
   3.832389534631983*^9, 3.8323897861291285`*^9}, {3.8323898300203314`*^9, 
   3.832389989375393*^9}, {3.8323900207676477`*^9, 3.8323902173408833`*^9}, 
   3.832390251584927*^9, {3.8323903077529306`*^9, 3.832390352344177*^9}, {
   3.8323917451114006`*^9, 3.8323918091008663`*^9}, {3.8323918872536583`*^9, 
   3.8323918908046484`*^9}, {3.832391930349535*^9, 3.832392040911647*^9}, {
   3.832392076614004*^9, 3.8323921268641424`*^9}, {3.832392164820825*^9, 
   3.832392169766996*^9}, {3.8323924289096403`*^9, 3.8323925023971963`*^9}, {
   3.8323925404695005`*^9, 3.832392641496972*^9}, {3.8323927790467463`*^9, 
   3.832392780152075*^9}, {3.8323928357318788`*^9, 3.8323930134281716`*^9}, {
   3.832393143365051*^9, 3.8323934728356075`*^9}, 3.832393508552151*^9, {
   3.8323935391783595`*^9, 3.832393613405896*^9}, {3.8323936535563836`*^9, 
   3.8323936829716296`*^9}, {3.832393740462405*^9, 3.8323937620193815`*^9}, {
   3.8323938702842607`*^9, 3.8323938927955866`*^9}, {3.832394465754197*^9, 
   3.8323945413713646`*^9}, {3.8323947939064636`*^9, 3.832394836456277*^9}, {
   3.8323948754124413`*^9, 3.8323949474746294`*^9}, {3.832395082033868*^9, 
   3.832395201010193*^9}, {3.8323952493882837`*^9, 3.8323954882669034`*^9}, {
   3.832395519847353*^9, 3.832395529007716*^9}, {3.8323955604605503`*^9, 
   3.8323956486587667`*^9}, 3.832395695712764*^9, {3.832396039659401*^9, 
   3.832396187929267*^9}, 3.832396222174383*^9, {3.832396428632221*^9, 
   3.832396435215683*^9}, {3.8323976516713123`*^9, 3.8323976866307745`*^9}, {
   3.8323977437123127`*^9, 3.832397747566387*^9}, 3.8324029290344334`*^9, {
   3.8324030803305387`*^9, 3.8324032337601075`*^9}, {3.8324032677516937`*^9, 
   3.832403640447675*^9}, {3.832403672903376*^9, 3.8324037131225653`*^9}, {
   3.832403746141182*^9, 3.8324038576894913`*^9}, 3.832403921321807*^9, {
   3.8324039578277426`*^9, 3.832404261936552*^9}},
 CellLabel->
  "In[1850]:=",ExpressionUUID->"3654899b-b6e3-4c2c-bb6a-698ebe06bbb6"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`capAperture1$$ = Rational[1, 3] 
    Pi, $CellContext`capAperture2$$ = 
    1.1969468010177111`, $CellContext`capDir1$$ = {0, -1, 
    0}, $CellContext`capDir2$$ = {1, -1, 0}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`capDir1$$], {0, -1, 0}}}, {{
       Hold[$CellContext`capDir2$$], {1, -1, 0}}, {-1, -1, 0.001}, {1, 1, 
      1}}, {{
       Hold[$CellContext`capAperture1$$], Rational[1, 3] Pi}, 0, 
      Rational[1, 2] Pi}, {{
       Hold[$CellContext`capAperture2$$], Rational[1, 3] Pi}, 0, 
      Rational[1, 2] Pi}}, Typeset`size$$ = {360., {173., 179.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`capDir2$234694$$ = {0, 0, 
    0}, $CellContext`capAperture1$234695$$ = 
    0, $CellContext`capAperture2$234696$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`capAperture1$$ = 
        Rational[1, 3] Pi, $CellContext`capAperture2$$ = 
        Rational[1, 3] Pi, $CellContext`capDir1$$ = {0, -1, 
         0}, $CellContext`capDir2$$ = {1, -1, 0}}, "ControllerVariables" :> {
        Hold[$CellContext`capDir2$$, $CellContext`capDir2$234694$$, {0, 0, 
         0}], 
        Hold[$CellContext`capAperture1$$, $CellContext`capAperture1$234695$$, 
         0], 
        Hold[$CellContext`capAperture2$$, $CellContext`capAperture2$234696$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`capApex1 := 
        Normalize[$CellContext`capDir1$$]; $CellContext`baseApertInfo := \
$CellContext`aaa[$CellContext`capDir1$$, $CellContext`capAperture1$$, \
$CellContext`capDir2$$, $CellContext`capAperture2$$]; \
$CellContext`baseQuaterAxis := RotationTransform[
          Part[$CellContext`baseApertInfo, 2], {0, 0, 
          1}][$CellContext`capApex1]; gPlots3D`gParamPlot3D[
         Association[
          ("spheres" -> {
            Association[
            "center" -> $CellContext`capApex1, "zbias" -> 5, "radius" -> 0.03,
              "colorFunc" -> (Red& )]}& )[], 
          ("spherCaps" -> {
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir1"], "coneAperture" -> Slot["capAperture1"], 
             "opacity" -> 1, "mesh" -> None], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> 
             Slot["capDir2"], "coneAperture" -> Slot["capAperture2"], 
             "colorFunc" -> (Green& ), "opacity" -> 1, "mesh" -> None], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, 
             "coneDir" -> $CellContext`capApex1, "coneAperture" -> 
             Part[$CellContext`baseApertInfo, 1], "colorFunc" -> (Brown& ), 
             "opacity" -> 1, "zbias" -> 2, "mesh" -> None], 
            Association[
            "center" -> {0, 0, 0}, "radius" -> 1, 
             "coneDir" -> $CellContext`baseQuaterAxis, "coneAperture" -> 
             Part[$CellContext`baseApertInfo, 3], "colorFunc" -> (Brown& ), 
             "opacity" -> 1, "zbias" -> 2, "mesh" -> None]}& )[
           Association[
           "capDir1" -> $CellContext`capDir1$$, 
            "capDir2" -> $CellContext`capDir2$$, 
            "capAperture1" -> $CellContext`capAperture1$$, 
            "capAperture2" -> $CellContext`capAperture2$$]], "spherCapInts" -> {
            Association[
            "spherCapPair" -> {1, 2}, "colorFunc" -> (Blue& ), "opacity" -> 1,
              "zbias" -> 1, "mesh" -> None]}, "axisExtent" -> 1.2, 
          "viewPoint" -> Front], Medium]), 
      "Specifications" :> {{{$CellContext`capDir1$$, {0, -1, 
          0}}}, {{$CellContext`capDir2$$, {1, -1, 0}}, {-1, -1, 0.001}, {1, 1,
          1}}, {{$CellContext`capAperture1$$, Rational[1, 3] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`capAperture2$$, Rational[1, 3] Pi}, 0, 
         Rational[1, 2] Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {255., 261.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8323897808149414`*^9, 3.832389786753583*^9}, {
   3.832389946496712*^9, 3.8323899729132485`*^9}, {3.8323900220490575`*^9, 
   3.832390036458898*^9}, {3.8323900798163395`*^9, 3.8323901471382227`*^9}, {
   3.8323901817622967`*^9, 3.8323902529454155`*^9}, 3.8323903096357403`*^9, {
   3.832390346601728*^9, 3.832390352867882*^9}, 3.832391765319355*^9, 
   3.8323919950925713`*^9, 3.8323920416143694`*^9, 3.8323921749309483`*^9, {
   3.8323924292301507`*^9, 3.8323924395190935`*^9}, {3.832392632853363*^9, 
   3.8323926422364974`*^9}, 3.8323929259872646`*^9, 3.832393014125765*^9, 
   3.832393213861246*^9, {3.832393269867346*^9, 3.8323933046277847`*^9}, 
   3.832393402110903*^9, 3.832393473747609*^9, 3.8323935121017723`*^9, {
   3.832393543914261*^9, 3.8323935559240246`*^9}, {3.8323935950292373`*^9, 
   3.8323936190687246`*^9}, {3.832393660534011*^9, 3.8323936847479067`*^9}, 
   3.832393762857197*^9, {3.832394509210807*^9, 3.8323945420154734`*^9}, 
   3.832395489581072*^9, {3.832395524750862*^9, 3.832395529873041*^9}, {
   3.8323955811822586`*^9, 3.832395618157917*^9}, 3.83239564943646*^9, 
   3.8323956964380245`*^9, 3.8323961923789177`*^9, 3.832396437493341*^9, 
   3.8323976232986584`*^9, {3.832397661873229*^9, 3.832397711163663*^9}, 
   3.8323977486402073`*^9, 3.8324029304765863`*^9, 3.832403415716502*^9, 
   3.8324034729967575`*^9, 3.832403597458214*^9, 3.8324036412344255`*^9, {
   3.832403677283282*^9, 3.832403713993593*^9}, {3.8324037469511886`*^9, 
   3.832403858837055*^9}, 3.8324039239715805`*^9, 3.832404263297095*^9},
 CellLabel->
  "Out[1861]=",ExpressionUUID->"2ab0232e-5d5c-4156-be47-4cdd571c604f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"reg6", "=", 
   RowBox[{"ParametricRegion", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}]}], "}"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"\[Mu]", "*", 
    RowBox[{"Exp", "[", 
     RowBox[{"\[Lambda]", "*", 
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}]}], "]"}], "*", 
    RowBox[{"Boole", "[", 
     RowBox[{"a", "\[LessEqual]", "z", "\[LessEqual]", "b"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", "reg6"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Lambda]", ">", "0"}], ",", 
      RowBox[{"\[Mu]", ">", "0"}], ",", 
      RowBox[{"z", ">", "0"}], ",", 
      RowBox[{"a", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{"a", "<", "b", "\[LessEqual]", "1"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8323172728534307`*^9, 3.832317358677642*^9}, {
   3.8323173888557367`*^9, 3.8323174838773603`*^9}, {3.83231752919895*^9, 
   3.8323175705806804`*^9}, {3.8323176119268556`*^9, 
   3.8323176871334085`*^9}, {3.8323177470868545`*^9, 
   3.8323178647745934`*^9}, {3.8323179881099916`*^9, 3.83231801852569*^9}, {
   3.83231828309301*^9, 3.832318320172037*^9}, {3.8323198764668446`*^9, 
   3.832319898834792*^9}, {3.832320156972596*^9, 3.8323201630940795`*^9}, {
   3.8323201973625555`*^9, 3.8323202643183765`*^9}, {3.8323203278211308`*^9, 
   3.8323203280103254`*^9}, {3.83232036455333*^9, 3.8323204593251095`*^9}, {
   3.8323204897810764`*^9, 3.8323205143103523`*^9}, {3.832320550530115*^9, 
   3.832320672418547*^9}, {3.832320724298931*^9, 3.8323207880020475`*^9}, {
   3.832320841018152*^9, 3.8323209594377956`*^9}, {3.832321166067587*^9, 
   3.832321167043845*^9}, {3.832321222382145*^9, 3.8323212225778365`*^9}, {
   3.8323212802979913`*^9, 3.8323213338009043`*^9}, {3.8323224422593913`*^9, 
   3.8323224708733244`*^9}, {3.8323225599393396`*^9, 
   3.8323226315807667`*^9}, {3.832322719236287*^9, 3.832322724795369*^9}, {
   3.8323228177827816`*^9, 3.8323228539216866`*^9}, {3.8323229995722036`*^9, 
   3.8323230527430687`*^9}, {3.8323231096635675`*^9, 
   3.8323232467705965`*^9}, {3.832323566113125*^9, 3.832323596915006*^9}, {
   3.8323236451985397`*^9, 3.832323658240017*^9}, {3.832323747422763*^9, 
   3.8323237894831777`*^9}, {3.8323238677673364`*^9, 
   3.8323239465006495`*^9}, {3.8323247211825333`*^9, 3.8323247419093304`*^9}, 
   3.8323250199731216`*^9, {3.8323250987855487`*^9, 3.832325212616511*^9}, {
   3.8323252549253893`*^9, 3.832325259893529*^9}, 3.8323253179255857`*^9, {
   3.8323702499358287`*^9, 3.832370250333763*^9}, 3.8323702943805227`*^9, 
   3.8323794933684435`*^9, {3.8323848038931723`*^9, 3.8323848040656548`*^9}},
 CellLabel->
  "In[243]:=",ExpressionUUID->"79d387a5-d30d-4f58-914c-15c9cf084dd8"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "\[Lambda]"}]]}],
             ")"}], " ", "\[Pi]", " ", "\[Mu]"}], "\[Lambda]"]}], 
        RowBox[{"b", "\[GreaterEqual]", "1"}]},
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", "\[Lambda]"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"a", " ", "\[Lambda]"}]], "-", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"b", " ", "\[Lambda]"}]]}], ")"}], " ", "\[Pi]", " ", 
           "\[Mu]"}], "\[Lambda]"]}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.8323703052791195`*^9, 3.8323848119106636`*^9},
 CellLabel->
  "Out[244]=",ExpressionUUID->"8f65adcd-8965-472e-91c1-8d5a0a37cca3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "\[Lambda]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"a", " ", "\[Lambda]"}]], "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"b", " ", "\[Lambda]"}]]}], ")"}], " ", "\[Pi]", " "}], 
     "\[Lambda]"]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "0.9"}], ",", 
     RowBox[{"b", "\[Rule]", "1"}], ",", 
     RowBox[{"\[Lambda]", "\[Rule]", "5"}]}], "}"}]}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.8323846544285483`*^9, 3.832384666234789*^9}, {
  3.8323847426089845`*^9, 3.8323847509336767`*^9}, {3.8323848246081643`*^9, 
  3.8323848652843795`*^9}, {3.832394966239544*^9, 3.8323949959200974`*^9}, {
  3.832395049484523*^9, 3.832395057930465*^9}},
 CellLabel->
  "In[1210]:=",ExpressionUUID->"99f6854a-5bec-4626-9015-6df89c0ae9f7"],

Cell[BoxData["0.4944481555438453`"], "Output",
 CellChangeTimes->{
  3.8323846672845016`*^9, {3.8323847456672106`*^9, 3.832384751315173*^9}, {
   3.832384836388164*^9, 3.832384865711877*^9}, {3.832394970888307*^9, 
   3.8323949963996325`*^9}, {3.8323950516857767`*^9, 3.832395058586814*^9}},
 CellLabel->
  "Out[1210]=",ExpressionUUID->"86f9b094-6b33-4a5a-b826-19db80d56680"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"reg7", "=", 
   RowBox[{"ParametricRegion", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"Boole", "[", 
    RowBox[{"a", "\[LessEqual]", "z", "\[LessEqual]", "b"}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", "reg7"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Lambda]", ">", "0"}], ",", 
      RowBox[{"\[Mu]", ">", "0"}], ",", 
      RowBox[{"z", ">", "0"}], ",", 
      RowBox[{"a", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{"a", "<", "b", "\[LessEqual]", "1"}]}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8323836888397913`*^9, 3.8323836942169666`*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"a275c3ed-0ba4-439b-b297-412ac06f6482"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"2", " ", "\[Pi]"}], 
        RowBox[{
         RowBox[{"a", "\[Equal]", "0"}], "&&", 
         RowBox[{"b", "\[GreaterEqual]", "1"}]}]},
       {
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "\[Pi]"}], 
        RowBox[{
         RowBox[{"a", ">", "0"}], "&&", 
         RowBox[{"b", "\[GreaterEqual]", "1"}]}]},
       {
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{"a", "-", "b"}], ")"}], " ", "\[Pi]"}], 
        RowBox[{
         RowBox[{"0", "<", "a"}], "&&", 
         RowBox[{"b", "<", "1"}]}]},
       {
        RowBox[{"2", " ", "b", " ", "\[Pi]"}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.8323837014350476`*^9},
 CellLabel->
  "Out[232]=",ExpressionUUID->"eb61c5e6-2097-428f-927c-6c97f2349ac1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "\[Lambda]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"a", " ", "\[Lambda]"}]], "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"b", " ", "\[Lambda]"}]]}], ")"}], " ", "\[Pi]", " ", 
      "\[Mu]"}], "\[Lambda]"]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "0"}], ",", 
     RowBox[{"b", "\[Rule]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"\[Lambda]", "\[Rule]", "5"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "1"}]}], "}"}]}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.8323705380543423`*^9, 3.8323705430310936`*^9}, {
  3.832370622651989*^9, 3.8323706496796484`*^9}, {3.832370713857115*^9, 
  3.8323707500692277`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"50cc3d66-1eb9-4296-ab5d-005529fdd3e0"],

Cell[BoxData["21.802671526532972`"], "Output",
 CellChangeTimes->{
  3.8323705437260437`*^9, 3.8323706504826403`*^9, {3.832370724272995*^9, 
   3.8323707505762167`*^9}},
 CellLabel->"Out[48]=",ExpressionUUID->"fdcc360b-7e75-46c4-970a-9ff8aa181121"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrigToExp", "[", 
  RowBox[{"sgSolveEnergy", "[", 
   RowBox[{"{", 
    RowBox[{"p", ",", "\[Lambda]", ",", "\[Mu]"}], "}"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8323710194062004`*^9, 3.832371173856476*^9}, {
  3.8323712224060907`*^9, 3.8323712288164206`*^9}},
 CellLabel->
  "In[281]:=",ExpressionUUID->"0f3cb560-b51b-45c6-8c24-33d274debe80"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", "\[Pi]", " ", "\[Mu]"}], "\[Lambda]"], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "\[Lambda]"}]], " ", "\[Pi]", " ", "\[Mu]"}], 
   "\[Lambda]"]}]], "Output",
 CellChangeTimes->{{3.8323710268200083`*^9, 3.8323711750029707`*^9}, 
   3.8323712293337197`*^9},
 CellLabel->
  "Out[281]=",ExpressionUUID->"30e1672a-7413-431d-bc17-ed23cced53bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"2", "\[Pi]"}], "\[Lambda]"], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "2"}], "*", "\[Lambda]"}]]}], ")"}]}], "/.", 
   RowBox[{"\[Lambda]", "\[Rule]", "5"}]}], "//", 
  "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sgEnergy", "[", 
   RowBox[{"{", 
    RowBox[{"p", ",", "5", ",", "1"}], "}"}], "]"}], "//", 
  "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"2", "\[Pi]"}], "\[Lambda]"], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "2"}], "*", "\[Lambda]"}]]}], ")"}]}], "/.", 
   RowBox[{"\[Lambda]", "\[Rule]", "10"}]}], "//", 
  "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sgEnergy", "[", 
    RowBox[{"{", 
     RowBox[{"p", ",", "10", ",", "1"}], "}"}], "]"}], "//", "N"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"1", "-", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], "*", "\[Lambda]"}]]}], "/.", 
   RowBox[{"\[Lambda]", "\[Rule]", "10"}]}], "//", 
  "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"1", "-", 
    RowBox[{"2", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", "\[Lambda]"}]]}]}], "/.", 
   RowBox[{"\[Lambda]", "\[Rule]", "10"}]}], "//", "N"}]}], "Input",
 CellChangeTimes->{{3.8323712947567973`*^9, 3.8323714863632574`*^9}, {
  3.832371574029807*^9, 3.832371669655587*^9}},
 CellLabel->
  "In[407]:=",ExpressionUUID->"471ede59-cba6-48df-9760-0a45afa9f7ab"],

Cell[BoxData["1.2565800102015912`"], "Output",
 CellChangeTimes->{{3.8323713133110037`*^9, 3.83237134996467*^9}, {
  3.832371380874106*^9, 3.832371486855246*^9}, {3.832371576110924*^9, 
  3.832371626834716*^9}, {3.832371657155422*^9, 3.832371670462439*^9}},
 CellLabel->
  "Out[407]=",ExpressionUUID->"c98ec3f8-b586-43a3-b052-d0c2d24c4ac0"],

Cell[BoxData["1.239702753601834`"], "Output",
 CellChangeTimes->{{3.8323713133110037`*^9, 3.83237134996467*^9}, {
  3.832371380874106*^9, 3.832371486855246*^9}, {3.832371576110924*^9, 
  3.832371626834716*^9}, {3.832371657155422*^9, 3.8323716704664288`*^9}},
 CellLabel->
  "Out[408]=",ExpressionUUID->"0df07b9d-4e1e-40d6-8fc1-0d2e31be43ea"],

Cell[BoxData["0.6283185294228977`"], "Output",
 CellChangeTimes->{{3.8323713133110037`*^9, 3.83237134996467*^9}, {
  3.832371380874106*^9, 3.832371486855246*^9}, {3.832371576110924*^9, 
  3.832371626834716*^9}, {3.832371657155422*^9, 3.832371670468423*^9}},
 CellLabel->
  "Out[409]=",ExpressionUUID->"bb843372-897d-46ee-a5d4-1e1edd456a80"],

Cell[BoxData["0.6282614794836325`"], "Output",
 CellChangeTimes->{{3.8323713133110037`*^9, 3.83237134996467*^9}, {
  3.832371380874106*^9, 3.832371486855246*^9}, {3.832371576110924*^9, 
  3.832371626834716*^9}, {3.832371657155422*^9, 3.8323716704694204`*^9}},
 CellLabel->
  "Out[410]=",ExpressionUUID->"033270f0-78b4-4509-9823-bded6a701c70"],

Cell[BoxData["0.9999999979388464`"], "Output",
 CellChangeTimes->{{3.8323713133110037`*^9, 3.83237134996467*^9}, {
  3.832371380874106*^9, 3.832371486855246*^9}, {3.832371576110924*^9, 
  3.832371626834716*^9}, {3.832371657155422*^9, 3.8323716704714146`*^9}},
 CellLabel->
  "Out[411]=",ExpressionUUID->"b98e63f9-18f6-4f0b-9926-ff119c5f1c48"],

Cell[BoxData["0.999909200140475`"], "Output",
 CellChangeTimes->{{3.8323713133110037`*^9, 3.83237134996467*^9}, {
  3.832371380874106*^9, 3.832371486855246*^9}, {3.832371576110924*^9, 
  3.832371626834716*^9}, {3.832371657155422*^9, 3.8323716704734097`*^9}},
 CellLabel->
  "Out[412]=",ExpressionUUID->"2fbca1b6-e25a-4230-b570-d230d7800a89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "a", ",", "\[Phi]", ",", "\[Theta]", ",", "dir1", ",", "apert1", ",", 
      "dir2", ",", "apert2", ",", "cphi", ",", "ctheta", ",", "cx", ",", "cy",
       ",", "cz"}], "]"}], ";", "\n", 
    RowBox[{"dir1", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"apert1", "=", 
     RowBox[{"\[Pi]", "/", "3"}]}], ";", "\n", 
    RowBox[{"dir2", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"apert2", "=", 
     RowBox[{"3", 
      RowBox[{"\[Pi]", "/", "10"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"area", "=", 
     RowBox[{"Quiet", "@", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"gSpherCapIntsVis", "[", 
         RowBox[{
         "dir1", ",", "apert1", ",", "dir2", ",", "apert2", ",", "\[Phi]", 
          ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Phi]", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"PrecisionGoal", "\[Rule]", "2"}], ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "2"}], ",", " ", 
        RowBox[{"Method", "\[Rule]", "\"\<QuasiMonteCarlo\>\""}], ",", 
        RowBox[{"MaxRecursion", "\[Rule]", "2"}]}], "]"}]}]}], ";", "\n", 
    RowBox[{"cx", "=", 
     RowBox[{
      RowBox[{"Quiet", "@", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
          RowBox[{"gSpherCapIntsVis", "[", 
           RowBox[{
           "dir1", ",", "apert1", ",", "dir2", ",", "apert2", ",", "\[Phi]", 
            ",", "\[Theta]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", "0", ",", 
           RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"PrecisionGoal", "\[Rule]", "2"}], ",", 
         RowBox[{"AccuracyGoal", "\[Rule]", "2"}], ",", " ", 
         RowBox[{"Method", "\[Rule]", "\"\<QuasiMonteCarlo\>\""}], ",", 
         RowBox[{"MaxRecursion", "\[Rule]", "2"}]}], "]"}]}], "/", "area"}]}],
     ";", "\n", 
    RowBox[{"cy", "=", 
     RowBox[{
      RowBox[{"Quiet", "@", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
          RowBox[{"gSpherCapIntsVis", "[", 
           RowBox[{
           "dir1", ",", "apert1", ",", "dir2", ",", "apert2", ",", "\[Phi]", 
            ",", "\[Theta]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", "0", ",", 
           RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"PrecisionGoal", "\[Rule]", "2"}], ",", 
         RowBox[{"AccuracyGoal", "\[Rule]", "2"}], ",", " ", 
         RowBox[{"Method", "\[Rule]", "\"\<QuasiMonteCarlo\>\""}], ",", 
         RowBox[{"MaxRecursion", "\[Rule]", "2"}]}], "]"}]}], "/", "area"}]}],
     ";", "\n", 
    RowBox[{"cz", "=", 
     RowBox[{
      RowBox[{"Quiet", "@", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "*", 
          RowBox[{"gSpherCapIntsVis", "[", 
           RowBox[{
           "dir1", ",", "apert1", ",", "dir2", ",", "apert2", ",", "\[Phi]", 
            ",", "\[Theta]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", "0", ",", 
           RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"PrecisionGoal", "\[Rule]", "2"}], ",", 
         RowBox[{"AccuracyGoal", "\[Rule]", "2"}], ",", " ", 
         RowBox[{"Method", "\[Rule]", "\"\<QuasiMonteCarlo\>\""}], ",", 
         RowBox[{"MaxRecursion", "\[Rule]", "2"}]}], "]"}]}], "/", "area"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Normalize", "[", 
     RowBox[{"{", 
      RowBox[{"cx", ",", "cy", ",", "cz"}], "}"}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Quiet", "@", 
     RowBox[{"gSpherCapIntsCentroid", "[", 
      RowBox[{"dir1", ",", "apert1", ",", "dir2", ",", "apert2"}], "]"}]}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "=", "1"}], ";"}], "\n", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sol", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2"}], "}"}], "/.", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p1", " ", "a1"}], "+", 
                 RowBox[{"p2", " ", ".2"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "r"}], ")"}]}], "+", 
              RowBox[{"w", " ", "1"}]}], "\[Equal]", "p1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p1", " ", ".1"}], "+", 
                 RowBox[{"p2", " ", ".4"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "r"}], ")"}]}], "+", 
              RowBox[{"w", " ", "30"}]}], "\[Equal]", "p2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p1", ",", "p2"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Plot", "[", 
       RowBox[{"sol", ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", "045"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", "0", ",", ".6"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.832220967546915*^9, 3.832220972339423*^9}, {
   3.8322211045575647`*^9, 3.8322211087302923`*^9}, {3.832221261109416*^9, 
   3.8322214631859584`*^9}, {3.832221562049961*^9, 3.832221779723724*^9}, {
   3.832221864098328*^9, 3.8322220523230495`*^9}, {3.832222152889434*^9, 
   3.8322221599614553`*^9}, {3.8322226388265886`*^9, 3.832222651332323*^9}, 
   3.8322227374936237`*^9, {3.832222789345397*^9, 3.83222284166615*^9}, {
   3.832230393450923*^9, 3.8322304146074963`*^9}, {3.832230457231795*^9, 
   3.832230470863179*^9}, {3.832230617448883*^9, 3.832230618374259*^9}, {
   3.832230688137218*^9, 3.8322306944800262`*^9}, {3.832230743340111*^9, 
   3.832230756703905*^9}, {3.832230881681102*^9, 3.832230889077947*^9}, {
   3.8322310875045567`*^9, 3.8322311074148455`*^9}, {3.832231153335223*^9, 
   3.8322311594143105`*^9}, {3.8322313785008383`*^9, 
   3.8322313863701625`*^9}, {3.8322314420873475`*^9, 3.832231509438383*^9}, {
   3.8322315446556516`*^9, 3.8322316326462097`*^9}, {3.83223166850285*^9, 
   3.8322317832290163`*^9}, {3.8322320200724635`*^9, 
   3.8322320896376266`*^9}, {3.8322321299747744`*^9, 
   3.8322321747279625`*^9}, {3.832232343167181*^9, 3.8322323445049343`*^9}, {
   3.832232382885973*^9, 3.832232402686841*^9}, {3.832232436410637*^9, 
   3.8322324467089157`*^9}, {3.832232482974578*^9, 3.8322324965754795`*^9}, {
   3.8322326337253633`*^9, 3.8322326347319965`*^9}, {3.832232721492962*^9, 
   3.832232860621887*^9}, {3.832232905730118*^9, 3.8322329786562986`*^9}, {
   3.8322330659991984`*^9, 3.8322330798698187`*^9}, {3.8322331167901187`*^9, 
   3.832233121710163*^9}, {3.8322336078126855`*^9, 3.832233616504567*^9}, {
   3.832233648679491*^9, 3.8322336506198006`*^9}, {3.832234931572563*^9, 
   3.832235006510687*^9}, 3.832235791950435*^9, {3.8323172645985603`*^9, 
   3.8323172693454795`*^9}},ExpressionUUID->"e38e5ed1-9d56-4290-93df-\
6475abb3f487"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a1$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`a1$$], 0, 0.6}}, Typeset`size$$ = {
    360., {104., 109.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`a1$2370$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`a1$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`a1$$, $CellContext`a1$2370$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`sol = 
        ReplaceAll[{$CellContext`p1, $CellContext`p2}, 
          
          Solve[{($CellContext`p1 $CellContext`a1$$ + $CellContext`p2 0.2) (
               1 + $CellContext`r) + $CellContext`w 
              1 == $CellContext`p1, ($CellContext`p1 0.1 + $CellContext`p2 
                0.4) (1 + $CellContext`r) + $CellContext`w 
              30 == $CellContext`p2}, {$CellContext`p1, $CellContext`p2}]]; 
       Plot[$CellContext`sol, {$CellContext`r, 0, 45}]), 
      "Specifications" :> {{$CellContext`a1$$, 0, 0.6}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {151., 157.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.832231173163708*^9, 3.832231390207983*^9, 3.8322314497759256`*^9, {
   3.8322316334392695`*^9, 3.832231654040784*^9}, 3.832231704106763*^9, {
   3.8322317355823307`*^9, 3.832231784787261*^9}, {3.8322320841039276`*^9, 
   3.8322321028065557`*^9}, {3.8322321412468057`*^9, 3.832232175500327*^9}, 
   3.8322324044114895`*^9, {3.8322324388784885`*^9, 3.8322324481066303`*^9}, 
   3.8322324989577446`*^9, 3.8322326358562346`*^9, {3.832232723011464*^9, 
   3.8322327934397173`*^9}, {3.8322328459281445`*^9, 3.832232861644136*^9}, 
   3.832232935826216*^9, 3.8322329797005405`*^9, 3.8322330116187887`*^9, {
   3.8322330943753915`*^9, 3.8322331227553225`*^9}, {3.832233619647624*^9, 
   3.8322336799636507`*^9}, 3.8322337473696356`*^9, {3.8322337832871923`*^9, 
   3.8322338552381783`*^9}, {3.832234941140115*^9, 3.8322350073059607`*^9}, 
   3.832317233279499*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"7c671481-6850-486d-9e76-c0e87e205980"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "aaa", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"aaa", "[", 
      RowBox[{"inN1_", ",", "\[Theta]1_", ",", "inN2_", ",", "\[Theta]2_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n1", ",", "n2", ",", "midN"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n1", "=", 
         RowBox[{"Normalize", "[", "inN1", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n2", "=", 
         RowBox[{"Normalize", "[", "inN2", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"midN", "=", 
         RowBox[{"Normalize", "[", 
          RowBox[{
           RowBox[{"n1", "*", "\[Theta]2"}], "+", 
           RowBox[{"n2", "*", "\[Theta]1"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"midN", ",", "midN"}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "  ", 
    RowBox[{
     RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\"\<spheres\>\"", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", " ", 
             RowBox[{
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<center\>\"", "\[Rule]", 
                 RowBox[{"#intsPoints", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
                RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                 RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}], ",", 
              "\[IndentingNewLine]", "   ", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<center\>\"", "\[Rule]", 
                 RowBox[{"#intsPoints", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
                RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                 RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}]}], 
             "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<intsPoints\>\"", "\[Rule]", 
            RowBox[{"aaa", "[", 
             RowBox[{
             "capDir1", ",", "capAperture1", ",", "capDir2", ",", 
              "capAperture2"}], "]"}]}], "|>"}], "]"}], ",", 
         "\[IndentingNewLine]", "   ", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<spherCaps\>\"", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", "   ", 
             RowBox[{
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<center\>\"", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
                RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
                RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir1"}], ",", 
                RowBox[{
                "\"\<coneAperture\>\"", "\[Rule]", "#capAperture1"}]}], 
               "|>"}], ",", "\[IndentingNewLine]", "   ", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<center\>\"", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
                RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
                RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir2"}], ",", 
                RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture2"}], 
                ",", "\[IndentingNewLine]", "\t", 
                RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
                 RowBox[{"Function", "[", "LightBlue", "]"}]}]}], "|>"}]}], 
             "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<capDir1\>\"", "\[Rule]", "capDir1"}], ",", 
            RowBox[{"\"\<capDir2\>\"", "\[Rule]", "capDir2"}], ",", 
            RowBox[{"\"\<capAperture1\>\"", "\[Rule]", "capAperture1"}], ",", 
            RowBox[{"\"\<capAperture2\>\"", "\[Rule]", "capAperture2"}]}], 
           "|>"}], "]"}], ",", "\[IndentingNewLine]", "    ", 
         RowBox[{"\"\<spherCapInts\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "\t ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<spherCapPair\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}]}], ",", 
             RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
              RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
             RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}]}], "|>"}], 
           "\[IndentingNewLine]", "       ", "}"}]}], ",", 
         "\[IndentingNewLine]", "     ", 
         RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.5"}]}], 
        "\[IndentingNewLine]", "|>"}], ",", "Medium"}], "]"}], ",", 
     "\[IndentingNewLine]", "   ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"capDir1", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", "   ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"capDir2", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", "0.001"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"capAperture1", ",", 
         RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", "0", ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"capAperture2", ",", 
         RowBox[{"3", 
          RowBox[{"\[Pi]", "/", "10"}]}]}], "}"}], ",", "0", ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8316109446150265`*^9, 3.8316109451047163`*^9}, {
   3.8316109752490807`*^9, 3.8316110011837053`*^9}, {3.8316111262472897`*^9, 
   3.831611127199741*^9}, 3.8316115444304295`*^9, {3.8316115900017753`*^9, 
   3.8316115921907654`*^9}, {3.831611637818702*^9, 3.831611819975301*^9}, {
   3.83161186522406*^9, 3.831611878406431*^9}, {3.8316119963853908`*^9, 
   3.8316120084074554`*^9}, {3.8316127084836125`*^9, 
   3.8316128929309855`*^9}, {3.8316131302214165`*^9, 3.8316131660199175`*^9}, 
   3.831613266292944*^9, {3.831613405983728*^9, 3.8316134348724174`*^9}, {
   3.831613497277599*^9, 3.831613539885232*^9}, {3.831613572527315*^9, 
   3.831613574219284*^9}, {3.831613637446761*^9, 3.831613669490849*^9}, {
   3.831613776024485*^9, 3.8316138094720755`*^9}, {3.8316141864302816`*^9, 
   3.831614194418947*^9}, {3.8316143199087744`*^9, 3.831614337698098*^9}, 
   3.831614396356619*^9, 3.831614468452835*^9, {3.831614507636098*^9, 
   3.8316145969533806`*^9}, 3.8316146550615997`*^9, 3.8316149911559997`*^9, {
   3.831615146083272*^9, 3.831615170854312*^9}, {3.8316154188118505`*^9, 
   3.831615450430157*^9}, {3.831615530798207*^9, 3.8316155315468445`*^9}, {
   3.831616015573389*^9, 3.831616031865348*^9}, {3.831616419227938*^9, 
   3.831616495042392*^9}, {3.8316165661103497`*^9, 3.8316165748077736`*^9}, {
   3.8316166463246007`*^9, 3.8316167443125715`*^9}, {3.831616774829698*^9, 
   3.8316167768104305`*^9}, {3.8316170504512405`*^9, 
   3.8316171131871815`*^9}, {3.8316172122043176`*^9, 
   3.8316172701007204`*^9}, {3.8316173387937098`*^9, 3.831617399366984*^9}, {
   3.831617463425668*^9, 3.831617537322872*^9}, {3.8316175866694784`*^9, 
   3.831617597151862*^9}, {3.831617641809436*^9, 3.8316176499440207`*^9}, 
   3.831617955038065*^9, {3.8316183320531263`*^9, 3.831618361786538*^9}, {
   3.8316194866082225`*^9, 3.8316195252581306`*^9}, {3.831619569847169*^9, 
   3.831619573094136*^9}, {3.8316196132673244`*^9, 3.831619723452407*^9}, {
   3.8316197549813175`*^9, 3.8316198532948437`*^9}, 3.831619909648966*^9, {
   3.8316199455775146`*^9, 3.8316199620608726`*^9}, 3.8316202071180763`*^9, {
   3.8316202986102123`*^9, 3.8316203688244057`*^9}, {3.831626143261367*^9, 
   3.8316261620913258`*^9}, {3.8316262072291746`*^9, 3.831626290508049*^9}, {
   3.8316264542577534`*^9, 3.8316264790861387`*^9}, {3.831626731394829*^9, 
   3.8316267388025866`*^9}, {3.8316269219739914`*^9, 
   3.8316269497300262`*^9}, {3.8316269882872763`*^9, 3.831626997259017*^9}, {
   3.8316270933286858`*^9, 3.831627119561939*^9}, {3.831627675794442*^9, 
   3.8316276761824307`*^9}, {3.8316277341264687`*^9, 
   3.8316277414294505`*^9}, {3.8316277753703737`*^9, 3.831627777356419*^9}, 
   3.831627850045376*^9, {3.831627973584049*^9, 3.831627995621174*^9}, {
   3.8316280273167973`*^9, 3.8316280279080124`*^9}, {3.831629365220565*^9, 
   3.8316294107611856`*^9}, {3.8316294803931074`*^9, 
   3.8316294866279917`*^9}, {3.831630651542062*^9, 3.8316307105538535`*^9}, {
   3.831678887526238*^9, 3.8316788950393877`*^9}, {3.831678932984187*^9, 
   3.8316789581216717`*^9}, {3.831678995832378*^9, 3.831678996299514*^9}, {
   3.831679324162695*^9, 3.831679331400757*^9}, {3.831679365763391*^9, 
   3.8316794021910305`*^9}, {3.8316794406002307`*^9, 3.8316796214787188`*^9}, 
   3.8316796605174875`*^9, {3.831679771590371*^9, 3.831679773146606*^9}, {
   3.831679836161007*^9, 3.8316799658505726`*^9}, {3.8316800382825317`*^9, 
   3.8316801322394147`*^9}, {3.831680199151025*^9, 3.831680203030284*^9}, {
   3.8316802790322433`*^9, 3.8316803916286373`*^9}, {3.831680430860076*^9, 
   3.83168047894943*^9}, {3.831680529761264*^9, 3.831680612091178*^9}, {
   3.83168064361582*^9, 3.8316806862328973`*^9}, {3.8316807183996897`*^9, 
   3.831680746152725*^9}, {3.831680784798071*^9, 3.831680812369256*^9}, 
   3.831681352264063*^9, {3.831681387364891*^9, 3.8316815089054165`*^9}, {
   3.831681566344904*^9, 3.831681607640648*^9}, {3.8316829650679827`*^9, 
   3.8316830705797853`*^9}, {3.831683102299791*^9, 3.831683218494635*^9}, {
   3.8316884995748243`*^9, 3.8316885727992697`*^9}, {3.831688784717017*^9, 
   3.8316888189030213`*^9}, {3.831688849906866*^9, 3.831688887073229*^9}, {
   3.8316895224586763`*^9, 3.83168957479426*^9}, {3.831689622901723*^9, 
   3.8316896240341215`*^9}, {3.8316903800969405`*^9, 3.831690394810577*^9}, {
   3.8316907842642355`*^9, 3.8316909738598146`*^9}, {3.831692247834975*^9, 
   3.831692370947121*^9}, {3.831692621863369*^9, 3.83169269868635*^9}, {
   3.8316927324698687`*^9, 3.83169282227818*^9}, {3.831695862696371*^9, 
   3.8316958841602526`*^9}, {3.831695970111452*^9, 3.8316959780387263`*^9}, {
   3.831696022668318*^9, 3.831696113025288*^9}, {3.831696143339884*^9, 
   3.8316961589381447`*^9}, {3.831696723755794*^9, 3.8316968162008576`*^9}, {
   3.831696982629433*^9, 3.831696988645219*^9}, {3.8316970416090884`*^9, 
   3.831697041955227*^9}, 3.831697086945982*^9, 3.8316971352227297`*^9, {
   3.8317872525538883`*^9, 3.8317872692950196`*^9}, {3.8317873194018393`*^9, 
   3.831787326431918*^9}, {3.831787472639682*^9, 3.8317875036806636`*^9}, {
   3.831790004684862*^9, 3.831790009630614*^9}, {3.8321224810099277`*^9, 
   3.832122496245041*^9}, {3.8321226447941523`*^9, 3.8321226517766266`*^9}, {
   3.8321227231284933`*^9, 3.832122723481357*^9}, {3.832124230555783*^9, 
   3.832124243194934*^9}, {3.8321243853868027`*^9, 3.832124420422595*^9}, {
   3.832124570751561*^9, 3.8321245746603556`*^9}, {3.8321277675411935`*^9, 
   3.832127848278613*^9}, {3.832128603418297*^9, 3.8321286305779657`*^9}, {
   3.8321305633244467`*^9, 3.8321306437903223`*^9}, {3.832130784852544*^9, 
   3.8321307853499146`*^9}, 3.832130824876062*^9, {3.8321310057799435`*^9, 
   3.832131006569851*^9}, {3.832132034039692*^9, 3.8321320370055327`*^9}, {
   3.8321321350619807`*^9, 3.832132160224341*^9}, {3.832132199002226*^9, 
   3.8321322457586837`*^9}, {3.8321323544311876`*^9, 
   3.8321323580304728`*^9}, {3.8321324613405905`*^9, 
   3.8321324630848055`*^9}, {3.8321325725616283`*^9, 3.83213260261705*^9}, 
   3.832132676642392*^9, {3.832132711566885*^9, 3.83213273675715*^9}, {
   3.8321329266348753`*^9, 3.8321329310716867`*^9}, {3.8321335679667892`*^9, 
   3.8321335771024575`*^9}, {3.8321337247591352`*^9, 3.832133729959688*^9}, 
   3.8321337914143515`*^9, {3.83213389081371*^9, 3.832133900132602*^9}, 
   3.8321339365725155`*^9, {3.8321340431462383`*^9, 3.832134080127078*^9}, {
   3.832134128641068*^9, 3.8321341430172043`*^9}, {3.832134188533922*^9, 
   3.832134203870819*^9}, {3.8321342683223777`*^9, 3.8321342772372227`*^9}, {
   3.8321343443776655`*^9, 3.8321344415079527`*^9}, {3.832134476713131*^9, 
   3.8321345337829685`*^9}, {3.8321346700595317`*^9, 3.8321346703352075`*^9}, 
   3.8321347498088245`*^9, {3.832134783318416*^9, 3.8321347836499076`*^9}, 
   3.8321348915122194`*^9, {3.8321349405103235`*^9, 3.8321349445063877`*^9}, {
   3.8321353356432133`*^9, 3.8321353571470137`*^9}, {3.8321354319789906`*^9, 
   3.832135465851368*^9}, {3.832135499003937*^9, 3.8321355016894484`*^9}, {
   3.8321356989516463`*^9, 3.8321357178720183`*^9}, {3.832136330819502*^9, 
   3.8321363409047794`*^9}, {3.8321364865483932`*^9, 3.8321364876093416`*^9}, 
   3.8321366519369283`*^9, 3.8321367247483115`*^9, {3.832136757203904*^9, 
   3.832136782571622*^9}, {3.832136818051862*^9, 3.8321368182468996`*^9}, {
   3.8321368641611176`*^9, 3.832136868274884*^9}, {3.8321369785042953`*^9, 
   3.8321369861483135`*^9}, 3.8321371257929173`*^9, {3.8321375749289675`*^9, 
   3.8321375765827274`*^9}, {3.8321377551372166`*^9, 3.8321378050149193`*^9}, 
   3.832138100513293*^9, 3.8321381849052453`*^9, {3.8321382920629883`*^9, 
   3.8321383088519783`*^9}, 3.8321383576379185`*^9, {3.8321383918117957`*^9, 
   3.832138675696443*^9}, {3.8321387458542476`*^9, 3.8321387608711934`*^9}, {
   3.832138850632866*^9, 3.8321388641901484`*^9}, {3.832138896339691*^9, 
   3.832138915613521*^9}, {3.8321415725184126`*^9, 3.8321415847232895`*^9}, {
   3.832141712563466*^9, 3.8321417147149935`*^9}, {3.8321419845934343`*^9, 
   3.832141993024576*^9}, {3.8321426886434393`*^9, 3.832142722353161*^9}, {
   3.8321427718409667`*^9, 3.8321428742887707`*^9}, {3.832142909303938*^9, 
   3.832142949922887*^9}, {3.8321431998448977`*^9, 3.8321433613044524`*^9}, {
   3.8321435808398123`*^9, 3.832143604321457*^9}, {3.832143784033524*^9, 
   3.8321438517973137`*^9}, {3.8321439314210234`*^9, 3.832143950746715*^9}, {
   3.832143982732905*^9, 3.832144012161697*^9}, {3.832144077939167*^9, 
   3.832144085468873*^9}, {3.8321441477625327`*^9, 3.832144254351245*^9}, {
   3.832144306691965*^9, 3.832144667676064*^9}, {3.832144697830405*^9, 
   3.8321448232931104`*^9}, {3.8321449250524087`*^9, 3.832144939374542*^9}, {
   3.832144976179243*^9, 3.832145271650797*^9}, {3.8321453026737146`*^9, 
   3.8321453090804405`*^9}, {3.832145467731866*^9, 3.8321455416904387`*^9}, {
   3.8321455745119324`*^9, 3.8321456034318223`*^9}, 3.8321456378246784`*^9, {
   3.8321456739841805`*^9, 3.8321458693672295`*^9}, 3.8321459148440127`*^9, {
   3.8321462391817627`*^9, 3.8321463031509275`*^9}, 3.8321463375844784`*^9, 
   3.832147697133647*^9, {3.8321477307795725`*^9, 3.8321477311390486`*^9}, 
   3.8321479018040304`*^9, 3.8321482005571613`*^9, {3.8321964038412294`*^9, 
   3.8321964193249187`*^9}, 3.832210781304818*^9, {3.832210931447732*^9, 
   3.832210950367056*^9}, {3.8322110828142676`*^9, 3.83221117181853*^9}, {
   3.8322112539341574`*^9, 3.8322112699258585`*^9}, {3.832211302995039*^9, 
   3.832211329966323*^9}, {3.832211452262136*^9, 3.832211464618183*^9}, {
   3.832211556345975*^9, 3.8322116043050137`*^9}, {3.832211731131279*^9, 
   3.832211755984835*^9}, {3.832211789033802*^9, 3.832211877063871*^9}, {
   3.8322119125235386`*^9, 3.832211930479579*^9}, {3.832212027925811*^9, 
   3.832212156631152*^9}, {3.832212193990961*^9, 3.832212221697892*^9}, {
   3.8322122691593437`*^9, 3.832212481545888*^9}, {3.832212515197855*^9, 
   3.832212735876254*^9}, {3.8322128030049653`*^9, 3.832213152697427*^9}, {
   3.832213374304368*^9, 3.832213381287876*^9}, {3.832213471750419*^9, 
   3.832213498099737*^9}, {3.832213607972108*^9, 3.8322136310325575`*^9}, {
   3.8322137091300817`*^9, 3.8322137143867044`*^9}, {3.832213807102262*^9, 
   3.8322138087709265`*^9}, {3.832214450460169*^9, 3.832214503900955*^9}, {
   3.8322146888977556`*^9, 3.8322147381545277`*^9}, {3.8322148532220316`*^9, 
   3.832214862625577*^9}, {3.832215118657695*^9, 3.832215140046693*^9}, {
   3.832215211550414*^9, 3.83221531156221*^9}, {3.8322155657125654`*^9, 
   3.832215566722142*^9}, {3.8322156662578626`*^9, 3.8322157085851245`*^9}, {
   3.8322158223629665`*^9, 3.8322158346807184`*^9}, {3.8322158648816586`*^9, 
   3.832215941866225*^9}, {3.832216179793569*^9, 3.832216195079422*^9}, {
   3.832216226712989*^9, 3.8322164599697547`*^9}, {3.8322165040132647`*^9, 
   3.8322165839922714`*^9}, {3.832216616434681*^9, 3.832216634544228*^9}, {
   3.8322167041228323`*^9, 3.8322168648084283`*^9}, 3.832216959676594*^9, {
   3.8322169961066213`*^9, 3.832217025868395*^9}, {3.8322171918164372`*^9, 
   3.8322172516976757`*^9}, {3.8322173132532053`*^9, 3.832217322191836*^9}, {
   3.832217443095682*^9, 3.8322174668725557`*^9}, {3.8322175267551785`*^9, 
   3.8322176377394147`*^9}, {3.83221803974468*^9, 3.83221804028185*^9}, {
   3.832218327904318*^9, 3.8322183603590136`*^9}, {3.8322185715526433`*^9, 
   3.83221858395669*^9}, {3.832218714179929*^9, 3.8322187521503625`*^9}, {
   3.8322188281351395`*^9, 3.83221890863474*^9}, {3.832219018786699*^9, 
   3.8322190445097265`*^9}, {3.832219092110083*^9, 3.8322191847999277`*^9}, {
   3.8322192227517433`*^9, 3.83221923529436*^9}, {3.8322197908709917`*^9, 
   3.8322198214693866`*^9}, {3.8322198591640387`*^9, 
   3.8322198848944445`*^9}, {3.8322199210011244`*^9, 
   3.8322199288081055`*^9}, {3.832220239910959*^9, 3.8322204256052256`*^9}, {
   3.8322204599520617`*^9, 3.832220488244772*^9}, {3.8322209582021427`*^9, 
   3.8322209615738635`*^9}, {3.832221079371739*^9, 3.83222108016288*^9}, {
   3.832222536491675*^9, 3.8322225609199753`*^9}, 3.8322235623525896`*^9},
 CellLabel->
  "In[1527]:=",ExpressionUUID->"c6c77f79-b86b-4e1d-9c77-6e8307b26d16"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`capAperture1$$ = Rational[1, 3] 
    Pi, $CellContext`capAperture2$$ = 
    0.4963716392671873, $CellContext`capDir1$$ = {0, 0, 
    1}, $CellContext`capDir2$$ = {1, -1, 1}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`capDir1$$], {0, 0, 1}}}, {{
       Hold[$CellContext`capDir2$$], {1, -1, 1}}, {-1, -1, 0.001}, {1, 1, 
      1}}, {{
       Hold[$CellContext`capAperture1$$], Rational[1, 3] Pi}, 0, 
      Rational[1, 2] Pi}, {{
       Hold[$CellContext`capAperture2$$], Rational[3, 10] Pi}, 0, 
      Rational[1, 2] Pi}}, Typeset`size$$ = {360., {179., 183.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`capDir2$89128$$ = {0, 0, 
    0}, $CellContext`capAperture1$89129$$ = 
    0, $CellContext`capAperture2$89130$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`capAperture1$$ = 
        Rational[1, 3] Pi, $CellContext`capAperture2$$ = 
        Rational[3, 10] Pi, $CellContext`capDir1$$ = {0, 0, 
         1}, $CellContext`capDir2$$ = {1, -1, 1}}, "ControllerVariables" :> {
        Hold[$CellContext`capDir2$$, $CellContext`capDir2$89128$$, {0, 0, 0}], 
        Hold[$CellContext`capAperture1$$, $CellContext`capAperture1$89129$$, 
         0], 
        Hold[$CellContext`capAperture2$$, $CellContext`capAperture2$89130$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> gPlots3D`gParamPlot3D[
        Association[
         ("spheres" -> {
           Association["center" -> Part[
              Slot["intsPoints"], 1], "radius" -> 0.03, 
            "colorFunc" -> (Red& )], 
           Association["center" -> Part[
              Slot["intsPoints"], 2], "radius" -> 0.03, 
            "colorFunc" -> (Red& )]}& )[
          Association[
          "intsPoints" -> $CellContext`aaa[$CellContext`capDir1$$, \
$CellContext`capAperture1$$, $CellContext`capDir2$$, \
$CellContext`capAperture2$$]]], 
         ("spherCaps" -> {
           Association[
           "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> Slot["capDir1"],
             "coneAperture" -> Slot["capAperture1"]], 
           Association[
           "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> Slot["capDir2"],
             "coneAperture" -> Slot["capAperture2"], 
            "colorFunc" -> (LightBlue& )]}& )[
          Association[
          "capDir1" -> $CellContext`capDir1$$, 
           "capDir2" -> $CellContext`capDir2$$, 
           "capAperture1" -> $CellContext`capAperture1$$, 
           "capAperture2" -> $CellContext`capAperture2$$]], "spherCapInts" -> {
           Association[
           "spherCapPair" -> {1, 2}, "colorFunc" -> (Blue& ), "zbias" -> 1]}, 
         "axisExtent" -> 1.5], Medium], 
      "Specifications" :> {{{$CellContext`capDir1$$, {0, 0, 
          1}}}, {{$CellContext`capDir2$$, {1, -1, 1}}, {-1, -1, 0.001}, {1, 1,
          1}}, {{$CellContext`capAperture1$$, Rational[1, 3] Pi}, 0, 
         Rational[1, 2] 
         Pi}, {{$CellContext`capAperture2$$, Rational[3, 10] Pi}, 0, 
         Rational[1, 2] Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {260., 266.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8322200285248566`*^9, 3.8322203713822393`*^9, {3.8322204194017596`*^9, 
   3.8322204263959355`*^9}, {3.832220467651335*^9, 3.832220489023752*^9}, 
   3.8322225167807655`*^9, {3.8322235563620205`*^9, 3.832223565558101*^9}},
 CellLabel->
  "Out[1529]=",ExpressionUUID->"4754ebf5-8f33-4b13-a5e5-79f34c8bde85"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{"n1", ",", "\[Theta]2"}], ")"}]], "Input",
 CellChangeTimes->{{3.8322245078770375`*^9, 3.832224511218624*^9}, {
  3.832224623336799*^9, 
  3.8322246234477262`*^9}},ExpressionUUID->"ec62de52-f851-47f8-98b0-\
9f9e04c41deb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "  ", 
  RowBox[{
   RowBox[{"gParamPlot3D", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spheres\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0.487799", ",", 
                 RowBox[{"-", "0.715578"}], ",", "0.5"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}], ",", 
            "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0.715578", ",", 
                 RowBox[{"-", "0.487799"}], ",", "0.5"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.03"}], ",", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "Red", "]"}]}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", " ", 
        RowBox[{"<|", 
         RowBox[{"\"\<intsPoints\>\"", "\[Rule]", 
          RowBox[{"solveCapIntsPoints", "[", 
           RowBox[{
           "capDir1", ",", "capAperture1", ",", "capDir2", ",", 
            "capAperture2"}], "]"}]}], "|>"}], "]"}], ",", 
       "\[IndentingNewLine]", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<spherCaps\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "   ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir1"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture1"}]}], 
             "|>"}], ",", "\[IndentingNewLine]", "   ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<coneDir\>\"", "\[Rule]", "#capDir2"}], ",", 
              RowBox[{"\"\<coneAperture\>\"", "\[Rule]", "#capAperture2"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
               RowBox[{"Function", "[", "LightBlue", "]"}]}]}], "|>"}]}], 
           "\[IndentingNewLine]", " ", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<capDir1\>\"", "\[Rule]", "capDir1"}], ",", 
          RowBox[{"\"\<capDir2\>\"", "\[Rule]", "capDir2"}], ",", 
          RowBox[{"\"\<capAperture1\>\"", "\[Rule]", "capAperture1"}], ",", 
          RowBox[{"\"\<capAperture2\>\"", "\[Rule]", "capAperture2"}]}], 
         "|>"}], "]"}], ",", "\[IndentingNewLine]", "    ", 
       RowBox[{"\"\<spherCapInts\>\"", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", "\t ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<spherCapPair\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], ",", 
           RowBox[{"\"\<colorFunc\>\"", "\[Rule]", 
            RowBox[{"Function", "[", "Blue", "]"}]}], ",", 
           RowBox[{"\"\<zbias\>\"", "\[Rule]", "1"}]}], "|>"}], 
         "\[IndentingNewLine]", "       ", "}"}]}], ",", 
       "\[IndentingNewLine]", "     ", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "1.5"}]}], 
      "\[IndentingNewLine]", "|>"}], ",", "Medium"}], "]"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"capDir1", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capDir2", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}], ",", "0.001"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture1", ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"capAperture2", ",", "0.182212"}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.832222610580761*^9, {3.8322226828631105`*^9, 3.8322227551156235`*^9}},
 CellLabel->
  "In[1289]:=",ExpressionUUID->"a614384e-e5f9-47e1-ac90-660ee7a357ed"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`capAperture1$$ = Rational[1, 3] 
    Pi, $CellContext`capAperture2$$ = 0.182212, $CellContext`capDir1$$ = {0, 
    0, 1}, $CellContext`capDir2$$ = {1, -1, 1}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`capDir1$$], {0, 0, 1}}}, {{
       Hold[$CellContext`capDir2$$], {1, -1, 1}}, {-1, -1, 0.001}, {1, 1, 
      1}}, {{
       Hold[$CellContext`capAperture1$$], Rational[1, 3] Pi}, 0, 
      Rational[1, 2] Pi}, {{
       Hold[$CellContext`capAperture2$$], 0.182212}, 0, Rational[1, 2] Pi}}, 
    Typeset`size$$ = {360., {179., 183.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`capDir2$80617$$ = {0, 0, 
    0}, $CellContext`capAperture1$80618$$ = 
    0, $CellContext`capAperture2$80619$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`capAperture1$$ = 
        Rational[1, 3] Pi, $CellContext`capAperture2$$ = 
        0.182212, $CellContext`capDir1$$ = {0, 0, 
         1}, $CellContext`capDir2$$ = {1, -1, 1}}, "ControllerVariables" :> {
        Hold[$CellContext`capDir2$$, $CellContext`capDir2$80617$$, {0, 0, 0}], 
        Hold[$CellContext`capAperture1$$, $CellContext`capAperture1$80618$$, 
         0], 
        Hold[$CellContext`capAperture2$$, $CellContext`capAperture2$80619$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> gPlots3D`gParamPlot3D[
        Association[
         ("spheres" -> {
           Association[
           "center" -> {0.487799, -0.715578, 0.5}, "radius" -> 0.03, 
            "colorFunc" -> (Red& )], 
           Association[
           "center" -> {0.715578, -0.487799, 0.5}, "radius" -> 0.03, 
            "colorFunc" -> (Red& )]}& )[
          Association[
          "intsPoints" -> \
$CellContext`solveCapIntsPoints[$CellContext`capDir1$$, \
$CellContext`capAperture1$$, $CellContext`capDir2$$, \
$CellContext`capAperture2$$]]], 
         ("spherCaps" -> {
           Association[
           "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> Slot["capDir1"],
             "coneAperture" -> Slot["capAperture1"]], 
           Association[
           "center" -> {0, 0, 0}, "radius" -> 1, "coneDir" -> Slot["capDir2"],
             "coneAperture" -> Slot["capAperture2"], 
            "colorFunc" -> (LightBlue& )]}& )[
          Association[
          "capDir1" -> $CellContext`capDir1$$, 
           "capDir2" -> $CellContext`capDir2$$, 
           "capAperture1" -> $CellContext`capAperture1$$, 
           "capAperture2" -> $CellContext`capAperture2$$]], "spherCapInts" -> {
           Association[
           "spherCapPair" -> {1, 2}, "colorFunc" -> (Blue& ), "zbias" -> 1]}, 
         "axisExtent" -> 1.5], Medium], 
      "Specifications" :> {{{$CellContext`capDir1$$, {0, 0, 
          1}}}, {{$CellContext`capDir2$$, {1, -1, 1}}, {-1, -1, 0.001}, {1, 1,
          1}}, {{$CellContext`capAperture1$$, Rational[1, 3] Pi}, 0, 
         Rational[1, 2] Pi}, {{$CellContext`capAperture2$$, 0.182212}, 0, 
         Rational[1, 2] Pi}}, 
      "Options" :> {Method -> {"ShowControls" -> True}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {260., 266.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.832222587600385*^9, 3.8322226305944633`*^9}, {
  3.8322226704018707`*^9, 3.8322226889347615`*^9}, {3.8322227282336226`*^9, 
  3.832222756043533*^9}},
 CellLabel->
  "Out[1289]=",ExpressionUUID->"760f6e1a-f3ab-4f5e-8dfa-f585f63794a9"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8321449533775334`*^9, 
  3.832144961565005*^9}},ExpressionUUID->"86fc3037-ae37-4681-afeb-\
07b77c8d5daf"],

Cell[BoxData[
 RowBox[{"ParametricPlot3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1.5", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{"1.5", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
       RowBox[{"1.5", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "}"}]}], "}"}], ",", "\n", 
   "\t\t", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", "\n", "\t\t", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", "Green", "}"}]}], ",", "\n", "\t\t", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}], ",", "\n", "\t\t", 
   RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", "\n", "\t\t", 
   RowBox[{"AspectRatio", "->", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8321243065154514`*^9, 3.832124378414946*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"57f023d8-2e5a-4619-94a9-24293c40520f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ParametricPlot3D", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}], "*", 
       RowBox[{"Boole", "[", 
        RowBox[{"\[Theta]", "<", 
         RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], "\[IndentingNewLine]", 
      "       ", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "0", ",", 
       RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"LightGreen", ",", "LightYellow"}], "}"}]}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.831790028781066*^9, 3.8317900410464644`*^9}, {
   3.8317901015586014`*^9, 3.831790133117756*^9}, 3.8317904965402327`*^9, {
   3.831790541822337*^9, 3.831790602051961*^9}, {3.83179084107593*^9, 
   3.831790937111478*^9}, {3.83179108165236*^9, 3.831791089667427*^9}, {
   3.83179112710014*^9, 3.8317911554712687`*^9}, {3.831792413075954*^9, 
   3.8317924414617453`*^9}, {3.83179257661907*^9, 3.831792584693375*^9}, {
   3.832122198423423*^9, 3.832122268233552*^9}, 3.8321223745700045`*^9},
 CellLabel->
  "In[117]:=",ExpressionUUID->"54a27c41-2d4d-43ac-9422-839a0a93f7f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sphCapFunc", "[", 
     RowBox[{
     "\[Phi]_", ",", "\[Theta]_", ",", "inConeDir_", ",", "coneAperture_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"spherePt", ",", "coneDir", ",", "deltaCos"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"spherePt", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"coneDir", "=", 
        RowBox[{"Normalize", "[", "inConeDir", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaCos", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{"spherePt", ",", "coneDir"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"spherePt", "*", 
        RowBox[{"Boole", "[", 
         RowBox[{"deltaCos", "\[GreaterEqual]", 
          RowBox[{"Cos", "[", "coneAperture", "]"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sphCapIntsFunc", "[", 
     RowBox[{
     "\[Phi]_", ",", "\[Theta]_", ",", "inConeDirA_", ",", "coneApertureA_", 
      ",", "inConeDirB_", ",", "coneApertureB_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "spherePt", ",", "coneDirA", ",", "deltaCosA", ",", "coneDirB", ",", 
        "deltaCosB"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"spherePt", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"coneDirA", "=", 
        RowBox[{"Normalize", "[", "inConeDirA", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaCosA", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{"spherePt", ",", "coneDirA"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"coneDirB", "=", 
        RowBox[{"Normalize", "[", "inConeDirB", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaCosB", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{"spherePt", ",", "coneDirB"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Boole", "[", 
         RowBox[{"deltaCosA", "\[GreaterEqual]", 
          RowBox[{"Cos", "[", "coneApertureA", "]"}]}], "]"}], "*", 
        RowBox[{"Boole", "[", 
         RowBox[{"deltaCosB", "\[GreaterEqual]", 
          RowBox[{"Cos", "[", "coneApertureB", "]"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sphCapIntsPaints", "[", 
     RowBox[{
     "\[Phi]_", ",", "\[Theta]_", ",", "inConeDirA_", ",", "coneApertureA_", 
      ",", "inConeDirB_", ",", "coneApertureB_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "spherePt", ",", "coneDirA", ",", "deltaCosA", ",", "coneDirB", ",", 
        "deltaCosB", ",", "zfightOffset"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"zfightOffset", "=", 
        RowBox[{"2", "^", 
         RowBox[{"-", "6"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"spherePt", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", "zfightOffset"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"spherePt", "*", 
        RowBox[{"sphCapIntsFunc", "[", 
         RowBox[{
         "\[Phi]", ",", "\[Theta]", ",", "inConeDirA", ",", "coneApertureA", 
          ",", "inConeDirB", ",", "coneApertureB"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ParametricPlot3D", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"sphCapFunc", "[", 
        RowBox[{
        "\[Phi]", ",", "\[Theta]", ",", "coneDir", ",", "coneAperture1"}], 
        "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"sphCapFunc", "[", 
        RowBox[{"\[Phi]", ",", "\[Theta]", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", "coneAperture2"}], 
        "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"sphCapIntsPaints", "[", 
        RowBox[{
        "\[Phi]", ",", "\[Theta]", ",", "coneDir", ",", "coneAperture1", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", "coneAperture2"}], 
        "]"}]}], "\[IndentingNewLine]", "\t", "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "0", ",", 
       RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"LightGreen", ",", "LightBlue", ",", "Red"}], "}"}]}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"PlotPoints", "\[Rule]", "10"}], ",", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"coneDir", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"coneAperture1", ",", 
       RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"coneAperture2", ",", 
       RowBox[{"\[Pi]", "/", "4"}]}], "}"}], ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "True"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8317924942427177`*^9, 3.8317925716610613`*^9}, {
  3.8317926303054695`*^9, 3.8317926558830347`*^9}, {3.8317926914102755`*^9, 
  3.8317927249692526`*^9}, {3.831798116915722*^9, 3.8317981352749553`*^9}, {
  3.831798206117837*^9, 3.8317983891664658`*^9}, {3.83179842966635*^9, 
  3.8317984856795883`*^9}, {3.8317985456696186`*^9, 3.8317985477032123`*^9}, {
  3.831798590635188*^9, 3.831798596190754*^9}, {3.831798630468264*^9, 
  3.8317986811668324`*^9}, {3.831798824131267*^9, 3.831798838433531*^9}, {
  3.8317988720046587`*^9, 3.83179889871957*^9}, {3.8317990723917*^9, 
  3.8317992123099155`*^9}, {3.8317993717212934`*^9, 3.8317995669180536`*^9}, {
  3.831799653143091*^9, 3.8317997277828054`*^9}, {3.831799772194249*^9, 
  3.831799781226774*^9}, {3.8317998224822693`*^9, 3.8317998351370196`*^9}, {
  3.8318000141777153`*^9, 3.8318000170010753`*^9}, {3.8318001419334354`*^9, 
  3.8318002090244274`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"08e5773f-dec2-435e-b983-a5c820cca639"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", "^", 
   RowBox[{"-", "6"}]}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.8322096010994787`*^9, 3.8322096014824505`*^9}},
 CellLabel->
  "In[926]:=",ExpressionUUID->"09b3adb0-5c4e-402b-bfe4-e37a4b25bd9b"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"sphCapIntsFunc", "[", 
      RowBox[{"\[Phi]", ",", "\[Theta]", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "apertureA", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", "apertureB"}], "]"}], 
     ",", "\[IndentingNewLine]", "\t", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "0", ",", 
       RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"PrecisionGoal", "\[Rule]", "1"}], ",", 
     RowBox[{"AccuracyGoal", "\[Rule]", "1"}], ",", " ", 
     RowBox[{"Method", "\[Rule]", "\"\<QuasiMonteCarlo\>\""}], ",", 
     RowBox[{"MaxRecursion", "\[Rule]", "2"}]}], "]"}], ",", 
   "\[IndentingNewLine]", "   ", 
   RowBox[{"{", 
    RowBox[{"apertureA", ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"apertureB", ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.8318005402559643`*^9, 3.831800670803832*^9}, {
  3.8318007148834424`*^9, 3.831800768875346*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"2e590f55-edc3-4c3e-bb45-70eace6bbcf1"],

Cell[BoxData[{
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"a", "*", 
     RowBox[{"(", 
      RowBox[{"z", "-", "1"}], ")"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", 
    RowBox[{"Sphere", "[", "]"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{
     RowBox[{"a", ">", "0"}], "&&", 
     RowBox[{"a", "\[Element]", "Reals"}]}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"a", "*", 
     RowBox[{"(", 
      RowBox[{"z", "-", "1"}], ")"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", 
    RowBox[{"ImplicitRegion", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x", "^", "2"}], "+", 
        RowBox[{"y", "^", "2"}], "+", 
        RowBox[{"z", "^", "2"}]}], "\[Equal]", "1"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{
     RowBox[{"a", ">", "0"}], "&&", 
     RowBox[{"a", "\[Element]", "Reals"}]}]}]}], "]"}]}], "Input",
 CellLabel->
  "In[123]:=",ExpressionUUID->"90a575bf-e065-4afd-be1f-7249d554a583"],

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"a", "*", 
     RowBox[{"(", 
      RowBox[{"z", "-", "1"}], ")"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", 
    RowBox[{"ImplicitRegion", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x", "^", "2"}], "+", 
        RowBox[{"y", "^", "2"}], "+", 
        RowBox[{"z", "^", "2"}]}], "\[Equal]", "1"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{
     RowBox[{"a", ">", "0"}], "&&", 
     RowBox[{"a", "\[Element]", "Reals"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8318018188324995`*^9, 3.8318018522814198`*^9}, 
   3.83180227831885*^9},
 CellLabel->
  "In[162]:=",ExpressionUUID->"1ff8d944-a06a-4050-be76-876a7cb85052"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"reg2", "=", 
    RowBox[{"ParametricRegion", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Phi]", ",", "0", ",", 
          RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}]}], "}"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"a", "*", 
        RowBox[{"(", 
         RowBox[{"z", "-", "1"}], ")"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", "reg2"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"a", ">", "0"}]}]}], "]"}], ";"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"solved2", "=", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"\[Mu]", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{"\[Lambda]", "*", 
        RowBox[{"(", 
         RowBox[{"z", "-", "1"}], ")"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", "reg2"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"\[Lambda]", ">", "0"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "solved2"}], "Input",
 CellChangeTimes->{{3.832020811231866*^9, 3.8320208112328634`*^9}, {
   3.8320209809000206`*^9, 3.832020997323145*^9}, 3.8320214264604626`*^9, {
   3.832021599027141*^9, 3.832021607808674*^9}, {3.8320218748836665`*^9, 
   3.832021880051987*^9}, {3.8320222692937937`*^9, 3.8320222869374948`*^9}, {
   3.8320223605742073`*^9, 3.83202240485353*^9}, {3.832022470443166*^9, 
   3.832022508021375*^9}, {3.832281040172362*^9, 3.832281106240369*^9}, {
   3.8322829239362807`*^9, 3.832282925079444*^9}, {3.8322837767370377`*^9, 
   3.8322837769620943`*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"535c93fc-8042-4471-9009-4e67796ee0e5"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{"\[Mu]", "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[Lambda]"}]], " ", "\[Mu]"}]}], ")"}]}], 
  "\[Lambda]"]], "Output",
 CellChangeTimes->{
  3.8322807640785365`*^9, {3.8322810600218515`*^9, 3.832281107553492*^9}, {
   3.832283770630089*^9, 3.8322837780332146`*^9}},
 CellLabel->
  "Out[320]=",ExpressionUUID->"f59a772d-df56-4905-8a89-27d832f06092"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "dotP_"}], "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"\[Lambda]1", "^", "2"}], "+", 
     RowBox[{"\[Lambda]2", "^", "2"}], "+", 
     RowBox[{"2", "\[Lambda]1", "*", "\[Lambda]2", "*", "dotP"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8322985181409807`*^9, 3.832298608878394*^9}, {
   3.8322988783646097`*^9, 3.8322989786308885`*^9}, 3.832299052054352*^9, {
   3.8322990821970267`*^9, 3.8322991417244463`*^9}, {3.832299206649164*^9, 
   3.8322992443252926`*^9}, {3.832299384484377*^9, 3.832299393466821*^9}, {
   3.832300125717727*^9, 3.8323001699156833`*^9}, {3.832300218074217*^9, 
   3.832300265018854*^9}, {3.832300299993588*^9, 3.8323003267300105`*^9}, {
   3.8323005754745464`*^9, 3.8323005772236943`*^9}, {3.832301138305566*^9, 
   3.832301152196245*^9}, {3.832301210556038*^9, 
   3.832301216561042*^9}},ExpressionUUID->"b3c9242e-cda3-4def-84ae-\
00f7bf4ac020"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"dp", "-", "dp0"}], ")"}], " ", "\[Lambda]1", " ", 
    "\[Lambda]2"}], 
   SqrtBox[
    RowBox[{
     SuperscriptBox["\[Lambda]1", "2"], "+", 
     RowBox[{"2", " ", "dp0", " ", "\[Lambda]1", " ", "\[Lambda]2"}], "+", 
     SuperscriptBox["\[Lambda]2", "2"]}]]], "+", 
  SqrtBox[
   RowBox[{
    SuperscriptBox["\[Lambda]1", "2"], "+", 
    RowBox[{"2", " ", "dp0", " ", "\[Lambda]1", " ", "\[Lambda]2"}], "+", 
    SuperscriptBox["\[Lambda]2", "2"]}]]}]], "Output",
 CellChangeTimes->{{3.832298519616414*^9, 3.8322985373901267`*^9}, 
   3.832298609402583*^9, 3.8322989794356804`*^9, {3.832299086406476*^9, 
   3.832299096957862*^9}, {3.8322991387000914`*^9, 3.8322991425369005`*^9}, {
   3.8322992181056175`*^9, 3.832299245019748*^9}, {3.832299370480839*^9, 
   3.832299397833805*^9}, {3.832300241138069*^9, 3.832300248680021*^9}, {
   3.832300305364333*^9, 3.832300315115855*^9}, 3.8323005780973787`*^9},
 CellLabel->
  "Out[449]=",ExpressionUUID->"6228bec0-6e68-453b-910f-18d6e96c01b5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{
        RowBox[{"x", "*", "t"}], ",", 
        RowBox[{"y", "*", "t"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "5"}], "}"}]}], "]"}], "]"}], "/.", 
   RowBox[{"t", "\[Rule]", "1"}]}]}]], "Input",
 CellChangeTimes->{{3.8323020083837166`*^9, 
  3.8323020390075436`*^9}},ExpressionUUID->"bee30247-5a72-415e-9955-\
bc93df215e6f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"x", "*", 
      RowBox[{"y", "^", "2"}]}], "]"}], "+", 
    RowBox[{
     RowBox[{"x", "^", "4"}], "*", "y"}], "-", 
    RowBox[{"3", "*", "x", "*", 
     RowBox[{"Cos", "[", "y", "]"}]}], "-", 
    RowBox[{
     RowBox[{"x", "^", "2"}], "*", 
     RowBox[{"y", "^", "3"}]}]}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{
       RowBox[{"x", "*", "t"}], ",", 
       RowBox[{"y", "*", "t"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "5"}], "}"}]}], "]"}], "]"}], "/.", 
  RowBox[{"t", "\[Rule]", "1"}]}]}], "Input",
 CellChangeTimes->{{3.8322987982137985`*^9, 3.8322988680773177`*^9}, {
  3.832299002573563*^9, 3.832299035750333*^9}},
 CellLabel->
  "In[406]:=",ExpressionUUID->"5bc48dad-8eb2-4515-981f-a8f17820fb4e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "3"}], " ", "x"}], "+", 
  RowBox[{
   SuperscriptBox["x", "4"], " ", "y"}], "+", 
  FractionBox[
   RowBox[{"5", " ", "x", " ", 
    SuperscriptBox["y", "2"]}], "2"], "-", 
  RowBox[{
   SuperscriptBox["x", "2"], " ", 
   SuperscriptBox["y", "3"]}], "-", 
  FractionBox[
   RowBox[{"x", " ", 
    SuperscriptBox["y", "4"]}], "8"]}]], "Output",
 CellChangeTimes->{
  3.832298799555577*^9, {3.8322988580932117`*^9, 3.8322988688580656`*^9}, 
   3.832299036359497*^9},
 CellLabel->
  "Out[407]=",ExpressionUUID->"ec35798b-c133-4af7-89bf-1593a7f87c7c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Assuming", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]", ">", "0"}], "&&", 
    RowBox[{"\[Mu]", ">", "0"}], "&&", 
    RowBox[{"\[Epsilon]", ">", "0"}]}], ",", 
   RowBox[{"FullSimplify", "@", 
    RowBox[{"Reduce", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[Lambda]"}]], " ", "\[Epsilon]"}], "-", 
        "\[Mu]"}], ">", "0"}], ",", "\[Lambda]", ",", "Reals"}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Log", "[", "1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Log", "[", "0.1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Log", "[", "0.01", "]"}]}], "Input",
 CellChangeTimes->{{3.832284052353006*^9, 3.832284056777667*^9}, {
  3.8322841054475594`*^9, 3.8322841261299057`*^9}, {3.832284167233037*^9, 
  3.83228424136053*^9}, {3.832284330736706*^9, 3.8322843400938196`*^9}, {
  3.8322843948240795`*^9, 3.8322844034155383`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"bb390b72-e941-4ce3-a86c-07771c24dfaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"2", " ", "\[Lambda]"}], "+", 
   RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], ">", 
  RowBox[{"Log", "[", "\[Mu]", "]"}]}]], "Output",
 CellChangeTimes->{
  3.832284058188998*^9, {3.8322841077881403`*^9, 3.8322841268910923`*^9}, {
   3.8322842205882993`*^9, 3.8322842427934003`*^9}, 3.8322843406763268`*^9, {
   3.8322844004316845`*^9, 3.832284403762388*^9}, 3.8322847940355597`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"40b7b4e6-11c8-4143-bde6-c9a17a27f49f"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.832284058188998*^9, {3.8322841077881403`*^9, 3.8322841268910923`*^9}, {
   3.8322842205882993`*^9, 3.8322842427934003`*^9}, 3.8322843406763268`*^9, {
   3.8322844004316845`*^9, 3.832284403762388*^9}, 3.8322847940375247`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"19baf609-a8ff-4f13-bb61-2095dc690ec2"],

Cell[BoxData[
 RowBox[{"-", "2.3025850929940455`"}]], "Output",
 CellChangeTimes->{
  3.832284058188998*^9, {3.8322841077881403`*^9, 3.8322841268910923`*^9}, {
   3.8322842205882993`*^9, 3.8322842427934003`*^9}, 3.8322843406763268`*^9, {
   3.8322844004316845`*^9, 3.832284403762388*^9}, 3.8322847940395193`*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"83a05023-3162-4d4a-ba2b-03ee6f6c9415"],

Cell[BoxData[
 RowBox[{"-", "4.605170185988091`"}]], "Output",
 CellChangeTimes->{
  3.832284058188998*^9, {3.8322841077881403`*^9, 3.8322841268910923`*^9}, {
   3.8322842205882993`*^9, 3.8322842427934003`*^9}, 3.8322843406763268`*^9, {
   3.8322844004316845`*^9, 3.832284403762388*^9}, 3.8322847940415144`*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"a22ee5c0-fb40-4d32-88dd-011d5df5f972"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ParametricPlot3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", "0", ",", 
     RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8320212816433487`*^9, 3.8320212945552807`*^9}, {
   3.8320214082925587`*^9, 3.832021410226184*^9}, 3.832021616164003*^9, {
   3.832021856237727*^9, 3.832021866538266*^9}, {3.8320220726144695`*^9, 
   3.8320221258724318`*^9}, {3.83202243000237*^9, 3.8320224611977406`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"f5bb2cf3-80bc-4fcf-a86e-3dd63a7a5bf5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"reg3", "=", 
   RowBox[{"ParametricRegion", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", 
         RowBox[{"3", 
          RowBox[{"\[Pi]", "/", "4"}]}], ",", "\[Pi]"}], "}"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"a", "*", 
     RowBox[{"(", 
      RowBox[{"z", "-", "1"}], ")"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", "reg3"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"z", ">", "0"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8320226080988436`*^9, 3.832022634762356*^9}, {
  3.8320230654984527`*^9, 3.8320230701458015`*^9}, {3.8320238001223135`*^9, 
  3.8320238084224043`*^9}, {3.832023840752634*^9, 3.8320238488073483`*^9}, {
  3.832023886984753*^9, 3.832023891320305*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"4ea862ab-1dfb-4332-b279-12f3914dc99e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"reg4", "=", 
     RowBox[{"ParametricRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", 
           RowBox[{"\[Theta]", "/", "2"}], ",", 
           RowBox[{"\[Theta]", "*", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "0", ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]2", "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]3", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Theta]2", "-", "\[Theta]1"}], ")"}], "/", "2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thetaHalfRange", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Theta]1", "+", "\[Theta]2"}], ")"}], "/", "2"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ParametricPlot3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "\[Theta]1", ",", "\[Theta]2"}], "}"}], ",", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", 
       RowBox[{"\[Pi]", "-", 
        RowBox[{"ArcCos", "[", 
         RowBox[{"Sin", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"\[Theta]", "-", "\[Theta]3"}], "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"\[Pi]", "+", 
        RowBox[{"ArcCos", "[", 
         RowBox[{"Sin", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"\[Theta]", "-", "\[Theta]3"}], "]"}], "]"}], "]"}]}]}], 
      "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8320227543849883`*^9, 3.8320227926344905`*^9}, {
  3.8320228380378013`*^9, 3.8320228915189323`*^9}, {3.832022950025171*^9, 
  3.832022982656049*^9}, {3.832023028722311*^9, 3.832023030650586*^9}, {
  3.832024102776186*^9, 3.8320242584636507`*^9}, {3.832024289135085*^9, 
  3.832024296814002*^9}, {3.832024752885805*^9, 3.832024892027783*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"e73e8747-dbb3-409d-a885-0338db2d019b"],

Cell[BoxData["Plot"], "Input",
 CellChangeTimes->{{3.8323006331775217`*^9, 
  3.832300637459672*^9}},ExpressionUUID->"f2e75d74-b037-4c91-8094-\
d7ef07c0c975"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8323009039929733`*^9, 
  3.832300905304417*^9}},ExpressionUUID->"2bb9416f-7dd8-4dea-a5e4-\
4c5fbc0e48fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{"Arrow", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "0"}], "}"}]}], "}"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8323009086229143`*^9, 3.8323009512071285`*^9}, {
  3.832301000618622*^9, 3.832301007321272*^9}, {3.8323010813802176`*^9, 
  3.8323011146704216`*^9}},
 CellLabel->
  "In[456]:=",ExpressionUUID->"0e905932-1fb5-4532-b674-f0394df8c664"],

Cell[BoxData[
 Graphics3DBox[Arrow3DBox[{{1, 1, -1}, {2, 2, 0}}]]], "Output",
 CellChangeTimes->{{3.8323009138681483`*^9, 3.8323009517822857`*^9}, 
   3.8323010091510773`*^9, {3.832301082465763*^9, 3.8323011153893704`*^9}},
 CellLabel->
  "Out[456]=",ExpressionUUID->"845e2472-3b1a-4795-8fc5-56938b4a3449"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8323023324814043`*^9, 
  3.8323023453380227`*^9}},ExpressionUUID->"64684fdc-111b-4e76-940e-\
b25931ff0c01"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c1", "|", "c2"}], ")"}], "\[Element]", "Reals"}], "&&", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p1", "|", "p2"}], ")"}], "\[Element]", 
       RowBox[{"Vectors", "[", 
        RowBox[{"3", ",", "Reals"}], "]"}]}]}], ",", " ", 
     RowBox[{"TraditionalForm", "[", 
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"c1", "*", "p1"}], "+", 
        RowBox[{"c2", "*", "p2"}]}], "]"}], "]"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c1", "|", "c2"}], ")"}], "\[Element]", "Reals"}], "&&", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p1", "|", "p2"}], ")"}], "\[Element]", 
       RowBox[{"Vectors", "[", 
        RowBox[{"3", ",", "Reals"}], "]"}]}]}], ",", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"c1", "^", "2"}], "+", 
       RowBox[{"c2", "^", "2"}], "+", 
       RowBox[{"2", "\[Lambda]1", "*", "\[Lambda]2", "*", 
        RowBox[{"Dot", "[", 
         RowBox[{"p1", ",", "p2"}], "]"}]}]}], "]"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TraditionalForm", "[", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"c1", "^", "2"}], "+", 
       RowBox[{"c2", "^", "2"}], "+", 
       RowBox[{"2", "\[Lambda]1", "*", "\[Lambda]2", "*", 
        RowBox[{"Dot", "[", 
         RowBox[{"p1", ",", "p2"}], "]"}]}]}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.832301325921613*^9, {3.832301375771406*^9, 3.832301392650818*^9}, {
   3.832301607352852*^9, 3.832301612056883*^9}, {3.8323016451866617`*^9, 
   3.83230168698662*^9}, {3.832301718600065*^9, 3.83230176240024*^9}, {
   3.832301814417406*^9, 3.832301888041247*^9}, {3.8323019321616592`*^9, 
   3.8323019867655897`*^9}, {3.832302042697936*^9, 3.8323020873551965`*^9}, {
   3.8323022934991636`*^9, 3.832302294752946*^9}, {3.832302353273815*^9, 
   3.8323023618992033`*^9}, {3.8323023951785927`*^9, 3.832302415758399*^9}, {
   3.832302571504487*^9, 3.8323026142930536`*^9}},
 CellLabel->
  "In[481]:=",ExpressionUUID->"3c0dbc72-2ee0-49ab-b401-b589018e1d9d"],

Cell[BoxData[
 FormBox[
  TemplateBox[{RowBox[{
      RowBox[{"c1", " ", "p1"}], "+", 
      RowBox[{"c2", " ", "p2"}]}]},
   "Norm"], TraditionalForm]], "Output",
 CellChangeTimes->{{3.8323025969659433`*^9, 3.8323026146873703`*^9}},
 CellLabel->
  "Out[481]//TraditionalForm=",ExpressionUUID->"b1d6e7fa-0186-49b7-9fe3-\
0cfc17f50e41"],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox["c1", "2"], "+", 
   SuperscriptBox["c2", "2"], "+", 
   RowBox[{"2", " ", "\[Lambda]1", " ", "\[Lambda]2", " ", 
    RowBox[{"p1", ".", "p2"}]}]}]]], "Output",
 CellChangeTimes->{{3.8323025969659433`*^9, 3.832302614694351*^9}},
 CellLabel->
  "Out[482]=",ExpressionUUID->"fbd146be-af43-4e6a-93ab-bf8824117abb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gSpherCapArea", "[", "\[Theta]", "]"}]], "Input",
 CellChangeTimes->{{3.832305085825574*^9, 3.83230508907216*^9}, 
   3.8323052721253405`*^9},
 CellLabel->
  "In[546]:=",ExpressionUUID->"3ea774f5-4124-4a5a-af60-9716deca59cb"],

Cell[BoxData[
 RowBox[{"2", " ", "\[Pi]", " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8323050899988413`*^9, 3.8323052332696843`*^9, {3.8323052732730265`*^9, 
   3.8323052798850527`*^9}},
 CellLabel->
  "Out[546]=",ExpressionUUID->"d8dd0efd-413d-4a32-9ea4-ee773b55c0ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Plot", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"gSpherCapIntsArea", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "apertAngle2"}], 
           "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{"gSpherCapIntsVis2", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"\[Pi]", "/", "3"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "apertAngle2", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", 
           RowBox[{"Sphere", "[", "]"}]}], ",", "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{"PrecisionGoal", "\[Rule]", "2"}], ",", 
          RowBox[{"AccuracyGoal", "\[Rule]", "2"}], ",", 
          RowBox[{"MaxRecursion", "\[Rule]", "2"}]}], "]"}]}], 
       "\[IndentingNewLine]", "\t", "}"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"{", 
       RowBox[{"apertAngle2", ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotPoints", "\[Rule]", "3"}], ",", 
      RowBox[{"MaxRecursion", "\[Rule]", "0"}]}], "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"gSpherCapIntsAreaError", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.8323073632059517`*^9, {3.8323115574007053`*^9, 3.8323115693566675`*^9}, {
   3.8323126400120997`*^9, 3.8323131685069103`*^9}, {3.8323178845037127`*^9, 
   3.832317909583183*^9}, 3.832317971959754*^9, {3.8323182495009813`*^9, 
   3.832318251557822*^9}, {3.832318329709757*^9, 3.832318339303796*^9}, {
   3.832318398103444*^9, 3.832318475231228*^9}, {3.832318693455933*^9, 
   3.832318718619298*^9}, {3.832318783812755*^9, 3.8323187858251314`*^9}},
 CellLabel->
  "In[428]:=",ExpressionUUID->"0f16a1fc-82d9-4fc6-9c10-5e6831c037d4"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","ncvb",
   "\"NIntegrate failed to converge to prescribed accuracy after \
\\!\\(\\*RowBox[{\\\"4\\\"}]\\) recursive bisections in \
\\!\\(\\*RowBox[{\\\"gSphericalCap`Private`y\\\"}]\\) near \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"gSphericalCap`Private`x\\\", \
\\\",\\\", \\\"gSphericalCap`Private`y\\\"}], \\\"}\\\"}]\\) = \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"1.9022828896715713`\\\", \\\",\\\", \
\\\"2.68768105306902`\\\"}], \\\"}\\\"}]\\). NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"1.6413538128303145`\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"0.09213676963280898`\\\"}]\\) for the integral and error \
estimates.\"",2,428,29,30162124851444104551,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.832318744285101*^9, 3.8323187913578196`*^9},
 CellLabel->
  "During evaluation of \
In[428]:=",ExpressionUUID->"9fc17a5e-b3b0-4128-8f35-677c99070a2b"],

Cell[BoxData["0.13564411969210188`"], "Output",
 CellChangeTimes->{3.832313206330126*^9, 3.8323179823369956`*^9, 
  3.832318245978578*^9, 3.8323182775274277`*^9, 3.83231836161809*^9, 
  3.8323186261684837`*^9, 3.8323187442930794`*^9, 3.8323187913657646`*^9},
 CellLabel->
  "Out[428]=",ExpressionUUID->"0511fda7-9fa6-4675-b009-6eddce013929"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"gSpherCapArea", "[", 
        RowBox[{"\[Pi]", "/", "2"}], "]"}], "//", 
       RowBox[{"N", "\[IndentingNewLine]", 
        RowBox[{"gSpherCapIntsArea", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}]}]}], ";"}], "//", 
     RowBox[{"N", "\[IndentingNewLine]", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"gSpherCapIntsVis", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"\[Pi]", "/", "3"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"\[Pi]", "/", "2"}], ",", "\[Phi]", ",", "\[Theta]"}], 
         "]"}], ",", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"\[Phi]", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"PrecisionGoal", "\[Rule]", "2"}], ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "2"}], ",", " ", 
        RowBox[{"Method", "\[Rule]", "\"\<QuasiMonteCarlo\>\""}], ",", 
        RowBox[{"MaxRecursion", "\[Rule]", "2"}]}], "]"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"reg6", "=", 
     RowBox[{"ParametricRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", "0", ",", 
           RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NIntegrate", "[", 
     RowBox[{"1", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", "reg6"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"gSpherCapVis2", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"\[Pi]", "/", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", 
      RowBox[{"Sphere", "[", "]"}]}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{"PrecisionGoal", "\[Rule]", "2"}], ",", 
     RowBox[{"AccuracyGoal", "\[Rule]", "2"}], ",", 
     RowBox[{"MaxRecursion", "\[Rule]", "2"}]}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8323146824491787`*^9, 3.832314773154827*^9}, {
   3.832314845030326*^9, 3.8323148887167764`*^9}, {3.8323149318657246`*^9, 
   3.832314962032942*^9}, {3.832315004890077*^9, 3.832315011080329*^9}, {
   3.8323150430534782`*^9, 3.8323150908321953`*^9}, {3.8323152627354465`*^9, 
   3.8323153255596533`*^9}, {3.832315672984784*^9, 3.8323156801049185`*^9}, {
   3.8323162020550675`*^9, 3.8323162321905823`*^9}, {3.832316623919601*^9, 
   3.832316633806307*^9}, {3.832316675143997*^9, 3.832316689355775*^9}, {
   3.8323167920790353`*^9, 3.8323167953614407`*^9}, {3.832316828231332*^9, 
   3.832316927638175*^9}, {3.832317043383341*^9, 3.832317062863245*^9}, {
   3.8323173407265635`*^9, 3.832317346200884*^9}, 3.832317874222603*^9},
 CellLabel->
  "In[289]:=",ExpressionUUID->"10c6a8e6-3bfe-4451-bf3b-3e73c1979c70"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","ncvb",
   "\"NIntegrate failed to converge to prescribed accuracy after \
\\!\\(\\*RowBox[{\\\"4\\\"}]\\) recursive bisections in \
\\!\\(\\*RowBox[{\\\"y\\\"}]\\) near \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"x\\\", \\\",\\\", \\\"y\\\"}], \\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\
\\\"{\\\", RowBox[{\\\"0.8441236008058426`\\\", \\\",\\\", \
\\\"0.05275772505036516`\\\"}], \\\"}\\\"}]\\). NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"6.208432692394886`\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"0.0685724515644851`\\\"}]\\) for the integral and error \
estimates.\"",2,291,21,30162124851444104551,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.8323173421295233`*^9, 3.832317349597934*^9}, 
   3.8323178753401003`*^9},
 CellLabel->
  "During evaluation of \
In[289]:=",ExpressionUUID->"d746481d-0ead-484d-ab2b-cf07da91f073"],

Cell[BoxData["6.208432692394886`"], "Output",
 CellChangeTimes->{{3.8323173421634965`*^9, 3.832317349606619*^9}, 
   3.832317875347081*^9},
 CellLabel->
  "Out[291]=",ExpressionUUID->"bc58bb6e-69d3-4bf9-967f-ca85b135154a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"NIntegrate", "[", 
  RowBox[{"1", ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", 
    RowBox[{"Sphere", "[", "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{"1", ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", 
    RowBox[{"Sphere", "[", "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.832315408064992*^9, 3.832315440033098*^9}, {
   3.8323155303628006`*^9, 3.832315577520938*^9}, {3.83231562192714*^9, 
   3.83231569703107*^9}, {3.832315791786148*^9, 3.8323158043264217`*^9}, 
   3.8323158515199947`*^9, {3.832315885839734*^9, 3.832315892376618*^9}, {
   3.8323159948011293`*^9, 3.8323160073167915`*^9}, 3.8323166097757497`*^9, {
   3.8323166841757345`*^9, 3.8323166845536823`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"bca18d90-9f6c-4993-b5ba-3f490f103c58"],

Cell[BoxData["12.56637054569839`"], "Output",
 CellChangeTimes->{{3.8323154312211885`*^9, 3.8323154406422234`*^9}, {
   3.832315511312354*^9, 3.8323155311967154`*^9}, {3.8323155668549933`*^9, 
   3.8323155723682923`*^9}, {3.832315653220065*^9, 3.8323156973810453`*^9}, {
   3.832315793297837*^9, 3.832315804813219*^9}, 3.8323158521346455`*^9, {
   3.832315886583419*^9, 3.832315892752681*^9}, {3.83231599527092*^9, 
   3.832316007638029*^9}, 3.832316610859293*^9, 3.832316684940791*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"df501c61-4982-4714-bceb-dac1241f4f22"],

Cell[BoxData[
 RowBox[{"4", " ", "\[Pi]"}]], "Output",
 CellChangeTimes->{{3.8323154312211885`*^9, 3.8323154406422234`*^9}, {
   3.832315511312354*^9, 3.8323155311967154`*^9}, {3.8323155668549933`*^9, 
   3.8323155723682923`*^9}, {3.832315653220065*^9, 3.8323156973810453`*^9}, {
   3.832315793297837*^9, 3.832315804813219*^9}, 3.8323158521346455`*^9, {
   3.832315886583419*^9, 3.832315892752681*^9}, {3.83231599527092*^9, 
   3.832316007638029*^9}, 3.832316610859293*^9, 3.832316684944746*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"bfa16c1b-6aaf-4a57-ba58-154e18f072f5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Plot", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
    RowBox[{"gSpherCapIntsArea", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "apertAngle2"}], 
       "}"}]}], "]"}], "\[IndentingNewLine]", "\t", "}"}], ",", 
   "\[IndentingNewLine]", "\t", 
   RowBox[{"{", 
    RowBox[{"apertAngle2", ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8323130455082903`*^9, 3.832313094173668*^9}, {
  3.8323142787076464`*^9, 3.8323142821412177`*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"e3cefa4f-6d11-426f-af6c-860f26046571"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "f", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], "=", 
   RowBox[{"Sqrt", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"c1", "^", "2"}], "+", 
     RowBox[{"c2", "^", "2"}], "+", 
     RowBox[{"2", "c1", "*", "c2", "*", "p"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8323681419314914`*^9, 3.8323682212036796`*^9}, {
  3.832368266752549*^9, 3.832368303857339*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"e2b27256-2dd9-4989-85d9-2bcfe06c2d72"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   SqrtBox[
    RowBox[{
     SuperscriptBox["c1", "2"], "+", 
     RowBox[{"2", " ", "c1", " ", "c2"}], "+", 
     SuperscriptBox["c2", "2"]}]], "+", 
   FractionBox[
    RowBox[{"c1", " ", "c2", " ", 
     RowBox[{"(", 
      RowBox[{"p", "-", "1"}], ")"}]}], 
    SqrtBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"c1", "+", "c2"}], ")"}], "2"]]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      RowBox[{"p", "-", "1"}], "]"}], "2"],
    SeriesData[$CellContext`p, 1, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`p, 
   1, {($CellContext`c1^2 + 
     2 $CellContext`c1 $CellContext`c2 + $CellContext`c2^2)^
    Rational[1, 
      2], $CellContext`c1 $CellContext`c2 (($CellContext`c1 + \
$CellContext`c2)^2)^Rational[-1, 2]}, 0, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.832368144795249*^9, 3.8323681982542486`*^9}, {
  3.8323682911377087`*^9, 3.83236830448988*^9}},
 CellLabel->"Out[92]=",ExpressionUUID->"31fa1946-c4f3-4167-8f3c-f1e69115f0f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListConvolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8323687929383335`*^9, 3.832368891928195*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"a9b66c4c-525d-4311-913d-ae1c47021f08"],

Cell[BoxData[
 RowBox[{"{", "28", "}"}]], "Output",
 CellChangeTimes->{{3.832368802397913*^9, 3.8323688922991395`*^9}},
 CellLabel->
  "Out[100]=",ExpressionUUID->"fd195131-a626-4eb9-b707-4dbadf3b7043"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"f", ",", "a", ",", "b", ",", "c"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a", "+", "b"}], ")"}], "-", 
    RowBox[{
     FractionBox[
      RowBox[{"a", "*", "b"}], 
      RowBox[{"a", "+", "b"}]], 
     RowBox[{"(", 
      RowBox[{"1", "-", "c"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Exp", "[", 
   RowBox[{
    RowBox[{"-", "2"}], "*", 
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "]"}], "//", "N"}]}], "Input",
 CellChangeTimes->{{3.8323698992466793`*^9, 3.8323699216800537`*^9}, {
  3.8323699938240256`*^9, 3.832369994469409*^9}, {3.83237002966936*^9, 
  3.832370149453652*^9}, {3.8323701858873277`*^9, 3.8323701909915023`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"9200863c-b0a4-4416-be80-7c15787b5b45"],

Cell[BoxData["0.049787068367863944`"], "Output",
 CellChangeTimes->{{3.832369905829582*^9, 3.8323699220017185`*^9}, {
  3.832370125218769*^9, 3.83237014988139*^9}, {3.832370186647089*^9, 
  3.8323701915914464`*^9}},
 CellLabel->
  "Out[129]=",ExpressionUUID->"59af30ae-b734-4a92-add8-2d9e9488c247"]
}, Open  ]]
},
WindowSize->{1106, 732},
WindowMargins->{{Automatic, 39}, {23, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 21210, 470, 1775, "Input",ExpressionUUID->"3654899b-b6e3-4c2c-bb6a-698ebe06bbb6"],
Cell[21793, 494, 6527, 118, 535, "Output",ExpressionUUID->"2ab0232e-5d5c-4156-be47-4cdd571c604f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28357, 617, 3415, 70, 67, "Input",ExpressionUUID->"79d387a5-d30d-4f58-914c-15c9cf084dd8"],
Cell[31775, 689, 2255, 64, 83, "Output",ExpressionUUID->"8f65adcd-8965-472e-91c1-8d5a0a37cca3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34067, 758, 997, 25, 51, "Input",ExpressionUUID->"99f6854a-5bec-4626-9015-6df89c0ae9f7"],
Cell[35067, 785, 375, 6, 32, "Output",ExpressionUUID->"86f9b094-6b33-4a5a-b826-19db80d56680"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35479, 796, 1465, 41, 48, "Input",ExpressionUUID->"a275c3ed-0ba4-439b-b297-412ac06f6482"],
Cell[36947, 839, 1995, 61, 83, "Output",ExpressionUUID->"eb61c5e6-2097-428f-927c-6c97f2349ac1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38979, 905, 978, 25, 51, "Input",ExpressionUUID->"50cc3d66-1eb9-4296-ab5d-005529fdd3e0"],
Cell[39960, 932, 248, 4, 32, "Output",ExpressionUUID->"fdcc360b-7e75-46c4-970a-9ff8aa181121"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40245, 941, 380, 9, 28, "Input",ExpressionUUID->"0f3cb560-b51b-45c6-8c24-33d274debe80"],
Cell[40628, 952, 456, 12, 52, "Output",ExpressionUUID->"30e1672a-7413-431d-bc17-ed23cced53bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41121, 969, 1694, 54, 179, "Input",ExpressionUUID->"471ede59-cba6-48df-9760-0a45afa9f7ab"],
Cell[42818, 1025, 340, 5, 32, "Output",ExpressionUUID->"c98ec3f8-b586-43a3-b052-d0c2d24c4ac0"],
Cell[43161, 1032, 341, 5, 32, "Output",ExpressionUUID->"0df07b9d-4e1e-40d6-8fc1-0d2e31be43ea"],
Cell[43505, 1039, 340, 5, 32, "Output",ExpressionUUID->"bb843372-897d-46ee-a5d4-1e1edd456a80"],
Cell[43848, 1046, 342, 5, 32, "Output",ExpressionUUID->"033270f0-78b4-4509-9823-bded6a701c70"],
Cell[44193, 1053, 342, 5, 32, "Output",ExpressionUUID->"b98e63f9-18f6-4f0b-9926-ff119c5f1c48"],
Cell[44538, 1060, 341, 5, 32, "Output",ExpressionUUID->"2fbca1b6-e25a-4230-b570-d230d7800a89"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44916, 1070, 8189, 184, 409, "Input",ExpressionUUID->"e38e5ed1-9d56-4290-93df-6475abb3f487"],
Cell[53108, 1256, 2946, 54, 327, "Output",ExpressionUUID->"7c671481-6850-486d-9e76-c0e87e205980"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56091, 1315, 18770, 317, 713, "Input",ExpressionUUID->"c6c77f79-b86b-4e1d-9c77-6e8307b26d16"],
Cell[74864, 1634, 4387, 88, 545, "Output",ExpressionUUID->"4754ebf5-8f33-4b13-a5e5-79f34c8bde85"]
}, Open  ]],
Cell[79266, 1725, 260, 6, 28, "Input",ExpressionUUID->"ec62de52-f851-47f8-98b0-9f9e04c41deb"],
Cell[CellGroupData[{
Cell[79551, 1735, 5411, 125, 447, "Input",ExpressionUUID->"a614384e-e5f9-47e1-ac90-660ee7a357ed"],
Cell[84965, 1862, 4264, 86, 545, "Output",ExpressionUUID->"760f6e1a-f3ab-4f5e-8dfa-f585f63794a9"]
}, Open  ]],
Cell[89244, 1951, 154, 3, 28, "Input",ExpressionUUID->"86fc3037-ae37-4681-afeb-07b77c8d5daf"],
Cell[89401, 1956, 1485, 41, 124, "Input",ExpressionUUID->"57f023d8-2e5a-4619-94a9-24293c40520f"],
Cell[90889, 1999, 1888, 41, 181, "Input",ExpressionUUID->"54a27c41-2d4d-43ac-9422-839a0a93f7f2"],
Cell[92780, 2042, 8767, 216, 846, "Input",ExpressionUUID->"08e5773f-dec2-435e-b983-a5c820cca639"],
Cell[101550, 2260, 245, 6, 28, "Input",ExpressionUUID->"09b3adb0-5c4e-402b-bfe4-e37a4b25bd9b"],
Cell[101798, 2268, 1430, 33, 143, "Input",ExpressionUUID->"2e590f55-edc3-4c3e-bb45-70eace6bbcf1"],
Cell[103231, 2303, 1267, 38, 48, "Input",ExpressionUUID->"90a575bf-e065-4afd-be1f-7249d554a583"],
Cell[104501, 2343, 900, 26, 28, "Input",ExpressionUUID->"1ff8d944-a06a-4050-be76-876a7cb85052"],
Cell[CellGroupData[{
Cell[105426, 2373, 2326, 60, 86, "Input",ExpressionUUID->"535c93fc-8042-4471-9009-4e67796ee0e5"],
Cell[107755, 2435, 511, 14, 52, "Output",ExpressionUUID->"f59a772d-df56-4905-8a89-27d832f06092"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108303, 2454, 1015, 20, 28, "Input",ExpressionUUID->"b3c9242e-cda3-4def-84ae-00f7bf4ac020"],
Cell[109321, 2476, 1072, 24, 63, "Output",ExpressionUUID->"6228bec0-6e68-453b-910f-18d6e96c01b5"]
}, Open  ]],
Cell[110408, 2503, 524, 15, 48, "Input",ExpressionUUID->"bee30247-5a72-415e-9955-bc93df215e6f"],
Cell[CellGroupData[{
Cell[110957, 2522, 1003, 30, 67, "Input",ExpressionUUID->"5bc48dad-8eb2-4515-981f-a8f17820fb4e"],
Cell[111963, 2554, 599, 19, 52, "Output",ExpressionUUID->"ec35798b-c133-4af7-89bf-1593a7f87c7c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112599, 2578, 1052, 24, 90, "Input",ExpressionUUID->"bb390b72-e941-4ce3-a86c-07771c24dfaa"],
Cell[113654, 2604, 507, 10, 32, "Output",ExpressionUUID->"40b7b4e6-11c8-4143-bde6-c9a17a27f49f"],
Cell[114164, 2616, 356, 5, 32, "Output",ExpressionUUID->"19baf609-a8ff-4f13-bb61-2095dc690ec2"],
Cell[114523, 2623, 391, 6, 32, "Output",ExpressionUUID->"83a05023-3162-4d4a-ba2b-03ee6f6c9415"],
Cell[114917, 2631, 390, 6, 32, "Output",ExpressionUUID->"a22ee5c0-fb40-4d32-88dd-011d5df5f972"]
}, Open  ]],
Cell[115322, 2640, 976, 22, 28, "Input",ExpressionUUID->"f5bb2cf3-80bc-4fcf-a86e-3dd63a7a5bf5"],
Cell[116301, 2664, 1489, 39, 48, "Input",ExpressionUUID->"4ea862ab-1dfb-4332-b279-12f3914dc99e"],
Cell[117793, 2705, 2916, 76, 170, "Input",ExpressionUUID->"e73e8747-dbb3-409d-a885-0338db2d019b"],
Cell[120712, 2783, 158, 3, 29, "Input",ExpressionUUID->"f2e75d74-b037-4c91-8094-d7ef07c0c975"],
Cell[120873, 2788, 154, 3, 29, "Input",ExpressionUUID->"2bb9416f-7dd8-4dea-a5e4-4c5fbc0e48fd"],
Cell[CellGroupData[{
Cell[121052, 2795, 551, 15, 29, "Input",ExpressionUUID->"0e905932-1fb5-4532-b674-f0394df8c664"],
Cell[121606, 2812, 306, 5, 407, "Output",ExpressionUUID->"845e2472-3b1a-4795-8fc5-56938b4a3449"]
}, Open  ]],
Cell[121927, 2820, 156, 3, 29, "Input",ExpressionUUID->"64684fdc-111b-4e76-940e-b25931ff0c01"],
Cell[CellGroupData[{
Cell[122108, 2827, 2332, 59, 131, "Input",ExpressionUUID->"3c0dbc72-2ee0-49ab-b401-b589018e1d9d"],
Cell[124443, 2888, 335, 9, 46, "Output",ExpressionUUID->"b1d6e7fa-0186-49b7-9fe3-0cfc17f50e41"],
Cell[124781, 2899, 364, 9, 41, "Output",ExpressionUUID->"fbd146be-af43-4e6a-93ab-bf8824117abb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125182, 2913, 249, 5, 29, "Input",ExpressionUUID->"3ea774f5-4124-4a5a-af60-9716deca59cb"],
Cell[125434, 2920, 358, 9, 32, "Output",ExpressionUUID->"d8dd0efd-413d-4a32-9ea4-ee773b55c0ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125829, 2934, 2958, 71, 230, "Input",ExpressionUUID->"0f16a1fc-82d9-4fc6-9c10-5e6831c037d4"],
Cell[128790, 3007, 921, 17, 60, "Message",ExpressionUUID->"9fc17a5e-b3b0-4128-8f35-677c99070a2b"],
Cell[129714, 3026, 341, 5, 32, "Output",ExpressionUUID->"0511fda7-9fa6-4675-b009-6eddce013929"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130092, 3036, 4326, 104, 270, "Input",ExpressionUUID->"10c6a8e6-3bfe-4451-bf3b-3e73c1979c70"],
Cell[134421, 3142, 884, 17, 41, "Message",ExpressionUUID->"d746481d-0ead-484d-ab2b-cf07da91f073"],
Cell[135308, 3161, 222, 4, 32, "Output",ExpressionUUID->"bc58bb6e-69d3-4bf9-967f-ca85b135154a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135567, 3170, 921, 19, 50, "Input",ExpressionUUID->"bca18d90-9f6c-4993-b5ba-3f490f103c58"],
Cell[136491, 3191, 565, 7, 32, "Output",ExpressionUUID->"df501c61-4982-4714-bceb-dac1241f4f22"],
Cell[137059, 3200, 574, 8, 32, "Output",ExpressionUUID->"bfa16c1b-6aaf-4a57-ba58-154e18f072f5"]
}, Open  ]],
Cell[137648, 3211, 926, 24, 110, "Input",ExpressionUUID->"e3cefa4f-6d11-426f-af6c-860f26046571"],
Cell[CellGroupData[{
Cell[138599, 3239, 715, 18, 70, "Input",ExpressionUUID->"e2b27256-2dd9-4989-85d9-2bcfe06c2d72"],
Cell[139317, 3259, 1075, 31, 60, "Output",ExpressionUUID->"31fa1946-c4f3-4167-8f3c-f1e69115f0f5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140429, 3295, 357, 9, 29, "Input",ExpressionUUID->"a9b66c4c-525d-4311-913d-ae1c47021f08"],
Cell[140789, 3306, 202, 4, 32, "Output",ExpressionUUID->"fd195131-a626-4eb9-b707-4dbadf3b7043"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141028, 3315, 982, 28, 84, "Input",ExpressionUUID->"9200863c-b0a4-4416-be80-7c15787b5b45"],
Cell[142013, 3345, 298, 5, 32, "Output",ExpressionUUID->"59af30ae-b734-4a92-add8-2d9e9488c247"]
}, Open  ]]
}
]
*)

