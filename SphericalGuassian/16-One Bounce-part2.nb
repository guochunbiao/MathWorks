(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    109007,       2421]
NotebookOptionsPosition[    107495,       2389]
NotebookOutlinePosition[    107839,       2404]
CellTagsIndexPosition[    107796,       2401]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Represent Cone\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "rightWallHeight", ",", "representPt", ",", "representCone", ",", 
    "\[IndentingNewLine]", "\t", "groundViewDir", ",", "groundLightDir", ",", 
    "wallViewDir", ",", "wallLightDir"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"rightWallHeight", "=", "2"}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"representPt", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"rightWallHeight", "/", "2"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"representCone", "=", 
     RowBox[{"gCreateCone", "[", 
      RowBox[{"representPt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "10"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"groundViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"eyePoint", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"groundLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}], "-", 
       RowBox[{"{", 
        RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", 
       RowBox[{"{", 
        RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"light", " ", "circle"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"eye", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#eyePoint"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Magenta"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "eyePoint"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"represent", " ", "point"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "representPt"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "1.5"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<cones\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "representPt"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<cone\>\"", "\[Rule]", "representCone"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "4"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eyePoint", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "3"}], "}"}], ",", "1", ",", "3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "5"}], "}"}], ",", "3", ",", "20"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "2"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "6"}], "}"}], ",", "1", ",", "6"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "2"}], "}"}], ",", "0", ",", "5"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.15"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "rightWallHeight", ",", "groundViewDir", ",", "groundLightDir", ",", 
    "wallViewDir", ",", "wallLightDir"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8335206289407897`*^9, 3.8335206311084456`*^9}, {
  3.8335206685791492`*^9, 3.8335206896880693`*^9}},
 CellLabel->
  "In[243]:=",ExpressionUUID->"b323f061-94e5-4f99-8263-d5c5a3fe1289"],

Cell[BoxData[
 StyleBox["\<\" Represent Cone\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.833601424290815*^9, 3.8339253498023467`*^9},
 CellLabel->
  "During evaluation of \
In[243]:=",ExpressionUUID->"d3777708-50b4-4091-add6-b062f8b18b58"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eyePoint$$ = {-3, 
    3}, $CellContext`leftWallHeight$$ = 2, $CellContext`lightCenter$$ = {-3, 
    4}, $CellContext`lightFadeEnd$$ = 5, $CellContext`lightFadeStart$$ = 
    3, $CellContext`lightIntensity$$ = 2, $CellContext`lightRadius$$ = 
    6, $CellContext`roughness$$ = 
    0.15, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 1}, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-3, 4}}, {-4, -4}, {4, 5}}, {{
       Hold[$CellContext`eyePoint$$], {-3, 3}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightFadeStart$$], 3}, 1, 3}, {{
       Hold[$CellContext`lightFadeEnd$$], 5}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 2}, 1, 10}, {{
       Hold[$CellContext`lightRadius$$], 6}, 1, 6}, {{
       Hold[$CellContext`leftWallHeight$$], 2}, 0, 5}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`roughness$$], 0.15}, 0.05, 1}, {{
       Hold[$CellContext`shadingPosX$$], -1}, -2, 2}}, Typeset`size$$ = {
    146., {101., 107.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$2665976$$ = {0, 
    0}, $CellContext`eyePoint$2665977$$ = {0, 
    0}, $CellContext`lightFadeStart$2665978$$ = 
    0, $CellContext`lightFadeEnd$2665979$$ = 
    0, $CellContext`lightIntensity$2665980$$ = 
    0, $CellContext`lightRadius$2665981$$ = 
    0, $CellContext`viewDir$2665982$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`eyePoint$$ = {-3, 
         3}, $CellContext`leftWallHeight$$ = 
        2, $CellContext`lightCenter$$ = {-3, 4}, $CellContext`lightFadeEnd$$ = 
        5, $CellContext`lightFadeStart$$ = 3, $CellContext`lightIntensity$$ = 
        2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
        0.15, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 
         1}}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$2665976$$, {
         0, 0}], 
        Hold[$CellContext`eyePoint$$, $CellContext`eyePoint$2665977$$, {0, 
         0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$2665978$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$2665979$$,
          0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$2665980$$, 0], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$2665981$$, 
         0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$2665982$$, {0, 0}]},
       "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`rightWallHeight = 
        2; $CellContext`representPt = {
         2, $CellContext`rightWallHeight/2}; $CellContext`representCone = 
        gUtils`gCreateCone[$CellContext`representPt, {-2, \
$CellContext`leftWallHeight$$}, {2, 10}]; $CellContext`groundViewDir = 
        Normalize[$CellContext`eyePoint$$ - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`groundLightDir = 
        Normalize[$CellContext`lightCenter$$ - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`wallViewDir = 
        Normalize[{$CellContext`shadingPosX$$, 0} - {
          2, $CellContext`rightWallHeight}]; $CellContext`wallLightDir = 
        Normalize[$CellContext`lightCenter$$ - {
          2, $CellContext`rightWallHeight}]; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> 0.1, "color" -> Gray,
              "thickness" -> 0.02], 
            Association[
            "center" -> Slot["lightCenter"], "radius" -> Slot["lightRadius"]], 
            Association[
            "center" -> Slot["eyePoint"], "radius" -> 0.1, "color" -> Magenta,
              "thickness" -> 0.02], 
            Association["center" -> {
               Slot["shadingPosX"], 0}, "radius" -> 0.1, "color" -> Red, 
             "thickness" -> 0.02]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightRadius" -> $CellContext`lightRadius$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "eyePoint" -> $CellContext`eyePoint$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Green, 
             "thickness" -> 0.015], 
            Association[
            "startPos" -> $CellContext`representPt, "dirVec" -> {-1, 0}, 
             "length" -> 1.5, "color" -> Gray, "thickness" -> 0.015]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("cones" -> {
            Association[
            "origin" -> $CellContext`representPt, "radius" -> 5, 
             "cone" -> $CellContext`representCone, "color" -> Gray]}& )[], 
          "axisExtent" -> 5]]), 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-3, 4}}, {-4, -4}, {
         4, 5}}, {{$CellContext`eyePoint$$, {-3, 3}}, {-4, -4}, {4, 
         4}}, {{$CellContext`lightFadeStart$$, 3}, 1, 
         3}, {{$CellContext`lightFadeEnd$$, 5}, 3, 
         20}, {{$CellContext`lightIntensity$$, 2}, 1, 
         10}, {{$CellContext`lightRadius$$, 6}, 1, 
         6}, {{$CellContext`leftWallHeight$$, 2}, 0, 
         5}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`roughness$$, 0.15}, 0.05, 
         1}, {{$CellContext`shadingPosX$$, -1}, -2, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{197., {125., 131.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8336014243337793`*^9, 3.833925349852242*^9},
 CellLabel->
  "Out[252]=",ExpressionUUID->"cc7163e9-ed77-4cd6-817a-c7fde4c9f33c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", "\"\<Wall Lighting (Represent Cone vs Dynamic Cone)\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "rightWallHeight", ",", "representPt", ",", "representCone", ",", 
    "\[IndentingNewLine]", "\t", "groundViewDir", ",", "groundLightDir", ",", 
    "wallViewDir", ",", "wallLightDir"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"rightWallHeight", "=", "2"}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"representPt", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"rightWallHeight", "/", "2"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"representCone", "=", 
     RowBox[{"gCreateCone", "[", 
      RowBox[{"representPt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "10"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"groundViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"eyePoint", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"groundLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}], "-", 
       RowBox[{"{", 
        RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", 
       RowBox[{"{", 
        RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"light", " ", "circle"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"eye", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#eyePoint"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Magenta"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "eyePoint"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"represent", " ", "point"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "representPt"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "1.5"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<cones\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", "representPt"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<cone\>\"", "\[Rule]", "representCone"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lobes\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensity"}],
              ",", 
             RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<normalDir\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], ")"}], "&"}], ")"}]}], ",", 
             RowBox[{"\"\<viewDir\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", "groundViewDir", ")"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightDir\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                   RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ")"}], 
                "&"}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lobeFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#shadingPos", "+", 
                  RowBox[{"0.1", "*", "lightIntensity", "*", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                   RowBox[{"gDGGX", "[", 
                    RowBox[{"#roughness", ",", "#noh"}], "]"}]}]}], ")"}], 
                "&"}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
             RowBox[{
             "\"\<label\>\"", "\[Rule]", 
              "\"\<GGX Lobe(view from eye)\>\""}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          RowBox[{"\"\<lightIntensity\>\"", "\[Rule]", "lightIntensity"}], 
          ",", 
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgRightWallShading\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", " ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",",
               "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallXRange\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallHeights\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#leftWallHeight", ",", "#rightWallHeight"}], "}"}]}],
               ",", "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
              ",", 
              RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<eyePoint\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgSphereLight", "[", 
                  RowBox[{
                  "#lightCenter", ",", "#lightFadeStart", ",", 
                   "#lightFadeEnd", ",", "\[IndentingNewLine]", "\t\t", 
                   "#lightIntensity", ",", "#shadingPos"}], "]"}], "&"}], 
                ")"}]}], ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDF", "[", 
                  RowBox[{
                  "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                   "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDFConvLight", "[", 
                  RowBox[{
                  "#lightRadius", ",", "#shadingDist", ",", "#sgLight", ",", 
                   "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgPercentStrategy\>\"", "\[Rule]", "3"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", 
               "\"\<Wall Lighting(Dynamic Cone,view from ground)\>\""}]}], 
             "|>"}], ",", "\[IndentingNewLine]", " ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",",
               "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<representCone\>\"", "\[Rule]", "representCone"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallXRange\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallHeights\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#leftWallHeight", ",", "#rightWallHeight"}], "}"}]}],
               ",", "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
              ",", 
              RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<eyePoint\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgSphereLight", "[", 
                  RowBox[{
                  "#lightCenter", ",", "#lightFadeStart", ",", 
                   "#lightFadeEnd", ",", "\[IndentingNewLine]", "\t\t", 
                   "#lightIntensity", ",", "#shadingPos"}], "]"}], "&"}], 
                ")"}]}], ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDF", "[", 
                  RowBox[{
                  "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                   "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDFConvLight", "[", 
                  RowBox[{
                  "#lightRadius", ",", "#shadingDist", ",", "#sgLight", ",", 
                   "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgPercentStrategy\>\"", "\[Rule]", "3"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", 
               "\"\<Wall Lighting(Represent Cone,view from ground)\>\""}]}], 
             "|>"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}],
           ",", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
          ",", "\t\t", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "4"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eyePoint", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "3"}], "}"}], ",", "1", ",", "3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "5"}], "}"}], ",", "3", ",", "20"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "2"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "6"}], "}"}], ",", "1", ",", "6"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "2"}], "}"}], ",", "0", ",", "5"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.15"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "rightWallHeight", ",", "representPt", ",", "representCone", ",", 
    "\[IndentingNewLine]", "\t", "groundViewDir", ",", "groundLightDir", ",", 
    "wallViewDir", ",", "wallLightDir"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.833526932029943*^9, 3.833526932938063*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"fdf89dba-324e-4a51-bc26-b8f2519e7520"],

Cell[BoxData[
 StyleBox["\<\" Wall Lighting (Represent Cone vs Dynamic Cone)\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.8336014245295362`*^9, 3.833925350052701*^9},
 CellLabel->
  "During evaluation of \
In[254]:=",ExpressionUUID->"341fcda4-ecb3-4f71-9a61-27c38570cf4d"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eyePoint$$ = {-3, 
    3}, $CellContext`leftWallHeight$$ = 2, $CellContext`lightCenter$$ = {-3, 
    4}, $CellContext`lightFadeEnd$$ = 5, $CellContext`lightFadeStart$$ = 
    3, $CellContext`lightIntensity$$ = 2, $CellContext`lightRadius$$ = 
    6, $CellContext`roughness$$ = 
    0.15, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 1}, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-3, 4}}, {-4, -4}, {4, 5}}, {{
       Hold[$CellContext`eyePoint$$], {-3, 3}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightFadeStart$$], 3}, 1, 3}, {{
       Hold[$CellContext`lightFadeEnd$$], 5}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 2}, 1, 10}, {{
       Hold[$CellContext`lightRadius$$], 6}, 1, 6}, {{
       Hold[$CellContext`leftWallHeight$$], 2}, 0, 5}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`roughness$$], 0.15}, 0.05, 1}, {{
       Hold[$CellContext`shadingPosX$$], -1}, -2, 2}}, Typeset`size$$ = {
    433., {129., 135.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$2666148$$ = {0, 
    0}, $CellContext`eyePoint$2666149$$ = {0, 
    0}, $CellContext`lightFadeStart$2666150$$ = 
    0, $CellContext`lightFadeEnd$2666151$$ = 
    0, $CellContext`lightIntensity$2666152$$ = 
    0, $CellContext`lightRadius$2666153$$ = 
    0, $CellContext`viewDir$2666154$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`eyePoint$$ = {-3, 
         3}, $CellContext`leftWallHeight$$ = 
        2, $CellContext`lightCenter$$ = {-3, 4}, $CellContext`lightFadeEnd$$ = 
        5, $CellContext`lightFadeStart$$ = 3, $CellContext`lightIntensity$$ = 
        2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
        0.15, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 
         1}}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$2666148$$, {
         0, 0}], 
        Hold[$CellContext`eyePoint$$, $CellContext`eyePoint$2666149$$, {0, 
         0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$2666150$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$2666151$$,
          0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$2666152$$, 0], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$2666153$$, 
         0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$2666154$$, {0, 0}]},
       "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`rightWallHeight = 
        2; $CellContext`representPt = {
         2, $CellContext`rightWallHeight/2}; $CellContext`representCone = 
        gUtils`gCreateCone[$CellContext`representPt, {-2, \
$CellContext`leftWallHeight$$}, {2, 10}]; $CellContext`groundViewDir = 
        Normalize[$CellContext`eyePoint$$ - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`groundLightDir = 
        Normalize[$CellContext`lightCenter$$ - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`wallViewDir = 
        Normalize[{$CellContext`shadingPosX$$, 0} - {
          2, $CellContext`rightWallHeight}]; $CellContext`wallLightDir = 
        Normalize[$CellContext`lightCenter$$ - {
          2, $CellContext`rightWallHeight}]; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> 0.1, "color" -> Gray,
              "thickness" -> 0.02], 
            Association[
            "center" -> Slot["lightCenter"], "radius" -> Slot["lightRadius"]], 
            Association[
            "center" -> Slot["eyePoint"], "radius" -> 0.1, "color" -> Magenta,
              "thickness" -> 0.02], 
            Association["center" -> {
               Slot["shadingPosX"], 0}, "radius" -> 0.1, "color" -> Red, 
             "thickness" -> 0.02]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightRadius" -> $CellContext`lightRadius$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "eyePoint" -> $CellContext`eyePoint$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Green, 
             "thickness" -> 0.015], 
            Association[
            "startPos" -> $CellContext`representPt, "dirVec" -> {-1, 0}, 
             "length" -> 1.5, "color" -> Gray, "thickness" -> 0.015]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("cones" -> {
            Association[
            "origin" -> $CellContext`representPt, "radius" -> 5, 
             "cone" -> $CellContext`representCone, "color" -> Gray]}& )[], 
          ("lobes" -> {
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "lightCenter" -> Slot["lightCenter"], 
             "lightIntensity" -> Slot["lightIntensity"], "roughness" -> 
             Slot["roughness"], "normalDir" -> ({0, 1}& ), 
             "viewDir" -> ($CellContext`groundViewDir& ), "lightDir" -> ({
               Cos[
                Slot["\[Theta]"]], 
               Sin[
                Slot["\[Theta]"]]}& ), 
             "lobeFunc" -> (Slot["shadingPos"] + 
              0.1 $CellContext`lightIntensity$$ {
                 Cos[
                  Slot["\[Theta]"]], 
                 Sin[
                  Slot["\[Theta]"]]} gBRDF`gDGGX[
                 Slot["roughness"], 
                 Slot["noh"]]& ), "color" -> Red, "label" -> 
             "GGX Lobe(view from eye)"]}& )[
           Association[
           "shadingPosX" -> $CellContext`shadingPosX$$, 
            "lightIntensity" -> $CellContext`lightIntensity$$, 
            "lightCenter" -> $CellContext`lightCenter$$, 
            "roughness" -> $CellContext`roughness$$]], 
          ("sgRightWallShading" -> {
            Association[
            "lightCenter" -> Slot["lightCenter"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "wallXRange" -> {-2, 2}, "wallHeights" -> {
               Slot["leftWallHeight"], 
               Slot["rightWallHeight"]}, "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
             "eyePoint" -> {
               Slot["shadingPosX"], 0}, 
             "sgLightFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
               Slot["roughness"], 
               Slot["lightDir"], 
               Slot["viewDir"], 
               Slot["normalDir"]]& ), 
             "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
               Slot["lightRadius"], 
               Slot["shadingDist"], 
               Slot["sgLight"], 
               Slot["sgNDF"]]& ), "sgPercentStrategy" -> 3, "color" -> Blue, 
             "thickness" -> 0.02, "label" -> 
             "Wall Lighting(Dynamic Cone,view from ground)"], 
            Association[
            "lightCenter" -> Slot["lightCenter"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "representCone" -> $CellContext`representCone, 
             "wallXRange" -> {-2, 2}, "wallHeights" -> {
               Slot["leftWallHeight"], 
               Slot["rightWallHeight"]}, "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
             "eyePoint" -> {
               Slot["shadingPosX"], 0}, 
             "sgLightFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
               Slot["roughness"], 
               Slot["lightDir"], 
               Slot["viewDir"], 
               Slot["normalDir"]]& ), 
             "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
               Slot["lightRadius"], 
               Slot["shadingDist"], 
               Slot["sgLight"], 
               Slot["sgNDF"]]& ), "sgPercentStrategy" -> 3, "color" -> Red, 
             "label" -> "Wall Lighting(Represent Cone,view from ground)"]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "lightFadeEnd" -> $CellContext`lightFadeEnd$$, 
            "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight, 
            "roughness" -> $CellContext`roughness$$]], "axisExtent" -> 5]]), 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-3, 4}}, {-4, -4}, {
         4, 5}}, {{$CellContext`eyePoint$$, {-3, 3}}, {-4, -4}, {4, 
         4}}, {{$CellContext`lightFadeStart$$, 3}, 1, 
         3}, {{$CellContext`lightFadeEnd$$, 5}, 3, 
         20}, {{$CellContext`lightIntensity$$, 2}, 1, 
         10}, {{$CellContext`lightRadius$$, 6}, 1, 
         6}, {{$CellContext`leftWallHeight$$, 2}, 0, 
         5}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`roughness$$, 0.15}, 0.05, 
         1}, {{$CellContext`shadingPosX$$, -1}, -2, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{484., {153., 159.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8336014245778837`*^9, 3.8339253500837526`*^9},
 CellLabel->
  "Out[256]=",ExpressionUUID->"0bb28584-9a89-42ed-b92a-32cfa3c26852"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Reflect SG Axis\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "rightWallHeight", ",", "representPt", ",", "representCone", ",", 
    "\[IndentingNewLine]", "\t", "groundViewDir", ",", "groundLightDir", ",", 
    "wallViewDir", ",", "wallLightDir", ",", "reflectSgAxisPt"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"rightWallHeight", "=", "2"}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"representPt", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"rightWallHeight", "/", "2"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"representCone", "=", 
     RowBox[{"gCreateCone", "[", 
      RowBox[{"representPt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "10"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"groundViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"eyePoint", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"groundLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}], "-", 
       RowBox[{"{", 
        RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", 
       RowBox[{"{", 
        RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"reflectSgAxisPt", ":=", 
     RowBox[{"Block", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "viewDist", ",", "lightDist", ",", "viewProjPt", ",", "lightProjPt", 
         ",", "lerpFactor", ",", "axisPt"}], "}"}], ",", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"viewDist", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"shadingPosX", ",", "0"}], "}"}], "-", "representPt"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"lightDist", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"lightCenter", "-", "representPt"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
        RowBox[{"viewProjPt", "=", 
         RowBox[{"{", 
          RowBox[{"2", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"lightProjPt", "=", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"lightCenter", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"axisPt", "=", 
         RowBox[{"gLerp", "[", 
          RowBox[{"viewProjPt", ",", "lightProjPt", ",", 
           RowBox[{"viewDist", "/", 
            RowBox[{"(", 
             RowBox[{"viewDist", "+", "lightDist"}], ")"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", "axisPt"}]}], "\[IndentingNewLine]", 
      "    ", "]"}]}], ";", "\[IndentingNewLine]", "\t", 
    "\[IndentingNewLine]", "  ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"light", " ", "circle"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"eye", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#eyePoint"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Magenta"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "eyePoint"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"reflect", " ", "sg", " ", "axis", " ", "line"}], "*)"}],
             "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "reflectSgAxisPt"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.03"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgRightWallShading\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}],
              ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<representCone\>\"", "\[Rule]", "representCone"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<wallXRange\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<wallHeights\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#leftWallHeight", ",", "#rightWallHeight"}], "}"}]}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
             ",", 
             RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<eyePoint\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgSphereLight", "[", 
                 RowBox[{
                 "#lightCenter", ",", "#lightFadeStart", ",", "#lightFadeEnd",
                   ",", "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",",
                   "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDF", "[", 
                 RowBox[{
                 "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                  "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDFConvLight", "[", 
                 RowBox[{
                 "#lightRadius", ",", "#shadingDist", ",", "#sgLight", ",", 
                  "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgPercentStrategy\>\"", "\[Rule]", "3"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<Wall Lighting\>\""}]}], 
            "|>"}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}],
           ",", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
          ",", "\t\t", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "4"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "6"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eyePoint", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "3"}], "}"}], ",", "1", ",", "3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "5"}], "}"}], ",", "3", ",", "20"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "2"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "6"}], "}"}], ",", "1", ",", "6"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "2"}], "}"}], ",", "0", ",", "5"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.15"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "rightWallHeight", ",", "representPt", ",", "representCone", ",", 
    "\[IndentingNewLine]", "\t", "groundViewDir", ",", "groundLightDir", ",", 
    "wallViewDir", ",", "wallLightDir", ",", "reflectSgAxis"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8335988137420197`*^9, 3.833598861830124*^9}, 
   3.833925333748315*^9},
 CellLabel->
  "In[258]:=",ExpressionUUID->"8a4e0b7f-ba28-4f4a-9e9f-b94fc5be95cd"],

Cell[BoxData[
 StyleBox["\<\" Reflect SG Axis\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.833601424977603*^9, 3.8339253504910946`*^9},
 CellLabel->
  "During evaluation of \
In[258]:=",ExpressionUUID->"78c9d29f-d09a-499d-9c94-07cfcd481570"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eyePoint$$ = {-3, 
    3}, $CellContext`leftWallHeight$$ = 2, $CellContext`lightCenter$$ = {-3, 
    4}, $CellContext`lightFadeEnd$$ = 5, $CellContext`lightFadeStart$$ = 
    3, $CellContext`lightIntensity$$ = 2, $CellContext`lightRadius$$ = 
    6, $CellContext`roughness$$ = 
    0.15, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 1}, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-3, 4}}, {-6, 0}, {4, 5}}, {{
       Hold[$CellContext`eyePoint$$], {-3, 3}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightFadeStart$$], 3}, 1, 3}, {{
       Hold[$CellContext`lightFadeEnd$$], 5}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 2}, 1, 10}, {{
       Hold[$CellContext`lightRadius$$], 6}, 1, 6}, {{
       Hold[$CellContext`leftWallHeight$$], 2}, 0, 5}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`roughness$$], 0.15}, 0.05, 1}, {{
       Hold[$CellContext`shadingPosX$$], -1}, -2, 2}}, Typeset`size$$ = {
    200., {98., 104.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$2672333$$ = {0, 
    0}, $CellContext`eyePoint$2672334$$ = {0, 
    0}, $CellContext`lightFadeStart$2672335$$ = 
    0, $CellContext`lightFadeEnd$2672336$$ = 
    0, $CellContext`lightIntensity$2672337$$ = 
    0, $CellContext`lightRadius$2672338$$ = 
    0, $CellContext`viewDir$2672339$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`eyePoint$$ = {-3, 
         3}, $CellContext`leftWallHeight$$ = 
        2, $CellContext`lightCenter$$ = {-3, 4}, $CellContext`lightFadeEnd$$ = 
        5, $CellContext`lightFadeStart$$ = 3, $CellContext`lightIntensity$$ = 
        2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
        0.15, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 
         1}}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$2672333$$, {
         0, 0}], 
        Hold[$CellContext`eyePoint$$, $CellContext`eyePoint$2672334$$, {0, 
         0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$2672335$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$2672336$$,
          0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$2672337$$, 0], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$2672338$$, 
         0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$2672339$$, {0, 0}]},
       "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`rightWallHeight = 
        2; $CellContext`representPt = {
         2, $CellContext`rightWallHeight/2}; $CellContext`representCone = 
        gUtils`gCreateCone[$CellContext`representPt, {-2, \
$CellContext`leftWallHeight$$}, {2, 10}]; $CellContext`groundViewDir = 
        Normalize[$CellContext`eyePoint$$ - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`groundLightDir = 
        Normalize[$CellContext`lightCenter$$ - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`wallViewDir = 
        Normalize[{$CellContext`shadingPosX$$, 0} - {
          2, $CellContext`rightWallHeight}]; $CellContext`wallLightDir = 
        Normalize[$CellContext`lightCenter$$ - {
          2, $CellContext`rightWallHeight}]; $CellContext`reflectSgAxisPt := 
        Block[{$CellContext`viewDist, $CellContext`lightDist, \
$CellContext`viewProjPt, $CellContext`lightProjPt, $CellContext`lerpFactor, \
$CellContext`axisPt}, $CellContext`viewDist = 
           Dot[{$CellContext`shadingPosX$$, 
               0} - $CellContext`representPt, {-1, 
             0}]; $CellContext`lightDist = 
           Dot[$CellContext`lightCenter$$ - $CellContext`representPt, {-1, 
             0}]; $CellContext`viewProjPt = {2, 
            0}; $CellContext`lightProjPt = {2, 
             Part[$CellContext`lightCenter$$, 2]}; $CellContext`axisPt = 
           gUtils`gLerp[$CellContext`viewProjPt, $CellContext`lightProjPt, \
$CellContext`viewDist/($CellContext`viewDist + $CellContext`lightDist)]; \
$CellContext`axisPt]; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> 0.1, "color" -> Gray,
              "thickness" -> 0.02], 
            Association[
            "center" -> Slot["lightCenter"], "radius" -> Slot["lightRadius"]], 
            Association[
            "center" -> Slot["eyePoint"], "radius" -> 0.1, "color" -> Magenta,
              "thickness" -> 0.02], 
            Association["center" -> {
               Slot["shadingPosX"], 0}, "radius" -> 0.1, "color" -> Red, 
             "thickness" -> 0.02]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightRadius" -> $CellContext`lightRadius$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "eyePoint" -> $CellContext`eyePoint$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Green, 
             "thickness" -> 0.015], 
            Association[
            "startPos" -> $CellContext`reflectSgAxisPt, "dirVec" -> {-1, 0}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Red, 
             "thickness" -> 0.03]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("sgRightWallShading" -> {
            Association[
            "lightCenter" -> Slot["lightCenter"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "representCone" -> $CellContext`representCone, 
             "wallXRange" -> {-2, 2}, "wallHeights" -> {
               Slot["leftWallHeight"], 
               Slot["rightWallHeight"]}, "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
             "eyePoint" -> {
               Slot["shadingPosX"], 0}, 
             "sgLightFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
               Slot["roughness"], 
               Slot["lightDir"], 
               Slot["viewDir"], 
               Slot["normalDir"]]& ), 
             "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
               Slot["lightRadius"], 
               Slot["shadingDist"], 
               Slot["sgLight"], 
               Slot["sgNDF"]]& ), "sgPercentStrategy" -> 3, "color" -> Blue, 
             "label" -> "Wall Lighting"]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "lightFadeEnd" -> $CellContext`lightFadeEnd$$, 
            "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight, 
            "roughness" -> $CellContext`roughness$$]], "axisExtent" -> 5]]), 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-3, 4}}, {-6, 0}, {
         4, 5}}, {{$CellContext`eyePoint$$, {-3, 3}}, {-4, -4}, {4, 
         4}}, {{$CellContext`lightFadeStart$$, 3}, 1, 
         3}, {{$CellContext`lightFadeEnd$$, 5}, 3, 
         20}, {{$CellContext`lightIntensity$$, 2}, 1, 
         10}, {{$CellContext`lightRadius$$, 6}, 1, 
         6}, {{$CellContext`leftWallHeight$$, 2}, 0, 
         5}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`roughness$$, 0.15}, 0.05, 
         1}, {{$CellContext`shadingPosX$$, -1}, -2, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{251., {122., 128.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.8336014250065174`*^9, 3.833925350526164*^9},
 CellLabel->
  "Out[260]=",ExpressionUUID->"5652a2d8-f5aa-4c9d-b1f7-c34200b82e11"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Fake SG vs Wall Reflectance\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightCenter", ",", "rightWallHeight", ",", "representPt", ",", 
    "representCone", ",", "\[IndentingNewLine]", "\t", "groundViewDir", ",", 
    "groundLightDir", ",", "wallViewDir", ",", "wallLightDir", ",", 
    "reflectSgAxisPt", ",", "disbFunc"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"rightWallHeight", "=", "2"}], ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"lightCenter", "=", 
     RowBox[{"{", 
      RowBox[{"lightCenterX", ",", "lightCenterY"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"representPt", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"rightWallHeight", "/", "2"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"representCone", "=", 
     RowBox[{"gCreateCone", "[", 
      RowBox[{"representPt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "10"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"groundViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"eyePoint", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"groundLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", 
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallViewDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"shadingPosX", ",", "0"}], "}"}], "-", 
       RowBox[{"{", 
        RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"wallLightDir", "=", 
     RowBox[{"Normalize", "[", 
      RowBox[{"lightCenter", "-", 
       RowBox[{"{", 
        RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"reflectSgAxisPt", "=", 
     RowBox[{"Block", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "viewDist", ",", "lightDist", ",", "viewProjPt", ",", "lightProjPt", 
         ",", "lerpFactor", ",", "axisPt"}], "}"}], ",", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"viewDist", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"shadingPosX", ",", "0"}], "}"}], "-", "representPt"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"lightDist", "=", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"lightCenter", "-", "representPt"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
        RowBox[{"viewProjPt", "=", 
         RowBox[{"{", 
          RowBox[{"2", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"lightProjPt", "=", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"lightCenter", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"axisPt", "=", 
         RowBox[{"gLerp", "[", 
          RowBox[{"viewProjPt", ",", "lightProjPt", ",", 
           RowBox[{"viewDist", "/", 
            RowBox[{"(", 
             RowBox[{"viewDist", "+", "lightDist"}], ")"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", "axisPt"}]}], "\[IndentingNewLine]", 
      "    ", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"light", " ", "circle"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"eye", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#eyePoint"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Magenta"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "eyePoint"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"reflect", " ", "sg", " ", "axis", " ", "line"}], "*)"}],
             "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", "reflectSgAxisPt"}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "rightWallHeight"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.02"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgRightWallShading\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", " ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}],
              ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<representCone\>\"", "\[Rule]", "representCone"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<wallXRange\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<wallHeights\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#leftWallHeight", ",", "#rightWallHeight"}], "}"}]}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
             ",", 
             RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<eyePoint\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgSphereLight", "[", 
                 RowBox[{
                 "#lightCenter", ",", "#lightFadeStart", ",", "#lightFadeEnd",
                   ",", "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",",
                   "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDF", "[", 
                 RowBox[{
                 "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                  "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgNDFConvLight", "[", 
                 RowBox[{
                 "#lightRadius", ",", "#shadingDist", ",", "#sgLight", ",", 
                  "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgPercentStrategy\>\"", "\[Rule]", "3"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<Wall Lighting\>\""}]}], 
            "|>"}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}],
           ",", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
          ",", "\t\t", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgDisbs\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<disbCenter\>\"", "\[Rule]", "#center"}], ",", 
             RowBox[{"\"\<sg\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "1.5", ",", 
                "2"}], "}"}]}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Gray"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{"\"\<center\>\"", "\[Rule]", "reflectSgAxisPt"}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "\t", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenterX", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "6"}], ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenterY", ",", "4"}], "}"}], ",", "0", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eyePoint", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "4"}], "}"}], ",", "1", ",", "6"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "10"}], "}"}], ",", "3", ",", "20"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "2"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "6"}], "}"}], ",", "1", ",", "6"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "0"}], "}"}], ",", "0", ",", "5"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.15"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "lightCenter", ",", "rightWallHeight", ",", "representPt", ",", 
    "representCone", ",", "\[IndentingNewLine]", "\t", "groundViewDir", ",", 
    "groundLightDir", ",", "wallViewDir", ",", "wallLightDir", ",", 
    "reflectSgAxis", ",", "disbFunc"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8336012395971775`*^9, 3.8336013350592146`*^9}, {
   3.8336013878512774`*^9, 3.8336014217024727`*^9}, {3.8336015482146277`*^9, 
   3.8336015744345417`*^9}, 3.833925343019831*^9},
 CellLabel->
  "In[262]:=",ExpressionUUID->"5dcb338b-4b9b-4ed5-9561-617a3dd9a8ba"],

Cell[BoxData[
 StyleBox["\<\" Fake SG vs Wall Reflectance\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{3.833601576366807*^9, 3.8339253508102107`*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"cc0dcab5-9f0a-4f11-8265-a6e147c86276"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eyePoint$$ = {-3, 
    3}, $CellContext`leftWallHeight$$ = 0, $CellContext`lightCenterX$$ = 
    0, $CellContext`lightCenterY$$ = 4, $CellContext`lightFadeEnd$$ = 
    10, $CellContext`lightFadeStart$$ = 4, $CellContext`lightIntensity$$ = 
    2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
    0.15, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 1}, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenterX$$], 0}, -6, 4}, {{
       Hold[$CellContext`lightCenterY$$], 4}, 0, 5}, {{
       Hold[$CellContext`eyePoint$$], {-3, 3}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightFadeStart$$], 4}, 1, 6}, {{
       Hold[$CellContext`lightFadeEnd$$], 10}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 2}, 1, 10}, {{
       Hold[$CellContext`lightRadius$$], 6}, 1, 6}, {{
       Hold[$CellContext`leftWallHeight$$], 0}, 0, 5}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`roughness$$], 0.15}, 0.05, 1}, {{
       Hold[$CellContext`shadingPosX$$], -1}, -2, 2}}, Typeset`size$$ = {
    200., {110., 116.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenterX$2675373$$ = 
    0, $CellContext`lightCenterY$2675374$$ = 
    0, $CellContext`eyePoint$2675375$$ = {0, 
    0}, $CellContext`lightFadeStart$2675376$$ = 
    0, $CellContext`lightFadeEnd$2675377$$ = 
    0, $CellContext`lightIntensity$2675378$$ = 
    0, $CellContext`lightRadius$2675379$$ = 
    0, $CellContext`viewDir$2675380$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`eyePoint$$ = {-3, 
         3}, $CellContext`leftWallHeight$$ = 0, $CellContext`lightCenterX$$ = 
        0, $CellContext`lightCenterY$$ = 4, $CellContext`lightFadeEnd$$ = 
        10, $CellContext`lightFadeStart$$ = 4, $CellContext`lightIntensity$$ = 
        2, $CellContext`lightRadius$$ = 6, $CellContext`roughness$$ = 
        0.15, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 
         1}}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenterX$$, $CellContext`lightCenterX$2675373$$,
          0], 
        Hold[$CellContext`lightCenterY$$, $CellContext`lightCenterY$2675374$$,
          0], 
        Hold[$CellContext`eyePoint$$, $CellContext`eyePoint$2675375$$, {0, 
         0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$2675376$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$2675377$$,
          0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$2675378$$, 0], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$2675379$$, 
         0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$2675380$$, {0, 0}]},
       "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`rightWallHeight = 
        2; $CellContext`lightCenter = {$CellContext`lightCenterX$$, \
$CellContext`lightCenterY$$}; $CellContext`representPt = {
         2, $CellContext`rightWallHeight/2}; $CellContext`representCone = 
        gUtils`gCreateCone[$CellContext`representPt, {-2, \
$CellContext`leftWallHeight$$}, {2, 10}]; $CellContext`groundViewDir = 
        Normalize[$CellContext`eyePoint$$ - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`groundLightDir = 
        Normalize[$CellContext`lightCenter - {$CellContext`shadingPosX$$, 
           0}]; $CellContext`wallViewDir = 
        Normalize[{$CellContext`shadingPosX$$, 0} - {
          2, $CellContext`rightWallHeight}]; $CellContext`wallLightDir = 
        Normalize[$CellContext`lightCenter - {
          2, $CellContext`rightWallHeight}]; $CellContext`reflectSgAxisPt = 
        Block[{$CellContext`viewDist, $CellContext`lightDist, \
$CellContext`viewProjPt, $CellContext`lightProjPt, $CellContext`lerpFactor, \
$CellContext`axisPt}, $CellContext`viewDist = 
           Dot[{$CellContext`shadingPosX$$, 
               0} - $CellContext`representPt, {-1, 
             0}]; $CellContext`lightDist = 
           Dot[$CellContext`lightCenter - $CellContext`representPt, {-1, 
             0}]; $CellContext`viewProjPt = {2, 
            0}; $CellContext`lightProjPt = {2, 
             Part[$CellContext`lightCenter, 2]}; $CellContext`axisPt = 
           gUtils`gLerp[$CellContext`viewProjPt, $CellContext`lightProjPt, \
$CellContext`viewDist/($CellContext`viewDist + $CellContext`lightDist)]; \
$CellContext`axisPt]; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> 0.1, "color" -> Gray,
              "thickness" -> 0.02], 
            Association[
            "center" -> Slot["lightCenter"], "radius" -> Slot["lightRadius"]], 
            Association[
            "center" -> Slot["eyePoint"], "radius" -> 0.1, "color" -> Magenta,
              "thickness" -> 0.02], 
            Association["center" -> {
               Slot["shadingPosX"], 0}, "radius" -> 0.1, "color" -> Red, 
             "thickness" -> 0.02]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter, 
            "lightRadius" -> $CellContext`lightRadius$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "eyePoint" -> $CellContext`eyePoint$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Green, 
             "thickness" -> 0.015], 
            Association[
            "startPos" -> $CellContext`reflectSgAxisPt, "dirVec" -> {-1, 0}, 
             "length" -> $CellContext`rightWallHeight, "color" -> Red, 
             "thickness" -> 0.02]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("sgRightWallShading" -> {
            Association[
            "lightCenter" -> Slot["lightCenter"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "representCone" -> $CellContext`representCone, 
             "wallXRange" -> {-2, 2}, "wallHeights" -> {
               Slot["leftWallHeight"], 
               Slot["rightWallHeight"]}, "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
             "eyePoint" -> {
               Slot["shadingPosX"], 0}, 
             "sgLightFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
               Slot["roughness"], 
               Slot["lightDir"], 
               Slot["viewDir"], 
               Slot["normalDir"]]& ), 
             "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
               Slot["lightRadius"], 
               Slot["shadingDist"], 
               Slot["sgLight"], 
               Slot["sgNDF"]]& ), "sgPercentStrategy" -> 3, "color" -> Blue, 
             "label" -> "Wall Lighting"]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "lightFadeEnd" -> $CellContext`lightFadeEnd$$, 
            "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$, 
            "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight, 
            "roughness" -> $CellContext`roughness$$]], 
          ("sgDisbs" -> {
            Association[
            "disbCenter" -> Slot["center"], "sg" -> {{-1, 0}, 1.5, 2}, 
             "color" -> Gray]}& )[
           Association["center" -> $CellContext`reflectSgAxisPt]], 
          "axisExtent" -> 5]]), 
      "Specifications" :> {{{$CellContext`lightCenterX$$, 0}, -6, 
         4}, {{$CellContext`lightCenterY$$, 4}, 0, 
         5}, {{$CellContext`eyePoint$$, {-3, 3}}, {-4, -4}, {4, 
         4}}, {{$CellContext`lightFadeStart$$, 4}, 1, 
         6}, {{$CellContext`lightFadeEnd$$, 10}, 3, 
         20}, {{$CellContext`lightIntensity$$, 2}, 1, 
         10}, {{$CellContext`lightRadius$$, 6}, 1, 
         6}, {{$CellContext`leftWallHeight$$, 0}, 0, 
         5}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`roughness$$, 0.15}, 0.05, 
         1}, {{$CellContext`shadingPosX$$, -1}, -2, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{251., {134., 140.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.833601576403577*^9, 3.833925350835417*^9},
 CellLabel->
  "Out[264]=",ExpressionUUID->"9c08871a-2316-4839-afde-45e289edbb9a"]
}, Open  ]]
},
WindowSize->{1083, 662},
WindowMargins->{{94, Automatic}, {Automatic, 151}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 11965, 294, 1169, "Input",ExpressionUUID->"b323f061-94e5-4f99-8263-d5c5a3fe1289"],
Cell[12548, 318, 311, 8, 30, "Print",ExpressionUUID->"d3777708-50b4-4091-add6-b062f8b18b58"],
Cell[12862, 328, 7057, 135, 275, "Output",ExpressionUUID->"cc7163e9-ed77-4cd6-817a-c7fde4c9f33c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19956, 468, 21325, 482, 1891, "Input",ExpressionUUID->"fdf89dba-324e-4a51-bc26-b8f2519e7520"],
Cell[41284, 952, 343, 8, 30, "Print",ExpressionUUID->"341fcda4-ecb3-4f71-9a61-27c38570cf4d"],
Cell[41630, 962, 11236, 220, 331, "Output",ExpressionUUID->"0bb28584-9a89-42ed-b92a-32cfa3c26852"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52903, 1187, 16610, 388, 1587, "Input",ExpressionUUID->"8a4e0b7f-ba28-4f4a-9e9f-b94fc5be95cd"],
Cell[69516, 1577, 312, 8, 30, "Print",ExpressionUUID->"78c9d29f-d09a-499d-9c94-07cfcd481570"],
Cell[69831, 1587, 9480, 180, 269, "Output",ExpressionUUID->"5652a2d8-f5aa-4c9d-b1f7-c34200b82e11"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79348, 1772, 17738, 410, 1701, "Input",ExpressionUUID->"5dcb338b-4b9b-4ed5-9561-617a3dd9a8ba"],
Cell[97089, 2184, 324, 8, 30, "Print",ExpressionUUID->"cc0dcab5-9f0a-4f11-8265-a6e147c86276"],
Cell[97416, 2194, 10063, 192, 293, "Output",ExpressionUUID->"9c08871a-2316-4839-afde-45e289edbb9a"]
}, Open  ]]
}
]
*)

