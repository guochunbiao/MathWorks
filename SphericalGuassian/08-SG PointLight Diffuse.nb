(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    117034,       2676]
NotebookOptionsPosition[    113018,       2604]
NotebookOutlinePosition[    113377,       2620]
CellTagsIndexPosition[    113334,       2617]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "gPlots.m"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"G", "[", 
     RowBox[{"v_", ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "\[Lambda]_", ",", "\[Mu]_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"\[Mu]", "*", 
     RowBox[{"Exp", "[", 
      RowBox[{"\[Lambda]", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"Normalize", "[", "v", "]"}], ",", 
           RowBox[{"Normalize", "[", "p", "]"}]}], "]"}], "-", "1"}], ")"}]}],
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"All", "-", 
    RowBox[{"Frequency", " ", "Eq", 
     RowBox[{"(", "3", ")"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"G1", "[", 
     RowBox[{"\[Theta]_", ",", "\[Lambda]_"}], "]"}], ":=", 
    RowBox[{"Exp", "[", 
     RowBox[{"\[Lambda]", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", "1"}], ")"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<>Solve \[Theta]:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"G1", "[", 
      RowBox[{"\[Theta]", ",", "\[Lambda]"}], "]"}], "\[Equal]", 
     "\[Epsilon]"}], "&&", 
    RowBox[{"\[Epsilon]", ">", "0"}], "&&", 
    RowBox[{"\[Lambda]", ">", 
     RowBox[{"-", 
      RowBox[{"Log", "[", "\[Epsilon]", "]"}]}]}]}], ",", "\[Theta]", ",", 
   "Reals"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8309903106916723`*^9, 3.8309903454519725`*^9}, {
   3.8309969765131054`*^9, 3.8309969895593653`*^9}, {3.830997037231437*^9, 
   3.8309970482892222`*^9}, {3.8309970787035923`*^9, 3.830997091407192*^9}, {
   3.8309971292235217`*^9, 3.830997167407466*^9}, {3.8309972567909627`*^9, 
   3.830997302111455*^9}, {3.8309974104080133`*^9, 3.8309974132230577`*^9}, {
   3.8309975364663334`*^9, 3.8309975412315435`*^9}, {3.8309975986641326`*^9, 
   3.8309976061674585`*^9}, {3.830997656480865*^9, 3.830997670528775*^9}, {
   3.830997767176325*^9, 3.8309978046705027`*^9}, 3.8309981122565165`*^9, {
   3.830998205695714*^9, 3.8309982346083364`*^9}, {3.830998310399248*^9, 
   3.8309983477506037`*^9}, {3.830998416271468*^9, 3.830998422807728*^9}, {
   3.8309995776315947`*^9, 3.8309995942159843`*^9}, {3.831009342008922*^9, 
   3.8310093421455555`*^9}, {3.8310124077375298`*^9, 
   3.8310124172461805`*^9}, {3.831433590228179*^9, 3.8314336181319375`*^9}, {
   3.8314426821751585`*^9, 3.831442693453438*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"84e62f8d-164c-477f-b0ff-b9717f848734"],

Cell[BoxData["\<\">Solve \[Theta]:\"\>"], "Print",
 CellChangeTimes->{
  3.831090508651869*^9, 3.8310909847919073`*^9, 3.831093844493513*^9, 
   3.8311590449626846`*^9, 3.8311786676776276`*^9, 3.831179407342661*^9, 
   3.831436316706063*^9, 3.831440641094316*^9, {3.831440880305629*^9, 
   3.831440905737561*^9}, 3.8314409595690126`*^9, 3.831441021592781*^9, 
   3.831441313494795*^9, 3.831442738475692*^9, 3.8314457442509995`*^9, 
   3.831446485165348*^9, 3.8314469186162305`*^9, 3.8314470055181246`*^9, 
   3.831454414591387*^9, 3.8315194234952226`*^9, 3.831519495827821*^9, {
   3.831519831274953*^9, 3.831519855444236*^9}},
 CellLabel->
  "During evaluation of \
In[300]:=",ExpressionUUID->"e94416d7-747d-4b12-b949-03bf0b2003d3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]", "\[Rule]", 
     RowBox[{"ConditionalExpression", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"ArcCos", "[", 
          FractionBox[
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], "\[Lambda]"], "]"}]}], 
        "+", 
        RowBox[{"2", " ", "\[Pi]", " ", 
         TemplateBox[{"1"},
          "C"]}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           TemplateBox[{"1"},
            "C"], "\[Element]", 
           TemplateBox[{},
            "Integers"]}], "&&", 
          RowBox[{"0", "<", "\[Epsilon]", "<", "1"}], "&&", 
          RowBox[{
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], ">", "0"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           TemplateBox[{"1"},
            "C"], "\[Element]", 
           TemplateBox[{},
            "Integers"]}], "&&", 
          RowBox[{"\[Epsilon]", ">", "1"}], "&&", 
          RowBox[{
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], ">", "0"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "\[Lambda]"}], "+", 
            RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], "\[LessEqual]", 
           "0"}]}], ")"}]}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", "\[Rule]", 
     RowBox[{"ConditionalExpression", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ArcCos", "[", 
         FractionBox[
          RowBox[{"\[Lambda]", "+", 
           RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], "\[Lambda]"], "]"}], 
        "+", 
        RowBox[{"2", " ", "\[Pi]", " ", 
         TemplateBox[{"1"},
          "C"]}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           TemplateBox[{"1"},
            "C"], "\[Element]", 
           TemplateBox[{},
            "Integers"]}], "&&", 
          RowBox[{"0", "<", "\[Epsilon]", "<", "1"}], "&&", 
          RowBox[{
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], ">", "0"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           TemplateBox[{"1"},
            "C"], "\[Element]", 
           TemplateBox[{},
            "Integers"]}], "&&", 
          RowBox[{"\[Epsilon]", ">", "1"}], "&&", 
          RowBox[{
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], ">", "0"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "\[Lambda]"}], "+", 
            RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], "\[LessEqual]", 
           "0"}]}], ")"}]}]}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8310878164683104`*^9, 3.831090508776536*^9, 3.831090984919595*^9, 
   3.8310938446231656`*^9, 3.8311590450858593`*^9, 3.831178667804829*^9, 
   3.8311794074543657`*^9, 3.83143631683323*^9, 3.831440641212001*^9, {
   3.831440880419325*^9, 3.8314409060672913`*^9}, 3.8314409596737328`*^9, 
   3.8314410217029953`*^9, 3.831441313608491*^9, 3.831442738594374*^9, 
   3.831445744363698*^9, 3.831446485514443*^9, 3.8314469189922247`*^9, 
   3.831447005864643*^9, 3.831454414716053*^9, 3.8315194246741996`*^9, 
   3.831519495943385*^9, {3.831519831394637*^9, 3.8315198555521584`*^9}},
 CellLabel->
  "Out[308]=",ExpressionUUID->"4d7bb9e0-d55a-466f-91bb-153c154c4468"],

Cell[CellGroupData[{

Cell[BoxData["\<\">Solve \[Theta]:\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.830998222886476*^9, 3.8309982356562757`*^9}, {
   3.8309983223026915`*^9, 3.8309983483445816`*^9}, {3.830998417948064*^9, 
   3.83099842416033*^9}, {3.83099958140348*^9, 3.830999594802928*^9}, 
   3.831006900458312*^9, 3.831006968649522*^9, {3.8310093429242*^9, 
   3.8310093656865244`*^9}, {3.831012446185112*^9, 3.8310124603564997`*^9}, 
   3.8310151360330296`*^9, 3.831070716882805*^9, 3.831072843672161*^9, 
   3.831074840811786*^9, 3.8310842181889696`*^9, 3.8310878163456383`*^9},
 FontSize->18,
 CellLabel->"During evaluation of In[2446]:="],

Cell[BoxData[
 RowBox[{"\<\">Solve \[Theta]:\"\>", "\[AliasDelimiter]"}]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.830998222886476*^9, 3.8309982356562757`*^9}, {
   3.8309983223026915`*^9, 3.8309983483445816`*^9}, {3.830998417948064*^9, 
   3.83099842416033*^9}, {3.83099958140348*^9, 3.830999594802928*^9}, 
   3.831006900458312*^9, 3.831006968649522*^9, {3.8310093429242*^9, 
   3.8310093656865244`*^9}, {3.831012446185112*^9, 3.8310124603564997`*^9}, 
   3.8310151360330296`*^9, 3.831070716882805*^9, 3.831072843672161*^9, 
   3.831074840811786*^9, 3.8310842181889696`*^9},
 FontSize->18]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]", "\[Rule]", 
     RowBox[{"ConditionalExpression", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"ArcCos", "[", 
          FractionBox[
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], "\[Lambda]"], "]"}]}], 
        "+", 
        RowBox[{"2", " ", "\[Pi]", " ", 
         TemplateBox[{"1"},
          "C"]}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           TemplateBox[{"1"},
            "C"], "\[Element]", 
           TemplateBox[{},
            "Integers"]}], "&&", 
          RowBox[{"0", "<", "\[Epsilon]", "<", "1"}], "&&", 
          RowBox[{
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], ">", "0"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           TemplateBox[{"1"},
            "C"], "\[Element]", 
           TemplateBox[{},
            "Integers"]}], "&&", 
          RowBox[{"\[Epsilon]", ">", "1"}], "&&", 
          RowBox[{
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], ">", "0"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "\[Lambda]"}], "+", 
            RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], "\[LessEqual]", 
           "0"}]}], ")"}]}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", "\[Rule]", 
     RowBox[{"ConditionalExpression", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ArcCos", "[", 
         FractionBox[
          RowBox[{"\[Lambda]", "+", 
           RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], "\[Lambda]"], "]"}], 
        "+", 
        RowBox[{"2", " ", "\[Pi]", " ", 
         TemplateBox[{"1"},
          "C"]}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           TemplateBox[{"1"},
            "C"], "\[Element]", 
           TemplateBox[{},
            "Integers"]}], "&&", 
          RowBox[{"0", "<", "\[Epsilon]", "<", "1"}], "&&", 
          RowBox[{
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], ">", "0"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           TemplateBox[{"1"},
            "C"], "\[Element]", 
           TemplateBox[{},
            "Integers"]}], "&&", 
          RowBox[{"\[Epsilon]", ">", "1"}], "&&", 
          RowBox[{
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], ">", "0"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "\[Lambda]"}], "+", 
            RowBox[{"Log", "[", "\[Epsilon]", "]"}]}], "\[LessEqual]", 
           "0"}]}], ")"}]}]}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8309975070202904`*^9, 3.830997542077346*^9, 3.830997671546428*^9, {
   3.8309977941602383`*^9, 3.830997805501749*^9}, 3.830998112988802*^9, {
   3.830998222945319*^9, 3.830998235717142*^9}, {3.8309983224183826`*^9, 
   3.83099834834159*^9}, {3.8309984179460692`*^9, 3.830998424275414*^9}, {
   3.8309995814423757`*^9, 3.8309995949186487`*^9}, 3.831006900580788*^9, 
   3.831006968785159*^9, {3.831009343040888*^9, 3.831009365811725*^9}, {
   3.8310124463027983`*^9, 3.831012460467558*^9}, 3.8310151361477222`*^9, 
   3.831070717001489*^9, 3.8310728437878513`*^9, 3.831074840936453*^9},
 FontSize->18,
 CellLabel->"Out[2131]="]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\<>Failed to solve integral\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolveFa", "[", 
   RowBox[{"\[Lambda]_", ",", "\[Epsilon]_"}], "]"}], "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"G1", "[", 
     RowBox[{"\[Theta]", ",", "\[Lambda]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"Log", "[", "\[Epsilon]", "]"}], "/", "\[Lambda]"}]}], 
       "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.830998434510915*^9, 3.8309985825277176`*^9}, {
  3.8309986435834637`*^9, 3.8309986784198327`*^9}, {3.8309990364378433`*^9, 
  3.830999109638248*^9}, {3.8309991469435396`*^9, 3.8309991603666887`*^9}, {
  3.830999759999028*^9, 3.830999860069661*^9}, {3.8309998922626185`*^9, 
  3.8309999049090443`*^9}, {3.8309999562698956`*^9, 3.831000075733575*^9}, {
  3.8310001238072805`*^9, 3.831000145765499*^9}, {3.831000293518614*^9, 
  3.8310006239015975`*^9}},
 CellLabel->
  "In[309]:=",ExpressionUUID->"e76d50d8-5936-4cd0-bf21-a005eddd32e9"],

Cell[BoxData["\<\">Failed to solve integral\"\>"], "Print",
 CellChangeTimes->{{3.831000584059764*^9, 3.8310006245837393`*^9}, 
   3.8310069007433558`*^9, 3.8310069689656763`*^9, 3.8310093659837475`*^9, 
   3.831012460630123*^9, 3.8310151363332305`*^9, 3.8310707171869917`*^9, 
   3.831072844015256*^9, 3.831074841203086*^9, 3.8310878167096653`*^9, 
   3.8310905090458293`*^9, 3.831090985180928*^9, 3.831093844842581*^9, 
   3.831159045296296*^9, 3.831178668091535*^9, 3.831179407809425*^9, 
   3.8314363170187345`*^9, 3.8314363651746397`*^9, 3.831440641347637*^9, 
   3.8314408804911337`*^9, 3.8314413136623745`*^9, 3.8314457445292544`*^9, 
   3.8314464856823483`*^9, 3.831447006020707*^9, 3.8314544148806133`*^9, 
   3.8315194248045287`*^9, 3.8315194960463696`*^9, 3.8315198556295023`*^9},
 FontSize->18,
 CellLabel->
  "During evaluation of \
In[309]:=",ExpressionUUID->"1c34808e-4e1d-46df-9c47-75bb99a0b2a5"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", "0", 
   RowBox[{"ArcCos", "[", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"Log", "[", "\[Epsilon]", "]"}], "\[Lambda]"]}], "]"}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[Lambda]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}]}]], 
   RowBox[{"\[DifferentialD]", "\[Theta]"}]}]}]], "Output",
 CellChangeTimes->{3.8310006340541687`*^9, 3.8310069105488653`*^9, 
  3.831006978764953*^9, 3.8310093758161335`*^9, 3.8310124704574146`*^9, 
  3.8310151462352486`*^9, 3.831070726972954*^9, 3.831072853990119*^9, 
  3.8310748510617385`*^9, 3.8310878266868057`*^9, 3.831090518991104*^9, 
  3.8310909950901527`*^9, 3.8310938548517694`*^9, 3.8311590551892214`*^9, 
  3.8311786781905313`*^9, 3.831179417971059*^9, 3.83143632796583*^9, 
  3.8314363748615074`*^9, 3.831440651490139*^9, 3.8314408904167705`*^9, 
  3.8314413253631067`*^9, 3.831445754364771*^9, 3.8314464965071087`*^9, 
  3.8314470168722725`*^9, 3.831454424491727*^9, 3.831519435911615*^9, 
  3.831519505533491*^9, 3.831519865203519*^9},
 FontSize->18,
 CellLabel->
  "Out[310]=",ExpressionUUID->"e7594854-4ad4-4e13-b272-e197b9a1fccf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["f", "a"], "[", 
     RowBox[{"\[Lambda]_", ",", "\[Epsilon]_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"-", "2"}], "\[Pi]", "*", 
     RowBox[{"Log", "[", 
      RowBox[{"\[Epsilon]", "/", "\[Lambda]"}], "]"}]}]}], ";"}], "//", 
  "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefaultEpsilon", "=", "0.1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fa", "[", "\[Lambda]_", "]"}], ":=", 
   RowBox[{
    SubscriptBox["f", "a"], "[", 
    RowBox[{"\[Lambda]", ",", "DefaultEpsilon"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InvFa", "=", 
   RowBox[{"InverseFunction", "[", "Fa", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<>Inverse Function:\>\"", " ", 
    RowBox[{"TraditionalForm", "[", "InvFa", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<>Validate Inverse Function:\>\"", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"InvFa", "[", 
       RowBox[{"Fa", "[", "x", "]"}], "]"}], "\[Equal]", "x"}], "}"}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<>Area Integral: \!\(\*SubscriptBox[\(\[Lambda]\), \(max\)]\)=30, \!\(\
\*SubscriptBox[\(Area\), \(max\)]\)=35\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Fa", "[", "\[Lambda]", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Lambda]", ",", "0.01", ",", "30"}], "}"}]}], "]"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"InvFa", "[", "area", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"area", ",", "0", ",", "35"}], "}"}]}], "]"}]}], "}"}], "//", 
  "GraphicsRow"}]}], "Input",
 CellChangeTimes->{{3.831000767047083*^9, 3.831000872799517*^9}, {
   3.831000967150676*^9, 3.831001163921897*^9}, {3.831001713374457*^9, 
   3.831001714124626*^9}, {3.8310228966410203`*^9, 3.8310229332585707`*^9}, {
   3.8310230584814634`*^9, 3.831023110008318*^9}, {3.831023228605547*^9, 
   3.831023351263688*^9}, {3.8310962421078196`*^9, 3.831096294795666*^9}, {
   3.8310963529561305`*^9, 3.8310964002516193`*^9}, {3.831096446204859*^9, 
   3.8310965115549507`*^9}, 3.8311615592870607`*^9, {3.831433761181633*^9, 
   3.831433778811781*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"0876f533-9363-4091-8845-cda44bb647c2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\<\">Inverse Function:\"\>", " ", 
  RowBox[{"(", 
   TagBox[
    FormBox[
     RowBox[{
      RowBox[{"0.1`", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"0.15915494309189535`", " ", "#1"}]]}], "&"}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ")"}]}]], "Print",
 CellChangeTimes->{
  3.831001165187668*^9, 3.8310017148167486`*^9, 3.8310069107423224`*^9, 
   3.8310069789783974`*^9, 3.8310093760335817`*^9, 3.831012470666885*^9, 
   3.8310151464875727`*^9, {3.831022908372427*^9, 3.831022934262*^9}, 
   3.831023079620844*^9, 3.8310231105330944`*^9, {3.8310232362817593`*^9, 
   3.8310232587668357`*^9}, {3.831023297262641*^9, 3.8310233522562003`*^9}, 
   3.831070727126542*^9, 3.831072854179613*^9, 3.831074851296082*^9, 
   3.8310878269066257`*^9, 3.8310905192071457`*^9, 3.8310909952965717`*^9, 
   3.8310938550342817`*^9, {3.8310962425520487`*^9, 3.8310962960365543`*^9}, {
   3.831096353476962*^9, 3.8310964007711678`*^9}, 3.83109644681458*^9, 
   3.831096512458253*^9, 3.8311590554078703`*^9, 3.8311786784662848`*^9, 
   3.831179418234354*^9, {3.831433768570922*^9, 3.8314337797220373`*^9}, 
   3.8314363280914946`*^9, 3.8314406515609503`*^9, 3.831440890474683*^9, 
   3.831441325436378*^9, 3.8314457545053954`*^9, 3.83144649667325*^9, 
   3.831447017056302*^9, 3.8314544246411037`*^9, 3.83151943603386*^9, 
   3.8315195056120043`*^9, 3.831519865267925*^9},
 FontSize->18,
 CellLabel->
  "During evaluation of \
In[311]:=",ExpressionUUID->"ca94e5f1-7186-4c40-9f56-d2130fd317da"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\">Validate Inverse Function:\"\>", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1.`", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["1", "x"], ")"}], "1.`"]], "\[Equal]", "x"}], ")"}]}], 
  "}"}]], "Print",
 CellChangeTimes->{
  3.831001165187668*^9, 3.8310017148167486`*^9, 3.8310069107423224`*^9, 
   3.8310069789783974`*^9, 3.8310093760335817`*^9, 3.831012470666885*^9, 
   3.8310151464875727`*^9, {3.831022908372427*^9, 3.831022934262*^9}, 
   3.831023079620844*^9, 3.8310231105330944`*^9, {3.8310232362817593`*^9, 
   3.8310232587668357`*^9}, {3.831023297262641*^9, 3.8310233522562003`*^9}, 
   3.831070727126542*^9, 3.831072854179613*^9, 3.831074851296082*^9, 
   3.8310878269066257`*^9, 3.8310905192071457`*^9, 3.8310909952965717`*^9, 
   3.8310938550342817`*^9, {3.8310962425520487`*^9, 3.8310962960365543`*^9}, {
   3.831096353476962*^9, 3.8310964007711678`*^9}, 3.83109644681458*^9, 
   3.831096512458253*^9, 3.8311590554078703`*^9, 3.8311786784662848`*^9, 
   3.831179418234354*^9, {3.831433768570922*^9, 3.8314337797220373`*^9}, 
   3.8314363280914946`*^9, 3.8314406515609503`*^9, 3.831440890474683*^9, 
   3.831441325436378*^9, 3.8314457545053954`*^9, 3.83144649667325*^9, 
   3.831447017056302*^9, 3.8314544246411037`*^9, 3.83151943603386*^9, 
   3.8315195056120043`*^9, 3.8315198652749467`*^9},
 FontSize->18,
 CellLabel->
  "During evaluation of \
In[311]:=",ExpressionUUID->"b244cff3-4cef-4e9b-80c4-3595d621d13b"],

Cell[BoxData["\<\">Area Integral: \\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \
\\(max\\)]\\)=30, \\!\\(\\*SubscriptBox[\\(Area\\), \\(max\\)]\\)=35\"\>"], \
"Print",
 CellChangeTimes->{
  3.831001165187668*^9, 3.8310017148167486`*^9, 3.8310069107423224`*^9, 
   3.8310069789783974`*^9, 3.8310093760335817`*^9, 3.831012470666885*^9, 
   3.8310151464875727`*^9, {3.831022908372427*^9, 3.831022934262*^9}, 
   3.831023079620844*^9, 3.8310231105330944`*^9, {3.8310232362817593`*^9, 
   3.8310232587668357`*^9}, {3.831023297262641*^9, 3.8310233522562003`*^9}, 
   3.831070727126542*^9, 3.831072854179613*^9, 3.831074851296082*^9, 
   3.8310878269066257`*^9, 3.8310905192071457`*^9, 3.8310909952965717`*^9, 
   3.8310938550342817`*^9, {3.8310962425520487`*^9, 3.8310962960365543`*^9}, {
   3.831096353476962*^9, 3.8310964007711678`*^9}, 3.83109644681458*^9, 
   3.831096512458253*^9, 3.8311590554078703`*^9, 3.8311786784662848`*^9, 
   3.831179418234354*^9, {3.831433768570922*^9, 3.8314337797220373`*^9}, 
   3.8314363280914946`*^9, 3.8314406515609503`*^9, 3.831440890474683*^9, 
   3.831441325436378*^9, 3.8314457545053954`*^9, 3.83144649667325*^9, 
   3.831447017056302*^9, 3.8314544246411037`*^9, 3.83151943603386*^9, 
   3.8315195056120043`*^9, 3.831519865278965*^9},
 FontSize->18,
 CellLabel->
  "During evaluation of \
In[311]:=",ExpressionUUID->"76108d8d-5e8b-4aab-bb72-34928123ffb8"]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{{}, {InsetBox[
     GraphicsBox[{{{}, {}, 
        TagBox[
         {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
          Opacity[1.], LineBox[CompressedData["
1:eJwVy2s4lAkDxnGT0gwZpVKKFHIIMSeJeea5n/TK2s1ZajFhqUiRoiiiqFQz
HSmUCo3aQtYhRZLDJpTt7dy8qGhIGYqEHHbeD/f1v34f7iWB4e7BU5SUlPYo
9v8eSj3tb03rIHUXFu49E2CEedPromDSQfobnYyR7TPCkaADa/pjOkjiZEmT
6l9GGH0A7ctNHWS3kj3dXWaEtn33Kie3d5IPBxs4wb8ZI/dbmfL90o/ke5Pc
YFcNE1i1XT9F2HeTLY9D7/fvMkW23ZY/es92k8TWXOWRLFPMTjfiXZR1k31R
woToBlMMeeS8Hkv5RFY6rzZs116GykcX9Cr/6SGb2R60mrJlcCw9kW8r7CVZ
BYkqTlIz3NV03t9T2Ety9hvWqU+YwSxihlsGTU6W1v3jE7nYHEyzlMGRXDnJ
PhqoZRRkjueXD9jd+dxHPho7JwjrMofV33c7M/lfyUQJp6anzQKVRfmRCxoH
SPeNuXWcTEvknnKPJvoHyPjVffM8iy1xfMePGH+tQdL+3O4dDk2W8GVRiZLA
QVK5YennnFFLjN16foL9c5BcMTxN9U8zKxC3ft50Mh8i0waNYw4nWaGq4Jeu
WPEwOZK6eKzGhAWJWN5zsWSY9AuujYpjsyDefkZe/XaYTLmYMGTCZ0G4vPW7
ivEIOXinrNbDhYWJ/IipZ+6PkD2bAvzGd7FA5p9bcqN/lLQzE2bX3WOh+sZH
H6n7OJllFU7oO7Ah8T3zP8GecbK6Npqx2JmN4+qUX/bFcbLCzK989jo21odf
EIZ0j5Ofun41bA1mo4/tEfAjboJ01GuSjSaxsehu9abZ1ydJS2XX5OgHbAg6
H5dfnVTCbmZbLI3LQVGlYYy3Jg3LI97lymw5MEzdu5KxlIb0hRoOdRQHqg6m
d8OcaNAocrMMceHgZV5SBSeVBumTcz4+oRxs22pX9WDZFDzXSwiRZ3Fw4du1
2lYvZWSVR6VaKXPh6/HQcGmoMgziXHTrGFzolnxMDotXhlf46kbXmVxkRek7
/pQowyR3VbOXLheXhjOb5w8rQ7M8cFBjBRfZE+IXHhlTUbXNMcw1hItrqlFd
j9qm4VzSLpr3Iy6K9Sm1ss10xJ0aQmUMDzN8a0ayY+l4o5FWlh7PQ1CqffcJ
ER2hJx+E7jzIwxy6Q31IMR1dui1XF4p42NXrtF93kg7za8HTcJkHbrnnQFIa
A9SaSV5rPQ8la7dIPepVQQr4ziKmNUr2nLjxVV8dne2lvJo0a0z/2l7VuGQW
zL8MCRMyV+A0L3mPoWQ2knT988d322CWKLnNcnIuBjWmJR6zWAmBPNqv7+h8
LDZ+/7K4dSX8A2uP+H9eAL3wOWUBkbbYKLuQ9IbUxZT5YxFdP2yhtmtzuspD
PfD3Po4QxNnB+6hDfuSsJTi6iS3e2m+H+Ha3BZXr9XGHz9+SEcTH2cqccEaG
AWyv7Zup2sKHoYFBZmG9IdRWVf/taU7gGHPhs0JVI9DfXdWrPkZg20G8p9sa
Y7j/l6DRdgJL49p+VhwwwZ1DbWmHrAVonqiZiKw3RWftVBnrsAC9jBevDnxb
hkCDYY/hJwJ8TN9474uNOVL+uGXhpU3Cu3heTGGIBXSm/4ZGHxLlnlq60WeX
w8H03uGADBL9saLHaa8t8Xu4iJkjJeE2V3vZkYNW+GmyVmmRGpBamDeww5iF
QS5jqNQUeCraUOTXwIK6xpO0PAeg0Ur/bZSQjYHpVu5V/sByLWOGHY0D79hv
Ljr7ANfqVTnm6Rx8SNz65dVZIKQgkbV4ORdN69uDNt4EetvG6qtbuMiR3tQ0
qlf8n4vrRZt40DoYffu8FJCq+TVNV7XGlsrrQYIB4D/0VfyCbGs0ySdflNEp
SBydrqyzWQH1fGmFjS6FnU3iGTffrsCV1ARZB5vCuGbPB4tIG2SKX0nSHSh8
u5B431drJfoaxqK2+VBoD+WfFN1eCdGlbh2/cAop4+rNPWtt0f4mUHwokULW
fxcyv/fbIl7YMLPuLIWIMFSYpdjhCvdSkruEgq3TEd+gRXy0hKQEmN2mEB46
Y6pTNR9u9Nhs5iMKAS55Wr7eBKYJd5YGv6Hge8lAMrGBAOd32pd8hdf1XeJd
8SVQOXWOzpDCv5447ykLIPCnWvOWQ28p8FpSTkeEEWgR5pVIpBQYLmHM5EQC
XcrMebJWCkXOLJWCGwT2B2Uz/T9QuJmVn+paQOCwNm1PnsISuenSgVsEYnUY
UrnCmWL91TZlBEqOaYvjOigkP5l9oKaaQNVen2sZnRQ2OA+Nv3xBIFJVWPBM
RsEzK1IU85pA/MCrvxZ0UXCWy3V0pATsVdSLAhS2F3fZBbwjkD43P6NPYYsn
r2M+9xDYXNuhr/aJgskiL4a4l8DqTq/vbgrrb3963qqfQKLS8QfnFZ7HbLwd
9Z1AiNhxjVEPBU2hw5r5wwRorKdK2xSeUVDz8u4ogWdW+iXFCqtMCDb5jRPI
usoPGFWY5lzxfXKSwAvJEjr1mcK/mbNdVA==
           "]]},
         Annotation[#, "Charting`Private`Tag$259849#1"]& ]}, {}},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->{True, True},
      AxesLabel->{None, None},
      AxesOrigin->{0.01, 11.190578332066758`},
      DisplayFunction->Identity,
      Frame->{{False, False}, {False, False}},
      FrameLabel->{{None, None}, {None, None}},
      FrameTicks->{{Automatic, 
         Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
         Charting`ScaledFrameTicks[{Identity, Identity}]}},
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      ImagePadding->{{7.989795918367349, 1.5}, {6.168639023694482, 
       0.5000000000000142}},
      Method->{
       "DefaultBoundaryStyle" -> Automatic, 
        "DefaultGraphicsInteraction" -> {
         "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
          "Effects" -> {
           "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
            "Droplines" -> {
             "freeformCursorMode" -> True, 
              "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
        "DefaultMeshStyle" -> AbsolutePointSize[6], "ScalingFunctions" -> 
        None, "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& )}},
      PlotRange->{{0.01, 30}, {11.190578332066758`, 35.83792211192273}},
      PlotRangeClipping->True,
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.05], 
         Scaled[0.05]}},
      Ticks->{Automatic, Automatic}], {192., -116.80842387373012}, 
     ImageScaled[{0.5, 0.5}], {360., 222.49223594996212}], InsetBox[
     GraphicsBox[{{{}, {}, 
        TagBox[
         {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
          Opacity[1.], LineBox[CompressedData["
1:eJwVk3k41HkAh92rlSNyNJFzmlxFOWaGfD+/1morHSw9xSZLjtxd7iOSYova
1VgyD3ZdsalUMlPEk2OZnuyEEi25lpY1IsdjprXtH+/z/v8+z2voF+keICMl
JbX/M/+7cytnvGqpwilpfXhnfj6PuPIK/VwlF8lt34H0F6U8YjDjckZXcoMs
n1VgKN7lkSzFwgQ5SRmpKjQzz2rjkac32lKWxQ+JrbV8ZMc8jxx9O5A6J24l
qxOznXYH+aQ85a80kbiXXNu7x/btmsdkvzBUdkY8TlpzzbT+yH5CeHE6KJpc
JPP86U8RGk0kQTtPIUdOGjGXaC83LDST5soWl8FYBdj4v3CTlmsh3SzGxQz/
tVAObbVUT28jSTWn5K9+VMMe3xxrb8MOskRCdl+Y04CH0p3E2gPPSauFTXTq
iBZCpmaiTIVdhDtS9c1C0QZ8mnfm3GsQEm8dx4IbP+vCLiS9/NelbmKiHZ9T
7aMP2eeZY9qur0hxfUv9CSVD5K4fN3Dv6yMlZUffr7lohMqGaYPs2QHCWGqZ
OjluDEn/gdzLFkOk+HKDpa8/HdORLdWHrg6TZ+2bAr36N2N6NF+uq36UhIUe
jlJlbgFrTuYSRzJOFA9u5HvdN8W3VGLk9JNJYppX1+uraQ69kYnBUu4U2ak/
ZPUp1wKnR688keiKiNgjKo2rvBVCSvegYdIH4iR6XbYctg3n5KJ7hanz5PGJ
QLmFs1aga05dL1hYIBvknm8SbLaGK7r6OzOWietKgI1xrzWK9rln53uKSdy1
tpMuP25HYk/tbFPjv2TyiLpi+64dGOGYpwkY0nBrNmlTl7HBzmDFrAh3WeSc
D01512CD7pqgsS8eyUP1NLdEKdwWHzK0g7h2isiU5YxKm9thobguuYwowaU9
LtvzrR0ch9WNboWpoG/4uo15lj0GjtOMOubU4F8YtSJwYaIhkmtZoqIB60y2
aeciE+f18nzqd2liWVMQ89NDFu4u/vCn0aw2ZHpdtvGD2LBwjowabqBh+O/F
YT8tB/TvuxdI69IDrzj8watuBzQf+ccoucUAPZe7RBXpjhB8rNvh/MgI79WW
9zo774S+0vflwZp0dIs8SvyknHBbYZi+9j4Dq1Jc38E7TjAair8VFGEGem01
oUcQ0HTpgbQmS7R1vnw2pgo4bklvqiu0wvjEyfGlQECYl39nNW07pDzHOFGt
wFd8TkqN8HM37x5Jnh4F/6VbPVoO9tis3lFoqE9hI0f2UKyLPVQ6GhyrDSg8
Nq7xGXKzx6BdRWKjMQUp7zE0BtsjWT1eMmZKITa2NOApxx5NHfoSazsKasle
N4Xz9tjFDBULDlAY9Dp/eE8tE2ai4zc9D1F4F/NliV8jE+rlHg5DbhSmhz70
pXYyMaLhlDDnQeFUaIzuyxEmLojUxDreFFRY8s58DRZayutWAoIolGRuqqiO
ZuG3Y9UFomAKWW/WMegXWJ8/KGbHhVBwDUl/VprDQkBaZvyVcArp10aO1VWy
oODz3UrtGQqX1jwIMx5gYWa9W4HjOQqr5HeTFxMsvBJ8zW6LphCSEbsu5SML
5axt8W/iKBDB69x5ZTayZ41p/gkUfmkvsn5EYyO6Qoc/nUjBV2irmspgw8dH
2Ss6mUKlSZWVmw0buzVlVlZTKEwmqeQzKDb+A40uNrY=
           "]]},
         Annotation[#, "Charting`Private`Tag$259896#1"]& ]}, {}},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->{True, True},
      AxesLabel->{None, None},
      AxesOrigin->{0, 0},
      DisplayFunction->Identity,
      Frame->{{False, False}, {False, False}},
      FrameLabel->{{None, None}, {None, None}},
      FrameTicks->{{Automatic, 
         Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
         Charting`ScaledFrameTicks[{Identity, Identity}]}},
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      ImagePadding->{{7.989795918367349, 1.5}, {6.168639023694482, 
       0.5000000000000142}},
      Method->{
       "DefaultBoundaryStyle" -> Automatic, 
        "DefaultGraphicsInteraction" -> {
         "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
          "Effects" -> {
           "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
            "Droplines" -> {
             "freeformCursorMode" -> True, 
              "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
        "DefaultMeshStyle" -> AbsolutePointSize[6], "ScalingFunctions" -> 
        None, "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& )}},
      PlotRange->{{0, 35}, {0., 26.254510465658228`}},
      PlotRangeClipping->True,
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.05], 
         Scaled[0.05]}},
      Ticks->{Automatic, Automatic}], {576., -116.80842387373012}, 
     ImageScaled[{0.5, 0.5}], {360., 222.49223594996212}]}, {}},
  ContentSelectable->True,
  ImageSize->{
    UpTo[600], 
    UpTo[360]},
  PlotRangePadding->{6, 5}]], "Output",
 CellChangeTimes->{{3.8310229085808687`*^9, 3.831022934260005*^9}, 
   3.831023079610871*^9, 3.8310231105290747`*^9, {3.8310232362787676`*^9, 
   3.831023258760852*^9}, {3.831023297479125*^9, 3.831023352471135*^9}, 
   3.8310707273349867`*^9, 3.8310728544369283`*^9, 3.8310748515523987`*^9, 
   3.831087827177411*^9, 3.8310905194863834`*^9, 3.8310909955588694`*^9, 
   3.831093855248759*^9, {3.8310962428163424`*^9, 3.831096296282862*^9}, {
   3.8310963537587156`*^9, 3.8310964010224943`*^9}, 3.8310964470781627`*^9, 
   3.8310965127076015`*^9, 3.8311590556477437`*^9, 3.831178678793837*^9, 
   3.831179418611927*^9, {3.831433768875617*^9, 3.831433780033251*^9}, 
   3.831436328387702*^9, 3.831440651800311*^9, 3.831440890696636*^9, 
   3.8314413260193253`*^9, 3.8314457548544674`*^9, 3.831446497008891*^9, 
   3.8314470173966694`*^9, 3.831454425012436*^9, 3.8315194362443647`*^9, 
   3.8315195057991695`*^9, 3.831519865442479*^9},
 CellLabel->
  "Out[318]=",ExpressionUUID->"abb57625-4d2d-4391-a676-4b10932c1494"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefaultLightingPower", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefaultLightCenter", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Point light fall off.\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\"\<circles\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
            RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}]}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<groundShadings\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", "    ", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
            RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadius"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<shadingFunc\>\"", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"gPointLightFallOff", "[", 
                RowBox[{"#lightRadius", ",", "#shadingDist"}], "]"}], "&"}], 
              ")"}]}]}], "|>"}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}]}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "3"}]}], "\[IndentingNewLine]",
      "|>"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "2"}], "}"}], ",", "1", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.831002078068723*^9, 3.83100208519676*^9}, {
   3.831002316532463*^9, 3.8310023212519755`*^9}, {3.831002373211689*^9, 
   3.8310023901400843`*^9}, {3.831002433547789*^9, 3.83100247683584*^9}, {
   3.831002564533651*^9, 3.831002649157276*^9}, {3.831002803580617*^9, 
   3.831002803971735*^9}, {3.83100283455576*^9, 3.83100288798783*^9}, {
   3.831002955910118*^9, 3.8310030815564528`*^9}, {3.83100316232605*^9, 
   3.83100316427699*^9}, {3.831003229796599*^9, 3.831003362837056*^9}, {
   3.8310035421405487`*^9, 3.831003543971882*^9}, {3.8310036206275563`*^9, 
   3.8310036579633093`*^9}, {3.831003849781001*^9, 3.8310038692611523`*^9}, {
   3.831004068556427*^9, 3.831004069723343*^9}, {3.8310041919177465`*^9, 
   3.83100430558853*^9}, {3.8310043489958177`*^9, 3.8310045353626685`*^9}, {
   3.8310045981153*^9, 3.831004727418696*^9}, {3.8310047739351945`*^9, 
   3.831004854299939*^9}, {3.831004891955823*^9, 3.831004917020706*^9}, {
   3.8310049900505433`*^9, 3.831005257147004*^9}, {3.8310054736596184`*^9, 
   3.8310054920361576`*^9}, 3.8310055284440107`*^9, {3.8310063540925813`*^9, 
   3.8310063700033817`*^9}, {3.831007232866215*^9, 3.831007236059877*^9}, {
   3.8310074326597676`*^9, 3.831007435265958*^9}, {3.8310095629208293`*^9, 
   3.8310095657278957`*^9}, {3.8310096630883384`*^9, 
   3.8310096920399394`*^9}, {3.8310097223150496`*^9, 3.831009734745722*^9}, 
   3.8310097932657056`*^9, {3.831072900764426*^9, 3.831072904772851*^9}, {
   3.8311598327331476`*^9, 3.8311598338523855`*^9}, {3.8314373487067013`*^9, 
   3.831437439362578*^9}, {3.831442715471566*^9, 3.83144272752213*^9}, {
   3.831442834368719*^9, 3.831442848885989*^9}, {3.831443252551099*^9, 
   3.831443257206956*^9}, {3.831445513208131*^9, 3.8314455244608617`*^9}, {
   3.831445669950042*^9, 3.8314456812442703`*^9}, 3.8315191812156916`*^9, {
   3.8315195550956345`*^9, 3.831519583629504*^9}, 3.831519975103011*^9, {
   3.8315207969629173`*^9, 3.831520801680238*^9}, {3.8315208737669864`*^9, 
   3.831520879544854*^9}},ExpressionUUID->"4194c259-f62c-4c25-bb7c-\
30ef74a0669d"],

Cell[BoxData[
 StyleBox["\<\" Point light fall off.\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8314456820450125`*^9, 3.8314457549182963`*^9, 3.831446497078704*^9, 
   3.831446927606476*^9, 3.8314470174654856`*^9, 3.831454425079229*^9, {
   3.83151943629366*^9, 3.831519465930171*^9}, {3.831519505870969*^9, 
   3.8315195310148726`*^9}, 3.831519584705165*^9, 3.8315198654828405`*^9, 
   3.831519976115898*^9, 3.831520804742359*^9},
 CellLabel->
  "During evaluation of \
In[412]:=",ExpressionUUID->"a05aaf85-6e0c-4ddf-8305-2a991c029056"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lightCenter$$ = {-1, 
    1}, $CellContext`lightRadius$$ = 2, Typeset`show$$ = False, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-1, 1}}, {-2, -2}, {2, 2}}, {
      Hold[$CellContext`lightRadius$$], 2, 5}}, Typeset`size$$ = {
    96., {47., 53.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$291830$$ = {0, 
    0}, $CellContext`lightRadius$291831$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`lightCenter$$ = {-1, 
         1}, $CellContext`lightRadius$$ = 2}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$291830$$, {
         0, 0}], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$291831$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> gPlots`gParamPlot[
        Association[
         ("circles" -> {
           Association[
           "center" -> Slot["lightCenter"], "radius" -> 
            Slot["lightRadius"]]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadius" -> $CellContext`lightRadius$$]], 
         ("groundShadings" -> {
           Association[
           "lightCenter" -> Slot["lightCenter"], "lightRadius" -> 
            Slot["lightRadius"], "shadingFunc" -> (gBRDF`gPointLightFallOff[
              Slot["lightRadius"], 
              Slot["shadingDist"]]& )]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadius" -> $CellContext`lightRadius$$]], "axisExtent" -> 3]],
       "Specifications" :> {{{$CellContext`lightCenter$$, {-1, 
          1}}, {-2, -2}, {2, 2}}, {$CellContext`lightRadius$$, 2, 5}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{147., {71., 77.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8314432578642435`*^9, {3.8314455195259566`*^9, 3.8314455357824993`*^9}, 
   3.8314456821208096`*^9, 3.831445754980131*^9, 3.831446497134614*^9, 
   3.8314469276712704`*^9, 3.831447017531309*^9, 3.8314544251380715`*^9, {
   3.831519436335931*^9, 3.831519465973822*^9}, {3.831519505921327*^9, 
   3.8315195310467587`*^9}, 3.831519584735149*^9, 3.831519865513715*^9, 
   3.831519976164115*^9, 3.831520804782534*^9},
 CellLabel->
  "Out[415]=",ExpressionUUID->"63ba8ec4-61b1-42a4-83be-c434deddfc48"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<>NoL*FallOff(Ground Lighting):\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\"\<circles\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
            RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}]}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<groundShadings\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", "    ", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
            RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadius"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<shadingFunc\>\"", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", "#nol", ")"}], "*", 
                RowBox[{"gPointLightFallOff", "[", 
                 RowBox[{"#lightRadius", ",", "#shadingDist"}], "]"}]}], 
               "&"}], ")"}]}]}], "|>"}], "\[IndentingNewLine]", "}"}]}], 
        "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}]}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "3"}]}], "\[IndentingNewLine]",
      "|>"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "2"}], "}"}], ",", "1", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8310052841560965`*^9, 3.831005440498991*^9}, {
   3.8310055063583727`*^9, 3.831005517723548*^9}, 3.831072911644847*^9, {
   3.831159809005241*^9, 3.831159810677723*^9}, {3.831445653215071*^9, 
   3.8314456607029057`*^9}, {3.8314456935264*^9, 3.831445734597472*^9}, 
   3.831519979998455*^9, 3.8315205551933174`*^9, {3.831520694479725*^9, 
   3.831520708772501*^9}, {3.831520809303187*^9, 3.8315208137047267`*^9}, 
   3.8315208840940003`*^9},ExpressionUUID->"7bdef0d5-6464-4074-9b2c-\
8a89e272c38b"],

Cell[BoxData[
 StyleBox["\<\" >NoL*FallOff(Ground Lighting):\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.8310053536694307`*^9, 3.8310054411257563`*^9}, {
   3.831005507532148*^9, 3.831005540177558*^9}, 3.8310069108720045`*^9, 
   3.831006979112809*^9, 3.8310093761687565`*^9, 3.8310124708084755`*^9, 
   3.8310151466710835`*^9, 3.831070727487612*^9, 3.8310728546403837`*^9, 
   3.831074851757898*^9, 3.8310878273738856`*^9, 3.8310905196868477`*^9, 
   3.831090995749361*^9, 3.8310938554143496`*^9, 3.8311590558521967`*^9, 
   3.831178679040001*^9, 3.831179418895173*^9, 3.8314363286126404`*^9, 
   3.8314406522351475`*^9, 3.831440890932007*^9, 3.8314413263693876`*^9, 
   3.831445545261395*^9, {3.83144565838922*^9, 3.831445755208028*^9}, 
   3.8314464973530006`*^9, {3.831446903434284*^9, 3.8314469309073143`*^9}, 
   3.831447017781639*^9, 3.8314544253744383`*^9, 3.8315194365018682`*^9, 
   3.8315195060846434`*^9, 3.831519601228425*^9, {3.8315198394854393`*^9, 
   3.8315198656771975`*^9}, {3.831519957959811*^9, 3.831519981347225*^9}, 
   3.8315205581041317`*^9, {3.8315207098853397`*^9, 3.831520718648655*^9}, 
   3.8315208149336257`*^9},
 FontSize->18,
 CellLabel->
  "During evaluation of \
In[416]:=",ExpressionUUID->"0f7f9311-0eab-447a-a80a-aee883117d36"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lightCenter$$ = {-1, 
    1}, $CellContext`lightRadius$$ = 2, Typeset`show$$ = False, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-1, 1}}, {-2, -2}, {2, 2}}, {
      Hold[$CellContext`lightRadius$$], 2, 5}}, Typeset`size$$ = {
    96., {47., 53.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$291958$$ = {0, 
    0}, $CellContext`lightRadius$291959$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`lightCenter$$ = {-1, 
         1}, $CellContext`lightRadius$$ = 2}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$291958$$, {
         0, 0}], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$291959$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> gPlots`gParamPlot[
        Association[
         ("circles" -> {
           Association[
           "center" -> Slot["lightCenter"], "radius" -> 
            Slot["lightRadius"]]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadius" -> $CellContext`lightRadius$$]], 
         ("groundShadings" -> {
           Association[
           "lightCenter" -> Slot["lightCenter"], "lightRadius" -> 
            Slot["lightRadius"], 
            "shadingFunc" -> (Slot["nol"] gBRDF`gPointLightFallOff[
               Slot["lightRadius"], 
               Slot["shadingDist"]]& )]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadius" -> $CellContext`lightRadius$$]], "axisExtent" -> 3]],
       "Specifications" :> {{{$CellContext`lightCenter$$, {-1, 
          1}}, {-2, -2}, {2, 2}}, {$CellContext`lightRadius$$, 2, 5}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{147., {71., 77.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8310053536943974`*^9, 3.8310054411516867`*^9}, {
   3.8310055075580773`*^9, 3.831005540204486*^9}, 3.831006910882945*^9, 
   3.8310069791387396`*^9, 3.8310093761797276`*^9, 3.8310124708214426`*^9, 
   3.8310151467089806`*^9, 3.8310707275265055`*^9, 3.831072854682276*^9, 
   3.831074851803819*^9, 3.8310878274187655`*^9, 3.8310905197337227`*^9, 
   3.831090995792244*^9, 3.8310938554362917`*^9, 3.8311590558811483`*^9, 
   3.831178679096359*^9, 3.831179418959999*^9, 3.8314363286644773`*^9, 
   3.831440652254096*^9, 3.831440890953458*^9, 3.8314413263783646`*^9, 
   3.8314455453222322`*^9, {3.8314456584510555`*^9, 3.83144575527485*^9}, 
   3.8314464974118423`*^9, {3.8314469035001664`*^9, 3.8314469309731426`*^9}, 
   3.8314470177936068`*^9, 3.8314544254402614`*^9, 3.831519436540766*^9, 
   3.831519506117554*^9, 3.8315196012606654`*^9, {3.8315198395203123`*^9, 
   3.831519865707118*^9}, {3.8315199579983215`*^9, 3.831519981381709*^9}, 
   3.8315205581480513`*^9, {3.831520709916087*^9, 3.831520718679484*^9}, 
   3.831520814974147*^9},
 CellLabel->
  "Out[417]=",ExpressionUUID->"c5abec4f-52bf-49f4-b69e-71e1a13bacb4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApproxLight", "[", 
     RowBox[{"i_", ",", "x_", ",", "l_", ",", "r_", ",", "s_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d", ",", "p", ",", "\[Lambda]", ",", "\[Mu]"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d", "=", 
        RowBox[{"Norm", "[", 
         RowBox[{"l", "-", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "-", "x"}], ")"}], "/", "d"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"InvFa", "[", 
         RowBox[{"2", "\[Pi]", "*", 
          RowBox[{
           SuperscriptBox["r", "2"], "/", 
           SuperscriptBox["d", "2"]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Mu]", "=", 
        RowBox[{"s", "/", 
         SuperscriptBox["d", "2"]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"G", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "\[Lambda]", ",", "\[Mu]"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Theta]", " ", "must", " ", "between"}], " ", "-", 
    RowBox[{
     RowBox[{"\[Pi]", "/", "2"}], " ", "and", " ", 
     RowBox[{"\[Pi]", "/", "2"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GSimple", "[", 
    RowBox[{"\[Theta]_", ",", "\[Lambda]_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "2"}], "\[LessEqual]", "\[Theta]", 
      "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"\[Mu]", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{"\[Lambda]", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", "1"}], ")"}]}], "]"}]}],
      ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApproxLight2", "[", 
     RowBox[{"\[Theta]_", ",", "x_", ",", "l_", ",", "r_", ",", "s_"}], "]"}],
     ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d", ",", "p", ",", "\[Lambda]", ",", "\[Mu]"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d", "=", 
        RowBox[{"Norm", "[", 
         RowBox[{"l", "-", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "-", "x"}], ")"}], "/", "d"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"InvFa", "[", 
         RowBox[{"2", "\[Pi]", "*", 
          RowBox[{
           SuperscriptBox["r", "2"], "/", 
           SuperscriptBox["d", "2"]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Mu]", "=", 
        RowBox[{"s", "/", 
         SuperscriptBox["d", "2"]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"GSimple", "[", 
        RowBox[{"\[Theta]", ",", "\[Lambda]", ",", "\[Mu]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApproxLightPaint", "[", 
     RowBox[{
     "\[Theta]_", ",", "shadingPos_", ",", "lightPos_", ",", "lightRadius_", 
      ",", "lightIntensity_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "SGShading", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SGShading", "=", 
        RowBox[{"ApproxLight2", "[", 
         RowBox[{
         "\[Theta]", ",", "shadingPos", ",", "lightPos", ",", "lightRadius", 
          ",", "lightIntensity"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"shadingPos", "+", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "SGShading"}], "}"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"ParametricPlot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"LightCircle", "[", 
          RowBox[{"DefaultLightCenter", ",", "radius", ",", "\[Theta]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ApproxLightPaint", "[", 
          RowBox[{"\[Theta]", ",", 
           RowBox[{"{", 
            RowBox[{"shadingPtX", ",", "0"}], "}"}], ",", 
           "DefaultLightCenter", ",", "radius", ",", "intensity"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"LightCircle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"shadingPtX", ",", "0"}], "}"}], ",", "0.1", ",", 
           "\[Theta]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "3.5"}], ",", "3.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "3.5"}], ",", "3.5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"radius", ",", "2", ",", "5"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"shadingPtX", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"intensity", ",", "1", ",", "10"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "\"\<\>\""}], ",", 
             RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<\>\""}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}]}], "|>"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<dirLines\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<angleLines\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<basicDisbs\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgDisbs\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<disbCenter\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shangingPos", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<upAxis\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], ",", 
             RowBox[{"\"\<sgLambda\>\"", "\[Rule]", "5"}], ",", 
             RowBox[{"\"\<sgMu\>\"", "\[Rule]", "1"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
             RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<\>\""}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{"\"\<shangingPos\>\"", "\[Rule]", "shangingPos"}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<groundShadings\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "3"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"lightRadius", ",", "2", ",", "5"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"shangingPos", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"intensity", ",", "1", ",", "10"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "gPrint", "[", 
   "\"\<>SG Light simulation at shading point(light-oriented SG):\>\"", "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\"\<circles\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
            RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightRadius"}]}], "|>"}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
         RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}]}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<sgDisbs\>\"", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<disbCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
            RowBox[{"\"\<sg\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", "5", ",", "1"}], 
              "}"}]}]}], "|>"}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
       RowBox[{"<|", 
        RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], "|>"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "3"}]}], "\[IndentingNewLine]",
      "|>"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "2"}], "}"}], ",", "1", ",", "5"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shangingPos", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8310098151078587`*^9, 3.8310098375509443`*^9}, {
   3.831009943711237*^9, 3.83100997958354*^9}, {3.83101012927912*^9, 
   3.831010251496069*^9}, {3.831010595526867*^9, 3.8310105980555983`*^9}, {
   3.8310106430549755`*^9, 3.831010836623004*^9}, {3.831011010465508*^9, 
   3.8310110814497285`*^9}, {3.831011134072752*^9, 3.831011165287645*^9}, 
   3.8310119997832837`*^9, {3.83101207591833*^9, 3.8310121266390953`*^9}, {
   3.831012206062169*^9, 3.8310122072695932`*^9}, {3.831012479559822*^9, 
   3.831012500407587*^9}, 3.8310125373349743`*^9, 3.831015323157586*^9, {
   3.831015393364179*^9, 3.831015522508423*^9}, {3.8310206960920677`*^9, 
   3.831020731122079*^9}, {3.8310207905069714`*^9, 3.831020837169459*^9}, {
   3.831020908289831*^9, 3.831020987547536*^9}, {3.831021037482692*^9, 
   3.8310212007326584`*^9}, {3.8310212396185446`*^9, 3.831021469224759*^9}, {
   3.8310215537221947`*^9, 3.8310216001384225`*^9}, {3.8310217168277326`*^9, 
   3.831021726720511*^9}, 3.8310218230738525`*^9, {3.8310218798577814`*^9, 
   3.831021886281022*^9}, {3.831023540416456*^9, 3.8310235723603363`*^9}, 
   3.8310707390542603`*^9, {3.831070955476513*^9, 3.8310709665869675`*^9}, 
   3.8310724022737074`*^9, {3.8310765808362865`*^9, 3.831076597087371*^9}, 
   3.831445777734026*^9, {3.8314552523598075`*^9, 3.8314552825760612`*^9}, {
   3.8314554602646465`*^9, 3.831455463151084*^9}, {3.8314555629531193`*^9, 
   3.8314555681602297`*^9}, {3.8314556648680954`*^9, 3.8314557063908215`*^9}, 
   3.8314557690157824`*^9, {3.8315205054968157`*^9, 3.83152053769529*^9}, {
   3.831520579383312*^9, 3.8315205996835566`*^9}, {3.8315207414439764`*^9, 
   3.8315207834459224`*^9}, {3.83152082350103*^9, 3.8315208567044363`*^9}, 
   3.8315208901877675`*^9, {3.8315209554567685`*^9, 
   3.8315209608997383`*^9}},ExpressionUUID->"1637b4e6-4e05-4711-8210-\
d31908663777"],

Cell[BoxData[
 StyleBox["\<\" >SG Light simulation at shading point(light-oriented SG):\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.83102356207175*^9, 3.8310235733281937`*^9}, {
   3.8310707277812634`*^9, 3.831070740421548*^9}, 3.831070967836382*^9, 
   3.8310724036261315`*^9, 3.8310728549844675`*^9, 3.8310748521128163`*^9, 
   3.831087827735916*^9, 3.8310905200351014`*^9, 3.831090996121873*^9, 
   3.831093855674285*^9, 3.831159055980851*^9, 3.831178679221532*^9, 
   3.8311794193341837`*^9, 3.8314363287622457`*^9, 3.8314406523378725`*^9, 
   3.831440891043722*^9, 3.831441326521023*^9, 3.8314457556119595`*^9, 
   3.831446497731495*^9, 3.8314470181521564`*^9, 3.8314544257783575`*^9, {
   3.831455550503689*^9, 3.8314555686837063`*^9}, 3.831455756910762*^9, 
   3.8315194371165276`*^9, 3.8315195066581216`*^9, 3.8315198658676877`*^9, {
   3.8315205155388985`*^9, 3.8315205382499332`*^9}, {3.8315207601004725`*^9, 
   3.831520784104472*^9}, {3.8315209210698657`*^9, 3.8315209377008257`*^9}},
 FontSize->18,
 CellLabel->
  "During evaluation of \
In[426]:=",ExpressionUUID->"4e737444-248f-45b6-afd8-081558df9c89"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lightCenter$$ = {-1, 
    1}, $CellContext`lightRadius$$ = 2, Typeset`show$$ = False, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-1, 1}}, {-2, -2}, {2, 2}}, {{
       Hold[$CellContext`lightRadius$$], 2}, 1, 5}}, Typeset`size$$ = {
    96., {47., 53.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$306788$$ = {0, 
    0}, $CellContext`lightRadius$306789$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`lightCenter$$ = {-1, 
         1}, $CellContext`lightRadius$$ = 2}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$306788$$, {
         0, 0}], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$306789$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> gPlots`gParamPlot[
        Association[
         ("circles" -> {
           Association[
           "center" -> Slot["lightCenter"], "radius" -> 
            Slot["lightRadius"]]}& )[
          Association[
          "lightCenter" -> $CellContext`lightCenter$$, 
           "lightRadius" -> $CellContext`lightRadius$$]], 
         ("sgDisbs" -> {
           Association[
           "disbCenter" -> Slot["lightCenter"], "sg" -> {{1, 1}, 5, 1}]}& )[
          Association["lightCenter" -> $CellContext`lightCenter$$]], 
         "axisExtent" -> 3]], 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-1, 1}}, {-2, -2}, {
         2, 2}}, {{$CellContext`lightRadius$$, 2}, 1, 5}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{147., {71., 77.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8315205382826357`*^9, {3.831520760139982*^9, 3.831520784142572*^9}, {
   3.831520921114969*^9, 3.8315209377402143`*^9}},
 CellLabel->
  "Out[433]=",ExpressionUUID->"473fdaa8-c812-467f-820d-2aad8cd977f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GSimple3", "[", 
    RowBox[{"\[Theta]_", ",", "\[Lambda]_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "2"}], "\[LessEqual]", "\[Theta]", 
      "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"\[Mu]", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{"\[Lambda]", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", "1"}], ")"}]}], "]"}]}],
      ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClipAngle", "[", "x_", "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"x", ">", "\[Pi]"}], ",", 
     RowBox[{"x", "-", 
      RowBox[{"2", "\[Pi]"}]}], ",", 
     RowBox[{"x", "<", 
      RowBox[{"-", "\[Pi]"}]}], ",", 
     RowBox[{"x", "+", 
      RowBox[{"2", "\[Pi]"}]}], ",", "True", ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApproxLight3", "[", 
    RowBox[{
    "varAngleInLightDomain_", ",", "shadingPos_", ",", "lightPos_", ",", 
     "lightRadius_", ",", "lightIntensity_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "d", ",", "axisAngle", ",", "angleOffset", ",", "p", ",", "\[Lambda]", 
       ",", "\[Mu]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{"lightPos", "-", "shadingPos"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"lightPos", "-", "shadingPos"}], ")"}], "/", "d"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"InvFa", "[", 
        RowBox[{"2", "\[Pi]", "*", 
         RowBox[{
          SuperscriptBox["lightRadius", "2"], "/", 
          SuperscriptBox["d", "2"]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{"lightIntensity", "/", 
        SuperscriptBox["d", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"axisAngle", "=", 
       RowBox[{
        RowBox[{"ToPolarCoordinates", "[", "p", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"angleOffset", "=", 
       RowBox[{"ClipAngle", "[", 
        RowBox[{"varAngleInLightDomain", "-", "axisAngle"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"GSimple3", "[", 
       RowBox[{"angleOffset", ",", "\[Lambda]", ",", "\[Mu]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApproxLightPaint3", "[", 
     RowBox[{
     "varAngleInLightDomain_", ",", "shadingPos_", ",", "lightPos_", ",", 
      "lightRadius_", ",", "lightIntensity_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sgShading", ",", "sgAxis", ",", "axisAngle", ",", "angleOffset", ",", 
        "rt"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sgAxis", "=", 
        RowBox[{"Normalize", "[", 
         RowBox[{"lightPos", "-", "shadingPos"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"axisAngle", "=", 
        RowBox[{
         RowBox[{"ToPolarCoordinates", "[", "sgAxis", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"angleOffset", "=", 
        RowBox[{"ClipAngle", "[", 
         RowBox[{"varAngleInLightDomain", "-", "axisAngle"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sgShading", "=", 
        RowBox[{"ApproxLight3", "[", 
         RowBox[{
         "varAngleInLightDomain", ",", "shadingPos", ",", "lightPos", ",", 
          "lightRadius", ",", "lightIntensity"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"RotationTransform", "[", 
            RowBox[{
             RowBox[{"axisAngle", "+", 
              RowBox[{"\[Pi]", "/", "2"}]}], ",", "lightPos"}], "]"}], "/@", 
           RowBox[{"{", 
            RowBox[{"(", 
             RowBox[{"lightPos", "+", 
              RowBox[{"{", 
               RowBox[{"angleOffset", ",", "sgShading"}], "}"}]}], ")"}], 
            "}"}]}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "//", "N"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LinePaint", "[", 
     RowBox[{"\[Theta]_", ",", "originPos_", ",", "direction_"}], "]"}], ":=", 
    RowBox[{"originPos", "+", 
     RowBox[{"\[Theta]", "*", 
      RowBox[{"Normalize", "[", "direction", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<>SG Light simulation at shading point(light-oriented SG):\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LightCircle", "[", 
        RowBox[{"DefaultLightCenter", ",", "radius", ",", "\[Theta]"}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"LightCircle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"shadingPtX", ",", "0"}], "}"}], ",", "0.1", ",", 
         "\[Theta]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ApproxLightPaint3", "[", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{"{", 
          RowBox[{"shadingPtX", ",", "0"}], "}"}], ",", "DefaultLightCenter", 
         ",", "radius", ",", "intensity"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"LinePaint", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Theta]", "+", "\[Pi]"}], ")"}], "/", "2"}], ",", 
         "DefaultLightCenter", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"shadingPtX", ",", "0"}], "}"}], "-", 
           "DefaultLightCenter"}], ")"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "Green", ",", "Blue", ",", "Blue"}], "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3.5"}], ",", "3.5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3.5"}], ",", "3.5"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"radius", ",", "2", ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"shadingPtX", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"intensity", ",", "1", ",", "10"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8310747780568094`*^9, 3.8310747985516*^9}, {
   3.831074834562177*^9, 3.831074876016758*^9}, {3.8310749380024486`*^9, 
   3.8310750036727934`*^9}, {3.83107504131153*^9, 3.83107507590447*^9}, {
   3.8310751272486296`*^9, 3.8310751329682865`*^9}, {3.8310751800478086`*^9, 
   3.831075216930641*^9}, {3.8310752492797637`*^9, 3.8310752699140377`*^9}, {
   3.83107529999417*^9, 3.831075336649002*^9}, {3.8310753698011694`*^9, 
   3.8310754223042183`*^9}, {3.8310754902491026`*^9, 3.831075509096416*^9}, {
   3.831075591705349*^9, 3.8310755934248457`*^9}, {3.831075673640483*^9, 
   3.831075680769942*^9}, {3.8310758115845766`*^9, 3.8310759798404317`*^9}, {
   3.831076011617002*^9, 3.831076017567231*^9}, {3.8310760486653304`*^9, 
   3.831076076834065*^9}, {3.831076340442236*^9, 3.8310763697189484`*^9}, {
   3.831076401287654*^9, 3.831076414136591*^9}, {3.8310764463148212`*^9, 
   3.831076447182786*^9}, {3.8310767649052725`*^9, 3.831076853871693*^9}, {
   3.83107824462424*^9, 3.831078268134577*^9}, {3.831083368219407*^9, 
   3.831083368435828*^9}, {3.8310835466674767`*^9, 3.8310838879486656`*^9}, {
   3.831083938325117*^9, 3.83108403277127*^9}, {3.8310841003322086`*^9, 
   3.8310841518505344`*^9}, {3.8310841930200996`*^9, 3.8310844437557783`*^9}, 
   3.8310845728999414`*^9, {3.8310847044847736`*^9, 3.8310847258605328`*^9}, {
   3.831084810171028*^9, 3.831084853235195*^9}, {3.831084910609787*^9, 
   3.831084998498553*^9}, {3.8310850404431653`*^9, 3.8310851616175575`*^9}, 
   3.8310852136193495`*^9, {3.8310852460435376`*^9, 3.831085335740028*^9}, {
   3.831085367038966*^9, 3.831085396834499*^9}, {3.831085469061909*^9, 
   3.831085514921522*^9}},
 CellLabel->
  "In[332]:=",ExpressionUUID->"381c6a79-bb67-4f79-95e1-2db68a817d0e"],

Cell[BoxData["\<\">SG Light simulation at shading point(light-oriented SG):\"\
\>"], "Print",
 CellChangeTimes->{{3.8310854703265667`*^9, 3.8310854922912784`*^9}, 
   3.8310878280720177`*^9, 3.8310905204061093`*^9, 3.8310909964854417`*^9, 
   3.8310938557979226`*^9, 3.8311590561274595`*^9, 3.831178679665883*^9, 
   3.8311794195439005`*^9, 3.8314363289288015`*^9, 3.831440652692467*^9, 
   3.831440891169623*^9, 3.8314413266337214`*^9, 3.8314457558373713`*^9, 
   3.8314464979150057`*^9, 3.831447018363694*^9, 3.8314544259883337`*^9, 
   3.8315194372965326`*^9, 3.8315195068231645`*^9, 3.831519866024269*^9},
 FontSize->18,
 CellLabel->
  "During evaluation of \
In[332]:=",ExpressionUUID->"3123fecd-671e-44c0-8c5f-8eda59d430f7"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`intensity$$ = 1, $CellContext`radius$$ = 
    2, $CellContext`shadingPtX$$ = -Pi, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`radius$$], 2, 5}, {
      Hold[$CellContext`shadingPtX$$], -Pi, Pi}, {
      Hold[$CellContext`intensity$$], 1, 10}}, Typeset`size$$ = {
    360., {177., 183.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`radius$260959$$ = 
    0, $CellContext`shadingPtX$260960$$ = 0, $CellContext`intensity$260961$$ =
     0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`intensity$$ = 1, $CellContext`radius$$ = 
        2, $CellContext`shadingPtX$$ = -Pi}, "ControllerVariables" :> {
        Hold[$CellContext`radius$$, $CellContext`radius$260959$$, 0], 
        Hold[$CellContext`shadingPtX$$, $CellContext`shadingPtX$260960$$, 0], 
        Hold[$CellContext`intensity$$, $CellContext`intensity$260961$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ParametricPlot[{
         $CellContext`LightCircle[$CellContext`DefaultLightCenter, \
$CellContext`radius$$, $CellContext`\[Theta]], 
         $CellContext`LightCircle[{$CellContext`shadingPtX$$, 0}, 
          0.1, $CellContext`\[Theta]], 
         $CellContext`ApproxLightPaint3[$CellContext`\[Theta], \
{$CellContext`shadingPtX$$, 
           0}, $CellContext`DefaultLightCenter, $CellContext`radius$$, \
$CellContext`intensity$$], 
         $CellContext`LinePaint[($CellContext`\[Theta] + Pi)/
          2, $CellContext`DefaultLightCenter, {$CellContext`shadingPtX$$, 
            0} - $CellContext`DefaultLightCenter]}, {$CellContext`\[Theta], -
         Pi, Pi}, PlotStyle -> {Green, Green, Blue, Blue}, 
        PlotRange -> {{-3.5, 3.5}, {-3.5, 3.5}}, AspectRatio -> 1], 
      "Specifications" :> {{$CellContext`radius$$, 2, 
         5}, {$CellContext`shadingPtX$$, -Pi, Pi}, {$CellContext`intensity$$, 
         1, 10}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{411., {252., 258.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.831075907472064*^9, 3.8310759804977174`*^9}, 
   3.8310760179272423`*^9, {3.8310760491983166`*^9, 3.8310760778730345`*^9}, 
   3.8310764157920732`*^9, 3.831076447912897*^9, 3.831076608301643*^9, {
   3.831078225574572*^9, 3.8310782450934687`*^9}, {3.8310838292687464`*^9, 
   3.831083867059559*^9}, 3.8310839911450143`*^9, 3.831084033656878*^9, {
   3.8310841082665195`*^9, 3.831084153171633*^9}, {3.8310844109155426`*^9, 
   3.831084444512399*^9}, 3.8310845738226147`*^9, {3.831084717748734*^9, 
   3.831084728952089*^9}, {3.8310849132178125`*^9, 3.831084917352991*^9}, {
   3.831084973398016*^9, 3.831084999223524*^9}, {3.831085051505965*^9, 
   3.8310850898326073`*^9}, 3.8310851641428823`*^9, 3.831085214729034*^9, {
   3.8310852645453234`*^9, 3.831085278055312*^9}, {3.8310853119442782`*^9, 
   3.8310853367468147`*^9}, {3.8310853692670665`*^9, 
   3.8310853973810687`*^9}, {3.83108547037045*^9, 3.831085492333167*^9}, 
   3.8310878281168976`*^9, 3.8310905204529543`*^9, 3.831090996523369*^9, 
   3.8310938558198643`*^9, 3.8311590561544175`*^9, 3.83117867972971*^9, 
   3.831179419598754*^9, 3.8314363289812593`*^9, 3.831440652705433*^9, 
   3.831440891195557*^9, 3.8314413266466875`*^9, 3.8314457558807635`*^9, 
   3.831446497961881*^9, 3.831447018415514*^9, 3.8314544260541596`*^9, 
   3.831519437336712*^9, 3.8315195068580427`*^9, 3.831519866056184*^9},
 CellLabel->
  "Out[338]=",ExpressionUUID->"869487b0-3298-4c7a-8370-b7d8ef67107d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sgIntegral", "[", 
    RowBox[{"\[Lambda]_", ",", 
     RowBox[{"\[Mu]_:", "1"}]}], "]"}], ":=", 
   RowBox[{"\[Mu]", "*", "2", "\[Pi]", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "2"}], "\[Lambda]"}], "]"}]}], ")"}], "/", 
     "\[Lambda]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApproxLight4", "[", 
    RowBox[{
    "xOffset_", ",", "lightPos_", ",", "lightRadius_", ",", 
     "lightIntensity_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "d", ",", "shadingPos", ",", "p1", ",", "\[Lambda]1", ",", "\[Mu]1"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"shadingPos", "=", 
       RowBox[{"{", 
        RowBox[{"xOffset", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{"lightPos", "-", "shadingPos"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Point", " ", "Light", " ", "SG"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"p1", "=", 
       RowBox[{"Normalize", "[", 
        RowBox[{"lightPos", "-", "shadingPos"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]1", "=", 
       RowBox[{"InvFa", "[", 
        RowBox[{"2", "\[Pi]", "*", 
         RowBox[{
          SuperscriptBox["lightRadius", "2"], "/", 
          SuperscriptBox["d", "2"]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]1", "=", 
       RowBox[{"lightIntensity", "/", 
        SuperscriptBox["d", "2"]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sgIntegral", "[", 
       RowBox[{"\[Lambda]1", ",", "\[Mu]1"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApproxLightPaint4", "[", 
     RowBox[{
     "xOffset_", ",", "lightPos_", ",", "lightRadius_", ",", 
      "lightIntensity_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "sgEnergy1", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sgEnergy1", "=", 
        RowBox[{"ApproxLight4", "[", 
         RowBox[{
         "xOffset", ",", "lightPos", ",", "lightRadius", ",", 
          "lightIntensity"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"{", 
        RowBox[{"xOffset", ",", "sgEnergy1"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<>SG Light Energy(at Ground):\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LightCircle", "[", 
        RowBox[{"DefaultLightCenter", ",", "radius", ",", "xOffset"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ApproxLightPaint4", "[", 
        RowBox[{
        "xOffset", ",", "DefaultLightCenter", ",", "radius", ",", 
         "intensity"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"xOffset", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "Blue"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3.5"}], ",", "3.5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3.5"}], ",", "3.5"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"radius", ",", "2", ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"intensity", ",", "1", ",", "10"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8310927108787737`*^9, 3.8310927163743453`*^9}, 
   3.8310927517982073`*^9, {3.8310928088861094`*^9, 3.831092981383458*^9}, {
   3.8310930229598556`*^9, 3.83109307972599*^9}, {3.831093156302052*^9, 
   3.831093183237785*^9}, {3.8310959301001863`*^9, 3.831095933038507*^9}},
 CellLabel->
  "In[339]:=",ExpressionUUID->"34dc8b9a-10cf-455f-9c89-4de3b5934093"],

Cell[BoxData["\<\">SG Light Energy(at Ground):\"\>"], "Print",
 CellChangeTimes->{{3.831093174381605*^9, 3.8310931855356407`*^9}, 
   3.8310938564233456`*^9, 3.831159056780259*^9, 3.8311786801999364`*^9, 
   3.8311794200709753`*^9, 3.831436329519807*^9, 3.8314406533597765`*^9, 
   3.831440891659853*^9, 3.8314413270434637`*^9, 3.831445756327568*^9, 
   3.8314464984191885`*^9, 3.8314470188512497`*^9, 3.8314544265004416`*^9, 
   3.83151943778132*^9, 3.831519507251414*^9, 3.831519866477736*^9},
 FontSize->18,
 CellLabel->
  "During evaluation of \
In[339]:=",ExpressionUUID->"f172525a-6317-4045-b640-04ccebc5a75c"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`intensity$$ = 1, $CellContext`radius$$ = 2, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`radius$$], 2, 5}, {
      Hold[$CellContext`intensity$$], 1, 10}}, Typeset`size$$ = {
    360., {177., 183.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`radius$261421$$ = 
    0, $CellContext`intensity$261422$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`intensity$$ = 1, $CellContext`radius$$ = 
        2}, "ControllerVariables" :> {
        Hold[$CellContext`radius$$, $CellContext`radius$261421$$, 0], 
        Hold[$CellContext`intensity$$, $CellContext`intensity$261422$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ParametricPlot[{
         $CellContext`LightCircle[$CellContext`DefaultLightCenter, \
$CellContext`radius$$, $CellContext`xOffset], 
         $CellContext`ApproxLightPaint4[$CellContext`xOffset, \
$CellContext`DefaultLightCenter, $CellContext`radius$$, \
$CellContext`intensity$$]}, {$CellContext`xOffset, -Pi, Pi}, 
        PlotStyle -> {Green, Blue}, PlotRange -> {{-3.5, 3.5}, {-3.5, 3.5}}, 
        AspectRatio -> 1], 
      "Specifications" :> {{$CellContext`radius$$, 2, 
         5}, {$CellContext`intensity$$, 1, 10}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {238., 244.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8310927146236305`*^9, 3.831092988129718*^9, {3.8310930238483677`*^9, 
   3.831093080499157*^9}, {3.831093174435461*^9, 3.8310931855825152`*^9}, 
   3.8310938564463215`*^9, 3.831159056818166*^9, 3.831178680268756*^9, 
   3.8311794201367993`*^9, 3.831436329561695*^9, 3.83144065337673*^9, 
   3.8314408916797996`*^9, 3.8314413270554314`*^9, 3.831445756376438*^9, 
   3.831446498462212*^9, 3.831447018894106*^9, 3.8314544265652685`*^9, 
   3.8315194378214216`*^9, 3.8315195072752666`*^9, 3.8315198664966855`*^9},
 CellLabel->
  "Out[343]=",ExpressionUUID->"ae5c497e-4605-4c43-80d1-de43b8df1d2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefaultDiffuseColor", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sgDot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1_", ",", "\[Lambda]1_", ",", "\[Mu]1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p2_", ",", "\[Lambda]2_", ",", "\[Mu]2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"4", "\[Pi]", "*", "\[Mu]1", "*", "\[Mu]2", "*", 
    RowBox[{
     RowBox[{"Sinh", "[", 
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"p1", "*", "\[Lambda]1"}], "+", 
        RowBox[{"p2", "*", "\[Lambda]2"}]}], "]"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], "]"}], "*", 
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{"p1", "*", "\[Lambda]1"}], "+", 
         RowBox[{"p2", "*", "\[Lambda]2"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sgDiffuse", "[", 
     RowBox[{"diffuseCol_", ",", 
      RowBox[{"{", 
       RowBox[{"p1_", ",", "\[Lambda]1_", ",", "\[Mu]1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p2_", ",", "\[Lambda]2_", ",", "\[Mu]2_"}], "}"}]}], "]"}], 
    "=", 
    RowBox[{
     FractionBox["diffuseCol", "\[Pi]"], 
     RowBox[{"sgDot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "\[Lambda]1", ",", "\[Mu]1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p2", ",", "\[Lambda]2", ",", "\[Mu]2"}], "}"}]}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DiffuseLighting", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApproxLight5", "[", 
     RowBox[{
     "xOffset_", ",", "lightPos_", ",", "lightRadius_", ",", 
      "lightIntensity_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "d", ",", "shadingPos", ",", "p1", ",", "\[Lambda]1", ",", "\[Mu]1", 
        ",", "p2", ",", "\[Lambda]2", ",", "\[Mu]2", ",", "diffuse"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"shadingPos", "=", 
        RowBox[{"{", 
         RowBox[{"xOffset", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Norm", "[", 
         RowBox[{"lightPos", "-", "shadingPos"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Point", " ", "Light", " ", "SG"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"p1", "=", 
        RowBox[{"Normalize", "[", 
         RowBox[{"lightPos", "-", "shadingPos"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]1", "=", 
        RowBox[{"InvFa", "[", 
         RowBox[{"2", "\[Pi]", "*", 
          RowBox[{
           SuperscriptBox["lightRadius", "2"], "/", 
           SuperscriptBox["d", "2"]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Mu]1", "=", 
        RowBox[{"lightIntensity", "/", 
         SuperscriptBox["d", "2"]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Clamped", " ", "Cosine", " ", "SG"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"p2", "=", "p1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]2", "=", "2.01906"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Mu]2", "=", "1.077094"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"sgDiffuse", "[", 
        RowBox[{"DefaultDiffuseColor", ",", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "\[Lambda]1", ",", "\[Mu]1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "\[Lambda]2", ",", "\[Mu]2"}], "}"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApproxLightPaint5", "[", 
     RowBox[{
     "xOffset_", ",", "lightPos_", ",", "lightRadius_", ",", 
      "lightIntensity_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "sgShading", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sgShading", "=", 
        RowBox[{"ApproxLight5", "[", 
         RowBox[{
         "xOffset", ",", "lightPos", ",", "lightRadius", ",", 
          "lightIntensity"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"{", 
        RowBox[{"xOffset", ",", "sgShading"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<>SG Diffse Lighting(at Ground):\>\"", " ", 
    RowBox[{"HoldForm", "[", 
     RowBox[{
      FractionBox[
       SubscriptBox["C", "diffuse"], "\[Pi]"], "*", 
      RowBox[{"Convolve", "[", 
       RowBox[{
        SubscriptBox["SG", "light"], ",", 
        SubscriptBox["SG", "ClampedCosine"], ",", "p1", ",", "p2"}], "]"}]}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LightCircle", "[", 
        RowBox[{"DefaultLightCenter", ",", "radius", ",", "xOffset"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ApproxLightPaint5", "[", 
        RowBox[{
        "xOffset", ",", "DefaultLightCenter", ",", "radius", ",", 
         "intensity"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"xOffset", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "Blue"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3.5"}], ",", "3.5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3.5"}], ",", "3.5"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"radius", ",", "1", ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"intensity", ",", "1", ",", "10"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.831086993130113*^9, 3.8310869955604925`*^9}, {
   3.831087259304553*^9, 3.831087303631496*^9}, {3.831087341689257*^9, 
   3.831087354672201*^9}, {3.831087396752536*^9, 3.8310874715843287`*^9}, {
   3.831087880234663*^9, 3.8310879283231444`*^9}, 3.8310879851129446`*^9, {
   3.831088112761607*^9, 3.831088158607603*^9}, {3.831088282352623*^9, 
   3.831088282712999*^9}, {3.8310883164247446`*^9, 3.8310883231626105`*^9}, {
   3.8310884277117743`*^9, 3.8310884402481613`*^9}, {3.831088599027294*^9, 
   3.831088652760061*^9}, {3.831088882243847*^9, 3.831088915232225*^9}, {
   3.831088966704708*^9, 3.831089187288596*^9}, {3.8310892235698814`*^9, 
   3.8310892384323487`*^9}, {3.8310892715601006`*^9, 
   3.8310897820810804`*^9}, {3.831090022566903*^9, 3.831090089672423*^9}, {
   3.831090138248274*^9, 3.8310901414552116`*^9}, {3.8310901796169696`*^9, 
   3.831090202402773*^9}, {3.8310902658905516`*^9, 3.831090268487155*^9}, {
   3.8310903026816645`*^9, 3.8310903369209957`*^9}, {3.8310903853539586`*^9, 
   3.831090455351734*^9}, {3.8310905461679163`*^9, 3.8310909632253885`*^9}, {
   3.831091001769411*^9, 3.8310910442734146`*^9}, {3.831091074945692*^9, 
   3.8310910829023285`*^9}, {3.83109117415096*^9, 3.831091180145255*^9}, {
   3.8310913851751328`*^9, 3.8310914213514743`*^9}, {3.831091451854615*^9, 
   3.831091512312651*^9}, {3.8310915702407074`*^9, 3.8310916085195403`*^9}, {
   3.831091640728747*^9, 3.8310917412388043`*^9}, {3.831092484823759*^9, 
   3.8310925046391287`*^9}, {3.831092724919196*^9, 3.831092731067273*^9}, 
   3.8311794480290847`*^9},
 CellLabel->
  "In[344]:=",ExpressionUUID->"732f6ef7-9c04-45c8-a7df-4717281d7cb0"],

Cell[BoxData[
 RowBox[{"\<\">SG Diffse Lighting(at Ground):\"\>", " ", 
  TagBox[
   FractionBox[
    RowBox[{
     SubscriptBox["C", "diffuse"], " ", 
     RowBox[{"Convolve", "[", 
      RowBox[{
       SubscriptBox["SG", "light"], ",", 
       SubscriptBox["SG", "ClampedCosine"], ",", "p1", ",", "p2"}], "]"}]}], 
    "\[Pi]"],
   HoldForm]}]], "Print",
 CellChangeTimes->{{3.8310917111471996`*^9, 3.831091742174737*^9}, 
   3.8310925051388006`*^9, 3.831092733050682*^9, 3.831093856543025*^9, 
   3.831159056926123*^9, 3.831178680414407*^9, {3.831179420517927*^9, 
   3.8311794489154067`*^9}, 3.831436329679407*^9, 3.83144065346051*^9, 
   3.83144089176956*^9, 3.831441327135217*^9, 3.831445756496117*^9, 
   3.831446498580864*^9, 3.8314470190113287`*^9, 3.8314544268046284`*^9, 
   3.8315194379181614`*^9, 3.8315195073613057`*^9, 3.8315198665811896`*^9},
 FontSize->18,
 CellLabel->
  "During evaluation of \
In[344]:=",ExpressionUUID->"58b0d4be-7f22-40db-89ea-9644239973ad"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`intensity$$ = 1, $CellContext`radius$$ = 1, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`radius$$], 1, 5}, {
      Hold[$CellContext`intensity$$], 1, 10}}, Typeset`size$$ = {
    360., {177., 183.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`radius$261749$$ = 
    0, $CellContext`intensity$261750$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`intensity$$ = 1, $CellContext`radius$$ = 
        1}, "ControllerVariables" :> {
        Hold[$CellContext`radius$$, $CellContext`radius$261749$$, 0], 
        Hold[$CellContext`intensity$$, $CellContext`intensity$261750$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ParametricPlot[{
         $CellContext`LightCircle[$CellContext`DefaultLightCenter, \
$CellContext`radius$$, $CellContext`xOffset], 
         $CellContext`ApproxLightPaint5[$CellContext`xOffset, \
$CellContext`DefaultLightCenter, $CellContext`radius$$, \
$CellContext`intensity$$]}, {$CellContext`xOffset, -Pi, Pi}, 
        PlotStyle -> {Green, Blue}, PlotRange -> {{-3.5, 3.5}, {-3.5, 3.5}}, 
        AspectRatio -> 1], 
      "Specifications" :> {{$CellContext`radius$$, 1, 
         5}, {$CellContext`intensity$$, 1, 10}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {238., 244.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.831091711191081*^9, 3.831091742228625*^9}, 
   3.831092505177697*^9, 3.831092733097556*^9, 3.831093856564966*^9, 
   3.831159056953052*^9, 3.8311786804662676`*^9, {3.8311794205817275`*^9, 
   3.8311794489782395`*^9}, 3.831436329720272*^9, 3.831440653477477*^9, 
   3.831440891797489*^9, 3.83144132714918*^9, 3.831445756540998*^9, 
   3.831446498624747*^9, 3.8314470190601683`*^9, 3.8314544268565187`*^9, 
   3.8315194379548144`*^9, 3.831519507385145*^9, 3.8315198666018734`*^9},
 CellLabel->
  "Out[351]=",ExpressionUUID->"c94a83ad-91c5-4fa8-aded-7cdded728888"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<>New Fit SG Diffse Lighting(at Ground):\>\"", " ", 
     RowBox[{"HoldForm", "[", 
      FractionBox[
       SubscriptBox["C", "diffuse"], "\[Pi]"], "]"}], "*", 
     RowBox[{"HoldForm", "[", 
      RowBox[{
       SubscriptBox["SG", "light"], "\[CircleTimes]", 
       SubscriptBox["SG", "ClampedCosine"]}], "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sgAmplitude6", "[", 
    RowBox[{"t_", ",", "a_", ",", "b_", ",", "c_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"a", "*", 
     RowBox[{"t", "^", "2"}]}], "+", 
    RowBox[{"b", "*", "t"}], "+", "c"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sgSharpness6", "[", 
     RowBox[{"percent_", ",", "d_", ",", "e_", ",", "f_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"d", "*", 
      RowBox[{"percent", "^", "2"}]}], "+", 
     RowBox[{"e", "*", "percent"}], "+", "f"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RadiusParams", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.791375", ",", 
        RowBox[{"-", "1.89057"}], ",", "1.0872", ",", "6.66654", ",", 
        RowBox[{"-", "10.8249"}], ",", "6.76642"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.340146"}], ",", "0.0665636", ",", "0.236471", ",", 
        "3.79125", ",", "0.618155", ",", "1.38885"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0.385139", ",", 
        RowBox[{"-", "0.87285"}], ",", "0.485253", ",", "1.80957", ",", 
        "0.308354", ",", "2.7173"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0.213239", ",", 
        RowBox[{"-", "0.506706"}], ",", "0.291679", ",", "1.83615", ",", 
        "2.49729", ",", "1.51728"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0.128335", ",", 
        RowBox[{"-", "0.316743"}], ",", "0.187358", ",", "2.15074", ",", 
        "3.59944", ",", "0.786432"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApproxLight6", "[", 
     RowBox[{
     "xOffset_", ",", "lightPos_", ",", "lightRadius_", ",", 
      "lightIntensity_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "d", ",", "distPercent", ",", "shadingPos", ",", "p1", ",", 
        "\[Lambda]1", ",", "\[Mu]1", ",", "p2", ",", "\[Lambda]2", ",", 
        "\[Mu]2", ",", "diffuse"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"shadingPos", "=", 
        RowBox[{"{", 
         RowBox[{"xOffset", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Norm", "[", 
         RowBox[{"lightPos", "-", "shadingPos"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"distPercent", "=", 
        RowBox[{"d", "/", "lightRadius"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Point", " ", "Light", " ", "SG"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"p1", "=", 
        RowBox[{"Normalize", "[", 
         RowBox[{"lightPos", "-", "shadingPos"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]1", "=", 
        RowBox[{"sgSharpness6", "[", 
         RowBox[{"distPercent", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"RadiusParams", "[", 
            RowBox[{"[", "lightRadius", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"RadiusParams", "[", 
            RowBox[{"[", "lightRadius", "]"}], "]"}], "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"RadiusParams", "[", 
            RowBox[{"[", "lightRadius", "]"}], "]"}], "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Mu]1", "=", 
        RowBox[{"lightIntensity", "*", 
         RowBox[{"sgAmplitude6", "[", 
          RowBox[{"distPercent", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"RadiusParams", "[", 
             RowBox[{"[", "lightRadius", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"RadiusParams", "[", 
             RowBox[{"[", "lightRadius", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"RadiusParams", "[", 
             RowBox[{"[", "lightRadius", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Clamped", " ", "Cosine", " ", "SG"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"p2", "=", "p1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]2", "=", "2.01906"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Mu]2", "=", "1.077094"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"sgDiffuse", "[", 
        RowBox[{"DefaultDiffuseColor", ",", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "\[Lambda]1", ",", "\[Mu]1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "\[Lambda]2", ",", "\[Mu]2"}], "}"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApproxLightPaint6", "[", 
     RowBox[{
     "xOffset_", ",", "lightPos_", ",", "lightRadius_", ",", 
      "lightIntensity_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "sgShading", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sgShading", "=", 
        RowBox[{"ApproxLight6", "[", 
         RowBox[{
         "xOffset", ",", "lightPos", ",", "lightRadius", ",", 
          "lightIntensity"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"{", 
        RowBox[{"xOffset", ",", "sgShading"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LightCircle", "[", 
        RowBox[{"DefaultLightCenter", ",", "radius", ",", "xOffset"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ApproxLightPaint6", "[", 
        RowBox[{
        "xOffset", ",", "DefaultLightCenter", ",", "radius", ",", 
         "intensity"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"xOffset", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "Blue"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3.5"}], ",", "3.5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3.5"}], ",", "3.5"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"radius", ",", "1", ",", "5", ",", "1"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"intensity", ",", "1", ",", "10"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.831178774034602*^9, 3.831179112081008*^9}, {
   3.831179142405552*^9, 3.83117914305584*^9}, {3.8311791986904106`*^9, 
   3.8311792168510585`*^9}, 3.831179424164754*^9, {3.831351956402111*^9, 
   3.8313519619466114`*^9}, {3.831351993552373*^9, 3.8313520364764366`*^9}, {
   3.8313522381066484`*^9, 3.8313522583217297`*^9}, {3.831352297249897*^9, 
   3.8313523180268383`*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"cbf6018d-0340-4a9c-aecb-9f811df172d3"],

Cell[BoxData[
 RowBox[{"\<\">New Fit SG Diffse Lighting(at Ground):\"\>", " ", 
  TagBox[
   FractionBox[
    SubscriptBox["C", "diffuse"], "\[Pi]"],
   HoldForm], " ", 
  TagBox[
   RowBox[{
    SubscriptBox["SG", "light"], "\[CircleTimes]", 
    SubscriptBox["SG", "ClampedCosine"]}],
   HoldForm]}]], "Print",
 CellChangeTimes->{
  3.8313522593158073`*^9, {3.8313522995220847`*^9, 3.831352318648275*^9}, 
   3.8314363298329983`*^9, 3.8314406535662236`*^9, 3.8314408919042006`*^9, 
   3.831441327231958*^9, 3.8314457567414613`*^9, 3.831446498860148*^9, 
   3.831447019291549*^9, 3.831454426976199*^9, 3.8315194381284885`*^9, 
   3.8315195074722548`*^9, 3.8315198666872907`*^9},
 CellLabel->
  "During evaluation of \
In[352]:=",ExpressionUUID->"dae71ca1-f0c6-4113-ab4b-6b2ee9250779"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`intensity$$ = 1, $CellContext`radius$$ = 1, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`radius$$], 1, 5, 1}, {
      Hold[$CellContext`intensity$$], 1, 10}}, Typeset`size$$ = {
    360., {177., 183.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`radius$262077$$ = 
    0, $CellContext`intensity$262078$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`intensity$$ = 1, $CellContext`radius$$ = 
        1}, "ControllerVariables" :> {
        Hold[$CellContext`radius$$, $CellContext`radius$262077$$, 0], 
        Hold[$CellContext`intensity$$, $CellContext`intensity$262078$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ParametricPlot[{
         $CellContext`LightCircle[$CellContext`DefaultLightCenter, \
$CellContext`radius$$, $CellContext`xOffset], 
         $CellContext`ApproxLightPaint6[$CellContext`xOffset, \
$CellContext`DefaultLightCenter, $CellContext`radius$$, \
$CellContext`intensity$$]}, {$CellContext`xOffset, -Pi, Pi}, 
        PlotStyle -> {Green, Blue}, PlotRange -> {{-3.5, 3.5}, {-3.5, 3.5}}, 
        AspectRatio -> 1], 
      "Specifications" :> {{$CellContext`radius$$, 1, 5, 
         1}, {$CellContext`intensity$$, 1, 10}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {238., 244.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8313522593686657`*^9, {3.8313522995819254`*^9, 3.8313523186991386`*^9}, 
   3.831436329878848*^9, 3.8314406535801864`*^9, 3.831440891928136*^9, 
   3.831441327241933*^9, 3.831445756789263*^9, 3.8314464989169674`*^9, 
   3.8314470193454065`*^9, 3.831454427032048*^9, 3.83151943817134*^9, 
   3.8315195074977503`*^9, 3.831519866706814*^9},
 CellLabel->
  "Out[358]=",ExpressionUUID->"d5db3e29-af46-4060-870c-cb2be2e71bcf"]
}, Open  ]]
},
WindowSize->{966, 803},
WindowMargins->{{102, Automatic}, {-37, Automatic}},
Visible->True,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 3153, 78, 257, "Input",ExpressionUUID->"84e62f8d-164c-477f-b0ff-b9717f848734"],
Cell[3736, 102, 733, 12, 22, "Print",ExpressionUUID->"e94416d7-747d-4b12-b949-03bf0b2003d3"],
Cell[4472, 116, 3534, 96, 149, "Output",ExpressionUUID->"4d7bb9e0-d55a-466f-91bb-153c154c4468"],
Cell[CellGroupData[{
Cell[8031, 216, 670, 11, 30, "Print",ExpressionUUID->"ce155d61-1f1d-49e4-b750-0b1b91e30fd4"],
Cell[8704, 229, 632, 11, 30, "Print",ExpressionUUID->"ad60fa2d-28e1-46b6-8d38-9133f3066218"]
}, Open  ]],
Cell[9351, 243, 3500, 96, 248, "Output",ExpressionUUID->"6a505c89-8198-453a-a2ec-9a6b8789fa0b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12888, 344, 1153, 26, 48, "Input",ExpressionUUID->"e76d50d8-5936-4cd0-bf21-a005eddd32e9"],
Cell[14044, 372, 912, 14, 30, "Print",ExpressionUUID->"1c34808e-4e1d-46df-9c47-75bb99a0b2a5"],
Cell[14959, 388, 1262, 27, 67, "Output",ExpressionUUID->"e7594854-4ad4-4e13-b272-e197b9a1fccf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16258, 420, 2530, 69, 200, "Input",ExpressionUUID->"0876f533-9363-4091-8845-cda44bb647c2"],
Cell[CellGroupData[{
Cell[18813, 493, 1551, 31, 34, "Print",ExpressionUUID->"ca94e5f1-7186-4c40-9f56-d2130fd317da"],
Cell[20367, 526, 1500, 29, 67, "Print",ExpressionUUID->"b244cff3-4cef-4e9b-80c4-3595d621d13b"],
Cell[21870, 557, 1383, 22, 30, "Print",ExpressionUUID->"76108d8d-5e8b-4aab-bb72-34928123ffb8"]
}, Open  ]],
Cell[23268, 582, 9526, 189, 214, "Output",ExpressionUUID->"abb57625-4d2d-4391-a676-4b10932c1494"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32831, 776, 4973, 102, 352, "Input",ExpressionUUID->"4194c259-f62c-4c25-bb7c-30ef74a0669d"],
Cell[37807, 880, 612, 13, 30, "Print",ExpressionUUID->"a05aaf85-6e0c-4ddf-8305-2a991c029056"],
Cell[38422, 895, 3255, 65, 167, "Output",ExpressionUUID->"63ba8ec4-61b1-42a4-83be-c434deddfc48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41714, 965, 3272, 77, 314, "Input",ExpressionUUID->"7bdef0d5-6464-4074-9b2c-8a89e272c38b"],
Cell[44989, 1044, 1337, 23, 30, "Print",ExpressionUUID->"0f7f9311-0eab-447a-a80a-aee883117d36"],
Cell[46329, 1069, 3908, 74, 167, "Output",ExpressionUUID->"c5abec4f-52bf-49f4-b69e-71e1a13bacb4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50274, 1148, 13240, 317, 1411, "Input",ExpressionUUID->"1637b4e6-4e05-4711-8210-d31908663777"],
Cell[63517, 1467, 1190, 20, 30, "Print",ExpressionUUID->"4e737444-248f-45b6-afd8-081558df9c89"],
Cell[64710, 1489, 2761, 57, 167, "Output",ExpressionUUID->"473fdaa8-c812-467f-820d-2aad8cd977f3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67508, 1551, 8975, 216, 692, "Input",ExpressionUUID->"381c6a79-bb67-4f79-95e1-2db68a817d0e"],
Cell[76486, 1769, 730, 12, 30, "Print",ExpressionUUID->"3123fecd-671e-44c0-8c5f-8eda59d430f7"],
Cell[77219, 1783, 4332, 74, 529, "Output",ExpressionUUID->"869487b0-3298-4c7a-8370-b7d8ef67107d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81588, 1862, 4458, 116, 540, "Input",ExpressionUUID->"34dc8b9a-10cf-455f-9c89-4de3b5934093"],
Cell[86049, 1980, 616, 10, 30, "Print",ExpressionUUID->"f172525a-6317-4045-b640-04ccebc5a75c"],
Cell[86668, 1992, 2840, 53, 501, "Output",ExpressionUUID->"ae5c497e-4605-4c43-80d1-de43b8df1d2e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89545, 2050, 8039, 193, 786, "Input",ExpressionUUID->"732f6ef7-9c04-45c8-a7df-4717281d7cb0"],
Cell[97587, 2245, 980, 22, 51, "Print",ExpressionUUID->"58b0d4be-7f22-40db-89ea-9644239973ad"],
Cell[98570, 2269, 2807, 52, 501, "Output",ExpressionUUID->"c94a83ad-91c5-4fa8-aded-7cdded728888"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101414, 2326, 8123, 201, 883, "Input",ExpressionUUID->"cbf6018d-0340-4a9c-aecb-9f811df172d3"],
Cell[109540, 2529, 785, 19, 41, "Print",ExpressionUUID->"dae71ca1-f0c6-4113-ab4b-6b2ee9250779"],
Cell[110328, 2550, 2674, 51, 501, "Output",ExpressionUUID->"d5db3e29-af46-4060-870c-cb2be2e71bcf"]
}, Open  ]]
}
]
*)

