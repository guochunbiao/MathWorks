(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    168728,       3677]
NotebookOptionsPosition[    166542,       3635]
NotebookOutlinePosition[    166885,       3650]
CellTagsIndexPosition[    166842,       3647]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gUtils`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<sgCommon`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gBRDF`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<gPlots3D`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<gSphericalCap`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Cone Cut SG Lobe(Point Light)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "oldLightSg2D", ",", "oldLightSg3D", ",", "newLightSg3D", ",", 
    "newLightSg2D", ",", "bentCone", ",", "coneTheta2D", ",", "coneAperture", 
    ",", "coneCapAxis", ",", "coneCap"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"oldLightSg2D", "=", 
     RowBox[{
      RowBox[{"sgPointLightNew", "[", 
       RowBox[{"lightCenter", ",", "lightRadius", ",", "lightIntensity", ",", 
        RowBox[{"{", 
         RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}], "//", "N"}]}], 
    ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"oldLightSg3D", "=", 
     RowBox[{"sgTo3D", "[", "oldLightSg2D", "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"bentCone", "=", 
     RowBox[{
      RowBox[{"gCreateCone", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"shadingPosX", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}], "//", "N"}]}],
     ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"coneTheta2D", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneAperture", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCapAxis", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "coneTheta2D", "]"}], ",", "0", ",", 
        RowBox[{"Sin", "[", "coneTheta2D", "]"}]}], "}"}], "//", "N"}]}], ";",
     "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCap", "=", 
     RowBox[{"{", 
      RowBox[{"coneCapAxis", ",", "coneAperture"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"newLightSg3D", "=", 
     RowBox[{
      RowBox[{"Quiet", "@", 
       RowBox[{"sgCapIntsAsNewSG", "[", 
        RowBox[{"oldLightSg3D", ",", "coneCap"}], "]"}]}], "//", "N"}]}], ";",
     "\[IndentingNewLine]", "\t", 
    RowBox[{"newLightSg2D", "=", 
     RowBox[{"sgTo2D", "[", "newLightSg3D", "]"}]}], ";", "\t", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}]}], "|>"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#rightWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<cones\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<cone\>\"", "\[Rule]", "bentCone"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Cyan"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgPointLights\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "  ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenterCtrl"}], 
             ",", 
             RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadiusCtrl"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
             ",", 
             RowBox[{"\"\<shadingPos\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgPointLightNew", "[", 
                 RowBox[{
                 "#lightCenter", ",", "#lightRadius", ",", 
                  "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",", 
                  "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
             RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<SG Point Light\>\""}]}],
             "|>"}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenterCtrl\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadiusCtrl\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}],
           ",", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}]}], "|>"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lobes\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<origin\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadius"}], ",", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensity"}], ",", 
              RowBox[{"\"\<lobeFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#shadingPos", "+", 
                   RowBox[{"lightIntensity", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"sgVector", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ",", 
                    "oldLightSg2D"}], "]"}]}]}], ")"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Orange"}], ",", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<Old Light Lobe\>\""}]}], 
             "|>"}], ",", "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<origin\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadius"}], ",", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensity"}], ",", 
              RowBox[{"\"\<lobeFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#shadingPos", "+", 
                   RowBox[{"lightIntensity", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"sgVector", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ",", 
                    "newLightSg2D"}], "]"}]}]}], ")"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<New Light Lobe\>\""}]}], 
             "|>"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          RowBox[{"\"\<lightIntensity\>\"", "\[Rule]", "lightIntensity"}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}]}], "|>"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.5"}], ",", "1.5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "4"}], "}"}], ",", "1", ",", "5", ",", 
     "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "8"}], "}"}], ",", "5", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rightWallHeight", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "oldLightSg2D", ",", "oldLightSg3D", ",", "newLightSg3D", ",", 
    "newLightSg2D", ",", "bentCone", ",", "coneTheta2D", ",", "coneAperture", 
    ",", "coneCapAxis", ",", "coneCap"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8328840989236345`*^9, 3.832884136466921*^9}, {
   3.8328841729931517`*^9, 3.832884174427596*^9}, {3.832884612644613*^9, 
   3.8328846145180516`*^9}, {3.83291168154412*^9, 3.832911715909726*^9}, 
   3.8329140408456182`*^9, 3.8329151539432926`*^9, {3.832922772035689*^9, 
   3.8329227723558946`*^9}, {3.8329922842941356`*^9, 
   3.8329923009679303`*^9}, {3.83299443017552*^9, 3.832994434384427*^9}, 
   3.8330098206832514`*^9, {3.8330106778489733`*^9, 3.8330106794429693`*^9}, {
   3.833330232553832*^9, 
   3.8333302341466255`*^9}},ExpressionUUID->"9cdfe33d-d373-4c13-b3af-\
e36a49c13913"],

Cell[BoxData[
 StyleBox["\<\" Cone Cut SG Lobe(Point Light)\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.832884138788918*^9, {3.832884609611795*^9, 3.8328846152823725`*^9}, {
   3.8329116941641483`*^9, 3.8329117169908857`*^9}, 3.8329151566263113`*^9, 
   3.8329225617300663`*^9, {3.832925307448045*^9, 3.8329253207083673`*^9}, 
   3.8329261520087824`*^9, 3.8329264002063446`*^9, 3.832992301723938*^9, 
   3.8329937109629717`*^9, 3.832994435191346*^9, 3.8330097689928217`*^9, 
   3.8330098224287205`*^9, 3.8330099154971185`*^9, {3.8330100356530237`*^9, 
   3.8330100848465757`*^9}, 3.833010172482248*^9, 3.8330106118164034`*^9, 
   3.8330106816173677`*^9, 3.833011071293444*^9, 3.833261777641898*^9, 
   3.8332717677784386`*^9, 3.8332718000185585`*^9},
 CellLabel->
  "During evaluation of \
In[67]:=",ExpressionUUID->"9d8f829e-f99a-4cc3-b54f-6254ebd39fd7"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`leftWallHeight$$ = 
    1, $CellContext`lightCenter$$ = {-2.5, 
    1.5}, $CellContext`lightIntensity$$ = 8, $CellContext`lightRadius$$ = 
    4, $CellContext`rightWallHeight$$ = 
    1, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 1}, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-2.5, 1.5}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightRadius$$], 4}, 1, 5, 1}, {{
       Hold[$CellContext`lightIntensity$$], 8}, 5, 10}, {{
       Hold[$CellContext`leftWallHeight$$], 1}, 0, 2}, {{
       Hold[$CellContext`rightWallHeight$$], 1}, 0, 2}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`shadingPosX$$], -1}, -2, 2}}, Typeset`size$$ = {
    235., {89., 95.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$65968$$ = {0, 
    0}, $CellContext`lightRadius$65969$$ = 
    0, $CellContext`lightIntensity$65970$$ = 
    0, $CellContext`leftWallHeight$65971$$ = 
    0, $CellContext`rightWallHeight$65972$$ = 
    0, $CellContext`viewDir$65973$$ = {0, 
    0}, $CellContext`shadingPosX$65974$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`leftWallHeight$$ = 
        1, $CellContext`lightCenter$$ = {-2.5, 
         1.5}, $CellContext`lightIntensity$$ = 8, $CellContext`lightRadius$$ = 
        4, $CellContext`rightWallHeight$$ = 
        1, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 1}}, 
      "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$65968$$, {0,
          0}], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$65969$$, 0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$65970$$, 0], 
        Hold[$CellContext`leftWallHeight$$, \
$CellContext`leftWallHeight$65971$$, 0], 
        Hold[$CellContext`rightWallHeight$$, \
$CellContext`rightWallHeight$65972$$, 0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$65973$$, {0, 0}], 
        Hold[$CellContext`shadingPosX$$, $CellContext`shadingPosX$65974$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`oldLightSg2D = N[
          
          sgCommon`sgPointLightNew[$CellContext`lightCenter$$, \
$CellContext`lightRadius$$, $CellContext`lightIntensity$$, \
{$CellContext`shadingPosX$$, 0}]]; $CellContext`oldLightSg3D = 
        sgCommon`sgTo3D[$CellContext`oldLightSg2D]; $CellContext`bentCone = N[
          
          gUtils`gCreateCone[{$CellContext`shadingPosX$$, 
            0}, {-2, $CellContext`leftWallHeight$$}, {
           2, $CellContext`rightWallHeight$$}]]; $CellContext`coneTheta2D = N[
          Part[$CellContext`bentCone, 1]]; $CellContext`coneAperture = N[
          Part[$CellContext`bentCone, 2]]; $CellContext`coneCapAxis = N[{
           Cos[$CellContext`coneTheta2D], 0, 
           
           Sin[$CellContext`coneTheta2D]}]; $CellContext`coneCap = \
{$CellContext`coneCapAxis, $CellContext`coneAperture}; \
$CellContext`newLightSg3D = N[
          Quiet[
           
           sgCommon`sgCapIntsAsNewSG[$CellContext`oldLightSg3D, \
$CellContext`coneCap]]]; $CellContext`newLightSg2D = 
        sgCommon`sgTo2D[$CellContext`newLightSg3D]; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association["center" -> {
               Slot["shadingPosX"], 0}, "radius" -> 0.1, "color" -> Red]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightRadius" -> $CellContext`lightRadius$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["rightWallHeight"], "color" -> Green, "thickness" -> 
             0.015]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("cones" -> {
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "radius" -> 5, 
             "cone" -> $CellContext`bentCone, "color" -> Cyan]}& )[
           Association["shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("sgPointLights" -> {
            Association[
            "lightCenter" -> Slot["lightCenterCtrl"], "lightRadius" -> 
             Slot["lightRadiusCtrl"], "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "shadingPos" -> {
               Slot["shadingPosX"], 0}, "sgFunc" -> (sgCommon`sgPointLightNew[
               Slot["lightCenter"], 
               Slot["lightRadius"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "color" -> Blue, "label" -> 
             "SG Point Light"]}& )[
           Association[
           "lightCenterCtrl" -> $CellContext`lightCenter$$, 
            "lightRadiusCtrl" -> $CellContext`lightRadius$$, 
            "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("lobes" -> {
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "lightCenter" -> Slot["lightCenter"], 
             "lightRadius" -> Slot["lightRadius"], "lightIntensity" -> 
             Slot["lightIntensity"], 
             "lobeFunc" -> (
              Slot["shadingPos"] + ($CellContext`lightIntensity$$ {
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}) sgCommon`sgVector[{
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}, $CellContext`oldLightSg2D]& ), "color" -> 
             Orange, "label" -> "Old Light Lobe"], 
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "lightCenter" -> Slot["lightCenter"], 
             "lightRadius" -> Slot["lightRadius"], "lightIntensity" -> 
             Slot["lightIntensity"], 
             "lobeFunc" -> (
              Slot["shadingPos"] + ($CellContext`lightIntensity$$ {
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}) sgCommon`sgVector[{
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}, $CellContext`newLightSg2D]& ), "color" -> 
             Red, "label" -> "New Light Lobe"]}& )[
           Association[
           "shadingPosX" -> $CellContext`shadingPosX$$, 
            "lightIntensity" -> $CellContext`lightIntensity$$, 
            "lightCenter" -> $CellContext`lightCenter$$, 
            "lightRadius" -> $CellContext`lightRadius$$]], "axisExtent" -> 
          5]]), "Specifications" :> {{{$CellContext`lightCenter$$, {-2.5, 
          1.5}}, {-4, -4}, {4, 4}}, {{$CellContext`lightRadius$$, 4}, 1, 5, 
         1}, {{$CellContext`lightIntensity$$, 8}, 5, 
         10}, {{$CellContext`leftWallHeight$$, 1}, 0, 
         2}, {{$CellContext`rightWallHeight$$, 1}, 0, 
         2}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`shadingPosX$$, -1}, -2, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{286., {113., 119.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8328841405983906`*^9, {3.832884609637725*^9, 3.832884615302644*^9}, {
   3.832911694191887*^9, 3.832911717013824*^9}, 3.832915156675432*^9, 
   3.832922561773341*^9, {3.8329253074999046`*^9, 3.8329253207642193`*^9}, 
   3.832926152046022*^9, 3.832926400239908*^9, 3.832992301763402*^9, 
   3.832993711002503*^9, 3.832994435225436*^9, 3.833009769022826*^9, 
   3.833009822460647*^9, 3.8330099155294685`*^9, {3.8330100356914*^9, 
   3.8330100848779583`*^9}, 3.833010172507181*^9, 3.8330106118501835`*^9, 
   3.8330106816472497`*^9, 3.8330110713266125`*^9, 3.833261777669595*^9, 
   3.8332717678207464`*^9, 3.833271800055035*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"dfea8a14-399d-4c0d-bbfb-7fea044451a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", "\"\<SG Lobe with Energy Percent(Point Light)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "oldLightSg2D", ",", "oldLightSg3D", ",", "newLightSg2D", ",", "bentCone", 
    ",", "coneTheta2D", ",", "coneAperture", ",", "coneCapAxis", ",", 
    "coneCap", ",", "energyPercent"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "    ", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"oldLightSg2D", "=", 
     RowBox[{
      RowBox[{"sgPointLightNew", "[", 
       RowBox[{"lightCenter", ",", "lightRadius", ",", "lightIntensity", ",", 
        RowBox[{"{", 
         RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}], "//", "N"}]}], 
    ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"oldLightSg3D", "=", 
     RowBox[{"sgTo3D", "[", "oldLightSg2D", "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"bentCone", "=", 
     RowBox[{
      RowBox[{"gCreateCone", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"shadingPosX", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}], "//", "N"}]}],
     ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"coneTheta2D", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneAperture", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCapAxis", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "coneTheta2D", "]"}], ",", "0", ",", 
        RowBox[{"Sin", "[", "coneTheta2D", "]"}]}], "}"}], "//", "N"}]}], ";",
     "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCap", "=", 
     RowBox[{"{", 
      RowBox[{"coneCapAxis", ",", "coneAperture"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", "\t", 
     RowBox[{
      RowBox[{"newLightSg3D", "=", 
       RowBox[{
        RowBox[{"Quiet", "@", 
         RowBox[{"sgCapIntsAsNewSG", "[", 
          RowBox[{"oldLightSg3D", ",", "coneCap"}], "]"}]}], "//", "N"}]}], 
      ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"newLightSg2D", "=", 
       RowBox[{"sgTo2D", "[", "newLightSg3D", "]"}]}], ";"}], "\t", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"energyPercent", "=", 
     RowBox[{"N", "@", 
      RowBox[{"sgCapIntsEnergyPercent", "[", 
       RowBox[{"oldLightSg3D", ",", "coneCap"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"newLightSg2D", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"oldLightSg2D", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"oldLightSg2D", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"energyPercent", "*", 
        RowBox[{"oldLightSg2D", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<center\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}]}], "|>"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#rightWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<cones\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<cone\>\"", "\[Rule]", "bentCone"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Cyan"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgPointLights\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "  ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenterCtrl"}], 
             ",", 
             RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadiusCtrl"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
             ",", 
             RowBox[{"\"\<shadingPos\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgPointLightNew", "[", 
                 RowBox[{
                 "#lightCenter", ",", "#lightRadius", ",", 
                  "\[IndentingNewLine]", "\t\t", "#lightIntensity", ",", 
                  "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
             RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<SG Point Light\>\""}]}],
             "|>"}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenterCtrl\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadiusCtrl\>\"", "\[Rule]", "lightRadius"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}],
           ",", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}]}], "|>"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lobes\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<origin\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadius"}], ",", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensity"}], ",", 
              RowBox[{"\"\<lobeFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#shadingPos", "+", 
                   RowBox[{"lightIntensity", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"sgVector", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ",", 
                    "oldLightSg2D"}], "]"}]}]}], ")"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Orange"}], ",", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<Old Light Lobe\>\""}]}], 
             "|>"}], ",", "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<origin\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "#lightRadius"}], ",", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensity"}], ",", 
              "\t", 
              RowBox[{"\"\<lobeFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#shadingPos", "+", 
                   RowBox[{"lightIntensity", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"sgVector", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ",", 
                    "newLightSg2D"}], "]"}]}]}], ")"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<New Light Lobe\>\""}]}], 
             "|>"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          RowBox[{"\"\<lightIntensity\>\"", "\[Rule]", "lightIntensity"}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightRadius\>\"", "\[Rule]", "lightRadius"}]}], "|>"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.5"}], ",", "1.5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightRadius", ",", "4"}], "}"}], ",", "1", ",", "5", ",", 
     "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "8"}], "}"}], ",", "5", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rightWallHeight", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"viewLightSg", ",", "oldLightSg3D"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"viewConeCap", ",", "coneCap"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"newEnergyPercent", ",", "energyPercent"}], "}"}], ",", "\t", 
   "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "oldLightSg2D", ",", "oldLightSg3D", ",", "newLightSg2D", ",", "bentCone", 
    ",", "coneTheta2D", ",", "coneAperture", ",", "coneCapAxis", ",", 
    "coneCap", ",", "energyPercent"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.832922607798257*^9, 3.832922617682316*^9}, {
   3.832922680175273*^9, 3.8329226963044977`*^9}, {3.832922729220224*^9, 
   3.832922835127955*^9}, {3.8329228769235306`*^9, 3.8329229236755095`*^9}, {
   3.832922959402855*^9, 3.832922984516342*^9}, {3.8329231314692025`*^9, 
   3.832923134231569*^9}, {3.832923247352398*^9, 3.8329232734554405`*^9}, {
   3.832923316710395*^9, 3.8329233283253155`*^9}, 3.832923736236533*^9, 
   3.8329238801757593`*^9, 3.8329253503667593`*^9, {3.8329253857562847`*^9, 
   3.832925399147842*^9}, {3.832925694902922*^9, 3.8329257063059163`*^9}, {
   3.8329258354253473`*^9, 3.83292588877999*^9}, {3.8329721754274216`*^9, 
   3.83297218704906*^9}, {3.832992307324808*^9, 3.8329923172142467`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"17abc6a5-d323-4681-95d4-d1fc44f8eb0a"],

Cell[BoxData[
 StyleBox["\<\" SG Lobe with Energy Percent(Point Light)\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.832922700446786*^9, 3.83292285352697*^9, {3.8329229253686743`*^9, 
   3.832922985073641*^9}, 3.8329231383809814`*^9, 3.832923175602621*^9, 
   3.8329232742092066`*^9, {3.8329233290111365`*^9, 3.8329233326809673`*^9}, 
   3.832923743358099*^9, 3.832923774058755*^9, 3.83292388155908*^9, {
   3.832925295874425*^9, 3.8329253215515957`*^9}, 3.8329253524204903`*^9, 
   3.832925399862708*^9, 3.832925707689928*^9, 3.832925889559903*^9, 
   3.832926097647607*^9, 3.8329261747639737`*^9, {3.8329923109109054`*^9, 
   3.8329923178533683`*^9}, 3.833009915962451*^9, {3.8330100361125164`*^9, 
   3.8330100852654715`*^9}, 3.833010172972164*^9, 3.8330106122335296`*^9, 
   3.8330106820613394`*^9, 3.8330110717451973`*^9, 3.833261780209213*^9, 
   3.8332664350646615`*^9, 3.8332717690135365`*^9, 3.8332718005126095`*^9},
 CellLabel->
  "During evaluation of \
In[78]:=",ExpressionUUID->"7369b52f-b3c7-4451-bbbd-a4f6bbac782f"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`leftWallHeight$$ = 
    1, $CellContext`lightCenter$$ = {-2.5, 
    1.5}, $CellContext`lightIntensity$$ = 8, $CellContext`lightRadius$$ = 
    4, $CellContext`newEnergyPercent$$ = 
    0.2883184998482484, $CellContext`rightWallHeight$$ = 
    1, $CellContext`shadingPosX$$ = -1, $CellContext`viewConeCap$$ = {{
     0.22975292054736127`, 0., 0.9732489894677302}, 
     1.0172219678978514`}, $CellContext`viewDir$$ = {1, 
    1}, $CellContext`viewLightSg$$ = {{-0.7071067811865476, 0, 
      0.7071067811865476}, 3.3580852076920147`, 0.6634482579925356}, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-2.5, 1.5}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightRadius$$], 4}, 1, 5, 1}, {{
       Hold[$CellContext`lightIntensity$$], 8}, 5, 10}, {{
       Hold[$CellContext`leftWallHeight$$], 1}, 0, 2}, {{
       Hold[$CellContext`rightWallHeight$$], 1}, 0, 2}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`shadingPosX$$], -1}, -2, 2}, {
      Hold[$CellContext`viewLightSg$$], {{-0.7071067811865476, 0, 
        0.7071067811865476}, 3.3580852076920147`, 0.6634482579925356}}, {
      Hold[$CellContext`viewConeCap$$], {{0.22975292054736127`, 0., 
       0.9732489894677302}, 1.0172219678978514`}}, {
      Hold[$CellContext`newEnergyPercent$$], 0.2883184998482484}}, 
    Typeset`size$$ = {235., {89., 95.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`lightCenter$66837$$ = {0, 
    0}, $CellContext`lightRadius$66838$$ = 
    0, $CellContext`lightIntensity$66839$$ = 
    0, $CellContext`leftWallHeight$66840$$ = 
    0, $CellContext`rightWallHeight$66841$$ = 
    0, $CellContext`viewDir$66842$$ = {0, 
    0}, $CellContext`shadingPosX$66843$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`leftWallHeight$$ = 
        1, $CellContext`lightCenter$$ = {-2.5, 
         1.5}, $CellContext`lightIntensity$$ = 8, $CellContext`lightRadius$$ = 
        4, $CellContext`newEnergyPercent$$ = $CellContext`energyPercent, \
$CellContext`rightWallHeight$$ = 
        1, $CellContext`shadingPosX$$ = -1, $CellContext`viewConeCap$$ = \
$CellContext`coneCap, $CellContext`viewDir$$ = {1, 
         1}, $CellContext`viewLightSg$$ = $CellContext`oldLightSg3D}, 
      "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$66837$$, {0,
          0}], 
        Hold[$CellContext`lightRadius$$, $CellContext`lightRadius$66838$$, 0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$66839$$, 0], 
        Hold[$CellContext`leftWallHeight$$, \
$CellContext`leftWallHeight$66840$$, 0], 
        Hold[$CellContext`rightWallHeight$$, \
$CellContext`rightWallHeight$66841$$, 0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$66842$$, {0, 0}], 
        Hold[$CellContext`shadingPosX$$, $CellContext`shadingPosX$66843$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`oldLightSg2D = N[
          
          sgCommon`sgPointLightNew[$CellContext`lightCenter$$, \
$CellContext`lightRadius$$, $CellContext`lightIntensity$$, \
{$CellContext`shadingPosX$$, 0}]]; $CellContext`oldLightSg3D = 
        sgCommon`sgTo3D[$CellContext`oldLightSg2D]; $CellContext`bentCone = N[
          
          gUtils`gCreateCone[{$CellContext`shadingPosX$$, 
            0}, {-2, $CellContext`leftWallHeight$$}, {
           2, $CellContext`rightWallHeight$$}]]; $CellContext`coneTheta2D = N[
          Part[$CellContext`bentCone, 1]]; $CellContext`coneAperture = N[
          Part[$CellContext`bentCone, 2]]; $CellContext`coneCapAxis = N[{
           Cos[$CellContext`coneTheta2D], 0, 
           
           Sin[$CellContext`coneTheta2D]}]; $CellContext`coneCap = \
{$CellContext`coneCapAxis, $CellContext`coneAperture}; \
$CellContext`energyPercent = N[
          
          sgCommon`sgCapIntsEnergyPercent[$CellContext`oldLightSg3D, \
$CellContext`coneCap]]; $CellContext`newLightSg2D = {
          Part[$CellContext`oldLightSg2D, 1], 
          Part[$CellContext`oldLightSg2D, 2], $CellContext`energyPercent 
          Part[$CellContext`oldLightSg2D, 3]}; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association["center" -> {
               Slot["shadingPosX"], 0}, "radius" -> 0.1, "color" -> Red]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightRadius" -> $CellContext`lightRadius$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["rightWallHeight"], "color" -> Green, "thickness" -> 
             0.015]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("cones" -> {
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "radius" -> 5, 
             "cone" -> $CellContext`bentCone, "color" -> Cyan]}& )[
           Association["shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("sgPointLights" -> {
            Association[
            "lightCenter" -> Slot["lightCenterCtrl"], "lightRadius" -> 
             Slot["lightRadiusCtrl"], "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "shadingPos" -> {
               Slot["shadingPosX"], 0}, "sgFunc" -> (sgCommon`sgPointLightNew[
               Slot["lightCenter"], 
               Slot["lightRadius"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "color" -> Blue, "label" -> 
             "SG Point Light"]}& )[
           Association[
           "lightCenterCtrl" -> $CellContext`lightCenter$$, 
            "lightRadiusCtrl" -> $CellContext`lightRadius$$, 
            "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("lobes" -> {
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "lightCenter" -> Slot["lightCenter"], 
             "lightRadius" -> Slot["lightRadius"], "lightIntensity" -> 
             Slot["lightIntensity"], 
             "lobeFunc" -> (
              Slot["shadingPos"] + ($CellContext`lightIntensity$$ {
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}) sgCommon`sgVector[{
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}, $CellContext`oldLightSg2D]& ), "color" -> 
             Orange, "label" -> "Old Light Lobe"], 
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "lightCenter" -> Slot["lightCenter"], 
             "lightRadius" -> Slot["lightRadius"], "lightIntensity" -> 
             Slot["lightIntensity"], 
             "lobeFunc" -> (
              Slot["shadingPos"] + ($CellContext`lightIntensity$$ {
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}) sgCommon`sgVector[{
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}, $CellContext`newLightSg2D]& ), "color" -> R\
ed, "label" -> "New Light Lobe"]}& )[
           Association[
           "shadingPosX" -> $CellContext`shadingPosX$$, 
            "lightIntensity" -> $CellContext`lightIntensity$$, 
            "lightCenter" -> $CellContext`lightCenter$$, 
            "lightRadius" -> $CellContext`lightRadius$$]], "axisExtent" -> 
          5]]), "Specifications" :> {{{$CellContext`lightCenter$$, {-2.5, 
          1.5}}, {-4, -4}, {4, 4}}, {{$CellContext`lightRadius$$, 4}, 1, 5, 
         1}, {{$CellContext`lightIntensity$$, 8}, 5, 
         10}, {{$CellContext`leftWallHeight$$, 1}, 0, 
         2}, {{$CellContext`rightWallHeight$$, 1}, 0, 
         2}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`shadingPosX$$, -1}, -2, 
         2}, {$CellContext`viewLightSg$$, $CellContext`oldLightSg3D}, \
{$CellContext`viewConeCap$$, $CellContext`coneCap}, \
{$CellContext`newEnergyPercent$$, $CellContext`energyPercent}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{286., {113., 119.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.832922700499672*^9, 3.8329228535779533`*^9, {3.8329229254221983`*^9, 
   3.83292298512251*^9}, 3.8329231384308476`*^9, 3.8329231756492786`*^9, 
   3.832923274255869*^9, {3.832923329056597*^9, 3.832923332725066*^9}, 
   3.832923743402667*^9, 3.8329237741047735`*^9, 3.8329238816172857`*^9, {
   3.8329252959089236`*^9, 3.832925321587471*^9}, 3.8329253524601173`*^9, 
   3.832925399910585*^9, 3.8329257077267904`*^9, 3.8329258895927863`*^9, 
   3.8329260976763353`*^9, 3.8329261747925143`*^9, {3.832992310947608*^9, 
   3.832992317880344*^9}, 3.83300991598938*^9, {3.833010036147427*^9, 
   3.833010085292368*^9}, 3.8330101730051365`*^9, 3.8330106122672596`*^9, 
   3.8330106820994687`*^9, 3.8330110717854557`*^9, 3.833261780243122*^9, 
   3.833266435089595*^9, 3.833271769055047*^9, 3.8332718005547256`*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"3dec1124-9843-476b-8010-c27f95df62ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Cone Cut SG Lobe(Sphere Light)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "oldLightSg2D", ",", "oldLightSg3D", ",", "newLightSg3D", ",", 
    "newLightSg2D", ",", "bentCone", ",", "coneTheta2D", ",", "coneAperture", 
    ",", "coneCapAxis", ",", "coneCap"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"oldLightSg2D", "=", 
     RowBox[{
      RowBox[{"sgSphereLight", "[", 
       RowBox[{
       "lightCenter", ",", "lightFadeStart", ",", "lightFadeEnd", ",", 
        "\[IndentingNewLine]", "\t\t", "lightIntensity", ",", 
        RowBox[{"{", 
         RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}], "//", "N"}]}], 
    ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"oldLightSg3D", "=", 
     RowBox[{"sgTo3D", "[", "oldLightSg2D", "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"bentCone", "=", 
     RowBox[{
      RowBox[{"gCreateCone", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"shadingPosX", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}], "//", "N"}]}],
     ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"coneTheta2D", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneAperture", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCapAxis", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "coneTheta2D", "]"}], ",", "0", ",", 
        RowBox[{"Sin", "[", "coneTheta2D", "]"}]}], "}"}], "//", "N"}]}], ";",
     "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCap", "=", 
     RowBox[{"{", 
      RowBox[{"coneCapAxis", ",", "coneAperture"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"newLightSg3D", "=", 
     RowBox[{
      RowBox[{"Quiet", "@", 
       RowBox[{"sgCapIntsAsNewSG", "[", 
        RowBox[{"oldLightSg3D", ",", "coneCap"}], "]"}]}], "//", "N"}]}], ";",
     "\[IndentingNewLine]", "\t", 
    RowBox[{"newLightSg2D", "=", 
     RowBox[{"sgTo2D", "[", "newLightSg3D", "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "inner", " ", "circle", " ", "of", " ", "sphere", " ", "light"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightFadeStart"}]}], 
             "|>"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}]}], "|>"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#rightWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<cones\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<cone\>\"", "\[Rule]", "bentCone"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Cyan"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgPointLights\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "  ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenterCtrl"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}],
              ",", 
             RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
             ",", 
             RowBox[{"\"\<shadingPos\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgSphereLight", "[", 
                 RowBox[{
                 "#lightCenter", ",", "#lightFadeStart", ",", "#lightFadeEnd",
                   ",", "\[IndentingNewLine]", "\t\t\t\t", "#lightIntensity", 
                  ",", "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
             RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<SG Point Light\>\""}]}],
             "|>"}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenterCtrl\>\"", "\[Rule]", "lightCenter"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}],
           ",", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}]}], "|>"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lobes\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<origin\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",",
               "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
              RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
              ",", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensity"}], ",", 
              RowBox[{"\"\<lobeFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#shadingPos", "+", 
                   RowBox[{"lightIntensity", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"sgVector", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ",", 
                    "oldLightSg2D"}], "]"}]}]}], ")"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Orange"}], ",", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<Old Light Lobe\>\""}]}], 
             "|>"}], ",", "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<origin\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",",
               "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
              RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
              ",", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensity"}], ",", 
              RowBox[{"\"\<lobeFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#shadingPos", "+", 
                   RowBox[{"lightIntensity", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"sgVector", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ",", 
                    "newLightSg2D"}], "]"}]}]}], ")"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<New Light Lobe\>\""}]}], 
             "|>"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          RowBox[{"\"\<lightIntensity\>\"", "\[Rule]", "lightIntensity"}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}]}], 
         "|>"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.5"}], ",", "1.5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "3"}], "}"}], ",", "1", ",", "3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "5"}], "}"}], ",", "3", ",", "20"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "2"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rightWallHeight", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "oldLightSg2D", ",", "oldLightSg3D", ",", "newLightSg3D", ",", 
    "newLightSg2D", ",", "bentCone", ",", "coneTheta2D", ",", "coneAperture", 
    ",", "coneCapAxis", ",", "coneCap"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.832993650476919*^9, 3.832993676541111*^9}, {
  3.8329944495205507`*^9, 3.832994452533823*^9}, {3.8329945091045685`*^9, 
  3.832994509831069*^9}, {3.833269731014951*^9, 3.8332697343744335`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"d4bf156d-8495-40c4-ba0f-22a2e192e79b"],

Cell[BoxData[
 StyleBox["\<\" Cone Cut SG Lobe(Sphere Light)\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{
  3.8329936839278526`*^9, 3.832993729568321*^9, 3.8329944533406343`*^9, 
   3.8329965931569033`*^9, 3.8330099162207603`*^9, {3.83301001224672*^9, 
   3.8330100854424715`*^9}, 3.8330101730996013`*^9, 3.8330106124191666`*^9, 
   3.8330106822665877`*^9, 3.833011071943594*^9, 3.833266416800376*^9, 
   3.833271769684746*^9, 3.833271800721922*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"954a8462-402f-4de0-b2f6-78f6b8d1c105"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`leftWallHeight$$ = 
    1, $CellContext`lightCenter$$ = {-2.5, 1.5}, $CellContext`lightFadeEnd$$ =
     5, $CellContext`lightFadeStart$$ = 3, $CellContext`lightIntensity$$ = 
    2, $CellContext`rightWallHeight$$ = 
    1, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 1}, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-2.5, 1.5}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightFadeStart$$], 3}, 1, 3}, {{
       Hold[$CellContext`lightFadeEnd$$], 5}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 2}, 1, 10}, {{
       Hold[$CellContext`leftWallHeight$$], 1}, 0, 2}, {{
       Hold[$CellContext`rightWallHeight$$], 1}, 0, 2}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`shadingPosX$$], -1}, -2, 2}}, Typeset`size$$ = {
    235., {101., 107.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$67182$$ = {0, 
    0}, $CellContext`lightFadeStart$67183$$ = 
    0, $CellContext`lightFadeEnd$67184$$ = 
    0, $CellContext`lightIntensity$67185$$ = 
    0, $CellContext`leftWallHeight$67186$$ = 
    0, $CellContext`rightWallHeight$67187$$ = 
    0, $CellContext`viewDir$67188$$ = {0, 
    0}, $CellContext`shadingPosX$67189$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`leftWallHeight$$ = 
        1, $CellContext`lightCenter$$ = {-2.5, 
         1.5}, $CellContext`lightFadeEnd$$ = 5, $CellContext`lightFadeStart$$ = 
        3, $CellContext`lightIntensity$$ = 2, $CellContext`rightWallHeight$$ = 
        1, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 1}}, 
      "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$67182$$, {0,
          0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$67183$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$67184$$, 
         0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$67185$$, 0], 
        Hold[$CellContext`leftWallHeight$$, \
$CellContext`leftWallHeight$67186$$, 0], 
        Hold[$CellContext`rightWallHeight$$, \
$CellContext`rightWallHeight$67187$$, 0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$67188$$, {0, 0}], 
        Hold[$CellContext`shadingPosX$$, $CellContext`shadingPosX$67189$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`oldLightSg2D = N[
          
          sgCommon`sgSphereLight[$CellContext`lightCenter$$, \
$CellContext`lightFadeStart$$, $CellContext`lightFadeEnd$$, \
$CellContext`lightIntensity$$, {$CellContext`shadingPosX$$, 
            0}]]; $CellContext`oldLightSg3D = 
        sgCommon`sgTo3D[$CellContext`oldLightSg2D]; $CellContext`bentCone = N[
          
          gUtils`gCreateCone[{$CellContext`shadingPosX$$, 
            0}, {-2, $CellContext`leftWallHeight$$}, {
           2, $CellContext`rightWallHeight$$}]]; $CellContext`coneTheta2D = N[
          Part[$CellContext`bentCone, 1]]; $CellContext`coneAperture = N[
          Part[$CellContext`bentCone, 2]]; $CellContext`coneCapAxis = N[{
           Cos[$CellContext`coneTheta2D], 0, 
           
           Sin[$CellContext`coneTheta2D]}]; $CellContext`coneCap = \
{$CellContext`coneCapAxis, $CellContext`coneAperture}; \
$CellContext`newLightSg3D = N[
          Quiet[
           
           sgCommon`sgCapIntsAsNewSG[$CellContext`oldLightSg3D, \
$CellContext`coneCap]]]; $CellContext`newLightSg2D = 
        sgCommon`sgTo2D[$CellContext`newLightSg3D]; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> 
             Slot["lightFadeStart"]], 
            Association["center" -> {
               Slot["shadingPosX"], 0}, "radius" -> 0.1, "color" -> Red]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["rightWallHeight"], "color" -> Green, "thickness" -> 
             0.015]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("cones" -> {
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "radius" -> 5, 
             "cone" -> $CellContext`bentCone, "color" -> Cyan]}& )[
           Association["shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("sgPointLights" -> {
            Association[
            "lightCenter" -> Slot["lightCenterCtrl"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "lightIntensity" -> Slot["lightIntensityCtrl"], "shadingPos" -> {
               Slot["shadingPosX"], 0}, "sgFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "color" -> Blue, "label" -> 
             "SG Point Light"]}& )[
           Association[
           "lightCenterCtrl" -> $CellContext`lightCenter$$, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "lightFadeEnd" -> $CellContext`lightFadeEnd$$, 
            "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("lobes" -> {
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "lightCenter" -> Slot["lightCenter"], 
             "lightFadeStart" -> Slot["lightFadeStart"], "lightFadeEnd" -> 
             Slot["lightFadeEnd"], "lightIntensity" -> Slot["lightIntensity"],
              "lobeFunc" -> (
              Slot["shadingPos"] + ($CellContext`lightIntensity$$ {
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}) sgCommon`sgVector[{
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}, $CellContext`oldLightSg2D]& ), "color" -> 
             Orange, "label" -> "Old Light Lobe"], 
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "lightCenter" -> Slot["lightCenter"], 
             "lightFadeStart" -> Slot["lightFadeStart"], "lightFadeEnd" -> 
             Slot["lightFadeEnd"], "lightIntensity" -> Slot["lightIntensity"],
              "lobeFunc" -> (
              Slot["shadingPos"] + ($CellContext`lightIntensity$$ {
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}) sgCommon`sgVector[{
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}, $CellContext`newLightSg2D]& ), "color" -> 
             Red, "label" -> "New Light Lobe"]}& )[
           Association[
           "shadingPosX" -> $CellContext`shadingPosX$$, 
            "lightIntensity" -> $CellContext`lightIntensity$$, 
            "lightCenter" -> $CellContext`lightCenter$$, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "lightFadeEnd" -> $CellContext`lightFadeEnd$$]], "axisExtent" -> 
          5]]), "Specifications" :> {{{$CellContext`lightCenter$$, {-2.5, 
          1.5}}, {-4, -4}, {4, 4}}, {{$CellContext`lightFadeStart$$, 3}, 1, 
         3}, {{$CellContext`lightFadeEnd$$, 5}, 3, 
         20}, {{$CellContext`lightIntensity$$, 2}, 1, 
         10}, {{$CellContext`leftWallHeight$$, 1}, 0, 
         2}, {{$CellContext`rightWallHeight$$, 1}, 0, 
         2}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`shadingPosX$$, -1}, -2, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{286., {125., 131.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.832993683967664*^9, 3.832993729595724*^9, 3.83299445337255*^9, 
   3.832996593206297*^9, 3.8330001287381396`*^9, 3.833009916248686*^9, {
   3.8330100122746725`*^9, 3.833010085468989*^9}, 3.833010173124159*^9, 
   3.833010612449044*^9, 3.8330106822985015`*^9, 3.8330110719741545`*^9, 
   3.833266416837508*^9, 3.8332717697216277`*^9, 3.8332718007596474`*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"d3e30d7d-64a1-4e1d-9816-beb09cfd5e1e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "gPrint", "[", "\"\<SG Lobe with Area Percent(Sphere Light)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "oldLightSg2D", ",", "oldLightSg3D", ",", "newLightSg3D", ",", 
    "newLightSg2D", ",", "bentCone", ",", "\[IndentingNewLine]", "\t", 
    "coneTheta2D", ",", "coneAperture", ",", "coneCapAxis", ",", "coneCap", 
    ",", "areaPercent"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"oldLightSg2D", "=", 
     RowBox[{
      RowBox[{"sgSphereLight", "[", 
       RowBox[{
       "lightCenter", ",", "lightFadeStart", ",", "\[IndentingNewLine]", 
        "\t\t", "lightFadeEnd", ",", "lightIntensity", ",", 
        RowBox[{"{", 
         RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}], "//", "N"}]}], 
    ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"oldLightSg3D", "=", 
     RowBox[{"sgTo3D", "[", "oldLightSg2D", "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"bentCone", "=", 
     RowBox[{
      RowBox[{"gCreateCone", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"shadingPosX", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}], "//", "N"}]}],
     ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"coneTheta2D", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneAperture", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCapAxis", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "coneTheta2D", "]"}], ",", "0", ",", 
        RowBox[{"Sin", "[", "coneTheta2D", "]"}]}], "}"}], "//", "N"}]}], ";",
     "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCap", "=", 
     RowBox[{"{", 
      RowBox[{"coneCapAxis", ",", "coneAperture"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"newLightSg3D", "=", 
       RowBox[{
        RowBox[{"Quiet", "@", 
         RowBox[{"sgCapIntsAsNewSG", "[", 
          RowBox[{"oldLightSg3D", ",", "coneCap"}], "]"}]}], "//", "N"}]}], 
      ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"newLightSg2D", "=", 
       RowBox[{"sgTo2D", "[", "newLightSg3D", "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"areaPercent", "=", 
     RowBox[{"sgCapIntsAreaPercent", "[", 
      RowBox[{"oldLightSg3D", ",", "coneCap"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"newLightSg2D", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"oldLightSg2D", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"oldLightSg2D", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"areaPercent", "*", 
        RowBox[{"oldLightSg2D", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "inner", " ", "circle", " ", "of", " ", "sphere", " ", "light"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightFadeStart"}]}], 
             "|>"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"shading", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}]}], "|>"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#rightWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<viewDir\>\"", "\[Rule]", "viewDir"}]}], "|>"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<cones\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<origin\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\"\<radius\>\"", "\[Rule]", "5"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<cone\>\"", "\[Rule]", "bentCone"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Cyan"}]}], "|>"}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgPointLights\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "  ", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenterCtrl"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}],
              ",", 
             RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
             ",", 
             RowBox[{"\"\<shadingPos\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<sgFunc\>\"", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sgSphereLight", "[", 
                 RowBox[{
                 "#lightCenter", ",", "#lightFadeStart", ",", "#lightFadeEnd",
                   ",", "\[IndentingNewLine]", "\t\t\t\t", "#lightIntensity", 
                  ",", "#shadingPos"}], "]"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
             RowBox[{"\"\<label\>\"", "\[Rule]", "\"\<SG Point Light\>\""}]}],
             "|>"}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenterCtrl\>\"", "\[Rule]", "lightCenter"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}],
           ",", 
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}]}], "|>"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lobes\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<origin\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",",
               "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
              RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
              ",", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensity"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<lobeFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#shadingPos", "+", 
                   RowBox[{"lightIntensity", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"sgVector", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ",", 
                    "oldLightSg2D"}], "]"}]}]}], ")"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Orange"}], ",", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<Old Light Lobe\>\""}]}], 
             "|>"}], ",", "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<origin\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#shadingPosX", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",",
               "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
              RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
              ",", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensity"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<lobeFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#shadingPos", "+", 
                   RowBox[{"lightIntensity", "*", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], "*", 
                    RowBox[{"sgVector", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "#\[Theta]", "]"}], ",", 
                    RowBox[{"Sin", "[", "#\[Theta]", "]"}]}], "}"}], ",", 
                    "newLightSg2D"}], "]"}]}]}], ")"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<New Light Lobe\>\""}]}], 
             "|>"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<shadingPosX\>\"", "\[Rule]", "shadingPosX"}], ",", 
          RowBox[{"\"\<lightIntensity\>\"", "\[Rule]", "lightIntensity"}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}]}], 
         "|>"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.5"}], ",", "1.5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "3"}], "}"}], ",", "1", ",", "3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "5"}], "}"}], ",", "3", ",", "20"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "2"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rightWallHeight", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"viewDir", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"newEnergyPercent", ",", "energyPercent"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "oldLightSg2D", ",", "oldLightSg3D", ",", "newLightSg3D", ",", 
    "newLightSg2D", ",", "bentCone", ",", "\[IndentingNewLine]", "\t", 
    "coneTheta2D", ",", "coneAperture", ",", "coneCapAxis", ",", "coneCap", 
    ",", "areaPercent"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8329946336457214`*^9, 3.8329946468633013`*^9}, {
  3.83326189566922*^9, 3.8332618962581162`*^9}, {3.833266392222726*^9, 
  3.833266401306746*^9}, {3.833269590089159*^9, 3.8332695906868067`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"8858df7c-bbe6-42b8-92fc-16fe303802ff"],

Cell[BoxData[
 StyleBox["\<\" SG Lobe with Area Percent(Sphere Light)\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.8330101734344244`*^9, 3.833010185639037*^9}, 
   3.833010298027852*^9, 3.833010494216446*^9, {3.833010609541645*^9, 
   3.833010612839196*^9}, 3.833010682688279*^9, 3.8330110723594885`*^9, 
   3.833261809662054*^9, 3.833266403593337*^9, 3.833266459037369*^9, 
   3.833269092874971*^9, 3.833271770180434*^9, 3.833271801163967*^9},
 CellLabel->
  "During evaluation of \
In[86]:=",ExpressionUUID->"e0e6b5a4-cf2b-48b5-ba19-01a84ec804cd"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`leftWallHeight$$ = 
    1, $CellContext`lightCenter$$ = {-2.5, 1.5}, $CellContext`lightFadeEnd$$ =
     5, $CellContext`lightFadeStart$$ = 3, $CellContext`lightIntensity$$ = 
    2, $CellContext`newEnergyPercent$$ = 
    0.2883184998482484, $CellContext`rightWallHeight$$ = 
    1, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 1}, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-2.5, 1.5}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightFadeStart$$], 3}, 1, 3}, {{
       Hold[$CellContext`lightFadeEnd$$], 5}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 2}, 1, 10}, {{
       Hold[$CellContext`leftWallHeight$$], 1}, 0, 2}, {{
       Hold[$CellContext`rightWallHeight$$], 1}, 0, 2}, {{
       Hold[$CellContext`viewDir$$], {1, 1}}, {-1, 0}, {1, 1}}, {{
       Hold[$CellContext`shadingPosX$$], -1}, -2, 2}, {
      Hold[$CellContext`newEnergyPercent$$], 0.2883184998482484}}, 
    Typeset`size$$ = {235., {101., 107.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`lightCenter$68082$$ = {0, 
    0}, $CellContext`lightFadeStart$68083$$ = 
    0, $CellContext`lightFadeEnd$68084$$ = 
    0, $CellContext`lightIntensity$68085$$ = 
    0, $CellContext`leftWallHeight$68086$$ = 
    0, $CellContext`rightWallHeight$68087$$ = 
    0, $CellContext`viewDir$68088$$ = {0, 
    0}, $CellContext`shadingPosX$68089$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`leftWallHeight$$ = 
        1, $CellContext`lightCenter$$ = {-2.5, 
         1.5}, $CellContext`lightFadeEnd$$ = 5, $CellContext`lightFadeStart$$ = 
        3, $CellContext`lightIntensity$$ = 2, $CellContext`newEnergyPercent$$ = 
        0.2883184998482484, $CellContext`rightWallHeight$$ = 
        1, $CellContext`shadingPosX$$ = -1, $CellContext`viewDir$$ = {1, 1}}, 
      "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$68082$$, {0,
          0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$68083$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$68084$$, 
         0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$68085$$, 0], 
        Hold[$CellContext`leftWallHeight$$, \
$CellContext`leftWallHeight$68086$$, 0], 
        Hold[$CellContext`rightWallHeight$$, \
$CellContext`rightWallHeight$68087$$, 0], 
        Hold[$CellContext`viewDir$$, $CellContext`viewDir$68088$$, {0, 0}], 
        Hold[$CellContext`shadingPosX$$, $CellContext`shadingPosX$68089$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`oldLightSg2D = N[
          
          sgCommon`sgSphereLight[$CellContext`lightCenter$$, \
$CellContext`lightFadeStart$$, $CellContext`lightFadeEnd$$, \
$CellContext`lightIntensity$$, {$CellContext`shadingPosX$$, 
            0}]]; $CellContext`oldLightSg3D = 
        sgCommon`sgTo3D[$CellContext`oldLightSg2D]; $CellContext`bentCone = N[
          
          gUtils`gCreateCone[{$CellContext`shadingPosX$$, 
            0}, {-2, $CellContext`leftWallHeight$$}, {
           2, $CellContext`rightWallHeight$$}]]; $CellContext`coneTheta2D = N[
          Part[$CellContext`bentCone, 1]]; $CellContext`coneAperture = N[
          Part[$CellContext`bentCone, 2]]; $CellContext`coneCapAxis = N[{
           Cos[$CellContext`coneTheta2D], 0, 
           
           Sin[$CellContext`coneTheta2D]}]; $CellContext`coneCap = \
{$CellContext`coneCapAxis, $CellContext`coneAperture}; \
$CellContext`areaPercent = 
        sgCommon`sgCapIntsAreaPercent[$CellContext`oldLightSg3D, \
$CellContext`coneCap]; $CellContext`newLightSg2D = {
          Part[$CellContext`oldLightSg2D, 1], 
          Part[$CellContext`oldLightSg2D, 2], $CellContext`areaPercent 
          Part[$CellContext`oldLightSg2D, 3]}; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> 
             Slot["lightFadeStart"]], 
            Association["center" -> {
               Slot["shadingPosX"], 0}, "radius" -> 0.1, "color" -> Red]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["rightWallHeight"], "color" -> Green, "thickness" -> 
             0.015]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight$$, 
            "viewDir" -> $CellContext`viewDir$$]], 
          ("cones" -> {
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "radius" -> 5, 
             "cone" -> $CellContext`bentCone, "color" -> Cyan]}& )[
           Association["shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("sgPointLights" -> {
            Association[
            "lightCenter" -> Slot["lightCenterCtrl"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "lightIntensity" -> Slot["lightIntensityCtrl"], "shadingPos" -> {
               Slot["shadingPosX"], 0}, "sgFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "color" -> Blue, "label" -> 
             "SG Point Light"]}& )[
           Association[
           "lightCenterCtrl" -> $CellContext`lightCenter$$, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "lightFadeEnd" -> $CellContext`lightFadeEnd$$, 
            "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
            "shadingPosX" -> $CellContext`shadingPosX$$]], 
          ("lobes" -> {
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "lightCenter" -> Slot["lightCenter"], 
             "lightFadeStart" -> Slot["lightFadeStart"], "lightFadeEnd" -> 
             Slot["lightFadeEnd"], "lightIntensity" -> Slot["lightIntensity"],
              "lobeFunc" -> (
              Slot["shadingPos"] + ($CellContext`lightIntensity$$ {
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}) sgCommon`sgVector[{
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}, $CellContext`oldLightSg2D]& ), "color" -> 
             Orange, "label" -> "Old Light Lobe"], 
            Association["origin" -> {
               Slot["shadingPosX"], 0}, "lightCenter" -> Slot["lightCenter"], 
             "lightFadeStart" -> Slot["lightFadeStart"], "lightFadeEnd" -> 
             Slot["lightFadeEnd"], "lightIntensity" -> Slot["lightIntensity"],
              "lobeFunc" -> (
              Slot["shadingPos"] + ($CellContext`lightIntensity$$ {
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}) sgCommon`sgVector[{
                  Cos[
                   Slot["\[Theta]"]], 
                  Sin[
                   Slot["\[Theta]"]]}, $CellContext`newLightSg2D]& ), "color" -> 
             Red, "label" -> "New Light Lobe"]}& )[
           Association[
           "shadingPosX" -> $CellContext`shadingPosX$$, 
            "lightIntensity" -> $CellContext`lightIntensity$$, 
            "lightCenter" -> $CellContext`lightCenter$$, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "lightFadeEnd" -> $CellContext`lightFadeEnd$$]], "axisExtent" -> 
          5]]), "Specifications" :> {{{$CellContext`lightCenter$$, {-2.5, 
          1.5}}, {-4, -4}, {4, 4}}, {{$CellContext`lightFadeStart$$, 3}, 1, 
         3}, {{$CellContext`lightFadeEnd$$, 5}, 3, 
         20}, {{$CellContext`lightIntensity$$, 2}, 1, 
         10}, {{$CellContext`leftWallHeight$$, 1}, 0, 
         2}, {{$CellContext`rightWallHeight$$, 1}, 0, 
         2}, {{$CellContext`viewDir$$, {1, 1}}, {-1, 0}, {1, 
         1}}, {{$CellContext`shadingPosX$$, -1}, -2, 
         2}, {$CellContext`newEnergyPercent$$, 0.2883184998482484}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{286., {125., 131.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8329946476052604`*^9, 3.8330099167209687`*^9, {3.833010036872306*^9, 
   3.833010085877676*^9}, {3.833010165924338*^9, 3.8330101856609783`*^9}, 
   3.833010298051817*^9, 3.833010494242568*^9, {3.833010609562589*^9, 
   3.833010612864436*^9}, 3.833010682716175*^9, 3.8330110723859224`*^9, 
   3.8332618096985903`*^9, 3.833266403628085*^9, 3.8332664590703144`*^9, 
   3.8332690929037457`*^9, 3.833271770214343*^9, 3.8332718012068524`*^9},
 CellLabel->"Out[88]=",ExpressionUUID->"238ba5c0-7a7e-4292-a040-b119190552f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Area Percent Ground Lighting\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "oldLightSg2D", ",", "oldLightSg3D", ",", "newLightSg3D", ",", 
    "newLightSg2D", ",", "bentCone", ",", "\[IndentingNewLine]", "\t", 
    "coneTheta2D", ",", "coneAperture", ",", "coneCapAxis", ",", "coneCap", 
    ",", "energyPercent"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"oldLightSg2D", "=", 
     RowBox[{
      RowBox[{"sgSphereLight", "[", 
       RowBox[{
       "lightCenter", ",", "lightFadeStart", ",", "lightFadeEnd", ",", 
        "lightIntensity", ",", 
        RowBox[{"{", 
         RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}], "//", "N"}]}], 
    ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"oldLightSg3D", "=", 
     RowBox[{"sgTo3D", "[", "oldLightSg2D", "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"bentCone", "=", 
     RowBox[{
      RowBox[{"gCreateCone", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"shadingPosX", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}], "//", "N"}]}],
     ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"coneTheta2D", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneAperture", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCapAxis", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "coneTheta2D", "]"}], ",", "0", ",", 
        RowBox[{"Sin", "[", "coneTheta2D", "]"}]}], "}"}], "//", "N"}]}], ";",
     "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCap", "=", 
     RowBox[{"{", 
      RowBox[{"coneCapAxis", ",", "coneAperture"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"newLightSg3D", "=", 
       RowBox[{
        RowBox[{"Quiet", "@", 
         RowBox[{"sgCapIntsAsNewSG", "[", 
          RowBox[{"oldLightSg3D", ",", "coneCap"}], "]"}]}], "//", "N"}]}], 
      ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"newLightSg2D", "=", 
       RowBox[{"sgTo2D", "[", "newLightSg3D", "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"energyPercent", "=", 
     RowBox[{"N", "@", 
      RowBox[{"sgCapIntsEnergyPercent", "[", 
       RowBox[{"oldLightSg3D", ",", "coneCap"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"newLightSg2D", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"oldLightSg2D", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"oldLightSg2D", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"energyPercent", "*", 
        RowBox[{"oldLightSg2D", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "inner", " ", "circle", " ", "of", " ", "sphere", " ", "light"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightFadeStart"}]}], 
             "|>"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"eye", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#eyePoint"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Magenta"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "eyePoint"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#rightWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}]}],
          "|>"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgGroundShadingWithWalls\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", "  ", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",",
               "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallXRange\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallHeights\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#leftWallHeight", ",", "#rightWallHeight"}], "}"}]}],
               ",", "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
              ",", 
              RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "#eyePoint"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgSphereLight", "[", 
                  RowBox[{
                  "#lightCenter", ",", "#lightFadeStart", ",", 
                   "#lightFadeEnd", ",", "\[IndentingNewLine]", "\t\t", 
                   "#lightIntensity", ",", "#shadingPos"}], "]"}], "&"}], 
                ")"}]}], ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDF", "[", 
                  RowBox[{
                  "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                   "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDFConvLight", "[", 
                  RowBox[{
                  "#lightRadius", ",", "#shadingDist", ",", "#sgLight", ",", 
                   "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgPercentStrategy\>\"", "\[Rule]", "1"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<SG Ground Lighting\>\""}]}], 
             "|>"}], ",", "\[IndentingNewLine]", "  ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",",
               "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallXRange\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallHeights\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#leftWallHeight", ",", "#rightWallHeight"}], "}"}]}],
               ",", "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
              ",", 
              RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "#eyePoint"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgSphereLight", "[", 
                  RowBox[{
                  "#lightCenter", ",", "#lightFadeStart", ",", 
                   "#lightFadeEnd", ",", "\[IndentingNewLine]", "\t\t", 
                   "#lightIntensity", ",", "#shadingPos"}], "]"}], "&"}], 
                ")"}]}], ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDF", "[", 
                  RowBox[{
                  "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                   "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDFConvLight", "[", 
                  RowBox[{
                  "#lightRadius", ",", "#shadingDist", ",", "#sgLight", ",", 
                   "#sgNDF"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgPercentStrategy\>\"", "\[Rule]", "3"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<Area Percent Lighting\>\""}]}],
              "|>"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}],
           ",", 
          RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "eyePoint"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
          ",", "\t\t", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.5"}], ",", "1.5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eyePoint", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "3"}], "}"}], ",", "1", ",", "3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "5"}], "}"}], ",", "3", ",", "20"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rightWallHeight", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"newEnergyPercent", ",", "energyPercent"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.1"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "oldLightSg2D", ",", "oldLightSg3D", ",", "newLightSg3D", ",", 
    "newLightSg2D", ",", "bentCone", ",", "\[IndentingNewLine]", "\t", 
    "coneTheta2D", ",", "coneAperture", ",", "coneCapAxis", ",", "coneCap", 
    ",", "energyPercent"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8330117178717904`*^9, 3.8330117444001517`*^9}, {
  3.833012922260478*^9, 3.833012949520753*^9}, {3.833319463340268*^9, 
  3.833319475633753*^9}},
 CellLabel->
  "In[286]:=",ExpressionUUID->"5d110519-2496-4cfa-ae17-1091b2da742c"],

Cell[BoxData[
 StyleBox["\<\" Area Percent Ground Lighting\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.833011730840335*^9, 3.8330117458163853`*^9}, {
   3.8330129009874945`*^9, 3.8330129436126704`*^9}, 3.833013042385259*^9, 
   3.833013137880535*^9, 3.8332609174581203`*^9, 3.8332710812692933`*^9, 
   3.833271770390901*^9, 3.8332718013953485`*^9, 3.8333194765279646`*^9},
 CellLabel->
  "During evaluation of \
In[286]:=",ExpressionUUID->"c2443c27-1c7c-4af9-9bed-3f963b80b138"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eyePoint$$ = {3, 
    3}, $CellContext`leftWallHeight$$ = 1, $CellContext`lightCenter$$ = {-2.5,
     1.5}, $CellContext`lightFadeEnd$$ = 5, $CellContext`lightFadeStart$$ = 
    3, $CellContext`lightIntensity$$ = 1, $CellContext`newEnergyPercent$$ = 
    0.3205859487415494, $CellContext`rightWallHeight$$ = 
    1, $CellContext`roughness$$ = 0.1, $CellContext`shadingPosX$$ = -1, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-2.5, 1.5}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`eyePoint$$], {3, 3}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightFadeStart$$], 3}, 1, 3}, {{
       Hold[$CellContext`lightFadeEnd$$], 5}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 1}, 1, 10}, {{
       Hold[$CellContext`leftWallHeight$$], 1}, 0, 2}, {{
       Hold[$CellContext`rightWallHeight$$], 1}, 0, 2}, {
      Hold[$CellContext`newEnergyPercent$$], 0.3205859487415494}, {{
       Hold[$CellContext`roughness$$], 0.1}, 0.05, 1}, {{
       Hold[$CellContext`shadingPosX$$], -1}, -2, 2}}, Typeset`size$$ = {
    256., {72., 78.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$1337698$$ = {0, 
    0}, $CellContext`eyePoint$1337699$$ = {0, 
    0}, $CellContext`lightFadeStart$1337700$$ = 
    0, $CellContext`lightFadeEnd$1337701$$ = 
    0, $CellContext`lightIntensity$1337702$$ = 
    0, $CellContext`leftWallHeight$1337703$$ = 
    0, $CellContext`rightWallHeight$1337704$$ = 
    0, $CellContext`roughness$1337705$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`eyePoint$$ = {3, 
         3}, $CellContext`leftWallHeight$$ = 
        1, $CellContext`lightCenter$$ = {-2.5, 
         1.5}, $CellContext`lightFadeEnd$$ = 5, $CellContext`lightFadeStart$$ = 
        3, $CellContext`lightIntensity$$ = 
        1, $CellContext`newEnergyPercent$$ = $CellContext`energyPercent, \
$CellContext`rightWallHeight$$ = 1, $CellContext`roughness$$ = 
        0.1, $CellContext`shadingPosX$$ = -1}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$1337698$$, {
         0, 0}], 
        Hold[$CellContext`eyePoint$$, $CellContext`eyePoint$1337699$$, {0, 
         0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$1337700$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$1337701$$,
          0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$1337702$$, 0], 
        Hold[$CellContext`leftWallHeight$$, \
$CellContext`leftWallHeight$1337703$$, 0], 
        Hold[$CellContext`rightWallHeight$$, \
$CellContext`rightWallHeight$1337704$$, 0], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$1337705$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`oldLightSg2D = N[
          
          sgCommon`sgSphereLight[$CellContext`lightCenter$$, \
$CellContext`lightFadeStart$$, $CellContext`lightFadeEnd$$, \
$CellContext`lightIntensity$$, {$CellContext`shadingPosX$$, 
            0}]]; $CellContext`oldLightSg3D = 
        sgCommon`sgTo3D[$CellContext`oldLightSg2D]; $CellContext`bentCone = N[
          
          gUtils`gCreateCone[{$CellContext`shadingPosX$$, 
            0}, {-2, $CellContext`leftWallHeight$$}, {
           2, $CellContext`rightWallHeight$$}]]; $CellContext`coneTheta2D = N[
          Part[$CellContext`bentCone, 1]]; $CellContext`coneAperture = N[
          Part[$CellContext`bentCone, 2]]; $CellContext`coneCapAxis = N[{
           Cos[$CellContext`coneTheta2D], 0, 
           
           Sin[$CellContext`coneTheta2D]}]; $CellContext`coneCap = \
{$CellContext`coneCapAxis, $CellContext`coneAperture}; \
$CellContext`energyPercent = N[
          
          sgCommon`sgCapIntsEnergyPercent[$CellContext`oldLightSg3D, \
$CellContext`coneCap]]; $CellContext`newLightSg2D = {
          Part[$CellContext`oldLightSg2D, 1], 
          Part[$CellContext`oldLightSg2D, 2], $CellContext`energyPercent 
          Part[$CellContext`oldLightSg2D, 3]}; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> 
             Slot["lightFadeStart"]], 
            Association[
            "center" -> Slot["eyePoint"], "radius" -> 0.1, "color" -> 
             Magenta]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "eyePoint" -> $CellContext`eyePoint$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["rightWallHeight"], "color" -> Green, "thickness" -> 
             0.015]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight$$]], 
          ("sgGroundShadingWithWalls" -> {
            Association[
            "lightCenter" -> Slot["lightCenter"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "wallXRange" -> {-2, 2}, "wallHeights" -> {
               Slot["leftWallHeight"], 
               Slot["rightWallHeight"]}, "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
             "eyePoint" -> Slot["eyePoint"], 
             "sgLightFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
               Slot["roughness"], 
               Slot["lightDir"], 
               Slot["viewDir"], 
               Slot["normalDir"]]& ), 
             "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
               Slot["lightRadius"], 
               Slot["shadingDist"], 
               Slot["sgLight"], 
               Slot["sgNDF"]]& ), "sgPercentStrategy" -> 1, "color" -> Red, 
             "label" -> "SG Ground Lighting"], 
            Association[
            "lightCenter" -> Slot["lightCenter"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "wallXRange" -> {-2, 2}, "wallHeights" -> {
               Slot["leftWallHeight"], 
               Slot["rightWallHeight"]}, "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
             "eyePoint" -> Slot["eyePoint"], 
             "sgLightFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
               Slot["roughness"], 
               Slot["lightDir"], 
               Slot["viewDir"], 
               Slot["normalDir"]]& ), 
             "sgShadingFunc" -> (sgCommon`sgNDFConvLight[
               Slot["lightRadius"], 
               Slot["shadingDist"], 
               Slot["sgLight"], 
               Slot["sgNDF"]]& ), "sgPercentStrategy" -> 3, "color" -> Blue, 
             "label" -> "Area Percent Lighting"]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "lightFadeEnd" -> $CellContext`lightFadeEnd$$, 
            "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
            "eyePoint" -> $CellContext`eyePoint$$, 
            "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight$$, 
            "roughness" -> $CellContext`roughness$$]], "axisExtent" -> 5]]), 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-2.5, 
          1.5}}, {-4, -4}, {4, 
         4}}, {{$CellContext`eyePoint$$, {3, 3}}, {-4, -4}, {4, 
         4}}, {{$CellContext`lightFadeStart$$, 3}, 1, 
         3}, {{$CellContext`lightFadeEnd$$, 5}, 3, 
         20}, {{$CellContext`lightIntensity$$, 1}, 1, 
         10}, {{$CellContext`leftWallHeight$$, 1}, 0, 
         2}, {{$CellContext`rightWallHeight$$, 1}, 0, 
         2}, {$CellContext`newEnergyPercent$$, $CellContext`energyPercent}, \
{{$CellContext`roughness$$, 0.1}, 0.05, 
         1}, {{$CellContext`shadingPosX$$, -1}, -2, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{307., {96., 102.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.833011730891535*^9, 3.833011745870762*^9}, {
   3.833012901021457*^9, 3.8330129436525636`*^9}, 3.8330130424166255`*^9, 
   3.8330131379180193`*^9, 3.833260917473427*^9, 3.833271081299756*^9, 
   3.8332717704227867`*^9, 3.8332718014382343`*^9, 3.8333194765739903`*^9},
 CellLabel->
  "Out[288]=",ExpressionUUID->"f3952af8-95eb-4753-b780-fc1befae4396"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gPrint", "[", "\"\<Energy Percent vs Area Percent\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "oldLightSg2D", ",", "oldLightSg3D", ",", "newLightSg3D", ",", 
    "newLightSg2D", ",", "bentCone", ",", "\[IndentingNewLine]", "\t", 
    "coneTheta2D", ",", "coneAperture", ",", "coneCapAxis", ",", "coneCap", 
    ",", "energyPercent"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"oldLightSg2D", "=", 
     RowBox[{
      RowBox[{"sgSphereLight", "[", 
       RowBox[{
       "lightCenter", ",", "lightFadeStart", ",", "lightFadeEnd", ",", 
        "lightIntensity", ",", 
        RowBox[{"{", 
         RowBox[{"shadingPosX", ",", "0"}], "}"}]}], "]"}], "//", "N"}]}], 
    ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"oldLightSg3D", "=", 
     RowBox[{"sgTo3D", "[", "oldLightSg2D", "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"bentCone", "=", 
     RowBox[{
      RowBox[{"gCreateCone", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"shadingPosX", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "leftWallHeight"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "rightWallHeight"}], "}"}]}], "]"}], "//", "N"}]}],
     ";", "\[IndentingNewLine]", "\t", 
    RowBox[{"coneTheta2D", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneAperture", "=", 
     RowBox[{
      RowBox[{"bentCone", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCapAxis", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "coneTheta2D", "]"}], ",", "0", ",", 
        RowBox[{"Sin", "[", "coneTheta2D", "]"}]}], "}"}], "//", "N"}]}], ";",
     "\[IndentingNewLine]", "\t", 
    RowBox[{"coneCap", "=", 
     RowBox[{"{", 
      RowBox[{"coneCapAxis", ",", "coneAperture"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"newLightSg3D", "=", 
       RowBox[{
        RowBox[{"Quiet", "@", 
         RowBox[{"sgCapIntsAsNewSG", "[", 
          RowBox[{"oldLightSg3D", ",", "coneCap"}], "]"}]}], "//", "N"}]}], 
      ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"newLightSg2D", "=", 
       RowBox[{"sgTo2D", "[", "newLightSg3D", "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"energyPercent", "=", 
     RowBox[{"N", "@", 
      RowBox[{"sgCapIntsEnergyPercent", "[", 
       RowBox[{"oldLightSg3D", ",", "coneCap"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"newLightSg2D", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"oldLightSg2D", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"oldLightSg2D", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"energyPercent", "*", 
        RowBox[{"oldLightSg2D", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
    RowBox[{"gParamPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<circles\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "inner", " ", "circle", " ", "of", " ", "sphere", " ", "light"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#lightCenter"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "#lightFadeStart"}]}], 
             "|>"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"eye", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<center\>\"", "\[Rule]", "#eyePoint"}], ",", 
              RowBox[{"\"\<radius\>\"", "\[Rule]", "0.1"}], ",", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Magenta"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "eyePoint"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<lines\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "ground", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "4"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"left", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "0"}], "}"}]}], ",", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#leftWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"right", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<startPos\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"\"\<dirVec\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"\"\<length\>\"", "\[Rule]", "#rightWallHeight"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Green"}], ",", 
              RowBox[{"\"\<thickness\>\"", "\[Rule]", "0.015"}]}], "|>"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}]}],
          "|>"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<sgGroundShadingWithWalls\>\"", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",",
               "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallXRange\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallHeights\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#leftWallHeight", ",", "#rightWallHeight"}], "}"}]}],
               ",", "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
              ",", 
              RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "#eyePoint"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgSphereLight", "[", 
                  RowBox[{
                  "#lightCenter", ",", "#lightFadeStart", ",", 
                   "#lightFadeEnd", ",", "\[IndentingNewLine]", "\t\t", 
                   "#lightIntensity", ",", "#shadingPos"}], "]"}], "&"}], 
                ")"}]}], ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDF", "[", 
                  RowBox[{
                  "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                   "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"1", "&"}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgPercentStrategy\>\"", "\[Rule]", "2"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Red"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<Energy Percent Only\>\""}]}], 
             "|>"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "#lightCenter"}], ",",
               "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightFadeStart\>\"", "\[Rule]", "#lightFadeStart"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "#lightFadeEnd"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallXRange\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<wallHeights\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"#leftWallHeight", ",", "#rightWallHeight"}], "}"}]}],
               ",", "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<lightIntensity\>\"", "\[Rule]", "#lightIntensityCtrl"}], 
              ",", 
              RowBox[{"\"\<roughness\>\"", "\[Rule]", "#roughness"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "#eyePoint"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgLightFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgSphereLight", "[", 
                  RowBox[{
                  "#lightCenter", ",", "#lightFadeStart", ",", 
                   "#lightFadeEnd", ",", "\[IndentingNewLine]", "\t\t", 
                   "#lightIntensity", ",", "#shadingPos"}], "]"}], "&"}], 
                ")"}]}], ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgNDFFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sgNDF", "[", 
                  RowBox[{
                  "#roughness", ",", "#lightDir", ",", "#viewDir", ",", 
                   "#normalDir"}], "]"}], "&"}], ")"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgShadingFunc\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"1", "&"}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<sgPercentStrategy\>\"", "\[Rule]", "3"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\"\<color\>\"", "\[Rule]", "Blue"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<label\>\"", "\[Rule]", "\"\<Area Percent Only\>\""}]}], 
             "|>"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<lightCenter\>\"", "\[Rule]", "lightCenter"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightFadeStart\>\"", "\[Rule]", "lightFadeStart"}], 
          ",", 
          RowBox[{"\"\<lightFadeEnd\>\"", "\[Rule]", "lightFadeEnd"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<lightIntensityCtrl\>\"", "\[Rule]", "lightIntensity"}],
           ",", 
          RowBox[{"\"\<eyePoint\>\"", "\[Rule]", "eyePoint"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<leftWallHeight\>\"", "\[Rule]", "leftWallHeight"}], 
          ",", 
          RowBox[{"\"\<rightWallHeight\>\"", "\[Rule]", "rightWallHeight"}], 
          ",", "\t\t", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<roughness\>\"", "\[Rule]", "roughness"}]}], "|>"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<axisExtent\>\"", "\[Rule]", "5"}]}], 
      "\[IndentingNewLine]", "|>"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightCenter", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.5"}], ",", "1.5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eyePoint", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4"}], ",", 
       RowBox[{"-", "4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeStart", ",", "3"}], "}"}], ",", "1", ",", "3"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightFadeEnd", ",", "5"}], "}"}], ",", "3", ",", "20"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lightIntensity", ",", "1"}], "}"}], ",", "1", ",", "10"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"leftWallHeight", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rightWallHeight", ",", "1"}], "}"}], ",", "0", ",", "2"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"newEnergyPercent", ",", "energyPercent"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roughness", ",", "0.1"}], "}"}], ",", "0.05", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shadingPosX", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<ShowControls\>\"", "\[Rule]", "False"}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "oldLightSg2D", ",", "oldLightSg3D", ",", "newLightSg3D", ",", 
    "newLightSg2D", ",", "bentCone", ",", "\[IndentingNewLine]", "\t", 
    "coneTheta2D", ",", "coneAperture", ",", "coneCapAxis", ",", "coneCap", 
    ",", "energyPercent"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8330118493919735`*^9, 3.8330118685331297`*^9}, {
   3.833012954522736*^9, 3.833012991074711*^9}, {3.833013057499757*^9, 
   3.8330130832914495`*^9}, {3.8332608568095436`*^9, 3.8332609214003124`*^9}, 
   3.833271666166235*^9, {3.83331949174123*^9, 3.8333195584685993`*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"6fb624ff-8a20-4ee1-ad85-3ad8d050b4fb"],

Cell[BoxData[
 StyleBox["\<\" Energy Percent vs Area Percent\"\>",
  StripOnInput->False,
  FontSize->18,
  Background->RGBColor[0.87, 0.94, 1]]], "Print",
 CellChangeTimes->{{3.8330118693046627`*^9, 3.833011888881838*^9}, 
   3.8330119334577413`*^9, 3.833012905079379*^9, {3.833012991754292*^9, 
   3.8330130839908686`*^9}, 3.833013141309551*^9, {3.8332608630261674`*^9, 
   3.833260922055332*^9}, {3.8332707400663958`*^9, 3.833270782462731*^9}, {
   3.8332708143910427`*^9, 3.8332708323432236`*^9}, 3.8332708929499493`*^9, {
   3.833270930882347*^9, 3.833270945032603*^9}, 3.8332710764512587`*^9, {
   3.8332715026549425`*^9, 3.833271514319378*^9}, 3.8332715498513494`*^9, {
   3.8332715947507353`*^9, 3.833271612884059*^9}, {3.8332716576498747`*^9, 
   3.8332716745225496`*^9}, 3.833271770772851*^9, 3.8332718018281455`*^9, {
   3.833319514613969*^9, 3.8333195733083687`*^9}},
 CellLabel->
  "During evaluation of \
In[306]:=",ExpressionUUID->"cc47796a-aff9-4bd1-ac5a-61bac5250863"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eyePoint$$ = {3, 
    3}, $CellContext`leftWallHeight$$ = 1, $CellContext`lightCenter$$ = {-2.5,
     1.5}, $CellContext`lightFadeEnd$$ = 5, $CellContext`lightFadeStart$$ = 
    3, $CellContext`lightIntensity$$ = 1, $CellContext`newEnergyPercent$$ = 
    0.3205859487415494, $CellContext`rightWallHeight$$ = 
    1, $CellContext`roughness$$ = 0.1, $CellContext`shadingPosX$$ = -1, 
    Typeset`show$$ = False, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lightCenter$$], {-2.5, 1.5}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`eyePoint$$], {3, 3}}, {-4, -4}, {4, 4}}, {{
       Hold[$CellContext`lightFadeStart$$], 3}, 1, 3}, {{
       Hold[$CellContext`lightFadeEnd$$], 5}, 3, 20}, {{
       Hold[$CellContext`lightIntensity$$], 1}, 1, 10}, {{
       Hold[$CellContext`leftWallHeight$$], 1}, 0, 2}, {{
       Hold[$CellContext`rightWallHeight$$], 1}, 0, 2}, {
      Hold[$CellContext`newEnergyPercent$$], 0.3205859487415494}, {{
       Hold[$CellContext`roughness$$], 0.1}, 0.05, 1}, {{
       Hold[$CellContext`shadingPosX$$], -1}, -2, 2}}, Typeset`size$$ = {
    242., {72., 78.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lightCenter$1833817$$ = {0, 
    0}, $CellContext`eyePoint$1833818$$ = {0, 
    0}, $CellContext`lightFadeStart$1833819$$ = 
    0, $CellContext`lightFadeEnd$1833820$$ = 
    0, $CellContext`lightIntensity$1833821$$ = 
    0, $CellContext`leftWallHeight$1833822$$ = 
    0, $CellContext`rightWallHeight$1833823$$ = 
    0, $CellContext`roughness$1833824$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`eyePoint$$ = {3, 
         3}, $CellContext`leftWallHeight$$ = 
        1, $CellContext`lightCenter$$ = {-2.5, 
         1.5}, $CellContext`lightFadeEnd$$ = 5, $CellContext`lightFadeStart$$ = 
        3, $CellContext`lightIntensity$$ = 
        1, $CellContext`newEnergyPercent$$ = $CellContext`energyPercent, \
$CellContext`rightWallHeight$$ = 1, $CellContext`roughness$$ = 
        0.1, $CellContext`shadingPosX$$ = -1}, "ControllerVariables" :> {
        Hold[$CellContext`lightCenter$$, $CellContext`lightCenter$1833817$$, {
         0, 0}], 
        Hold[$CellContext`eyePoint$$, $CellContext`eyePoint$1833818$$, {0, 
         0}], 
        Hold[$CellContext`lightFadeStart$$, \
$CellContext`lightFadeStart$1833819$$, 0], 
        Hold[$CellContext`lightFadeEnd$$, $CellContext`lightFadeEnd$1833820$$,
          0], 
        Hold[$CellContext`lightIntensity$$, \
$CellContext`lightIntensity$1833821$$, 0], 
        Hold[$CellContext`leftWallHeight$$, \
$CellContext`leftWallHeight$1833822$$, 0], 
        Hold[$CellContext`rightWallHeight$$, \
$CellContext`rightWallHeight$1833823$$, 0], 
        Hold[$CellContext`roughness$$, $CellContext`roughness$1833824$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`oldLightSg2D = N[
          
          sgCommon`sgSphereLight[$CellContext`lightCenter$$, \
$CellContext`lightFadeStart$$, $CellContext`lightFadeEnd$$, \
$CellContext`lightIntensity$$, {$CellContext`shadingPosX$$, 
            0}]]; $CellContext`oldLightSg3D = 
        sgCommon`sgTo3D[$CellContext`oldLightSg2D]; $CellContext`bentCone = N[
          
          gUtils`gCreateCone[{$CellContext`shadingPosX$$, 
            0}, {-2, $CellContext`leftWallHeight$$}, {
           2, $CellContext`rightWallHeight$$}]]; $CellContext`coneTheta2D = N[
          Part[$CellContext`bentCone, 1]]; $CellContext`coneAperture = N[
          Part[$CellContext`bentCone, 2]]; $CellContext`coneCapAxis = N[{
           Cos[$CellContext`coneTheta2D], 0, 
           
           Sin[$CellContext`coneTheta2D]}]; $CellContext`coneCap = \
{$CellContext`coneCapAxis, $CellContext`coneAperture}; \
$CellContext`energyPercent = N[
          
          sgCommon`sgCapIntsEnergyPercent[$CellContext`oldLightSg3D, \
$CellContext`coneCap]]; $CellContext`newLightSg2D = {
          Part[$CellContext`oldLightSg2D, 1], 
          Part[$CellContext`oldLightSg2D, 2], $CellContext`energyPercent 
          Part[$CellContext`oldLightSg2D, 3]}; gPlots`gParamPlot[
         Association[
          ("circles" -> {
            Association[
            "center" -> Slot["lightCenter"], "radius" -> 
             Slot["lightFadeStart"]], 
            Association[
            "center" -> Slot["eyePoint"], "radius" -> 0.1, "color" -> 
             Magenta]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "eyePoint" -> $CellContext`eyePoint$$]], 
          ("lines" -> {
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {1, 0}, "length" -> 4, "color" -> 
             Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {-2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["leftWallHeight"], "color" -> Green, "thickness" -> 0.015], 
            Association[
            "startPos" -> {2, 0}, "dirVec" -> {0, 1}, "length" -> 
             Slot["rightWallHeight"], "color" -> Green, "thickness" -> 
             0.015]}& )[
           Association[
           "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight$$]], 
          ("sgGroundShadingWithWalls" -> {
            Association[
            "lightCenter" -> Slot["lightCenter"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "wallXRange" -> {-2, 2}, "wallHeights" -> {
               Slot["leftWallHeight"], 
               Slot["rightWallHeight"]}, "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
             "eyePoint" -> Slot["eyePoint"], 
             "sgLightFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
               Slot["roughness"], 
               Slot["lightDir"], 
               Slot["viewDir"], 
               Slot["normalDir"]]& ), "sgShadingFunc" -> (1& ), 
             "sgPercentStrategy" -> 2, "color" -> Red, "label" -> 
             "Energy Percent Only"], 
            Association[
            "lightCenter" -> Slot["lightCenter"], "lightFadeStart" -> 
             Slot["lightFadeStart"], "lightFadeEnd" -> Slot["lightFadeEnd"], 
             "wallXRange" -> {-2, 2}, "wallHeights" -> {
               Slot["leftWallHeight"], 
               Slot["rightWallHeight"]}, "lightIntensity" -> 
             Slot["lightIntensityCtrl"], "roughness" -> Slot["roughness"], 
             "eyePoint" -> Slot["eyePoint"], 
             "sgLightFunc" -> (sgCommon`sgSphereLight[
               Slot["lightCenter"], 
               Slot["lightFadeStart"], 
               Slot["lightFadeEnd"], 
               Slot["lightIntensity"], 
               Slot["shadingPos"]]& ), "sgNDFFunc" -> (sgCommon`sgNDF[
               Slot["roughness"], 
               Slot["lightDir"], 
               Slot["viewDir"], 
               Slot["normalDir"]]& ), "sgShadingFunc" -> (1& ), 
             "sgPercentStrategy" -> 3, "color" -> Blue, "label" -> 
             "Area Percent Only"]}& )[
           Association[
           "lightCenter" -> $CellContext`lightCenter$$, 
            "lightFadeStart" -> $CellContext`lightFadeStart$$, 
            "lightFadeEnd" -> $CellContext`lightFadeEnd$$, 
            "lightIntensityCtrl" -> $CellContext`lightIntensity$$, 
            "eyePoint" -> $CellContext`eyePoint$$, 
            "leftWallHeight" -> $CellContext`leftWallHeight$$, 
            "rightWallHeight" -> $CellContext`rightWallHeight$$, 
            "roughness" -> $CellContext`roughness$$]], "axisExtent" -> 5]]), 
      "Specifications" :> {{{$CellContext`lightCenter$$, {-2.5, 
          1.5}}, {-4, -4}, {4, 
         4}}, {{$CellContext`eyePoint$$, {3, 3}}, {-4, -4}, {4, 
         4}}, {{$CellContext`lightFadeStart$$, 3}, 1, 
         3}, {{$CellContext`lightFadeEnd$$, 5}, 3, 
         20}, {{$CellContext`lightIntensity$$, 1}, 1, 
         10}, {{$CellContext`leftWallHeight$$, 1}, 0, 
         2}, {{$CellContext`rightWallHeight$$, 1}, 0, 
         2}, {$CellContext`newEnergyPercent$$, $CellContext`energyPercent}, \
{{$CellContext`roughness$$, 0.1}, 0.05, 
         1}, {{$CellContext`shadingPosX$$, -1}, -2, 2}}, 
      "Options" :> {Method -> {"ShowControls" -> False}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{293., {96., 102.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.83301186935668*^9, 3.8330118889089546`*^9}, 
   3.8330119334888425`*^9, 3.833012905115679*^9, {3.8330129917958045`*^9, 
   3.8330130840261955`*^9}, 3.833013141347453*^9, {3.8332608630451164`*^9, 
   3.8332609220815487`*^9}, {3.833270740096466*^9, 3.833270782488832*^9}, {
   3.8332708144191575`*^9, 3.833270832369867*^9}, 3.8332708929788723`*^9, {
   3.8332709309111557`*^9, 3.833270945067622*^9}, 3.833271076479184*^9, {
   3.833271502682869*^9, 3.833271514351965*^9}, 3.8332715498868265`*^9, {
   3.8332715947792544`*^9, 3.8332716129174747`*^9}, {3.8332716576784844`*^9, 
   3.833271674558353*^9}, 3.8332717708077583`*^9, 3.8332718018656235`*^9, {
   3.83331951466284*^9, 3.83331957335428*^9}},
 CellLabel->
  "Out[308]=",ExpressionUUID->"93f838a0-3c16-4be0-92e8-d4c2a93926f1"]
}, Open  ]]
},
WindowSize->{904, 803},
WindowMargins->{{306, Automatic}, {13, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 16124, 373, 1549, "Input",ExpressionUUID->"9cdfe33d-d373-4c13-b3af-e36a49c13913"],
Cell[16707, 397, 930, 17, 30, "Print",ExpressionUUID->"9d8f829e-f99a-4cc3-b54f-6254ebd39fd7"],
Cell[17640, 416, 9324, 181, 251, "Output",ExpressionUUID->"dfea8a14-399d-4c0d-bbfb-7fea044451a2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27001, 602, 16642, 381, 1492, "Input",ExpressionUUID->"17abc6a5-d323-4681-95d4-d1fc44f8eb0a"],
Cell[43646, 985, 1103, 19, 30, "Print",ExpressionUUID->"7369b52f-b3c7-4451-bbbd-a4f6bbac782f"],
Cell[44752, 1006, 10602, 201, 251, "Output",ExpressionUUID->"3dec1124-9843-476b-8010-c27f95df62ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55391, 1212, 16451, 377, 1549, "Input",ExpressionUUID->"d4bf156d-8495-40c4-ba0f-22a2e192e79b"],
Cell[71845, 1591, 624, 13, 30, "Print",ExpressionUUID->"954a8462-402f-4de0-b2f6-78f6b8d1c105"],
Cell[72472, 1606, 9858, 190, 275, "Output",ExpressionUUID->"d3e30d7d-64a1-4e1d-9816-beb09cfd5e1e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82367, 1801, 17407, 402, 1644, "Input",ExpressionUUID->"8858df7c-bbe6-42b8-92fc-16fe303802ff"],
Cell[99777, 2205, 621, 12, 30, "Print",ExpressionUUID->"e0e6b5a4-cf2b-48b5-ba19-01a84ec804cd"],
Cell[100401, 2219, 10279, 196, 275, "Output",ExpressionUUID->"238ba5c0-7a7e-4292-a040-b119190552f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110717, 2420, 17038, 394, 1682, "Input",ExpressionUUID->"5d110519-2496-4cfa-ae17-1091b2da742c"],
Cell[127758, 2816, 551, 11, 30, "Print",ExpressionUUID->"c2443c27-1c7c-4af9-9bed-3f963b80b138"],
Cell[128312, 2829, 10171, 197, 217, "Output",ExpressionUUID->"f3952af8-95eb-4753-b780-fc1befae4396"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138520, 3031, 16738, 385, 1682, "Input",ExpressionUUID->"6fb624ff-8a20-4ee1-ad85-3ad8d050b4fb"],
Cell[155261, 3418, 985, 17, 30, "Print",ExpressionUUID->"cc47796a-aff9-4bd1-ac5a-61bac5250863"],
Cell[156249, 3437, 10277, 195, 217, "Output",ExpressionUUID->"93f838a0-3c16-4be0-92e8-d4c2a93926f1"]
}, Open  ]]
}
]
*)

